import{bE as Rs,bF as Pr,aQ as li,m as v,s as M,l as R,bG as $r,o as c,c as y,j as A,b as t,ab as we,p as q,q as Ce,n as H,y as _o,a as m,w as x,f as ce,t as k,h as Ee,i as D,H as Ge,_ as We,bH as Nr,bI as Dr,b6 as nt,a_ as ye,bJ as Tl,br as ni,u as Ne,e as U,a8 as ga,r as fe,F as ee,b9 as za,bK as Dl,ap as qe,bL as Us,am as He,aG as Ol,aF as Fl,bM as Ba,aN as De,b4 as El,A as Qe,bg as Or,bh as Fr,a0 as Zs,x as Je,b1 as st,bj as _t,aX as at,bk as Mr,bl as St,af as pt,bb as yo,bN as Vr,bO as bo,bP as Br,bi as et,bQ as $i,D as Be,E as Ll,G as rt,v as ii,b7 as va,b8 as _a,aJ as Ta,bR as Rr,bS as oi,bT as ms,bU as Sa,bV as Ni,bW as qr,bX as Ur,al as it,bY as ri,aR as yt,bZ as ko,b_ as Co,b$ as bs,c0 as ks,aW as mt,g as Di,b5 as ht,c1 as hs,c2 as zr,by as ja,c3 as xo,ad as wo,c4 as Dt,c5 as Bt,aB as zt,c6 as ia,c7 as Gs,aC as To,c8 as jt,c9 as Ia,ay as Eo,an as Lo,ca as jr,aO as Js,cb as Yr,cc as vs,aq as tt,cd as ci,ce as Wr,cf as Hr,cg as Oi,ch as Fi,bm as dt,ci as So,bf as Zr,cj as Ml,a5 as Gr,aU as Pa,aT as Vl,aZ as Jr,ck as Xr,cl as Qr,cm as Ao,cn as Kr,co as ec,cp as tc,cq as ac,cr as sc,cs as ui,ct as lc,cu as nc,cv as Mi,cw as ic,ac as oc,ah as rc}from"./stepForm.3a26f058.js";import{e as cc,n as Ye,o as uc,m as Ke,p as Sl}from"./eventListForm.ba52eebf.js";function Nt(n,a){let e=a!==""?JSON.parse(n.translations)[a]:JSON.parse(n.translations);if(Rs in e)return e[Rs];let s=Object.keys(e),l=Object.keys(e).map(o=>o.length>2?o.slice(0,2):o),i="";for(let o=0;o<l.length;o++){if(Pr===s[o]&&e[s[o]]){i=e[s[o]];break}l[o]===Rs&&e[s[o]]&&(i=e[s[o]])}return i}function $n(n,a){return n.translations&&JSON.parse(n.translations)[a]&&Nt(n,a)?Nt(n,a):n[a]}function Vt(n){return n.translations&&JSON.parse(n.translations).name&&Nt(n,"name")?Nt(n,"name"):n.name}function dc(n){return n.translations&&Nt(n,"")?Nt(n,""):n.name}function DC(n){return n.translations&&Nt(n,"")?Nt(n,""):n.content}function mc(n){return n.translations&&Nt(n,"name")?Nt(n,"name"):n.label}function pc(n){return n.translations&&Nt(n,"")?Nt(n,""):n.label}function na(n){return n.translations&&JSON.parse(n.translations).description&&Nt(n,"description")?Nt(n,"description"):n.description}function OC(n){n.services&&n.services.length&&n.services.forEach(a=>{a.name=Vt(a),a.description=na(a),a.extras.forEach(e=>{e.name=Vt(e),e.description=na(e)})}),n.locations&&n.locations.length&&n.locations.forEach(a=>{a.name=Vt(a),a.description=na(a)}),n.packages&&n.packages.length&&n.packages.forEach(a=>{a.name=Vt(a),a.description=na(a),a.bookable.forEach(e=>{e.service.name=Vt(e.service),e.service.description=na(e.service),"extras"in e.service&&e.service.extras.forEach(s=>{s.name=Vt(s),s.description=na(s)})})}),n.categories&&n.categories.length&&n.categories.forEach(a=>{a.name=Vt(a),a.serviceList.forEach(e=>{e.name=Vt(e),e.description=na(e),e.extras.forEach(s=>{s.name=Vt(s),s.description=na(s)})})}),n.events&&n.events.length&&n.events.forEach(a=>{a.name=Vt(a),a.description=na(a),a.extras.forEach(e=>{e.name=Vt(e),e.description=na(e)})}),n.customFields&&n.customFields.length&&n.customFields.forEach(a=>{a.label=mc(a),a.options.forEach(e=>{e.label=pc(e)})}),n.employees&&n.employees.length&&n.employees.forEach(a=>{a.firstName=$n(a,"firstName"),a.lastName=$n(a,"lastName"),a.description=$n(a,"description")})}const lt={props:{modelValue:{type:[Boolean,String,Number],default:!1},id:{type:String},name:{type:String},width:{type:[Number,String]},size:{type:String,default:"default",validator(n){return["large","default","small"].includes(n)}},validateEvent:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},activeColor:{type:String},inactiveColor:{type:String},activeText:{type:String},inactiveText:{type:String},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeIconClass:{type:String},inactiveIconClass:{type:String},activeIcon:{type:String},inactiveIcon:{type:String},beforeChange:{type:[Function,Boolean],default:()=>{}},borderColor:{type:String},inlinePrompt:{type:Boolean,default:!1},parentClass:{type:String},class:{type:String},ariaLabel:{type:String}},emits:["update:modelValue","change"],setup(n,{emit:a}){const e=n,{modelValue:s}=li(e),l=v({get:()=>s.value,set:u=>a("update:modelValue",u)}),i=M(null),o=R("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF",colorBtnWaiting:"#CCA20C",colorBtnWaitingText:"#FFFFFF",colorBtnDanger:"#B4190F",colorBtnDangerText:"#FFFFFF"})),r=v(()=>({"--am-c-switch-bgr-active":o.value.colorPrimary,"--am-c-switch-bgr-inactive":o.value.colorInpBorder,"--am-c-switch-action":o.value.colorMainBgr,"--am-c-switch-text":o.value.colorMainText}));return(u,d)=>{const f=$r;return c(),y("div",{class:q(["am-switch-wrapper",n.parentClass]),style:Ce(t(r))},[A(f,{id:n.id,ref_key:"amSwitch",ref:i,modelValue:t(l),"onUpdate:modelValue":d[0]||(d[0]=_=>we(l)?l.value=_:null),class:q(["am-switch",e.class]),name:n.name,width:n.width,size:n.size,"validate-event":n.validateEvent,loading:n.loading,disabled:n.disabled,"active-color":n.activeColor,"inactive-color":n.inactiveColor,"active-text":n.activeText,"inactive-text":n.inactiveText,"active-value":n.activeValue,"inactive-value":n.inactiveValue,"active-icon-class":n.activeIconClass,"inactive-icon-class":n.inactiveIconClass,"active-icon":n.activeIcon,"inactive-icon":n.inactiveIcon,"before-change":n.beforeChange,"border-color":n.borderColor,"inline-prompt":n.inlinePrompt,"aria-label":n.ariaLabel,onChange:d[1]||(d[1]=_=>a("change",_))},null,8,["id","modelValue","class","name","width","size","validate-event","loading","disabled","active-color","inactive-color","active-text","inactive-text","active-value","inactive-value","active-icon-class","inactive-icon-class","active-icon","inactive-icon","before-change","border-color","inline-prompt","aria-label"])],6)}}};const gc={props:{ready:{type:Boolean,default:!0}},setup(n){let a=R("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),e=v(()=>({"--am-c-caph-text":a.value.colorMainText,"--am-c-caph-heading-text":a.value.colorMainHeadingText,"--am-c-caph-text-op15":H(a.value.colorMainText,.15)}));return(s,l)=>(c(),y("div",{class:"am-caph__main",style:Ce(t(e))},[_o(s.$slots,"default")],4))}};const fc={key:0},hc={key:1},vc={key:2},_c={name:"MainProfileFooter"},yc=Object.assign(_c,{props:{parentWidth:{type:Number,default:1200},display:{type:String,default:"first"},loading:{type:Boolean,default:!1},customizedLabels:{type:Object,default:()=>({})},deleteFooterType:{type:String,default:"plain"},saveFooterButton:{type:String,default:"filled"},passFooterButton:{type:String,default:"filled"}},setup(n){const a=n,e=R("labels");function s(_){return Object.keys(a.customizedLabels).length&&a.customizedLabels[_]?a.customizedLabels[_]:e[_]}const l=R("settings");let i=R("deleteProfileDialog",M(!1)),o=R("saveProfileChanges",()=>{}),r=R("saveCustomerCustomFields",()=>{}),u=R("changeProfilePassword",()=>{}),d=R("amColors"),f=v(()=>({"--am-c-cappf-bgr":d.value.colorMainBgr,"--am-c-cappf-text":d.value.colorMainText,"--am-c-cappf-text-op15":H(d.value.colorMainText,.15)}));return(_,g)=>(c(),y("div",{class:"am-cappf",style:Ce(t(f))},[m("div",{class:q(["am-cappf__options",{"am-only-one":n.display==="second"||!t(l).roles.allowCustomerDeleteProfile}])},[n.display==="first"&&t(l).roles.allowCustomerDeleteProfile?(c(),y("div",fc,[A(Ee,{category:"danger",size:t(a).parentWidth<=360?"small":"default",type:t(a).deleteFooterType,class:"am-cappf__delete",disabled:n.loading,onClick:g[0]||(g[0]=C=>we(i)?i.value=!0:i=!0)},{default:x(()=>[ce(k(s("delete_profile")),1)]),_:1},8,["size","type","disabled"])])):D("",!0),n.display==="first"||n.display==="third"?(c(),y("div",hc,[A(Ee,{type:t(a).saveFooterButton,size:t(a).parentWidth<=360?"small":"default",disabled:n.loading,onClick:g[1]||(g[1]=C=>n.display==="first"?t(o)():t(r)())},{default:x(()=>[ce(k(s("save_changes")),1)]),_:1},8,["type","size","disabled"])])):D("",!0),n.display==="second"?(c(),y("div",vc,[A(Ee,{type:t(a).passFooterButton,size:t(a).parentWidth<=360?"small":"default",disabled:n.loading,onClick:g[2]||(g[2]=C=>t(u)())},{default:x(()=>[ce(k(s("change_password")),1)]),_:1},8,["type","size","disabled"])])):D("",!0)],2)],4))}});const bc={key:0,class:"am-date-picker__input-date"},kc={key:1,class:"am-date-picker__input-start"},Cc={key:2,class:"am-date-picker__input-end"},Yt={props:{modelValue:{type:[String,Array,Object,Number]},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!1},placeholder:{type:String,default:""},startPlaceholder:{type:String},endPlaceholder:{type:String},type:{type:String,default:"date",validator(n){return["year","years","month","months","date","dates","datetime","week","datetimerange","daterange","monthrange","yearrange"].includes(n)}},format:{type:String},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>{}},rangeSeparator:{type:String,default:"-"},defaultValue:{type:[String,Array,Object,Number]},defaultTime:{type:[String,Array,Object,Number]},valueFormat:{type:String},id:{type:[String,Array]},name:{type:[String,Array]},unlinkPanels:{type:Boolean,default:!1},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="calendar"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="close"/>'})},validateEvent:{type:Boolean,default:!0},disabledDate:{type:Function,default:()=>{}},shortcuts:{type:Array,default:()=>[]},cellClassName:{type:Function},teleported:{type:Boolean,default:!0},emptyValues:{type:[String,Array]},valueOnClear:{type:[String,Number,Boolean,Function],default:""},fallbackPlacements:{type:Array},placement:{type:String,default:"bottom",validator(n){return["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"].includes(n)}},lang:{type:String,default:""}},emits:["update:modelValue","change","blur","focus","clear","calendar-change","panel-change","visible-change"],setup(n,{emit:a}){const e=n;let{modelValue:s}=li(e),l=v({get:()=>s.value,set:d=>{a("update:modelValue",d)}});const i=M(null);function o(){i.value&&i.value.focus()}let r=R("amColors"),u=v(()=>({"--am-c-primary":r.value.colorPrimary,"--am-c-inp-bgr":r.value.colorInpBgr,"--am-c-inp-border":r.value.colorInpBorder,"--am-c-inp-text":r.value.colorInpText,"--am-c-inp-text-op03":H(r.value.colorInpText,.03),"--am-c-inp-text-op05":H(r.value.colorInpText,.05),"--am-c-inp-text-op40":H(r.value.colorInpText,.4),"--am-c-inp-text-op60":H(r.value.colorInpText,.6),"--am-c-inp-placeholder":r.value.colorInpPlaceHolder,"--am-c-drop-bgr":r.value.colorDropBgr,"--am-c-drop-text":r.value.colorDropText,"--am-c-drop-text-op03":H(r.value.colorDropText,.03),"--am-c-drop-text-op10":H(r.value.colorDropText,.1),"--am-c-drop-text-op30":H(r.value.colorDropText,.3),"--am-c-drop-text-op50":H(r.value.colorDropText,.5),"--am-c-drop-text-op70":H(r.value.colorDropText,.7),"--am-c-drop-text-op80":H(r.value.colorDropText,.8),"--am-c-drop-border":r.value.colorDropBorder,"--am-c-skeleton-op20":H(r.value.colorMainText,.2),"--am-c-skeleton-op60":H(r.value.colorMainText,.6),"--am-c-skeleton-sb-op20":H(r.value.colorSbText,.2),"--am-c-skeleton-sb-op60":H(r.value.colorSbText,.6)}));return(d,f)=>{const _=Nr,g=Dr;return c(),y("div",{class:q(["am-date-picker__wrapper",{"is-disabled":e.disabled}]),style:Ce(t(u))},[m("div",{class:q(["am-date-picker__input",[`am-${e.type}`,{"is-disabled":e.disabled}]]),onClick:o},[e.type==="date"&&t(l)?(c(),y("div",bc,k(t(nt)(t(ye)(t(l)).format("YYYY-MM-DD"))),1)):D("",!0),e.type==="daterange"&&t(l)[0]?(c(),y("div",kc,k(t(nt)(t(ye)(t(l)[0]).format("YYYY-MM-DD"))),1)):D("",!0),e.type==="daterange"&&t(l)[1]?(c(),y("div",Cc,k(t(nt)(t(ye)(t(l)[1]).format("YYYY-MM-DD"))),1)):D("",!0)],2),A(g,{locale:t(cc)(e.lang)},{default:x(()=>[A(_,{id:n.id,ref_key:"amDatePicker",ref:i,modelValue:t(l),"onUpdate:modelValue":f[0]||(f[0]=C=>we(l)?l.value=C:l=C),readonly:e.readonly,disabled:e.disabled,editable:e.editable,clearable:e.clearable,placeholder:e.placeholder,"start-placeholder":e.startPlaceholder,"end-placeholder":e.endPlaceholder,type:e.type,format:e.format,"popper-class":e.popperClass,"popper-options":e.popperOptions,"popper-style":t(u),"range-separator":e.rangeSeparator,"default-value":e.defaultValue,"default-time":e.defaultTime,"value-format":e.valueFormat,"unlink-panels":e.unlinkPanels,"prefix-icon":e.prefixIcon,"clear-icon":e.clearIcon,"validate-event":e.validateEvent,"disabled-date":n.disabledDate,shortcuts:e.shortcuts,"cell-class-name":e.cellClassName,teleported:e.teleported,"empty-values":e.emptyValues,"value-on-clear":e.valueOnClear,"fallback-placements":e.fallbackPlacements,placement:e.placement,class:q(["am-date-picker",[`am-date-picker--${n.size}`,{"am-date-picker--disabled":e.disabled}]]),onChange:f[1]||(f[1]=C=>d.$emit("change",C)),onBlur:f[2]||(f[2]=C=>d.$emit("blur",C)),onFocus:f[3]||(f[3]=C=>d.$emit("focus",C)),onClear:f[4]||(f[4]=C=>d.$emit("clear",C)),onCalendarChange:f[5]||(f[5]=C=>d.$emit("calendar-change",C)),onPanelChange:f[6]||(f[6]=C=>d.$emit("panel-change",C)),onVisibleChange:f[7]||(f[7]=C=>d.$emit("visible-change",C))},null,8,["id","modelValue","readonly","disabled","editable","clearable","placeholder","start-placeholder","end-placeholder","type","format","popper-class","popper-options","popper-style","range-separator","default-value","default-time","value-format","unlink-panels","prefix-icon","clear-icon","validate-event","disabled-date","shortcuts","cell-class-name","teleported","empty-values","value-on-clear","fallback-placements","placement","class"])]),_:1},8,["locale"])],6)}}};function xc(n,a,e){let s={};return n.forEach(l=>{a===""&&l.periods.forEach(f=>{f.periodStart=Tl(f.periodStart),f.periodEnd=Tl(f.periodEnd)});let o=ye(l.periods[0].periodStart,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"),r=e.getters.getSettings.general.usedLanguages.map(f=>f.length>2?f.slice(0,2):f);(e.getters.getSettings.general.usedLanguages.indexOf(e.getters.getLocalLanguage)!==-1||r.indexOf(e.getters.getLocalLanguage.split("_")[0])!==-1)&&(l.name=Vt(l),l.customTickets.forEach(f=>{f.name=dc(f)})),l.recurring&&l.recurring.until&&(l.recurring.until=l.recurring.until.split(" ")[0]),o in s||(s[o]={date:o,events:[]});let d=l.bookings.some(f=>f.status==="waiting");if(l.full&&l.status==="approved"?l.status="full":l.upcoming&&l.status==="approved"&&(l.status="upcoming"),d&&(l.status="waiting"),e.getters["auth/getProfile"].type==="provider"){let f=JSON.parse(JSON.stringify(l));s[o].events.push(f)}else l.bookings.forEach(f=>{let _=JSON.parse(JSON.stringify(l));_.bookings=[f],s[o].events.push(_)})}),s}function Io(n){let a=0;return n.bookings.forEach(e=>{if(["approved","pending"].includes(e.status)){let s=0;if(e.ticketsData.length>0)for(let i=0;i<e.ticketsData.length;i++)s+=e.ticketsData[i].persons*e.ticketsData[i].price;else s+=n.price;let l=ni(n,e.coupon,e.tax?e.tax[0]:null,s,!1);a+=l.price-l.discount+l.tax}}),a>=0?a:0}function wc(n){let a=[];return n.forEach(e=>{let s=ye(e.periodStart.split(" ")[0],"YYYY-MM-DD"),l=ye(e.periodEnd.split(" ")[0],"YYYY-MM-DD"),i=e.periodStart.split(" ")[1].slice(0,5),o=e.periodEnd.split(" ")[1].slice(0,5);o==="00:00"&&(o="24:00",l.subtract(1,"days"));let r=[];for(;s.isSameOrBefore(l);)r.push(s.format("YYYY-MM-DD")),s.add(1,"days");r.forEach(u=>{a.push({date:u,startTime:i,endTime:o,periodStart:u+" "+i,periodEnd:u+" "+o,zoomLink:n.length>1&&e.zoomMeeting?e.zoomMeeting.joinUrl:"",lessonSpaceLink:n.length>1&&e.lessonSpace?e.lessonSpace:"",googleMeetLink:n.length>1&&e.googleMeetUrl?e.googleMeetUrl:"",microsoftTeamsLink:n.length>1&&e.microsoftTeamsUrl?e.microsoftTeamsUrl:""})})}),a}function Tc(n){let a={};return n.bookings.forEach(e=>{["approved","pending"].includes(e.status)&&e.ticketsData&&e.ticketsData.length&&e.ticketsData.forEach(s=>{s.eventTicketId in a||(a[s.eventTicketId]={persons:0,price:s.price,name:n.customTickets.find(l=>l.id===s.eventTicketId).name}),a[s.eventTicketId].persons=a[s.eventTicketId].persons+s.persons})}),a}function Ec(n,a){let e=n.getters["entities/getLocations"];if(a.locationId&&e.length){let s=e.find(l=>l.id===a.locationId);return typeof s<"u"?s:null}else if(a.customLocation)return{address:"",name:a.customLocation};return null}const Lc={class:"am-msd__item-wrapper"},Sc={class:"am-msd__item-inner"},Ac=m("div",{class:"am-msd__item-icon"},[m("span",{class:"am-icon-close"})],-1),Ic=["onClick"],Pc={class:"am-msd__item-inner"},$c={class:"am-msd__item-icon"},Nc={key:1,class:"am-msd__item-divider"},Dc={class:"am-msd__item-inner"},Oc=m("div",{class:"am-msd__item-icon"},[m("span",{class:"am-icon-logout"})],-1),Fc={class:"am-msd__item-heading"},Mc={props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},monitor:{type:String,required:!0},menuItems:{type:Array,required:!0},customCss:{type:Object,default:()=>{}},width:{type:Number,default:300},position:{type:String,default:"right",validator(n){return["right","left","top","bottom"].includes(n)}}},emits:["click","update:visibility","logout"],setup(n,{emit:a}){const e=n;let s=R("labels");const l=Ne();let i=v(()=>document?document.documentElement.dir==="rtl":!1);function o(f,_){a("click",{step:f,index:_}),a("update:visibility",!1)}function r(){a("update:visibility",!1)}function u(f){return Object.keys(e.customizedLabels).length&&e.customizedLabels[f]?e.customizedLabels[f]:s[f]}let d=v(()=>({"--am-mw-msd":`${e.width}px`}));return(f,_)=>(c(),U(za,{visibility:n.visibility,position:n.position,"custom-class":"am-msd","close-outside":!0,"custom-css":{...n.customCss,...t(d)},"onUpdate:visibility":_[1]||(_[1]=g=>t(a)("update:visibility",!1))},{footer:x(()=>[m("div",{class:"am-msd__item",onClick:_[0]||(_[0]=()=>t(a)("logout"))},[m("div",Dc,[Oc,m("p",Fc,k(u("log_out")),1)])])]),default:x(()=>[m("div",Lc,[m("div",{class:"am-msd__item",onClick:r},[m("div",Sc,[A(ga,{name:"fade"},{default:x(()=>[m("p",{class:q(["am-msd__item-heading",{"am-rtl":t(i)}])},k(u("menu_title")),3)]),_:1}),A(ga,{name:"fade"},{default:x(()=>[Ac]),_:1})])]),(c(!0),y(ee,null,fe(n.menuItems,(g,C)=>(c(),y(ee,{key:g.key},[g.key!=="packages"||t(l).getters["entities/getPackages"].length?(c(),y("div",{key:0,class:q(["am-msd__item",{selected:n.monitor===g.key}]),onClick:O=>o(g,C)},[m("div",Pc,[m("div",$c,[m("span",{class:q(`am-icon-${g.icon}`)},null,2)]),A(ga,{name:"fade"},{default:x(()=>[m("p",{class:q(["am-msd__item-heading",{"am-rtl":t(i)}])},k(g.label),3)]),_:2},1024),A(ga,{name:"fade"},{default:x(()=>[m("div",{class:q(["am-msd__item-indicator",{"am-rtl":t(i)}])},[m("span",{class:q(t(i)?"am-icon-arrow-big-left":"am-icon-arrow-big-right")},null,2)],2)]),_:1})])],10,Ic)):D("",!0),C===0?(c(),y("div",Nc)):D("",!0)],64))),128))])]),_:1},8,["visibility","position","custom-css"]))}};const zn={props:{size:{type:String,default:"default"}},setup(n){const a=n,e=Dl().cookies,s=R("settings");let l=R("cabinetType"),{bookingsCounterChanger:i}=R("bookingsCounterChanger",{bookingsCounterChanger:()=>{}});const o=Ne();let r=v({get:()=>o.getters["cabinet/getTimeZone"],set:b=>{o.commit("cabinet/setTimeZone",b||"")}}),u=v(()=>o.getters["appointment/getActive"]||o.getters["event/getActive"]||o.getters["attendee/getActive"]);const d=R("timeZone"),f=R("timeZones");let _=M("");function g(b){_.value=b.toLowerCase()}let C=v(()=>_.value?f.filter(b=>b.toLowerCase().includes(_.value)):f);function O(){let b;s.general.showClientTimeZone?b=Us():b=d.value,e.set("ameliaUserTimeZone",b,s.roles[l.value+"Cabinet"].tokenValidTime),i(),o.commit("cabinet/setTimeZone",b)}function I(b){e.set("ameliaUserTimeZone",b,s.roles[l.value+"Cabinet"].tokenValidTime),i()}return(b,P)=>t(u)?D("",!0):(c(),U(He,{key:0,modelValue:t(r),"onUpdate:modelValue":P[0]||(P[0]=L=>we(r)?r.value=L:r=L),filterable:!0,placeholder:t(Us)(),clearable:!0,size:t(a).size,"custom-class":"am-ctz","prefix-icon":"globe-watch","filter-method":g,onClear:O,onChange:I},{default:x(()=>[(c(!0),y(ee,null,fe(t(C),(L,$)=>(c(),U(qe,{key:$,label:L,value:L},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","size"]))}};function Po(){return"ameliaBooking"in window&&"cabinet"in window.ameliaBooking&&"disableAuthorizationHeader"in window.ameliaBooking.cabinet&&window.ameliaBooking.cabinet.disableAuthorizationHeader}function ze(n){let a=n.getters["auth/getToken"];return a&&!Po()?{headers:{Authorization:"Bearer "+a}}:{}}const Vc={key:0,class:"el-skeleton-item-wrapper-title"},Bc={name:"AuthSkeleton"},Wt=Object.assign(Bc,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const a=n;return(e,s)=>{const l=Ol,i=Fl;return c(),U(i,{animated:"",class:q(["am-asi-el-skeleton",t(a).mainClass])},{template:x(()=>[t(a).centerFirst?(c(),y("div",Vc,[A(l,{variant:"rect"})])):D("",!0),(c(!0),y(ee,null,fe(new Array(t(a).count),o=>(c(),y("div",{key:o,class:"el-skeleton-item-wrapper"},[A(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});function Rc(n,a){let e=Ba(Ba(Ba(window.location.href,"code"),"state"),"scope");De.post("/google/authorization/token",{authCode:n,userId:El(window.location.href).state,redirectUri:e}).then(()=>{history.pushState(null,null,e)}).catch(s=>{console.log(s)}).finally(()=>{a()})}function qc(n){n.getters["auth/getGoogleLoading"]||(n.commit("auth/setGoogleLoading",!0),De.get("/google/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},ze(n))).then(a=>{window.location.href=a.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(a=>{console.log(a),n.commit("auth/setGoogleLoading",!1)}))}function Uc(n){n.commit("auth/setGoogleLoading",!0),De.post("/google/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setGoogleId",null),n.commit("employee/setGoogleCalendarId",""),n.commit("employee/setGoogleToken",null),n.commit("auth/setGoogleCalendars",[])}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setGoogleLoading",!1)})}function zc(n,a){let e=Ba(Ba(Ba(window.location.href,"code"),"state"),"type");De.post("/outlook/authorization/token",{authCode:n,userId:El(window.location.href).state.split("amelia-outlook-calendar-auth-")[1],redirectUri:window.location.href.split("?")[0]}).then(()=>{history.pushState({},null,e)}).catch(s=>{console.log(s)}).finally(()=>{a()})}function jc(n){n.getters["auth/getOutlookLoading"]||(n.commit("auth/setOutlookLoading",!0),De.get("/outlook/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},ze(n))).then(a=>{window.location.href=a.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(a=>{console.log(a),n.commit("auth/setGoogleLoading",!1)}))}function Yc(n){n.commit("auth/setOutlookLoading",!0),De.post("/outlook/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setOutlookId",""),n.commit("employee/setOutlookCalendarId",""),n.commit("employee/setOutlookToken",null),n.commit("auth/setOutlookCalendars",[])}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setOutlookLoading",!1)})}function Wc(n){n.commit("auth/setZoomLoading",!0),De.get("/zoom/users",Object.assign(ze(n),{params:{source:"cabinet-provider"}})).then(a=>{"data"in a.data&&"users"in a.data.data&&n.commit("auth/setZoomUsers",a.data.data?.users?a.data.data.users:[])}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setZoomLoading",!1)})}function Hc(n){n.commit("auth/setStripeLoading",!0),De.get("/stripe/accounts/"+n.getters["employee/getId"],Object.assign({},ze(n))).then(a=>{a.data.data.account&&(n.commit("auth/setStripeProvider",a.data.data.account),n.getters["employee/getStripeConnect"]||n.commit("employee/setStripeConnect",{id:a.data.data.account.id,amount:null}))}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function Zc(n,a){n.commit("auth/setStripeLoading",!0),De.post("/stripe/onboard/"+n.getters["auth/getProfile"].id,Object.assign({returnUrl:window.location.href,accountType:a},ze(n))).then(e=>{window.location.href=e.data.data.url}).catch(e=>{n.commit("auth/setStripeLoading",!1),console.log("response"in e&&"data"in e.response&&"message"in e.response.data?e.response.data.message:e.message)})}function Gc(n){n.commit("auth/setStripeLoading",!0),De.post("/stripe/disconnect/"+n.getters["auth/getProfile"].id,ze(n)).then(()=>{n.commit("auth/setStripeProvider",{id:"",email:"",type:"",completed:!1}),n.commit("employee/setStripeConnect",null)}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function Jc(n){let a=n.getters["auth/getStripeProvider"];n.commit("auth/setStripeLoading",!0),a.type==="standard"?(window.open("https://dashboard.stripe.com/"+a.id,"_blank"),n.commit("auth/setStripeLoading",!1)):a.type==="express"&&De.post("/stripe/dashboard/"+n.getters["auth/getProfile"].id,ze(n)).then(e=>{e.data.data.url&&window.open(e.data.data.url,"_blank")}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}let xa=M(!1);function jn(n){n.commit("auth/setAppleLoading",!0),De.get("/apple/calendar-list/"+n.getters["employee/getId"],ze(n)).then(a=>{n.commit("auth/setAppleCalendars",a.data.data?.calendarList?a.data.data.calendarList:[]),n.getters["auth/getAppleCalendars"].map(e=>e.id).indexOf(n.getters["employee/getAppleCalendarId"])===-1&&n.commit("employee/setAppleCalendarId",""),n.commit("employee/setAppleCalendarId",a.data.data?.appleCalendarId),xa.value=a.data.data.isEmployeeConnectedToPersonalAppleCalendar}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setAppleLoading",!1)})}const Xc={class:"am-asi__top"},Qc={class:"am-asi__header"},Kc={class:"am-asi__text"},eu={key:0},tu={class:"am-asi__social-wrapper"},au={class:"am-asi__social-divider"},su={class:"par-sm"},lu={class:"am-asi__footer"},nu={class:"am-asi__footer-text"},iu={key:1,id:"am-recaptcha",class:"am-recaptcha-holder"},ou={name:"AuthSignIn"},ru=Object.assign(ou,{setup(n){let a=R("licence"),e=Ne();const s=Dl().cookies,l=R("settings");let i=R("amCustomize");const o=R("labels"),r=R("localLanguage");let u=v(()=>l.general.usedLanguages.includes(r.value)),d=v(()=>{let F=Qe({...o}),Z=i.value.signIn.translations;return Z&&Object.keys(Z).forEach(W=>{Z[W][r.value]&&u.value?F[W]=Z[W][r.value]:Z[W].default&&(F[W]=Z[W].default)}),F}),f={components:{IconComponent:We},template:'<IconComponent icon="email"></IconComponent>'},_={components:{IconComponent:We},template:'<IconComponent icon="password"></IconComponent>'},g=M("");const C=Or.factory(De,Fr);function O({provider:F,credentials:Z}){e.commit("setLoading",!0);const W=`/users/authentication/${F}`,le={};g=F,le.cabinetType=z.value,F==="facebook"&&(le.redirectUri=C.options.providers[F].redirectUri,C.options.providers[F].url=`${W}`,e.commit("setLoading",!1),C.authenticate(F,le).then(de=>{E.value.email=de.data.data.user.email,I(de)}).catch(de=>{C.isAuthenticated()||(se.value=!0,j.value="User is not authenticated.",e.commit("setLoading",!1)),de.response?.data&&(se.value=!0,j.value=de.response.data.message),e.commit("setLoading",!1)})),F==="google"&&(le.code=Z,De.post(`${W}`,le).then(de=>{E.value.email=de.data.data.user.email,I(de)}).catch(de=>{if(!("data"in de.response.data)&&"message"in de.response.data){se.value=!0,j.value=de.response.data.message;return}"invalid_credentials"in de.response.data.data&&(se.value=!0,j.value=d.value.invalid_credentials)}).finally(()=>{e.commit("setLoading",!1)}))}function I(F){"token"in F.data.data&&(s.set("ameliaToken",F.data.data.token,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",F.data.data.user.email,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),e.commit("auth/setToken",F.data.data.token)),"user"in F.data.data&&F.data.data.user.type==="provider"&&te(F),e.commit("auth/setProfile",F.data.data.user),F.data.data.user.timeZone&&e.commit("cabinet/setTimeZone",F.data.data.user.timeZone),e.commit("auth/setAuthenticated",!0);let Z=z.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;Z>0&&Z<18144e5&&setTimeout(()=>{e.dispatch("auth/logout")},Z)}let b=M(null),P=M(!1),L=M(null);function $(){P.value=!1,se.value=!0,j.value=d.value.recaptcha_invalid_error}function h(F){P.value=!0,L.value=F,l.general.googleRecaptcha.invisible&&K()}let S=M(null),E=M({email:v({get:()=>e.getters["auth/getEmail"],set:F=>{e.commit("auth/setEmail",F||"")}}),password:v({get:()=>e.getters["auth/getPassword"],set:F=>{e.commit("auth/setPassword",F||"")}})}),T=M({email:[{required:!0,message:d.value.enter_email_or_username_warning,trigger:"submit"}],password:[{required:!0,message:d.value.enter_password_warning,trigger:"submit"}]}),w=M({email:{template:Ye.text,props:{itemName:"email",label:d.value.email_or_username,prefixIcon:Ge(f),placeholder:"",class:"am-asi__item"}},password:{template:Ye.text,props:{itemName:"password",itemType:"password",showPassword:!0,label:d.value.password,prefixIcon:Ge(_),placeholder:"",class:"am-asi__item"}}}),B=R("pageKey"),z=R("cabinetType"),N=v(()=>e.getters.getLoading),G=v(()=>e.getters["auth/getProfileDeleted"]),se=M(!1),j=M("");function ne(F,Z){let W=$i("token");F?oe(F,!1,!1,!1):W?oe(W,!0,!1,Z):oe("",!1,!0,!1)}function te(F){let Z={id:F.data.data.user.id,firstName:F.data.data.user.firstName,lastName:F.data.data.user.lastName,email:F.data.data.user.email,phone:F.data.data.user.phone,countryPhoneIso:F.data.data.user.countryPhoneIso,googleCalendar:{id:"id"in F.data.data.user.googleCalendar?F.data.data.user.googleCalendar.id:null,calendarId:F.data.data.user.googleCalendar.calendarId?F.data.data.user.googleCalendar.calendarId:"",token:"token"in F.data.data.user.googleCalendar?F.data.data.user.googleCalendar.token:null},outlookCalendar:{id:"id"in F.data.data.user.outlookCalendar?F.data.data.user.outlookCalendar.id:null,calendarId:F.data.data.user.outlookCalendar.calendarId?F.data.data.user.outlookCalendar.calendarId:"",token:"token"in F.data.data.user.outlookCalendar?F.data.data.user.outlookCalendar.token:null},appleCalendarId:F.data.data.user.appleCalendarId?F.data.data.user.appleCalendarId:"",stripeConnect:F.data.data.user.stripeConnect,zoomUserId:F.data.data.user.zoomUserId?F.data.data.user.zoomUserId:"",locationId:F.data.data.user.locationId,pictureFullPath:F.data.data.user.pictureFullPath,pictureThumbPath:F.data.data.user.pictureThumbPath,description:F.data.data.user.description,weekDayList:F.data.data.user.weekDayList,specialDayList:F.data.data.user.specialDayList,dayOffList:F.data.data.user.dayOffList,serviceList:F.data.data.user.serviceList};Z.serviceList.forEach(W=>{Vr(W)}),e.getters["entities/getReady"]&&(e.commit("entities/setEmployees",[JSON.parse(JSON.stringify(Z))]),Z.serviceList=bo(e,Z.serviceList)),e.commit("employee/setEmployee",Br(e,Z)),e.commit("auth/setOutlookCalendars",F.data.data.user.outlookCalendar?.calendarList?F.data.data.user.outlookCalendar.calendarList:[]),e.commit("auth/setGoogleCalendars",F.data.data.user.googleCalendar?.calendarList?F.data.data.user.googleCalendar.calendarList:[]),l.appleCalendar&&!a.isLite&&!a.isStarter&&jn(e),l.payments.stripe.enabled&&l.payments.stripe.connect.enabled&&!a.isLite&&!a.isStarter&&!a.isBasic&&Hc(e),l.zoom.enabled&&!a.isLite&&!a.isStarter&&Wc(e)}function oe(F,Z,W,le){let de={cabinetType:z.value,changePass:le};L.value!==null&&(de.recaptcha=L.value),W&&(de.checkIfWpUser=!0);let ae=e.getters["auth/getPassword"],xe=e.getters["auth/getEmail"];!F&&ae&&xe&&(de.password=ae,de.email=xe),Z&&(de.token=F),De.post("/users/authenticate",de,F!==null&&!Po()?{headers:{Authorization:"Bearer "+F}}:{}).then(_e=>{if("authentication_required"in _e.data.data){l.roles[z.value+"Cabinet"].loginEnabled||(B.value="sendAccessLink");return}"token"in _e.data.data&&(s.set("ameliaToken",_e.data.data.token,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",_e.data.data.user.email,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),e.commit("auth/setToken",_e.data.data.token)),"user"in _e.data.data&&_e.data.data.user.type==="provider"&&te(_e),$i("token")&&window.history.replaceState(null,null,Ba(window.location.href,"token")),e.commit("auth/setProfile",_e.data.data.user),!_e.data.data.user.countryPhoneIso&&l.general.phoneDefaultCountryCode&&l.general.phoneDefaultCountryCode!=="auto"&&e.commit("auth/setProfileCountryPhoneIso",l.general.phoneDefaultCountryCode),_e.data.data.user.timeZone&&e.commit("cabinet/setTimeZone",_e.data.data.user.timeZone),"set_password"in _e.data.data&&_e.data.data.set_password||"change_password"in _e.data.data&&_e.data.data.change_password?B.value="setPassword":e.commit("auth/setAuthenticated",!0);let pe=z.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;pe>0&&pe<18144e5&&setTimeout(()=>{e.dispatch("auth/logout")},pe)}).catch(_e=>{if(!("data"in _e.response.data)&&"message"in _e.response.data){se.value=!0,j.value=_e.response.data.message;return}"invalid_credentials"in _e.response.data.data&&(se.value=!0,j.value=d.value.invalid_credentials),"recaptcha_error"in _e.response.data.data&&(se.value=!0,j.value=d.value.recaptcha_error)}).finally(()=>{e.commit("setLoading",!1)})}function ie(){S.value.validate(F=>{if(F)if(l.general.googleRecaptcha.enabled&&l.roles[z.value+"Cabinet"].googleRecaptcha)if(l.general.googleRecaptcha.invisible)b.value.execute();else if(P.value)K();else return se.value=!0,j.value=d.value.recaptcha_error,!1;else K();else return!1})}function K(){e.commit("setLoading",!0),oe(null,!1,!1,!1)}function me(){ne(s.get("ameliaToken"),"changePass"in El(window.location.href))}Zs(()=>{e.commit("setLoading",!0)}),Je(()=>{if(e.getters["auth/getLoggedOut"])l.roles[z.value+"Cabinet"].loginEnabled||(B.value="sendAccessLink"),e.commit("setLoading",!1);else{let F=El(window.location.href);l.googleCalendar.enabled&&z.value==="provider"&&F&&F.code&&F.scope?Rc(F.code,me):l.outlookCalendar.enabled&&z.value==="provider"&&F&&F.code&&F.state?zc(F.code,me):me()}});let Ae=R("containerWidth"),Ve=v(()=>st(Ae.value)),Q=R("amFonts"),ve=R("amColors"),X=v(()=>({"--am-c-primary":ve.value.colorPrimary,"--am-c-success":ve.value.colorSuccess,"--am-c-error":ve.value.colorError,"--am-c-warning":ve.value.colorWarning,"--am-c-main-bgr":ve.value.colorMainBgr,"--am-c-main-heading-text":ve.value.colorMainHeadingText,"--am-c-main-text":ve.value.colorMainText,"--am-c-main-text-op70":H(ve.value.colorMainText,.7),"--am-c-main-text-op60":H(ve.value.colorMainText,.6),"--am-c-main-text-op40":H(ve.value.colorMainText,.4),"--am-c-main-text-op25":H(ve.value.colorMainText,.25),"--am-c-inp-bgr":ve.value.colorInpBgr,"--am-c-inp-border":ve.value.colorInpBorder,"--am-c-inp-text":ve.value.colorInpText,"--am-c-inp-placeholder":ve.value.colorInpPlaceHolder,"--am-c-btn-prim":ve.value.colorBtnPrim,"--am-c-btn-prim-text":ve.value.colorBtnPrimText,"--am-c-skeleton-op20":H(ve.value.colorMainText,.2),"--am-c-skeleton-op60":H(ve.value.colorMainText,.6),"--am-font-family":Q.value.fontFamily,"--am-c-scroll-op30":H(ve.value.colorPrimary,.3),"--am-c-scroll-op10":H(ve.value.colorPrimary,.1)}));return(F,Z)=>{const W=et;return t(N)?(c(),U(t(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi-sign-in am-asi"})):(c(),y("div",{key:0,class:"am-asi",style:Ce(t(X))},[m("div",Xc,[t(G)?(c(),U(_t,{key:0,class:"am-asi__top-message am-asi__top-message-success",type:"success",title:t(d).profile_deleted,description:"","show-icon":!0,closable:!0,onClose:Z[0]||(Z[0]=le=>t(e).commit("auth/setProfileDeleted",!1))},null,8,["title"])):D("",!0),t(se)?(c(),U(_t,{key:1,class:"am-asi__top-message am-asi__top-message-error",type:"error",title:t(j),description:"","show-icon":!0,closable:!0,onClose:Z[1]||(Z[1]=le=>t(e).commit("auth/setProfileDeleted",!1))},null,8,["title"])):D("",!0),m("div",Qc,k(t(d).welcome_back),1),m("div",Kc,k(t(d).enter_credentials),1)]),t(at).socialLogin.googleLoginEnabled&&t(at).general.googleClientId||t(at).socialLogin.facebookLoginEnabled&&t(at).socialLogin.facebookCredentialsEnabled?(c(),y("div",eu,[m("div",tu,[A(Mr,{provider:t(g),onSocialAction:O},null,8,["provider"])]),m("div",au,[m("span",su,k(t(d).or_enter_details_below),1)])])):D("",!0),A(W,{ref_key:"authFormRef",ref:S,model:t(E),rules:t(T),"label-position":"top",class:q(["am-asi__form",t(Ve)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(w),(le,de)=>(c(),U(pt(le.template),St({key:de,ref_for:!0,ref:"customerCollectorRef",modelValue:t(E)[de],"onUpdate:modelValue":ae=>t(E)[de]=ae},le.props,{onEnter:ie}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),A(Ee,{class:"am-asi__btn",type:t(i).signIn.options.signInBtn.buttonType,onClick:ie},{default:x(()=>[ce(k(t(d).sign_in),1)]),_:1},8,["type"]),m("div",lu,[m("span",nu,k(t(d).forgot_your_password),1),m("span",{class:"am-asi__footer-link",onClick:Z[2]||(Z[2]=le=>we(B)?B.value="sendAccessLink":B="sendAccessLink")},k(t(d).reset_password),1)]),t(l).general.googleRecaptcha.enabled&&t(l).roles[t(z)+"Cabinet"].googleRecaptcha?(c(),y("div",iu,[A(t(yo),{ref_key:"recaptchaRef",ref:b,size:t(l).general.googleRecaptcha.invisible?"invisible":null,"load-recaptcha-script":!0,sitekey:t(l).general.googleRecaptcha.siteKey,onVerify:h,onExpired:$},null,8,["size","sitekey"])])):D("",!0)],4))}}});const cu={class:"am-asi__top"},uu={class:"am-asi__header"},du={class:"am-asi__text"},mu={key:0,class:"am-asi__footer"},pu={key:1,id:"am-recaptcha",class:"am-recaptcha-holder"},gu={name:"AuthReset"},fu=Object.assign(gu,{setup(n){let a=Ne();const e=R("settings");let s=R("amCustomize");const l=R("labels"),i=R("localLanguage");let o=v(()=>e.general.usedLanguages.includes(i.value)),r=v(()=>{let se=Qe({...l}),j=s.value.accessLink.translations;return j&&Object.keys(j).forEach(ne=>{j[ne][i.value]&&o.value?se[ne]=j[ne][i.value]:j[ne].default&&(se[ne]=j[ne].default)}),se}),u=M(!1),d=M(""),f=M(null),_=M(!1),g=M(null);function C(){_.value=!1,u.value=!0,d.value=r.value.recaptcha_invalid_error}function O(se){_.value=!0,g.value=se,e.general.googleRecaptcha.invisible&&T()}let I=M(null),b=M({email:v({get:()=>a.getters["auth/getEmail"],set:se=>{a.commit("auth/setEmail",se||"")}})}),P=M({email:[{required:!0,message:r.value.enter_email_warning,trigger:"submit"}]}),L=M({email:{template:Ye.text,props:{itemName:"email",itemType:"email",label:r.value.email,placeholder:"",class:"am-asi__item"}}}),$=R("pageKey"),h=R("cabinetType"),S=v(()=>a.getters.getLoading);function E(){I.value.validate(se=>{if(se)if(e.general.googleRecaptcha.enabled&&e.roles[h.value+"Cabinet"].googleRecaptcha)if(e.general.googleRecaptcha.invisible)f.value.execute();else if(_.value)T();else return u.value=!0,d.value=r.value.recaptcha_error,!1;else T();else return!1})}function T(){a.commit("setLoading",!0);let se={email:a.getters["auth/getEmail"],locale:window.localeLanguage[0],cabinetType:h.value};g.value!==null&&(se.recaptcha=g.value),De.post("/users/customers/reauthorize",se).then(()=>{$.value="sendAccessLinkProcess"}).catch(()=>{}).finally(()=>{a.commit("setLoading",!1)})}let w=R("containerWidth"),B=v(()=>st(w.value)),z=R("amFonts"),N=R("amColors"),G=v(()=>({"--am-c-primary":N.value.colorPrimary,"--am-c-success":N.value.colorSuccess,"--am-c-error":N.value.colorError,"--am-c-warning":N.value.colorWarning,"--am-c-main-bgr":N.value.colorMainBgr,"--am-c-main-heading-text":N.value.colorMainHeadingText,"--am-c-main-text":N.value.colorMainText,"--am-c-main-text-op70":H(N.value.colorMainText,.7),"--am-c-main-text-op60":H(N.value.colorMainText,.6),"--am-c-main-text-op40":H(N.value.colorMainText,.4),"--am-c-main-text-op25":H(N.value.colorMainText,.25),"--am-c-inp-bgr":N.value.colorInpBgr,"--am-c-inp-border":N.value.colorInpBorder,"--am-c-inp-text":N.value.colorInpText,"--am-c-inp-placeholder":N.value.colorInpPlaceHolder,"--am-c-btn-prim":N.value.colorBtnPrim,"--am-c-btn-prim-text":N.value.colorBtnPrimText,"--am-c-skeleton-op20":H(N.value.colorMainText,.2),"--am-c-skeleton-op60":H(N.value.colorMainText,.6),"--am-font-family":z.value.fontFamily,"--am-c-scroll-op30":H(N.value.colorPrimary,.3),"--am-c-scroll-op10":H(N.value.colorPrimary,.1)}));return(se,j)=>{const ne=et;return t(S)?(c(),U(t(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(c(),y("div",{key:0,class:"am-asi",style:Ce(t(G))},[m("div",cu,[t(u)?(c(),U(_t,{key:0,class:"am-asi__top-message am-asi__top-message-error",type:"error",title:t(d),description:"","show-icon":!0,closable:!0},null,8,["title"])):D("",!0),m("div",uu,k(t(r).access_link_send),1),m("div",du,k(t(r).access_link_send_description),1)]),A(ne,{ref_key:"authFormRef",ref:I,model:t(b),rules:t(P),"label-position":"top",class:q(["am-asi__form",t(B)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(L),(te,oe)=>(c(),U(pt(te.template),St({key:oe,ref_for:!0,ref:"customerCollectorRef",modelValue:t(b)[oe],"onUpdate:modelValue":ie=>t(b)[oe]=ie},te.props,{onEnter:E}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),A(Ee,{class:"am-asi__btn",type:t(s).accessLink.options.sendBtn.buttonType,onClick:E},{default:x(()=>[ce(k(t(r).send),1)]),_:1},8,["type"]),t(e).roles[t(h)+"Cabinet"].loginEnabled?(c(),y("div",mu,[m("span",{class:"am-asi__footer-link",onClick:j[0]||(j[0]=te=>we($)?$.value="signIn":$="signIn")},k(t(r).sign_in),1)])):D("",!0),t(e).general.googleRecaptcha.enabled&&t(e).roles[t(h)+"Cabinet"].googleRecaptcha?(c(),y("div",pu,[A(t(yo),{ref_key:"recaptchaRef",ref:f,size:t(e).general.googleRecaptcha.invisible?"invisible":null,"load-recaptcha-script":!0,sitekey:t(e).general.googleRecaptcha.siteKey,onVerify:O,onExpired:C},null,8,["size","sitekey"])])):D("",!0)],4))}}});const hu={class:"am-asi__top"},vu={class:"am-asi__header"},_u={class:"am-asi__text"},yu={class:"am-asi__email"},bu={class:"am-asi__footer"},ku={class:"am-asi__footer-text"},Cu={name:"AuthResetProcess"},xu=Object.assign(Cu,{setup(n){let a=Ne();const e=R("settings");let s=R("amCustomize");const l=R("labels"),i=R("localLanguage");let o=v(()=>e.general.usedLanguages.includes(i.value)),r=v(()=>{let C=Qe({...l}),O=s.value.accessLinkSuccess.translations;return O&&Object.keys(O).forEach(I=>{O[I][i.value]&&o.value?C[I]=O[I][i.value]:O[I].default&&(C[I]=O[I].default)}),C}),u=v(()=>a.getters["auth/getEmail"]),d=R("pageKey"),f=R("amFonts"),_=R("amColors"),g=v(()=>({"--am-c-primary":_.value.colorPrimary,"--am-c-success":_.value.colorSuccess,"--am-c-error":_.value.colorError,"--am-c-warning":_.value.colorWarning,"--am-c-main-bgr":_.value.colorMainBgr,"--am-c-main-heading-text":_.value.colorMainHeadingText,"--am-c-main-text":_.value.colorMainText,"--am-c-main-text-op70":H(_.value.colorMainText,.7),"--am-c-main-text-op60":H(_.value.colorMainText,.6),"--am-c-main-text-op40":H(_.value.colorMainText,.4),"--am-c-main-text-op25":H(_.value.colorMainText,.25),"--am-c-inp-bgr":_.value.colorInpBgr,"--am-c-inp-border":_.value.colorInpBorder,"--am-c-inp-text":_.value.colorInpText,"--am-c-inp-placeholder":_.value.colorInpPlaceHolder,"--am-c-btn-prim":_.value.colorBtnPrim,"--am-c-btn-prim-text":_.value.colorBtnPrimText,"--am-c-skeleton-op20":H(_.value.colorMainText,.2),"--am-c-skeleton-op60":H(_.value.colorMainText,.6),"--am-font-family":f.value.fontFamily,"--am-c-scroll-op30":H(_.value.colorPrimary,.3),"--am-c-scroll-op10":H(_.value.colorPrimary,.1)}));return(C,O)=>(c(),y("div",{class:"am-asi",style:Ce(t(g))},[m("div",hu,[m("div",vu,k(t(r).access_link_send_check),1),m("div",_u,k(t(r).access_link_send_click),1),m("div",yu,k(t(u)),1)]),m("div",bu,[m("span",ku,k(t(r).access_link_send_inbox),1),m("span",{class:"am-asi__footer-link",onClick:O[0]||(O[0]=I=>we(d)?d.value="sendAccessLink":d="sendAccessLink")},k(t(r).access_link_send_retry),1)])],4))}});const wu={class:"am-asi__top"},Tu={class:"am-asi__header"},Eu={class:"am-asi__text"},Lu={name:"AuthNewPass"},Su=Object.assign(Lu,{setup(n){let a=Ne();const e=R("settings");let s=R("amCustomize");const l=R("labels"),i=R("localLanguage");let o=v(()=>e.general.usedLanguages.includes(i.value)),r=v(()=>{let h=Qe({...l}),S=s.value.setPass.translations;return S&&Object.keys(S).forEach(E=>{S[E][i.value]&&o.value?h[E]=S[E][i.value]:S[E].default&&(h[E]=S[E].default)}),h}),u=M(null),d=M({newPassword:v({get:()=>a.getters["auth/getNewPassword"],set:h=>{a.commit("auth/setNewPassword",h||"")}}),confirmPassword:v({get:()=>a.getters["auth/getConfirmPassword"],set:h=>{a.commit("auth/setConfirmPassword",h||"")}})}),f=M({newPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"}],confirmPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"},{validator:()=>a.getters["auth/getNewPassword"]===a.getters["auth/getConfirmPassword"],message:r.value.passwords_not_match,trigger:"submit"}]}),_=M({newPassword:{template:Ye.text,props:{itemName:"newPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon,placeholder:"",minLength:3,class:"am-asi__item"}},confirmPassword:{template:Ye.text,props:{itemName:"confirmPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon_retype,placeholder:"",minLength:3,class:"am-asi__item"}}}),g=R("cabinetType"),C=v(()=>a.getters.getLoading);function O(){u.value.validate(h=>{if(h&&a.getters["auth/getNewPassword"]===a.getters["auth/getConfirmPassword"]){let S=a.getters["auth/getProfile"];a.commit("setLoading",!0),De.post("/users/"+g.value+"s/"+S.id,{password:a.getters["auth/getNewPassword"]},Object.assign(ze(a),{params:{source:"cabinet-"+g.value}})).then(()=>{a.commit("auth/setAuthenticated",!0)}).catch(()=>{}).finally(()=>{a.commit("setLoading",!1)})}else return!1})}let I=R("containerWidth"),b=v(()=>st(I.value)),P=R("amFonts"),L=R("amColors"),$=v(()=>({"--am-c-primary":L.value.colorPrimary,"--am-c-success":L.value.colorSuccess,"--am-c-error":L.value.colorError,"--am-c-warning":L.value.colorWarning,"--am-c-main-bgr":L.value.colorMainBgr,"--am-c-main-heading-text":L.value.colorMainHeadingText,"--am-c-main-text":L.value.colorMainText,"--am-c-main-text-op70":H(L.value.colorMainText,.7),"--am-c-main-text-op60":H(L.value.colorMainText,.6),"--am-c-main-text-op40":H(L.value.colorMainText,.4),"--am-c-main-text-op25":H(L.value.colorMainText,.25),"--am-c-inp-bgr":L.value.colorInpBgr,"--am-c-inp-border":L.value.colorInpBorder,"--am-c-inp-text":L.value.colorInpText,"--am-c-inp-placeholder":L.value.colorInpPlaceHolder,"--am-c-btn-prim":L.value.colorBtnPrim,"--am-c-btn-prim-text":L.value.colorBtnPrimText,"--am-c-skeleton-op20":H(L.value.colorMainText,.2),"--am-c-skeleton-op60":H(L.value.colorMainText,.6),"--am-font-family":P.value.fontFamily,"--am-c-scroll-op30":H(L.value.colorPrimary,.3),"--am-c-scroll-op10":H(L.value.colorPrimary,.1)}));return(h,S)=>{const E=et;return t(C)?(c(),U(t(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(c(),y("div",{key:0,class:"am-asi",style:Ce(t($))},[m("div",wu,[m("div",Tu,k(t(r).new_password_set),1),m("div",Eu,k(t(r).new_password_set_description),1)]),A(E,{ref_key:"authFormRef",ref:u,model:t(d),rules:t(f),"label-position":"top",class:q(["am-asi__form",t(b)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(_),(T,w)=>(c(),U(pt(T.template),St({key:w,ref_for:!0,ref:"customerCollectorRef",modelValue:t(d)[w],"onUpdate:modelValue":B=>t(d)[w]=B},T.props,{onEnter:O}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),A(Ee,{class:"am-asi__btn",type:t(s).setPass.options.newPassBtn.buttonType,onClick:O},{default:x(()=>[ce(k(t(r).new_password_set_action),1)]),_:1},8,["type"])],4))}}});const Au={class:"am-asi__top"},Iu=m("div",{class:"am-asi__img"},[m("span",{class:"am-icon-check"})],-1),Pu={class:"am-asi__header"},$u={class:"am-asi__text"},Nu={name:"ChangePassSuccess"},Du=Object.assign(Nu,{setup(n){const a=R("settings");let e=R("amCustomize");const s=R("labels"),l=R("localLanguage");let i=v(()=>a.general.usedLanguages.includes(l.value)),o=v(()=>{let _=Qe({...s}),g=e.value.setPassSuccess.translations;return g&&Object.keys(g).forEach(C=>{g[C][l.value]&&i.value?_[C]=g[C][l.value]:g[C].default&&(_[C]=g[C].default)}),_}),r=R("pageKey"),u=R("amFonts"),d=R("amColors"),f=v(()=>({"--am-c-primary":d.value.colorPrimary,"--am-c-success":d.value.colorSuccess,"--am-c-error":d.value.colorError,"--am-c-warning":d.value.colorWarning,"--am-c-main-bgr":d.value.colorMainBgr,"--am-c-main-heading-text":d.value.colorMainHeadingText,"--am-c-main-text":d.value.colorMainText,"--am-c-main-text-op70":H(d.value.colorMainText,.7),"--am-c-main-text-op60":H(d.value.colorMainText,.6),"--am-c-main-text-op40":H(d.value.colorMainText,.4),"--am-c-main-text-op25":H(d.value.colorMainText,.25),"--am-c-btn-prim":d.value.colorBtnPrim,"--am-c-btn-prim-text":d.value.colorBtnPrimText,"--am-c-skeleton-op20":H(d.value.colorMainText,.2),"--am-c-skeleton-op60":H(d.value.colorMainText,.6),"--am-font-family":u.value.fontFamily,"--am-c-scroll-op30":H(d.value.colorPrimary,.3),"--am-c-scroll-op10":H(d.value.colorPrimary,.1)}));return(_,g)=>(c(),y("div",{class:"am-asi",style:Ce(t(f))},[m("div",Au,[Iu,m("div",Pu,k(t(o).new_password_changed),1),m("div",$u,k(t(o).new_password_changed_description),1)]),A(Ee,{class:"am-asi__btn",type:t(e).setPassSuccess.options.signInBtn.buttonType,onClick:g[0]||(g[0]=C=>we(r)?r.value="signIn":r="signIn")},{default:x(()=>[ce(k(t(o).sign_in),1)]),_:1},8,["type"])],4))}}),Ou={name:"AuthWrapper"},Fu=Object.assign(Ou,{setup(n){const a=R("settings");let e=M({signIn:Ge(ru),sendAccessLink:Ge(fu),sendAccessLinkProcess:Ge(xu),setPassword:Ge(Su),changeSuccess:Ge(Du)}),s=R("originKey"),l=M("signIn");Be("pageKey",l);const i=M(a.customizedData?a.customizedData.fonts:Ll.fonts);Be("amFonts",i);let o=v(()=>a.customizedData&&s.value in a.customizedData?a.customizedData[s.value].colors:Ll[s.value].colors);return Be("amColors",o),(r,u)=>(c(),U(pt(t(e)[t(l)])))}});const Mu={class:"am-csd__inner"},Vu={class:"am-csd__header"},Bu={class:"am-csd__header-text"},Ru={class:"am-csd__content"},qu={class:"am-csd__footer"},Uu={name:"DeleteProfile"},zu=Object.assign(Uu,{props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},customizedOptions:{type:Object,default:()=>({})}},emits:["close","deleteProfile"],setup(n,{emit:a}){const e=n;let s=R("containerWidth");const l=R("labels");function i(d){return Object.keys(e.customizedLabels).length&&e.customizedLabels[d]?e.customizedLabels[d]:l[d]}let o=R("amFonts"),r=R("amColors"),u=v(()=>({"--am-c-csd-text":r.value.colorMainText,"--am-c-csd-bgr":r.value.colorMainBgr,"--am-c-csd-text-op10":H(r.value.colorMainText,.1),"--am-font-family":o.value.fontFamily}));return(d,f)=>(c(),U(za,{visibility:t(e).visibility,"custom-class":"am-csd am-csd__cancel",style:Ce(t(u)),position:"center"},{footer:x(()=>[m("div",qu,[A(Ee,{category:"secondary",size:t(s)<=360?"small":"default",type:t(e).customizedOptions.closeBtn.buttonType,onClick:f[1]||(f[1]=()=>{a("close")})},{default:x(()=>[ce(k(i("close")),1)]),_:1},8,["size","type"]),A(Ee,{category:"danger",size:t(s)<=360?"small":"default","loading-icon":"loading",type:t(e).customizedOptions.confirmBtn.buttonType,onClick:f[2]||(f[2]=()=>{a("deleteProfile")})},{default:x(()=>[ce(k(i("delete")),1)]),_:1},8,["size","type"])])]),default:x(()=>[m("div",Mu,[m("div",Vu,[m("div",Bu,k(i("delete_profile")),1),m("div",{class:"am-csd__header-btn",onClick:f[0]||(f[0]=()=>{a("close")})},[A(We,{icon:"close"})])]),m("div",Ru,[m("p",null,k(i("delete_profile_description")),1)])])]),_:1},8,["visibility","style"]))}});const wl={props:{pageWidth:{type:Number,default:768},count:{type:[Number,String],default:2},itemDirection:{type:String,default:"row",validator(n){return["row","row-reverse","column","column-reverse","initial","revert","unset"].includes(n)}}},setup(n){const a=n;let e=v(()=>st(a.pageWidth)),s=R("amColors"),l=v(()=>({"--am-c-skeleton-op20":H(s.value.colorMainText,.2),"--am-c-skeleton-op60":H(s.value.colorMainText,.6),"--am-c-flex-direction":a.itemDirection}));return(i,o)=>{const r=Ol,u=Fl;return c(),U(u,{animated:"",class:"am-cps",style:Ce(t(l))},{template:x(()=>[(c(!0),y(ee,null,fe(new Array(t(a).count),d=>(c(),y("div",{key:d,class:q(["am-cps__item",t(e)])},[A(r,{class:"am-cps__item-label",variant:"rect"}),A(r,{class:"am-cps__item-input",variant:"rect"})],2))),128))]),_:1},8,["style"])}}};const ju={class:"am-capi__inner"},Yu=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),Wu={name:"CabinetProfile",key:"profile"},Hu=Object.assign(Wu,{setup(n){let a=Ne(),e=v(()=>a.getters.getLoading),s=M(null),l=M(0),i=R("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}rt(i,pe=>{pe?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{ii(()=>{l.value=s.value.offsetWidth}),de()});let u=v(()=>st(l.value));const d=R("settings");let f=R("cabinetType"),_=R("amCustomize");const g=R("labels"),C=R("localLanguage");let O=v(()=>d.general.usedLanguages.includes(C.value));function I(pe,Te){return Te&&Object.keys(Te).forEach($e=>{Te[$e][C.value]&&O.value?pe[$e]=Te[$e][C.value]:Te[$e].default&&(pe[$e]=Te[$e].default)}),pe}let b=v(()=>{let pe=Qe({...g}),Te=_.value.profile.translations;return I(pe,Te)});function P(pe){let Te={},$e=_.value[pe].translations;return I(Te,$e)}let L=v(()=>_.value.profile.options),$=M("first"),h=M("");function S(){oe.value=!1,h.value=""}let E=M(null),T=M(!1),w=M({firstName:v({get:()=>a.getters["auth/getProfile"].firstName,set:pe=>{a.commit("auth/setProfileFirstName",pe||"")}}),lastName:v({get:()=>a.getters["auth/getProfile"].lastName,set:pe=>{a.commit("auth/setProfileLastName",pe||"")}}),email:v({get:()=>a.getters["auth/getProfile"].email,set:pe=>{a.commit("auth/setProfileEmail",pe||"")}}),phone:v({get:()=>a.getters["auth/getProfile"].phone,set:pe=>{a.commit("auth/setProfilePhone",pe||"")}}),birthday:v({get:()=>a.getters["auth/getProfile"].birthday?a.getters["auth/getProfile"].birthday:"",set:pe=>{a.commit("auth/setProfileBirthday",pe?ye(pe).format("YYYY-MM-DD"):"")}})}),B=M({firstName:{template:Ye.text,props:{itemName:"firstName",label:b.value.first_name_colon,placeholder:b.value.enter_first_name,class:v(()=>`am-capi__item ${u.value}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:b.value.last_name_colon,placeholder:b.value.enter_last_name,class:v(()=>`am-capi__item ${u.value}`)}},email:{template:Ye.text,props:{itemName:"email",label:b.value.email_colon,placeholder:b.value.enter_email,class:v(()=>`am-capi__item ${u.value}`)}},phone:{countryPhoneIso:v({get:()=>a.getters["auth/getProfile"].countryPhoneIso?a.getters["auth/getProfile"].countryPhoneIso:"",set:pe=>{a.commit("auth/setProfileCountryPhoneIso",pe?pe.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:b.value.phone_colon,placeholder:b.value.enter_phone,defaultCode:v(()=>a.getters["auth/getProfile"].countryPhoneIso?a.getters["auth/getProfile"].countryPhoneIso:""),phoneError:v(()=>T.value),whatsAppLabel:b.value.whatsapp_opt_in_text,isWhatsApp:d.notifications.whatsAppEnabled&&d.notifications.whatsAppAccessToken&&d.notifications.whatsAppBusinessID&&d.notifications.whatsAppPhoneID,class:v(()=>`am-capi__item ${u.value}`)}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:b.value.date_of_birth,placeholder:b.value.enter_date_of_birth,clearable:!0,readonly:!1,class:v(()=>`am-capi__item am-capi__item-birthday ${u.value}`)}}}),z=M({firstName:[{required:!0,message:b.value.enter_first_name_warning,trigger:"submit"}],lastName:[{required:L.value.lastName.required,message:b.value.enter_last_name_warning,trigger:"submit"}],email:[{required:L.value.email.required,type:"email",message:b.value.enter_valid_email_warning,trigger:"submit"}],phone:[{required:L.value.phone.required,message:b.value.enter_phone_warning,trigger:"submit"}],birthday:[{required:L.value.birthday.required,message:b.value.enter_date_of_birth_warning,trigger:"submit"}]}),N=M(!1);Be("deleteProfileDialog",N);function G(){a.commit("auth/setProfileFirstName",w.value.firstName?w.value.firstName.trim():""),a.commit("auth/setProfileLastName",w.value.lastName?w.value.lastName.trim():""),a.commit("auth/setProfileEmail",w.value.email?w.value.email.trim():""),E.value.validate(pe=>{if(pe){h.value=b.value.profile_data_success;let Te=a.getters["auth/getProfile"];a.commit("setLoading",!0),De.post("/users/"+f.value+"s/"+Te.id,Te,ze(a)).finally(()=>{a.commit("setLoading",!1),oe.value=!0,L.value.phone.required&&w.value.phone&&(T.value=!1)})}else return L.value.phone.required&&!w.value.phone&&(T.value=!0),!1})}Be("saveProfileChanges",G);let se=M(null),j=M({newPass:v({get:()=>a.getters["auth/getNewPassword"],set:pe=>{a.commit("auth/setNewPassword",pe||"")}}),confirmPass:v({get:()=>a.getters["auth/getConfirmPassword"],set:pe=>{a.commit("auth/setConfirmPassword",pe||"")}})}),ne=M({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:b.value.new_password_colon,placeholder:"",minLength:3,class:v(()=>`am-capp__item ${u.value}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:b.value.new_password_colon_retype,placeholder:"",minLength:3,class:v(()=>`am-capp__item ${u.value}`)}}}),te=M({newPass:[{required:!0,message:b.value.new_password_required,trigger:"submit"},{min:4,message:b.value.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:b.value.new_password_required,trigger:"submit"},{min:4,message:b.value.new_password_length,trigger:"submit"},{validator:()=>a.getters["auth/getNewPassword"]===a.getters["auth/getConfirmPassword"],message:b.value.passwords_not_match,trigger:"submit"}]}),oe=M(!1);function ie(){oe.value=!1}function K(){se.value.validate(pe=>{if(pe){let Te=a.getters["auth/getProfile"];a.commit("setLoading",!0),De.post("/users/customers/"+Te.id,{password:a.getters["auth/getNewPassword"]},ze(a)).then(()=>{h.value=b.value.password_success,a.commit("auth/setNewPassword",""),a.commit("auth/setConfirmPassword","")}).catch(()=>{}).finally(()=>{a.commit("setLoading",!1),oe.value=!0})}else return!1})}Be("changeProfilePassword",K);function me(){N.value=!1,a.commit("auth/setProfileDeleted",!0),a.dispatch("auth/logout")}function Ae(){a.commit("setLoading",!0);let pe=a.getters["auth/getProfile"]?a.getters["auth/getProfile"].id:null;if(!pe)return;let Te={email:"",firstName:b.value.customer,lastName:pe,phone:"",birthday:"",gender:"",externalId:"",password:""};const $e=Dl().cookies;De.post("/users/customers/"+pe,Object.assign(ze(a),Te)).then(()=>{a.commit("auth/setProfile",{}),$e.remove("ameliaUserEmail"),a.commit("setLoading",!1),me()}).catch(Oe=>{a.commit("setLoading",!1),console.log(Oe)})}const Ve=M(null),Q=Qe({}),ve=Qe({}),X=Qe({}),F=Qe({});function Z(pe,Te,$e){Q[Te]=$e??""}function W(pe,Te){if(X[Te]={template:Ye[pe.type],props:{id:Te,itemName:Te.toString(),label:pe.label,options:pe.options,class:`am-capei-att-cf__item am-cf-width-${pe.width}`}},pe.type==="text-area"&&(X[Te].props.itemType="textarea"),pe.type==="datepicker"&&(X[Te].props.weekStartsFromDay=d.wordpress.startOfWeek),pe.type==="file"){let $e=a.getters["auth/getProfile"]?a.getters["auth/getProfile"].id:null;X[Te].props={...X[Te].props,btnLabel:b.value.upload_file_here,isUpload:!0,bookingId:$e,source:"cabinet-customer"}}}function le(pe){ve[pe.id]=[{message:b.value.required_field,required:pe.required,trigger:["submit","change"]}]}function de(){const pe=a.getters["entities/getCustomFields"],Te=JSON.parse(a.getters["auth/getProfile"].customFields||"{}");pe.filter($e=>$e.saveType==="customer"&&$e.type!=="content").sort(($e,Oe)=>$e.position-Oe.position).forEach($e=>{const{position:Oe,id:Re}=$e,be=Te[Re]?.value;F[Oe]={...$e,value:be??($e.type==="checkbox"||$e.type==="file"?[]:"")},Z($e,Re,F[Oe].value),W($e,Re),le($e)})}function ae(){Ve.value.validate(pe=>{if(pe){const Te=a.getters["auth/getProfile"],$e={};for(const Re in F){const be=F[Re],Ue=Q[be.id];$e[be.id]={label:be.label,type:be.type,value:typeof Ue=="string"?Ue.trim():Ue}}const Oe={...Te,customFields:JSON.stringify($e)};a.commit("setLoading",!0),De.post(`/users/${f.value}s/${Te.id}`,Oe,ze(a)).finally(()=>{a.commit("setLoading",!1),h.value=b.value.profile_data_success,oe.value=!0})}else return!1})}Be("saveCustomerCustomFields",ae);let xe=R("amColors"),_e=v(()=>({"--am-c-capi-primary":xe.value.colorPrimary,"--am-c-capi-text":xe.value.colorMainText,"--am-c-capi-text-op10":H(xe.value.colorMainText,.1)}));return(pe,Te)=>{const $e=et,Oe=va,Re=_a;return c(),y("div",{ref_key:"pageContainer",ref:s,class:"am-capi",style:Ce(t(_e))},[m("div",ju,[t(oe)?(c(),U(_t,{key:0,type:"success","show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:S,onTriggerClose:S},{title:x(()=>[Yu,ce(" "+k(t(h)),1)]),_:1})):D("",!0),A(Re,{modelValue:t($),"onUpdate:modelValue":Te[0]||(Te[0]=be=>we($)?$.value=be:$=be),class:"am-capi__tabs",onTabClick:ie},{default:x(()=>[A(Oe,{class:"am-capi__tabs-item",label:t(b).personal_info,name:"first"},{default:x(()=>[t(e)?(c(),U(wl,{key:1,count:5,"page-width":t(l)},null,8,["page-width"])):(c(),y(ee,{key:0},[t(a).getters["auth/getProfile"]?(c(),U($e,{key:0,ref_key:"infoFormRef",ref:E,model:t(w),rules:t(z),"label-position":"top",class:q(["am-capi__form",t(u)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(_).profile.order,be=>(c(),y(ee,{key:be.id},[!t(L)[be.id]||t(L)[be.id].visibility?(c(),U(pt(t(B)[be.id].template),St({key:0,ref_for:!0,ref:"customerCollectorRef",modelValue:t(w)[be.id],"onUpdate:modelValue":Ue=>t(w)[be.id]=Ue,countryPhoneIso:t(B)[be.id].countryPhoneIso,"onUpdate:countryPhoneIso":Ue=>t(B)[be.id].countryPhoneIso=Ue},t(B)[be.id].props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"])):D("",!0)],64))),128))]),_:1},8,["model","rules","class"])):D("",!0)],64))]),_:1},8,["label"]),Object.keys(t(F)).length?(c(),U(Oe,{key:0,label:t(b).custom_fields,name:"third"},{default:x(()=>[t(e)?(c(),U(wl,{key:1,count:Object.keys(t(F)).length,"page-width":t(l)},null,8,["count","page-width"])):(c(),U($e,{key:0,ref_key:"customFieldsFormRef",ref:Ve,model:t(Q),rules:t(ve),"label-position":"top",class:q(["am-capei-att-cf__form",t(u)])},{default:x(()=>[(c(!0),y(ee,null,fe(Object.values(t(F)),be=>(c(),y(ee,{key:be.id},[be.id in t(Q)?(c(),U(pt(t(X)[be.id]?.template),St({key:0,modelValue:t(Q)[be.id],"onUpdate:modelValue":Ue=>t(Q)[be.id]=Ue},t(X)[be.id]?.props),null,16,["modelValue","onUpdate:modelValue"])):D("",!0)],64))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])):D("",!0),A(Oe,{class:"am-capi__tabs-item",label:t(b).password_tab,name:"second"},{default:x(()=>[t(e)?(c(),U(wl,{key:1,"item-direction":"column",count:2,"page-width":t(l)},null,8,["page-width"])):(c(),U($e,{key:0,ref_key:"passFormRef",ref:se,model:t(j),rules:t(te),"label-position":"top",class:q(["am-capi__form",t(u)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(ne),(be,Ue)=>(c(),U(pt(be.template),St({key:be.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:t(j)[Ue],"onUpdate:modelValue":J=>t(j)[Ue]=J},be.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])]),_:1},8,["modelValue"]),A(zu,{visibility:t(N),"customized-labels":P("deleteProfile"),"customized-options":t(_).deleteProfile.options,onClose:Te[1]||(Te[1]=be=>we(N)?N.value=!1:N=!1),onDeleteProfile:Ae},null,8,["visibility","customized-labels","customized-options"]),A(yc,{loading:t(e),display:t($),"parent-width":t(l),"customized-labels":t(b),"save-footer-button":t(L).saveFooterButton.buttonType,"delete-footer-type":t(L).deleteFooterButton.buttonType,"pass-footer-button":t(L).passFooterButton.buttonType},null,8,["loading","display","parent-width","customized-labels","save-footer-button","delete-footer-type","pass-footer-button"])])],4)}}});var Ie=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(Ie||{});class oa{constructor(a,e,s={}){this.attrName=a,this.keyName=e;const l=Ie.TYPE&Ie.ATTRIBUTE;this.scope=s.scope!=null?s.scope&Ie.LEVEL|l:Ie.ATTRIBUTE,s.whitelist!=null&&(this.whitelist=s.whitelist)}static keys(a){return Array.from(a.attributes).map(e=>e.name)}add(a,e){return this.canAdd(a,e)?(a.setAttribute(this.keyName,e),!0):!1}canAdd(a,e){return this.whitelist==null?!0:typeof e=="string"?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1}remove(a){a.removeAttribute(this.keyName)}value(a){const e=a.getAttribute(this.keyName);return this.canAdd(a,e)&&e?e:""}}class ps extends Error{constructor(a){a="[Parchment] "+a,super(a),this.message=a,this.name=this.constructor.name}}const $o=class Yn{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(a,e=!1){if(a==null)return null;if(this.blots.has(a))return this.blots.get(a)||null;if(e){let s=null;try{s=a.parentNode}catch{return null}return this.find(s,e)}return null}create(a,e,s){const l=this.query(e);if(l==null)throw new ps(`Unable to create ${e} blot`);const i=l,o=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:i.create(s),r=new i(a,o,s);return Yn.blots.set(r.domNode,r),r}find(a,e=!1){return Yn.find(a,e)}query(a,e=Ie.ANY){let s;return typeof a=="string"?s=this.types[a]||this.attributes[a]:a instanceof Text||a.nodeType===Node.TEXT_NODE?s=this.types.text:typeof a=="number"?a&Ie.LEVEL&Ie.BLOCK?s=this.types.block:a&Ie.LEVEL&Ie.INLINE&&(s=this.types.inline):a instanceof Element&&((a.getAttribute("class")||"").split(/\s+/).some(l=>(s=this.classes[l],!!s)),s=s||this.tags[a.tagName]),s==null?null:"scope"in s&&e&Ie.LEVEL&s.scope&&e&Ie.TYPE&s.scope?s:null}register(...a){return a.map(e=>{const s="blotName"in e,l="attrName"in e;if(!s&&!l)throw new ps("Invalid definition");if(s&&e.blotName==="abstract")throw new ps("Cannot register abstract class");const i=s?e.blotName:l?e.attrName:void 0;return this.types[i]=e,l?typeof e.keyName=="string"&&(this.attributes[e.keyName]=e):s&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(o=>o.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(o=>{(this.tags[o]==null||e.className==null)&&(this.tags[o]=e)}))),e})}};$o.blots=new WeakMap;let _s=$o;function Vi(n,a){return(n.getAttribute("class")||"").split(/\s+/).filter(e=>e.indexOf(`${a}-`)===0)}class Zu extends oa{static keys(a){return(a.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(a,e){return this.canAdd(a,e)?(this.remove(a),a.classList.add(`${this.keyName}-${e}`),!0):!1}remove(a){Vi(a,this.keyName).forEach(e=>{a.classList.remove(e)}),a.classList.length===0&&a.removeAttribute("class")}value(a){const e=(Vi(a,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(a,e)?e:""}}const ea=Zu;function Nn(n){const a=n.split("-"),e=a.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("");return a[0]+e}class Gu extends oa{static keys(a){return(a.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(a,e){return this.canAdd(a,e)?(a.style[Nn(this.keyName)]=e,!0):!1}remove(a){a.style[Nn(this.keyName)]="",a.getAttribute("style")||a.removeAttribute("style")}value(a){const e=a.style[Nn(this.keyName)];return this.canAdd(a,e)?e:""}}const $a=Gu;class Ju{constructor(a){this.attributes={},this.domNode=a,this.build()}attribute(a,e){e?a.add(this.domNode,e)&&(a.value(this.domNode)!=null?this.attributes[a.attrName]=a:delete this.attributes[a.attrName]):(a.remove(this.domNode),delete this.attributes[a.attrName])}build(){this.attributes={};const a=_s.find(this.domNode);if(a==null)return;const e=oa.keys(this.domNode),s=ea.keys(this.domNode),l=$a.keys(this.domNode);e.concat(s).concat(l).forEach(i=>{const o=a.scroll.query(i,Ie.ATTRIBUTE);o instanceof oa&&(this.attributes[o.attrName]=o)})}copy(a){Object.keys(this.attributes).forEach(e=>{const s=this.attributes[e].value(this.domNode);a.format(e,s)})}move(a){this.copy(a),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((a,e)=>(a[e]=this.attributes[e].value(this.domNode),a),{})}}const Bl=Ju,No=class{constructor(a,e){this.scroll=a,this.domNode=e,_s.blots.set(e,this),this.prev=null,this.next=null}static create(a){if(this.tagName==null)throw new ps("Blot definition missing tagName");let e,s;return Array.isArray(this.tagName)?(typeof a=="string"?(s=a.toUpperCase(),parseInt(s,10).toString()===s&&(s=parseInt(s,10))):typeof a=="number"&&(s=a),typeof s=="number"?e=document.createElement(this.tagName[s-1]):s&&this.tagName.indexOf(s)>-1?e=document.createElement(s):e=document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const a=this.domNode.cloneNode(!1);return this.scroll.create(a)}detach(){this.parent!=null&&this.parent.removeChild(this),_s.blots.delete(this.domNode)}deleteAt(a,e){this.isolate(a,e).remove()}formatAt(a,e,s,l){const i=this.isolate(a,e);if(this.scroll.query(s,Ie.BLOT)!=null&&l)i.wrap(s,l);else if(this.scroll.query(s,Ie.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);i.wrap(o),o.format(s,l)}}insertAt(a,e,s){const l=s==null?this.scroll.create("text",e):this.scroll.create(e,s),i=this.split(a);this.parent.insertBefore(l,i||void 0)}isolate(a,e){const s=this.split(a);if(s==null)throw new Error("Attempt to isolate at end");return s.split(e),s}length(){return 1}offset(a=this.parent){return this.parent==null||this===a?0:this.parent.children.offset(this)+this.parent.offset(a)}optimize(a){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(a,e){const s=typeof a=="string"?this.scroll.create(a,e):a;return this.parent!=null&&(this.parent.insertBefore(s,this.next||void 0),this.remove()),s}split(a,e){return a===0?this:this.next}update(a,e){}wrap(a,e){const s=typeof a=="string"?this.scroll.create(a,e):a;if(this.parent!=null&&this.parent.insertBefore(s,this.next||void 0),typeof s.appendChild!="function")throw new ps(`Cannot wrap ${a}`);return s.appendChild(this),s}};No.blotName="abstract";let Do=No;const Oo=class extends Do{static value(a){return!0}index(a,e){return this.domNode===a||this.domNode.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(a,e){let s=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return a>0&&(s+=1),[this.parent.domNode,s]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Oo.scope=Ie.INLINE_BLOT;let Xu=Oo;const xt=Xu;class Qu{constructor(){this.head=null,this.tail=null,this.length=0}append(...a){if(this.insertBefore(a[0],null),a.length>1){const e=a.slice(1);this.append(...e)}}at(a){const e=this.iterator();let s=e();for(;s&&a>0;)a-=1,s=e();return s}contains(a){const e=this.iterator();let s=e();for(;s;){if(s===a)return!0;s=e()}return!1}indexOf(a){const e=this.iterator();let s=e(),l=0;for(;s;){if(s===a)return l;l+=1,s=e()}return-1}insertBefore(a,e){a!=null&&(this.remove(a),a.next=e,e!=null?(a.prev=e.prev,e.prev!=null&&(e.prev.next=a),e.prev=a,e===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)}offset(a){let e=0,s=this.head;for(;s!=null;){if(s===a)return e;e+=s.length(),s=s.next}return-1}remove(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)}iterator(a=this.head){return()=>{const e=a;return a!=null&&(a=a.next),e}}find(a,e=!1){const s=this.iterator();let l=s();for(;l;){const i=l.length();if(a<i||e&&a===i&&(l.next==null||l.next.length()!==0))return[l,a];a-=i,l=s()}return[null,0]}forEach(a){const e=this.iterator();let s=e();for(;s;)a(s),s=e()}forEachAt(a,e,s){if(e<=0)return;const[l,i]=this.find(a);let o=a-i;const r=this.iterator(l);let u=r();for(;u&&o<a+e;){const d=u.length();a>o?s(u,a-o,Math.min(e,o+d-a)):s(u,0,Math.min(d,a+e-o)),o+=d,u=r()}}map(a){return this.reduce((e,s)=>(e.push(a(s)),e),[])}reduce(a,e){const s=this.iterator();let l=s();for(;l;)e=a(e,l),l=s();return e}}function Bi(n,a){const e=a.find(n);if(e)return e;try{return a.create(n)}catch{const s=a.create(Ie.INLINE);return Array.from(n.childNodes).forEach(l=>{s.domNode.appendChild(l)}),n.parentNode&&n.parentNode.replaceChild(s.domNode,n),s.attach(),s}}const Fo=class wa extends Do{constructor(a,e){super(a,e),this.uiNode=null,this.build()}appendChild(a){this.insertBefore(a)}attach(){super.attach(),this.children.forEach(a=>{a.attach()})}attachUI(a){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=a,wa.uiClass&&this.uiNode.classList.add(wa.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Qu,Array.from(this.domNode.childNodes).filter(a=>a!==this.uiNode).reverse().forEach(a=>{try{const e=Bi(a,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(e){if(e instanceof ps)return;throw e}})}deleteAt(a,e){if(a===0&&e===this.length())return this.remove();this.children.forEachAt(a,e,(s,l,i)=>{s.deleteAt(l,i)})}descendant(a,e=0){const[s,l]=this.children.find(e);return a.blotName==null&&a(s)||a.blotName!=null&&s instanceof a?[s,l]:s instanceof wa?s.descendant(a,l):[null,-1]}descendants(a,e=0,s=Number.MAX_VALUE){let l=[],i=s;return this.children.forEachAt(e,s,(o,r,u)=>{(a.blotName==null&&a(o)||a.blotName!=null&&o instanceof a)&&l.push(o),o instanceof wa&&(l=l.concat(o.descendants(a,r,i))),i-=u}),l}detach(){this.children.forEach(a=>{a.detach()}),super.detach()}enforceAllowedChildren(){let a=!1;this.children.forEach(e=>{a||this.statics.allowedChildren.some(s=>e instanceof s)||(e.statics.scope===Ie.BLOCK_BLOT?(e.next!=null&&this.splitAfter(e),e.prev!=null&&this.splitAfter(e.prev),e.parent.unwrap(),a=!0):e instanceof wa?e.unwrap():e.remove())})}formatAt(a,e,s,l){this.children.forEachAt(a,e,(i,o,r)=>{i.formatAt(o,r,s,l)})}insertAt(a,e,s){const[l,i]=this.children.find(a);if(l)l.insertAt(i,e,s);else{const o=s==null?this.scroll.create("text",e):this.scroll.create(e,s);this.appendChild(o)}}insertBefore(a,e){a.parent!=null&&a.parent.children.remove(a);let s=null;this.children.insertBefore(a,e||null),a.parent=this,e!=null&&(s=e.domNode),(this.domNode.parentNode!==a.domNode||this.domNode.nextSibling!==s)&&this.domNode.insertBefore(a.domNode,s),a.attach()}length(){return this.children.reduce((a,e)=>a+e.length(),0)}moveChildren(a,e){this.children.forEach(s=>{a.insertBefore(s,e)})}optimize(a){if(super.optimize(a),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(a,e=!1){const[s,l]=this.children.find(a,e),i=[[this,a]];return s instanceof wa?i.concat(s.path(l,e)):(s!=null&&i.push([s,l]),i)}removeChild(a){this.children.remove(a)}replaceWith(a,e){const s=typeof a=="string"?this.scroll.create(a,e):a;return s instanceof wa&&this.moveChildren(s),super.replaceWith(s)}split(a,e=!1){if(!e){if(a===0)return this;if(a===this.length())return this.next}const s=this.clone();return this.parent&&this.parent.insertBefore(s,this.next||void 0),this.children.forEachAt(a,this.length(),(l,i,o)=>{const r=l.split(i,e);r!=null&&s.appendChild(r)}),s}splitAfter(a){const e=this.clone();for(;a.next!=null;)e.appendChild(a.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(a,e){const s=[],l=[];a.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(s.push(...i.addedNodes),l.push(...i.removedNodes))}),l.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(i);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),s.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,o)=>i===o?0:i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let o=null;i.nextSibling!=null&&(o=this.scroll.find(i.nextSibling));const r=Bi(i,this.scroll);(r.next!==o||r.next==null)&&(r.parent!=null&&r.parent.removeChild(this),this.insertBefore(r,o||void 0))}),this.enforceAllowedChildren()}};Fo.uiClass="";let Ku=Fo;const Qt=Ku;function ed(n,a){if(Object.keys(n).length!==Object.keys(a).length)return!1;for(const e in n)if(n[e]!==a[e])return!1;return!0}const is=class os extends Qt{static create(a){return super.create(a)}static formats(a,e){const s=e.query(os.blotName);if(!(s!=null&&a.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return a.tagName.toLowerCase()}}constructor(a,e){super(a,e),this.attributes=new Bl(this.domNode)}format(a,e){if(a===this.statics.blotName&&!e)this.children.forEach(s=>{s instanceof os||(s=s.wrap(os.blotName,!0)),this.attributes.copy(s)}),this.unwrap();else{const s=this.scroll.query(a,Ie.INLINE);if(s==null)return;s instanceof oa?this.attributes.attribute(s,e):e&&(a!==this.statics.blotName||this.formats()[a]!==e)&&this.replaceWith(a,e)}}formats(){const a=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(a[this.statics.blotName]=e),a}formatAt(a,e,s,l){this.formats()[s]!=null||this.scroll.query(s,Ie.ATTRIBUTE)?this.isolate(a,e).format(s,l):super.formatAt(a,e,s,l)}optimize(a){super.optimize(a);const e=this.formats();if(Object.keys(e).length===0)return this.unwrap();const s=this.next;s instanceof os&&s.prev===this&&ed(e,s.formats())&&(s.moveChildren(this),s.remove())}replaceWith(a,e){const s=super.replaceWith(a,e);return this.attributes.copy(s),s}update(a,e){super.update(a,e),a.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}wrap(a,e){const s=super.wrap(a,e);return s instanceof os&&this.attributes.move(s),s}};is.allowedChildren=[is,xt],is.blotName="inline",is.scope=Ie.INLINE_BLOT,is.tagName="SPAN";let td=is;const di=td,rs=class Wn extends Qt{static create(a){return super.create(a)}static formats(a,e){const s=e.query(Wn.blotName);if(!(s!=null&&a.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return a.tagName.toLowerCase()}}constructor(a,e){super(a,e),this.attributes=new Bl(this.domNode)}format(a,e){const s=this.scroll.query(a,Ie.BLOCK);s!=null&&(s instanceof oa?this.attributes.attribute(s,e):a===this.statics.blotName&&!e?this.replaceWith(Wn.blotName):e&&(a!==this.statics.blotName||this.formats()[a]!==e)&&this.replaceWith(a,e))}formats(){const a=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(a[this.statics.blotName]=e),a}formatAt(a,e,s,l){this.scroll.query(s,Ie.BLOCK)!=null?this.format(s,l):super.formatAt(a,e,s,l)}insertAt(a,e,s){if(s==null||this.scroll.query(e,Ie.INLINE)!=null)super.insertAt(a,e,s);else{const l=this.split(a);if(l!=null){const i=this.scroll.create(e,s);l.parent.insertBefore(i,l)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(a,e){const s=super.replaceWith(a,e);return this.attributes.copy(s),s}update(a,e){super.update(a,e),a.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}};rs.blotName="block",rs.scope=Ie.BLOCK_BLOT,rs.tagName="P",rs.allowedChildren=[di,rs,xt];let ad=rs;const zs=ad,Hn=class extends Qt{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(a,e){super.deleteAt(a,e),this.enforceAllowedChildren()}formatAt(a,e,s,l){super.formatAt(a,e,s,l),this.enforceAllowedChildren()}insertAt(a,e,s){super.insertAt(a,e,s),this.enforceAllowedChildren()}optimize(a){super.optimize(a),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Hn.blotName="container",Hn.scope=Ie.BLOCK_BLOT;let sd=Hn;const Rl=sd;class ld extends xt{static formats(a,e){}format(a,e){super.formatAt(0,this.length(),a,e)}formatAt(a,e,s,l){a===0&&e===this.length()?this.format(s,l):super.formatAt(a,e,s,l)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Ft=ld,nd={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},id=100,cs=class extends Qt{constructor(a,e){super(null,e),this.registry=a,this.scroll=this,this.build(),this.observer=new MutationObserver(s=>{this.update(s)}),this.observer.observe(this.domNode,nd),this.attach()}create(a,e){return this.registry.create(this,a,e)}find(a,e=!1){const s=this.registry.find(a,e);return s?s.scroll===this?s:e?this.find(s.scroll.domNode.parentNode,!0):null:null}query(a,e=Ie.ANY){return this.registry.query(a,e)}register(...a){return this.registry.register(...a)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(a,e){this.update(),a===0&&e===this.length()?this.children.forEach(s=>{s.remove()}):super.deleteAt(a,e)}formatAt(a,e,s,l){this.update(),super.formatAt(a,e,s,l)}insertAt(a,e,s){this.update(),super.insertAt(a,e,s)}optimize(a=[],e={}){super.optimize(e);const s=e.mutationsMap||new WeakMap;let l=Array.from(this.observer.takeRecords());for(;l.length>0;)a.push(l.pop());const i=(u,d=!0)=>{u==null||u===this||u.domNode.parentNode!=null&&(s.has(u.domNode)||s.set(u.domNode,[]),d&&i(u.parent))},o=u=>{s.has(u.domNode)&&(u instanceof Qt&&u.children.forEach(o),s.delete(u.domNode),u.optimize(e))};let r=a;for(let u=0;r.length>0;u+=1){if(u>=id)throw new Error("[Parchment] Maximum optimize iterations reached");for(r.forEach(d=>{const f=this.find(d.target,!0);f!=null&&(f.domNode===d.target&&(d.type==="childList"?(i(this.find(d.previousSibling,!1)),Array.from(d.addedNodes).forEach(_=>{const g=this.find(_,!1);i(g,!1),g instanceof Qt&&g.children.forEach(C=>{i(C,!1)})})):d.type==="attributes"&&i(f.prev)),i(f))}),this.children.forEach(o),r=Array.from(this.observer.takeRecords()),l=r.slice();l.length>0;)a.push(l.pop())}}update(a,e={}){a=a||this.observer.takeRecords();const s=new WeakMap;a.map(l=>{const i=this.find(l.target,!0);return i==null?null:s.has(i.domNode)?(s.get(i.domNode).push(l),null):(s.set(i.domNode,[l]),i)}).forEach(l=>{l!=null&&l!==this&&s.has(l.domNode)&&l.update(s.get(l.domNode)||[],e)}),e.mutationsMap=s,s.has(this.domNode)&&super.update(s.get(this.domNode),e),this.optimize(a,e)}};cs.blotName="scroll",cs.defaultChild=zs,cs.allowedChildren=[zs,Rl],cs.scope=Ie.BLOCK_BLOT,cs.tagName="DIV";let od=cs;const mi=od,Zn=class Mo extends xt{static create(a){return document.createTextNode(a)}static value(a){return a.data}constructor(a,e){super(a,e),this.text=this.statics.value(this.domNode)}deleteAt(a,e){this.domNode.data=this.text=this.text.slice(0,a)+this.text.slice(a+e)}index(a,e){return this.domNode===a?e:-1}insertAt(a,e,s){s==null?(this.text=this.text.slice(0,a)+e+this.text.slice(a),this.domNode.data=this.text):super.insertAt(a,e,s)}length(){return this.text.length}optimize(a){super.optimize(a),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Mo&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(a,e=!1){return[this.domNode,a]}split(a,e=!1){if(!e){if(a===0)return this;if(a===this.length())return this.next}const s=this.scroll.create(this.domNode.splitText(a));return this.parent.insertBefore(s,this.next||void 0),this.text=this.statics.value(this.domNode),s}update(a,e){a.some(s=>s.type==="characterData"&&s.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Zn.blotName="text",Zn.scope=Ie.INLINE_BLOT;let rd=Zn;const Al=rd;var cd=Object.freeze(Object.defineProperty({__proto__:null,Attributor:oa,AttributorStore:Bl,BlockBlot:zs,ClassAttributor:ea,ContainerBlot:Rl,EmbedBlot:Ft,InlineBlot:di,LeafBlot:xt,ParentBlot:Qt,Registry:_s,Scope:Ie,ScrollBlot:mi,StyleAttributor:$a,TextBlot:Al},Symbol.toStringTag,{value:"Module"})),$t={exports:{}},Ot=-1,Lt=1,ut=0;function js(n,a,e,s,l){if(n===a)return n?[[ut,n]]:[];if(e!=null){var i=_d(n,a,e);if(i)return i}var o=pi(n,a),r=n.substring(0,o);n=n.substring(o),a=a.substring(o),o=ql(n,a);var u=n.substring(n.length-o);n=n.substring(0,n.length-o),a=a.substring(0,a.length-o);var d=ud(n,a);return r&&d.unshift([ut,r]),u&&d.push([ut,u]),gi(d,l),s&&pd(d),d}function ud(n,a){var e;if(!n)return[[Lt,a]];if(!a)return[[Ot,n]];var s=n.length>a.length?n:a,l=n.length>a.length?a:n,i=s.indexOf(l);if(i!==-1)return e=[[Lt,s.substring(0,i)],[ut,l],[Lt,s.substring(i+l.length)]],n.length>a.length&&(e[0][0]=e[2][0]=Ot),e;if(l.length===1)return[[Ot,n],[Lt,a]];var o=md(n,a);if(o){var r=o[0],u=o[1],d=o[2],f=o[3],_=o[4],g=js(r,d),C=js(u,f);return g.concat([[ut,_]],C)}return dd(n,a)}function dd(n,a){for(var e=n.length,s=a.length,l=Math.ceil((e+s)/2),i=l,o=2*l,r=new Array(o),u=new Array(o),d=0;d<o;d++)r[d]=-1,u[d]=-1;r[i+1]=0,u[i+1]=0;for(var f=e-s,_=f%2!==0,g=0,C=0,O=0,I=0,b=0;b<l;b++){for(var P=-b+g;P<=b-C;P+=2){var L=i+P,$;P===-b||P!==b&&r[L-1]<r[L+1]?$=r[L+1]:$=r[L-1]+1;for(var h=$-P;$<e&&h<s&&n.charAt($)===a.charAt(h);)$++,h++;if(r[L]=$,$>e)C+=2;else if(h>s)g+=2;else if(_){var S=i+f-P;if(S>=0&&S<o&&u[S]!==-1){var E=e-u[S];if($>=E)return Ri(n,a,$,h)}}}for(var T=-b+O;T<=b-I;T+=2){var S=i+T,E;T===-b||T!==b&&u[S-1]<u[S+1]?E=u[S+1]:E=u[S-1]+1;for(var w=E-T;E<e&&w<s&&n.charAt(e-E-1)===a.charAt(s-w-1);)E++,w++;if(u[S]=E,E>e)I+=2;else if(w>s)O+=2;else if(!_){var L=i+f-T;if(L>=0&&L<o&&r[L]!==-1){var $=r[L],h=i+$-L;if(E=e-E,$>=E)return Ri(n,a,$,h)}}}}return[[Ot,n],[Lt,a]]}function Ri(n,a,e,s){var l=n.substring(0,e),i=a.substring(0,s),o=n.substring(e),r=a.substring(s),u=js(l,i),d=js(o,r);return u.concat(d)}function pi(n,a){if(!n||!a||n.charAt(0)!==a.charAt(0))return 0;for(var e=0,s=Math.min(n.length,a.length),l=s,i=0;e<l;)n.substring(i,l)==a.substring(i,l)?(e=l,i=e):s=l,l=Math.floor((s-e)/2+e);return Vo(n.charCodeAt(l-1))&&l--,l}function qi(n,a){var e=n.length,s=a.length;if(e==0||s==0)return 0;e>s?n=n.substring(e-s):e<s&&(a=a.substring(0,e));var l=Math.min(e,s);if(n==a)return l;for(var i=0,o=1;;){var r=n.substring(l-o),u=a.indexOf(r);if(u==-1)return i;o+=u,(u==0||n.substring(l-o)==a.substring(0,o))&&(i=o,o++)}}function ql(n,a){if(!n||!a||n.slice(-1)!==a.slice(-1))return 0;for(var e=0,s=Math.min(n.length,a.length),l=s,i=0;e<l;)n.substring(n.length-l,n.length-i)==a.substring(a.length-l,a.length-i)?(e=l,i=e):s=l,l=Math.floor((s-e)/2+e);return Bo(n.charCodeAt(n.length-l))&&l--,l}function md(n,a){var e=n.length>a.length?n:a,s=n.length>a.length?a:n;if(e.length<4||s.length*2<e.length)return null;function l(C,O,I){for(var b=C.substring(I,I+Math.floor(C.length/4)),P=-1,L="",$,h,S,E;(P=O.indexOf(b,P+1))!==-1;){var T=pi(C.substring(I),O.substring(P)),w=ql(C.substring(0,I),O.substring(0,P));L.length<w+T&&(L=O.substring(P-w,P)+O.substring(P,P+T),$=C.substring(0,I-w),h=C.substring(I+T),S=O.substring(0,P-w),E=O.substring(P+T))}return L.length*2>=C.length?[$,h,S,E,L]:null}var i=l(e,s,Math.ceil(e.length/4)),o=l(e,s,Math.ceil(e.length/2)),r;if(!i&&!o)return null;o?i?r=i[4].length>o[4].length?i:o:r=o:r=i;var u,d,f,_;n.length>a.length?(u=r[0],d=r[1],f=r[2],_=r[3]):(f=r[0],_=r[1],u=r[2],d=r[3]);var g=r[4];return[u,d,f,_,g]}function pd(n){for(var a=!1,e=[],s=0,l=null,i=0,o=0,r=0,u=0,d=0;i<n.length;)n[i][0]==ut?(e[s++]=i,o=u,r=d,u=0,d=0,l=n[i][1]):(n[i][0]==Lt?u+=n[i][1].length:d+=n[i][1].length,l&&l.length<=Math.max(o,r)&&l.length<=Math.max(u,d)&&(n.splice(e[s-1],0,[Ot,l]),n[e[s-1]+1][0]=Lt,s--,s--,i=s>0?e[s-1]:-1,o=0,r=0,u=0,d=0,l=null,a=!0)),i++;for(a&&gi(n),hd(n),i=1;i<n.length;){if(n[i-1][0]==Ot&&n[i][0]==Lt){var f=n[i-1][1],_=n[i][1],g=qi(f,_),C=qi(_,f);g>=C?(g>=f.length/2||g>=_.length/2)&&(n.splice(i,0,[ut,_.substring(0,g)]),n[i-1][1]=f.substring(0,f.length-g),n[i+1][1]=_.substring(g),i++):(C>=f.length/2||C>=_.length/2)&&(n.splice(i,0,[ut,f.substring(0,C)]),n[i-1][0]=Lt,n[i-1][1]=_.substring(0,_.length-C),n[i+1][0]=Ot,n[i+1][1]=f.substring(C),i++),i++}i++}}var Ui=/[^a-zA-Z0-9]/,zi=/\s/,ji=/[\r\n]/,gd=/\n\r?\n$/,fd=/^\r?\n\r?\n/;function hd(n){function a(C,O){if(!C||!O)return 6;var I=C.charAt(C.length-1),b=O.charAt(0),P=I.match(Ui),L=b.match(Ui),$=P&&I.match(zi),h=L&&b.match(zi),S=$&&I.match(ji),E=h&&b.match(ji),T=S&&C.match(gd),w=E&&O.match(fd);return T||w?5:S||E?4:P&&!$&&h?3:$||h?2:P||L?1:0}for(var e=1;e<n.length-1;){if(n[e-1][0]==ut&&n[e+1][0]==ut){var s=n[e-1][1],l=n[e][1],i=n[e+1][1],o=ql(s,l);if(o){var r=l.substring(l.length-o);s=s.substring(0,s.length-o),l=r+l.substring(0,l.length-o),i=r+i}for(var u=s,d=l,f=i,_=a(s,l)+a(l,i);l.charAt(0)===i.charAt(0);){s+=l.charAt(0),l=l.substring(1)+i.charAt(0),i=i.substring(1);var g=a(s,l)+a(l,i);g>=_&&(_=g,u=s,d=l,f=i)}n[e-1][1]!=u&&(u?n[e-1][1]=u:(n.splice(e-1,1),e--),n[e][1]=d,f?n[e+1][1]=f:(n.splice(e+1,1),e--))}e++}}function gi(n,a){n.push([ut,""]);for(var e=0,s=0,l=0,i="",o="",r;e<n.length;){if(e<n.length-1&&!n[e][1]){n.splice(e,1);continue}switch(n[e][0]){case Lt:l++,o+=n[e][1],e++;break;case Ot:s++,i+=n[e][1],e++;break;case ut:var u=e-l-s-1;if(a){if(u>=0&&qo(n[u][1])){var d=n[u][1].slice(-1);if(n[u][1]=n[u][1].slice(0,-1),i=d+i,o=d+o,!n[u][1]){n.splice(u,1),e--;var f=u-1;n[f]&&n[f][0]===Lt&&(l++,o=n[f][1]+o,f--),n[f]&&n[f][0]===Ot&&(s++,i=n[f][1]+i,f--),u=f}}if(Ro(n[e][1])){var d=n[e][1].charAt(0);n[e][1]=n[e][1].slice(1),i+=d,o+=d}}if(e<n.length-1&&!n[e][1]){n.splice(e,1);break}if(i.length>0||o.length>0){i.length>0&&o.length>0&&(r=pi(o,i),r!==0&&(u>=0?n[u][1]+=o.substring(0,r):(n.splice(0,0,[ut,o.substring(0,r)]),e++),o=o.substring(r),i=i.substring(r)),r=ql(o,i),r!==0&&(n[e][1]=o.substring(o.length-r)+n[e][1],o=o.substring(0,o.length-r),i=i.substring(0,i.length-r)));var _=l+s;i.length===0&&o.length===0?(n.splice(e-_,_),e=e-_):i.length===0?(n.splice(e-_,_,[Lt,o]),e=e-_+1):o.length===0?(n.splice(e-_,_,[Ot,i]),e=e-_+1):(n.splice(e-_,_,[Ot,i],[Lt,o]),e=e-_+2)}e!==0&&n[e-1][0]===ut?(n[e-1][1]+=n[e][1],n.splice(e,1)):e++,l=0,s=0,i="",o="";break}}n[n.length-1][1]===""&&n.pop();var g=!1;for(e=1;e<n.length-1;)n[e-1][0]===ut&&n[e+1][0]===ut&&(n[e][1].substring(n[e][1].length-n[e-1][1].length)===n[e-1][1]?(n[e][1]=n[e-1][1]+n[e][1].substring(0,n[e][1].length-n[e-1][1].length),n[e+1][1]=n[e-1][1]+n[e+1][1],n.splice(e-1,1),g=!0):n[e][1].substring(0,n[e+1][1].length)==n[e+1][1]&&(n[e-1][1]+=n[e+1][1],n[e][1]=n[e][1].substring(n[e+1][1].length)+n[e+1][1],n.splice(e+1,1),g=!0)),e++;g&&gi(n,a)}function Vo(n){return n>=55296&&n<=56319}function Bo(n){return n>=56320&&n<=57343}function Ro(n){return Bo(n.charCodeAt(0))}function qo(n){return Vo(n.charCodeAt(n.length-1))}function vd(n){for(var a=[],e=0;e<n.length;e++)n[e][1].length>0&&a.push(n[e]);return a}function Dn(n,a,e,s){return qo(n)||Ro(s)?null:vd([[ut,n],[Ot,a],[Lt,e],[ut,s]])}function _d(n,a,e){var s=typeof e=="number"?{index:e,length:0}:e.oldRange,l=typeof e=="number"?null:e.newRange,i=n.length,o=a.length;if(s.length===0&&(l===null||l.length===0)){var r=s.index,u=n.slice(0,r),d=n.slice(r),f=l?l.index:null;e:{var _=r+o-i;if(f!==null&&f!==_||_<0||_>o)break e;var g=a.slice(0,_),C=a.slice(_);if(C!==d)break e;var O=Math.min(r,_),I=u.slice(0,O),b=g.slice(0,O);if(I!==b)break e;var P=u.slice(O),L=g.slice(O);return Dn(I,P,L,d)}e:{if(f!==null&&f!==r)break e;var $=r,g=a.slice(0,$),C=a.slice($);if(g!==u)break e;var h=Math.min(i-$,o-$),S=d.slice(d.length-h),E=C.slice(C.length-h);if(S!==E)break e;var P=d.slice(0,d.length-h),L=C.slice(0,C.length-h);return Dn(u,P,L,S)}}if(s.length>0&&l&&l.length===0){e:{var I=n.slice(0,s.index),S=n.slice(s.index+s.length),O=I.length,h=S.length;if(o<O+h)break e;var b=a.slice(0,O),E=a.slice(o-h);if(I!==b||S!==E)break e;var P=n.slice(O,i-h),L=a.slice(O,o-h);return Dn(I,P,L,S)}}return null}function Ul(n,a,e,s){return js(n,a,e,s,!0)}Ul.INSERT=Lt;Ul.DELETE=Ot;Ul.EQUAL=ut;var yd=Ul,Il={exports:{}};(function(n,a){var e=200,s="__lodash_hash_undefined__",l=9007199254740991,i="[object Arguments]",o="[object Array]",r="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Function]",_="[object GeneratorFunction]",g="[object Map]",C="[object Number]",O="[object Object]",I="[object Promise]",b="[object RegExp]",P="[object Set]",L="[object String]",$="[object Symbol]",h="[object WeakMap]",S="[object ArrayBuffer]",E="[object DataView]",T="[object Float32Array]",w="[object Float64Array]",B="[object Int8Array]",z="[object Int16Array]",N="[object Int32Array]",G="[object Uint8Array]",se="[object Uint8ClampedArray]",j="[object Uint16Array]",ne="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,oe=/\w*$/,ie=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,me={};me[i]=me[o]=me[S]=me[E]=me[r]=me[u]=me[T]=me[w]=me[B]=me[z]=me[N]=me[g]=me[C]=me[O]=me[b]=me[P]=me[L]=me[$]=me[G]=me[se]=me[j]=me[ne]=!0,me[d]=me[f]=me[h]=!1;var Ae=typeof Ta=="object"&&Ta&&Ta.Object===Object&&Ta,Ve=typeof self=="object"&&self&&self.Object===Object&&self,Q=Ae||Ve||Function("return this")(),ve=a&&!a.nodeType&&a,X=ve&&!0&&n&&!n.nodeType&&n,F=X&&X.exports===ve;function Z(p,V){return p.set(V[0],V[1]),p}function W(p,V){return p.add(V),p}function le(p,V){for(var Y=-1,re=p?p.length:0;++Y<re&&V(p[Y],Y,p)!==!1;);return p}function de(p,V){for(var Y=-1,re=V.length,Me=p.length;++Y<re;)p[Me+Y]=V[Y];return p}function ae(p,V,Y,re){var Me=-1,Pe=p?p.length:0;for(re&&Pe&&(Y=p[++Me]);++Me<Pe;)Y=V(Y,p[Me],Me,p);return Y}function xe(p,V){for(var Y=-1,re=Array(p);++Y<p;)re[Y]=V(Y);return re}function _e(p,V){return p?.[V]}function pe(p){var V=!1;if(p!=null&&typeof p.toString!="function")try{V=!!(p+"")}catch{}return V}function Te(p){var V=-1,Y=Array(p.size);return p.forEach(function(re,Me){Y[++V]=[Me,re]}),Y}function $e(p,V){return function(Y){return p(V(Y))}}function Oe(p){var V=-1,Y=Array(p.size);return p.forEach(function(re){Y[++V]=re}),Y}var Re=Array.prototype,be=Function.prototype,Ue=Object.prototype,J=Q["__core-js_shared__"],he=function(){var p=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),ge=be.toString,Fe=Ue.hasOwnProperty,ke=Ue.toString,ba=RegExp("^"+ge.call(Fe).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wt=F?Q.Buffer:void 0,Za=Q.Symbol,xs=Q.Uint8Array,Mt=$e(Object.getPrototypeOf,Object),tl=Object.create,al=Ue.propertyIsEnumerable,Hl=Re.splice,ws=Object.getOwnPropertySymbols,Ga=wt?wt.isBuffer:void 0,sl=$e(Object.keys,Object),Ja=Zt(Q,"DataView"),Na=Zt(Q,"Map"),Ht=Zt(Q,"Promise"),Xa=Zt(Q,"Set"),Ts=Zt(Q,"WeakMap"),Da=Zt(Object,"create"),Es=Tt(Ja),Oa=Tt(Na),Ls=Tt(Ht),Ss=Tt(Xa),As=Tt(Ts),ka=Za?Za.prototype:void 0,ll=ka?ka.valueOf:void 0;function ca(p){var V=-1,Y=p?p.length:0;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function Zl(){this.__data__=Da?Da(null):{}}function Gl(p){return this.has(p)&&delete this.__data__[p]}function Jl(p){var V=this.__data__;if(Da){var Y=V[p];return Y===s?void 0:Y}return Fe.call(V,p)?V[p]:void 0}function nl(p){var V=this.__data__;return Da?V[p]!==void 0:Fe.call(V,p)}function Is(p,V){var Y=this.__data__;return Y[p]=Da&&V===void 0?s:V,this}ca.prototype.clear=Zl,ca.prototype.delete=Gl,ca.prototype.get=Jl,ca.prototype.has=nl,ca.prototype.set=Is;function gt(p){var V=-1,Y=p?p.length:0;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function Xl(){this.__data__=[]}function Ql(p){var V=this.__data__,Y=Ka(V,p);if(Y<0)return!1;var re=V.length-1;return Y==re?V.pop():Hl.call(V,Y,1),!0}function Kl(p){var V=this.__data__,Y=Ka(V,p);return Y<0?void 0:V[Y][1]}function en(p){return Ka(this.__data__,p)>-1}function tn(p,V){var Y=this.__data__,re=Ka(Y,p);return re<0?Y.push([p,V]):Y[re][1]=V,this}gt.prototype.clear=Xl,gt.prototype.delete=Ql,gt.prototype.get=Kl,gt.prototype.has=en,gt.prototype.set=tn;function bt(p){var V=-1,Y=p?p.length:0;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function an(){this.__data__={hash:new ca,map:new(Na||gt),string:new ca}}function sn(p){return Ma(this,p).delete(p)}function ln(p){return Ma(this,p).get(p)}function nn(p){return Ma(this,p).has(p)}function on(p,V){return Ma(this,p).set(p,V),this}bt.prototype.clear=an,bt.prototype.delete=sn,bt.prototype.get=ln,bt.prototype.has=nn,bt.prototype.set=on;function It(p){this.__data__=new gt(p)}function rn(){this.__data__=new gt}function cn(p){return this.__data__.delete(p)}function un(p){return this.__data__.get(p)}function dn(p){return this.__data__.has(p)}function mn(p,V){var Y=this.__data__;if(Y instanceof gt){var re=Y.__data__;if(!Na||re.length<e-1)return re.push([p,V]),this;Y=this.__data__=new bt(re)}return Y.set(p,V),this}It.prototype.clear=rn,It.prototype.delete=cn,It.prototype.get=un,It.prototype.has=dn,It.prototype.set=mn;function Qa(p,V){var Y=Ds(p)||ts(p)?xe(p.length,String):[],re=Y.length,Me=!!re;for(var Pe in p)(V||Fe.call(p,Pe))&&!(Me&&(Pe=="length"||En(Pe,re)))&&Y.push(Pe);return Y}function il(p,V,Y){var re=p[V];(!(Fe.call(p,V)&&dl(re,Y))||Y===void 0&&!(V in p))&&(p[V]=Y)}function Ka(p,V){for(var Y=p.length;Y--;)if(dl(p[Y][0],V))return Y;return-1}function aa(p,V){return p&&Ns(V,Fs(V),p)}function Ps(p,V,Y,re,Me,Pe,je){var Ze;if(re&&(Ze=Pe?re(p,Me,Pe,je):re(p)),Ze!==void 0)return Ze;if(!la(p))return p;var ot=Ds(p);if(ot){if(Ze=wn(p),!V)return kn(p,Ze)}else{var Xe=da(p),kt=Xe==f||Xe==_;if(ml(p))return es(p,V);if(Xe==O||Xe==i||kt&&!Pe){if(pe(p))return Pe?p:{};if(Ze=sa(kt?{}:p),!V)return Cn(p,aa(Ze,p))}else{if(!me[Xe])return Pe?p:{};Ze=Tn(p,Xe,Ps,V)}}je||(je=new It);var Pt=je.get(p);if(Pt)return Pt;if(je.set(p,Ze),!ot)var ct=Y?xn(p):Fs(p);return le(ct||p,function(Ct,ft){ct&&(ft=Ct,Ct=p[ft]),il(Ze,ft,Ps(Ct,V,Y,re,ft,p,je))}),Ze}function pn(p){return la(p)?tl(p):{}}function gn(p,V,Y){var re=V(p);return Ds(p)?re:de(re,Y(p))}function fn(p){return ke.call(p)}function hn(p){if(!la(p)||Sn(p))return!1;var V=Os(p)||pe(p)?ba:ie;return V.test(Tt(p))}function vn(p){if(!cl(p))return sl(p);var V=[];for(var Y in Object(p))Fe.call(p,Y)&&Y!="constructor"&&V.push(Y);return V}function es(p,V){if(V)return p.slice();var Y=new p.constructor(p.length);return p.copy(Y),Y}function $s(p){var V=new p.constructor(p.byteLength);return new xs(V).set(new xs(p)),V}function Fa(p,V){var Y=V?$s(p.buffer):p.buffer;return new p.constructor(Y,p.byteOffset,p.byteLength)}function ol(p,V,Y){var re=V?Y(Te(p),!0):Te(p);return ae(re,Z,new p.constructor)}function rl(p){var V=new p.constructor(p.source,oe.exec(p));return V.lastIndex=p.lastIndex,V}function _n(p,V,Y){var re=V?Y(Oe(p),!0):Oe(p);return ae(re,W,new p.constructor)}function yn(p){return ll?Object(ll.call(p)):{}}function bn(p,V){var Y=V?$s(p.buffer):p.buffer;return new p.constructor(Y,p.byteOffset,p.length)}function kn(p,V){var Y=-1,re=p.length;for(V||(V=Array(re));++Y<re;)V[Y]=p[Y];return V}function Ns(p,V,Y,re){Y||(Y={});for(var Me=-1,Pe=V.length;++Me<Pe;){var je=V[Me],Ze=re?re(Y[je],p[je],je,Y,p):void 0;il(Y,je,Ze===void 0?p[je]:Ze)}return Y}function Cn(p,V){return Ns(p,ua(p),V)}function xn(p){return gn(p,Fs,ua)}function Ma(p,V){var Y=p.__data__;return Ln(V)?Y[typeof V=="string"?"string":"hash"]:Y.map}function Zt(p,V){var Y=_e(p,V);return hn(Y)?Y:void 0}var ua=ws?$e(ws,Object):In,da=fn;(Ja&&da(new Ja(new ArrayBuffer(1)))!=E||Na&&da(new Na)!=g||Ht&&da(Ht.resolve())!=I||Xa&&da(new Xa)!=P||Ts&&da(new Ts)!=h)&&(da=function(p){var V=ke.call(p),Y=V==O?p.constructor:void 0,re=Y?Tt(Y):void 0;if(re)switch(re){case Es:return E;case Oa:return g;case Ls:return I;case Ss:return P;case As:return h}return V});function wn(p){var V=p.length,Y=p.constructor(V);return V&&typeof p[0]=="string"&&Fe.call(p,"index")&&(Y.index=p.index,Y.input=p.input),Y}function sa(p){return typeof p.constructor=="function"&&!cl(p)?pn(Mt(p)):{}}function Tn(p,V,Y,re){var Me=p.constructor;switch(V){case S:return $s(p);case r:case u:return new Me(+p);case E:return Fa(p,re);case T:case w:case B:case z:case N:case G:case se:case j:case ne:return bn(p,re);case g:return ol(p,re,Y);case C:case L:return new Me(p);case b:return rl(p);case P:return _n(p,re,Y);case $:return yn(p)}}function En(p,V){return V=V??l,!!V&&(typeof p=="number"||K.test(p))&&p>-1&&p%1==0&&p<V}function Ln(p){var V=typeof p;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?p!=="__proto__":p===null}function Sn(p){return!!he&&he in p}function cl(p){var V=p&&p.constructor,Y=typeof V=="function"&&V.prototype||Ue;return p===Y}function Tt(p){if(p!=null){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""}function ul(p){return Ps(p,!0,!0)}function dl(p,V){return p===V||p!==p&&V!==V}function ts(p){return An(p)&&Fe.call(p,"callee")&&(!al.call(p,"callee")||ke.call(p)==i)}var Ds=Array.isArray;function as(p){return p!=null&&pl(p.length)&&!Os(p)}function An(p){return gl(p)&&as(p)}var ml=Ga||Pn;function Os(p){var V=la(p)?ke.call(p):"";return V==f||V==_}function pl(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=l}function la(p){var V=typeof p;return!!p&&(V=="object"||V=="function")}function gl(p){return!!p&&typeof p=="object"}function Fs(p){return as(p)?Qa(p):vn(p)}function In(){return[]}function Pn(){return!1}n.exports=ul})(Il,Il.exports);var Pl={exports:{}};(function(n,a){var e=200,s="__lodash_hash_undefined__",l=1,i=2,o=9007199254740991,r="[object Arguments]",u="[object Array]",d="[object AsyncFunction]",f="[object Boolean]",_="[object Date]",g="[object Error]",C="[object Function]",O="[object GeneratorFunction]",I="[object Map]",b="[object Number]",P="[object Null]",L="[object Object]",$="[object Promise]",h="[object Proxy]",S="[object RegExp]",E="[object Set]",T="[object String]",w="[object Symbol]",B="[object Undefined]",z="[object WeakMap]",N="[object ArrayBuffer]",G="[object DataView]",se="[object Float32Array]",j="[object Float64Array]",ne="[object Int8Array]",te="[object Int16Array]",oe="[object Int32Array]",ie="[object Uint8Array]",K="[object Uint8ClampedArray]",me="[object Uint16Array]",Ae="[object Uint32Array]",Ve=/[\\^$.*+?()[\]{}|]/g,Q=/^\[object .+?Constructor\]$/,ve=/^(?:0|[1-9]\d*)$/,X={};X[se]=X[j]=X[ne]=X[te]=X[oe]=X[ie]=X[K]=X[me]=X[Ae]=!0,X[r]=X[u]=X[N]=X[f]=X[G]=X[_]=X[g]=X[C]=X[I]=X[b]=X[L]=X[S]=X[E]=X[T]=X[z]=!1;var F=typeof Ta=="object"&&Ta&&Ta.Object===Object&&Ta,Z=typeof self=="object"&&self&&self.Object===Object&&self,W=F||Z||Function("return this")(),le=a&&!a.nodeType&&a,de=le&&!0&&n&&!n.nodeType&&n,ae=de&&de.exports===le,xe=ae&&F.process,_e=function(){try{return xe&&xe.binding&&xe.binding("util")}catch{}}(),pe=_e&&_e.isTypedArray;function Te(p,V){for(var Y=-1,re=p==null?0:p.length,Me=0,Pe=[];++Y<re;){var je=p[Y];V(je,Y,p)&&(Pe[Me++]=je)}return Pe}function $e(p,V){for(var Y=-1,re=V.length,Me=p.length;++Y<re;)p[Me+Y]=V[Y];return p}function Oe(p,V){for(var Y=-1,re=p==null?0:p.length;++Y<re;)if(V(p[Y],Y,p))return!0;return!1}function Re(p,V){for(var Y=-1,re=Array(p);++Y<p;)re[Y]=V(Y);return re}function be(p){return function(V){return p(V)}}function Ue(p,V){return p.has(V)}function J(p,V){return p?.[V]}function he(p){var V=-1,Y=Array(p.size);return p.forEach(function(re,Me){Y[++V]=[Me,re]}),Y}function ge(p,V){return function(Y){return p(V(Y))}}function Fe(p){var V=-1,Y=Array(p.size);return p.forEach(function(re){Y[++V]=re}),Y}var ke=Array.prototype,ba=Function.prototype,wt=Object.prototype,Za=W["__core-js_shared__"],xs=ba.toString,Mt=wt.hasOwnProperty,tl=function(){var p=/[^.]+$/.exec(Za&&Za.keys&&Za.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),al=wt.toString,Hl=RegExp("^"+xs.call(Mt).replace(Ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ws=ae?W.Buffer:void 0,Ga=W.Symbol,sl=W.Uint8Array,Ja=wt.propertyIsEnumerable,Na=ke.splice,Ht=Ga?Ga.toStringTag:void 0,Xa=Object.getOwnPropertySymbols,Ts=ws?ws.isBuffer:void 0,Da=ge(Object.keys,Object),Es=ua(W,"DataView"),Oa=ua(W,"Map"),Ls=ua(W,"Promise"),Ss=ua(W,"Set"),As=ua(W,"WeakMap"),ka=ua(Object,"create"),ll=Tt(Es),ca=Tt(Oa),Zl=Tt(Ls),Gl=Tt(Ss),Jl=Tt(As),nl=Ga?Ga.prototype:void 0,Is=nl?nl.valueOf:void 0;function gt(p){var V=-1,Y=p==null?0:p.length;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function Xl(){this.__data__=ka?ka(null):{},this.size=0}function Ql(p){var V=this.has(p)&&delete this.__data__[p];return this.size-=V?1:0,V}function Kl(p){var V=this.__data__;if(ka){var Y=V[p];return Y===s?void 0:Y}return Mt.call(V,p)?V[p]:void 0}function en(p){var V=this.__data__;return ka?V[p]!==void 0:Mt.call(V,p)}function tn(p,V){var Y=this.__data__;return this.size+=this.has(p)?0:1,Y[p]=ka&&V===void 0?s:V,this}gt.prototype.clear=Xl,gt.prototype.delete=Ql,gt.prototype.get=Kl,gt.prototype.has=en,gt.prototype.set=tn;function bt(p){var V=-1,Y=p==null?0:p.length;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function an(){this.__data__=[],this.size=0}function sn(p){var V=this.__data__,Y=es(V,p);if(Y<0)return!1;var re=V.length-1;return Y==re?V.pop():Na.call(V,Y,1),--this.size,!0}function ln(p){var V=this.__data__,Y=es(V,p);return Y<0?void 0:V[Y][1]}function nn(p){return es(this.__data__,p)>-1}function on(p,V){var Y=this.__data__,re=es(Y,p);return re<0?(++this.size,Y.push([p,V])):Y[re][1]=V,this}bt.prototype.clear=an,bt.prototype.delete=sn,bt.prototype.get=ln,bt.prototype.has=nn,bt.prototype.set=on;function It(p){var V=-1,Y=p==null?0:p.length;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function rn(){this.size=0,this.__data__={hash:new gt,map:new(Oa||bt),string:new gt}}function cn(p){var V=Zt(this,p).delete(p);return this.size-=V?1:0,V}function un(p){return Zt(this,p).get(p)}function dn(p){return Zt(this,p).has(p)}function mn(p,V){var Y=Zt(this,p),re=Y.size;return Y.set(p,V),this.size+=Y.size==re?0:1,this}It.prototype.clear=rn,It.prototype.delete=cn,It.prototype.get=un,It.prototype.has=dn,It.prototype.set=mn;function Qa(p){var V=-1,Y=p==null?0:p.length;for(this.__data__=new It;++V<Y;)this.add(p[V])}function il(p){return this.__data__.set(p,s),this}function Ka(p){return this.__data__.has(p)}Qa.prototype.add=Qa.prototype.push=il,Qa.prototype.has=Ka;function aa(p){var V=this.__data__=new bt(p);this.size=V.size}function Ps(){this.__data__=new bt,this.size=0}function pn(p){var V=this.__data__,Y=V.delete(p);return this.size=V.size,Y}function gn(p){return this.__data__.get(p)}function fn(p){return this.__data__.has(p)}function hn(p,V){var Y=this.__data__;if(Y instanceof bt){var re=Y.__data__;if(!Oa||re.length<e-1)return re.push([p,V]),this.size=++Y.size,this;Y=this.__data__=new It(re)}return Y.set(p,V),this.size=Y.size,this}aa.prototype.clear=Ps,aa.prototype.delete=pn,aa.prototype.get=gn,aa.prototype.has=fn,aa.prototype.set=hn;function vn(p,V){var Y=ts(p),re=!Y&&dl(p),Me=!Y&&!re&&as(p),Pe=!Y&&!re&&!Me&&gl(p),je=Y||re||Me||Pe,Ze=je?Re(p.length,String):[],ot=Ze.length;for(var Xe in p)(V||Mt.call(p,Xe))&&!(je&&(Xe=="length"||Me&&(Xe=="offset"||Xe=="parent")||Pe&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||Tn(Xe,ot)))&&Ze.push(Xe);return Ze}function es(p,V){for(var Y=p.length;Y--;)if(ul(p[Y][0],V))return Y;return-1}function $s(p,V,Y){var re=V(p);return ts(p)?re:$e(re,Y(p))}function Fa(p){return p==null?p===void 0?B:P:Ht&&Ht in Object(p)?da(p):cl(p)}function ol(p){return la(p)&&Fa(p)==r}function rl(p,V,Y,re,Me){return p===V?!0:p==null||V==null||!la(p)&&!la(V)?p!==p&&V!==V:_n(p,V,Y,re,rl,Me)}function _n(p,V,Y,re,Me,Pe){var je=ts(p),Ze=ts(V),ot=je?u:sa(p),Xe=Ze?u:sa(V);ot=ot==r?L:ot,Xe=Xe==r?L:Xe;var kt=ot==L,Pt=Xe==L,ct=ot==Xe;if(ct&&as(p)){if(!as(V))return!1;je=!0,kt=!1}if(ct&&!kt)return Pe||(Pe=new aa),je||gl(p)?Ns(p,V,Y,re,Me,Pe):Cn(p,V,ot,Y,re,Me,Pe);if(!(Y&l)){var Ct=kt&&Mt.call(p,"__wrapped__"),ft=Pt&&Mt.call(V,"__wrapped__");if(Ct||ft){var Ca=Ct?p.value():p,ma=ft?V.value():V;return Pe||(Pe=new aa),Me(Ca,ma,Y,re,Pe)}}return ct?(Pe||(Pe=new aa),xn(p,V,Y,re,Me,Pe)):!1}function yn(p){if(!pl(p)||Ln(p))return!1;var V=ml(p)?Hl:Q;return V.test(Tt(p))}function bn(p){return la(p)&&Os(p.length)&&!!X[Fa(p)]}function kn(p){if(!Sn(p))return Da(p);var V=[];for(var Y in Object(p))Mt.call(p,Y)&&Y!="constructor"&&V.push(Y);return V}function Ns(p,V,Y,re,Me,Pe){var je=Y&l,Ze=p.length,ot=V.length;if(Ze!=ot&&!(je&&ot>Ze))return!1;var Xe=Pe.get(p);if(Xe&&Pe.get(V))return Xe==V;var kt=-1,Pt=!0,ct=Y&i?new Qa:void 0;for(Pe.set(p,V),Pe.set(V,p);++kt<Ze;){var Ct=p[kt],ft=V[kt];if(re)var Ca=je?re(ft,Ct,kt,V,p,Pe):re(Ct,ft,kt,p,V,Pe);if(Ca!==void 0){if(Ca)continue;Pt=!1;break}if(ct){if(!Oe(V,function(ma,Va){if(!Ue(ct,Va)&&(Ct===ma||Me(Ct,ma,Y,re,Pe)))return ct.push(Va)})){Pt=!1;break}}else if(!(Ct===ft||Me(Ct,ft,Y,re,Pe))){Pt=!1;break}}return Pe.delete(p),Pe.delete(V),Pt}function Cn(p,V,Y,re,Me,Pe,je){switch(Y){case G:if(p.byteLength!=V.byteLength||p.byteOffset!=V.byteOffset)return!1;p=p.buffer,V=V.buffer;case N:return!(p.byteLength!=V.byteLength||!Pe(new sl(p),new sl(V)));case f:case _:case b:return ul(+p,+V);case g:return p.name==V.name&&p.message==V.message;case S:case T:return p==V+"";case I:var Ze=he;case E:var ot=re&l;if(Ze||(Ze=Fe),p.size!=V.size&&!ot)return!1;var Xe=je.get(p);if(Xe)return Xe==V;re|=i,je.set(p,V);var kt=Ns(Ze(p),Ze(V),re,Me,Pe,je);return je.delete(p),kt;case w:if(Is)return Is.call(p)==Is.call(V)}return!1}function xn(p,V,Y,re,Me,Pe){var je=Y&l,Ze=Ma(p),ot=Ze.length,Xe=Ma(V),kt=Xe.length;if(ot!=kt&&!je)return!1;for(var Pt=ot;Pt--;){var ct=Ze[Pt];if(!(je?ct in V:Mt.call(V,ct)))return!1}var Ct=Pe.get(p);if(Ct&&Pe.get(V))return Ct==V;var ft=!0;Pe.set(p,V),Pe.set(V,p);for(var Ca=je;++Pt<ot;){ct=Ze[Pt];var ma=p[ct],Va=V[ct];if(re)var Pi=je?re(Va,ma,ct,V,p,Pe):re(ma,Va,ct,p,V,Pe);if(!(Pi===void 0?ma===Va||Me(ma,Va,Y,re,Pe):Pi)){ft=!1;break}Ca||(Ca=ct=="constructor")}if(ft&&!Ca){var fl=p.constructor,hl=V.constructor;fl!=hl&&"constructor"in p&&"constructor"in V&&!(typeof fl=="function"&&fl instanceof fl&&typeof hl=="function"&&hl instanceof hl)&&(ft=!1)}return Pe.delete(p),Pe.delete(V),ft}function Ma(p){return $s(p,Fs,wn)}function Zt(p,V){var Y=p.__data__;return En(V)?Y[typeof V=="string"?"string":"hash"]:Y.map}function ua(p,V){var Y=J(p,V);return yn(Y)?Y:void 0}function da(p){var V=Mt.call(p,Ht),Y=p[Ht];try{p[Ht]=void 0;var re=!0}catch{}var Me=al.call(p);return re&&(V?p[Ht]=Y:delete p[Ht]),Me}var wn=Xa?function(p){return p==null?[]:(p=Object(p),Te(Xa(p),function(V){return Ja.call(p,V)}))}:In,sa=Fa;(Es&&sa(new Es(new ArrayBuffer(1)))!=G||Oa&&sa(new Oa)!=I||Ls&&sa(Ls.resolve())!=$||Ss&&sa(new Ss)!=E||As&&sa(new As)!=z)&&(sa=function(p){var V=Fa(p),Y=V==L?p.constructor:void 0,re=Y?Tt(Y):"";if(re)switch(re){case ll:return G;case ca:return I;case Zl:return $;case Gl:return E;case Jl:return z}return V});function Tn(p,V){return V=V??o,!!V&&(typeof p=="number"||ve.test(p))&&p>-1&&p%1==0&&p<V}function En(p){var V=typeof p;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?p!=="__proto__":p===null}function Ln(p){return!!tl&&tl in p}function Sn(p){var V=p&&p.constructor,Y=typeof V=="function"&&V.prototype||wt;return p===Y}function cl(p){return al.call(p)}function Tt(p){if(p!=null){try{return xs.call(p)}catch{}try{return p+""}catch{}}return""}function ul(p,V){return p===V||p!==p&&V!==V}var dl=ol(function(){return arguments}())?ol:function(p){return la(p)&&Mt.call(p,"callee")&&!Ja.call(p,"callee")},ts=Array.isArray;function Ds(p){return p!=null&&Os(p.length)&&!ml(p)}var as=Ts||Pn;function An(p,V){return rl(p,V)}function ml(p){if(!pl(p))return!1;var V=Fa(p);return V==C||V==O||V==d||V==h}function Os(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function pl(p){var V=typeof p;return p!=null&&(V=="object"||V=="function")}function la(p){return p!=null&&typeof p=="object"}var gl=pe?be(pe):bn;function Fs(p){return Ds(p)?vn(p):kn(p)}function In(){return[]}function Pn(){return!1}n.exports=An})(Pl,Pl.exports);var fi={};Object.defineProperty(fi,"__esModule",{value:!0});const bd=Il.exports,kd=Pl.exports;var Gn;(function(n){function a(i={},o={},r=!1){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});let u=bd(o);r||(u=Object.keys(u).reduce((d,f)=>(u[f]!=null&&(d[f]=u[f]),d),{}));for(const d in i)i[d]!==void 0&&o[d]===void 0&&(u[d]=i[d]);return Object.keys(u).length>0?u:void 0}n.compose=a;function e(i={},o={}){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});const r=Object.keys(i).concat(Object.keys(o)).reduce((u,d)=>(kd(i[d],o[d])||(u[d]=o[d]===void 0?null:o[d]),u),{});return Object.keys(r).length>0?r:void 0}n.diff=e;function s(i={},o={}){i=i||{};const r=Object.keys(o).reduce((u,d)=>(o[d]!==i[d]&&i[d]!==void 0&&(u[d]=o[d]),u),{});return Object.keys(i).reduce((u,d)=>(i[d]!==o[d]&&o[d]===void 0&&(u[d]=null),u),r)}n.invert=s;function l(i,o,r=!1){if(typeof i!="object")return o;if(typeof o!="object")return;if(!r)return o;const u=Object.keys(o).reduce((d,f)=>(i[f]===void 0&&(d[f]=o[f]),d),{});return Object.keys(u).length>0?u:void 0}n.transform=l})(Gn||(Gn={}));fi.default=Gn;var zl={};Object.defineProperty(zl,"__esModule",{value:!0});var Jn;(function(n){function a(e){return typeof e.delete=="number"?e.delete:typeof e.retain=="number"?e.retain:typeof e.retain=="object"&&e.retain!==null?1:typeof e.insert=="string"?e.insert.length:1}n.length=a})(Jn||(Jn={}));zl.default=Jn;var hi={};Object.defineProperty(hi,"__esModule",{value:!0});const Yi=zl;class Cd{constructor(a){this.ops=a,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(a){a||(a=1/0);const e=this.ops[this.index];if(e){const s=this.offset,l=Yi.default.length(e);if(a>=l-s?(a=l-s,this.index+=1,this.offset=0):this.offset+=a,typeof e.delete=="number")return{delete:a};{const i={};return e.attributes&&(i.attributes=e.attributes),typeof e.retain=="number"?i.retain=a:typeof e.retain=="object"&&e.retain!==null?i.retain=e.retain:typeof e.insert=="string"?i.insert=e.insert.substr(s,a):i.insert=e.insert,i}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?Yi.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const a=this.ops[this.index];return a?typeof a.delete=="number"?"delete":typeof a.retain=="number"||typeof a.retain=="object"&&a.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const a=this.offset,e=this.index,s=this.next(),l=this.ops.slice(this.index);return this.offset=a,this.index=e,[s].concat(l)}}else return[]}}hi.default=Cd;(function(n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.AttributeMap=a.OpIterator=a.Op=void 0;const e=yd,s=Il.exports,l=Pl.exports,i=fi;a.AttributeMap=i.default;const o=zl;a.Op=o.default;const r=hi;a.OpIterator=r.default;const u=String.fromCharCode(0),d=(_,g)=>{if(typeof _!="object"||_===null)throw new Error(`cannot retain a ${typeof _}`);if(typeof g!="object"||g===null)throw new Error(`cannot retain a ${typeof g}`);const C=Object.keys(_)[0];if(!C||C!==Object.keys(g)[0])throw new Error(`embed types not matched: ${C} != ${Object.keys(g)[0]}`);return[C,_[C],g[C]]};class f{constructor(g){Array.isArray(g)?this.ops=g:g!=null&&Array.isArray(g.ops)?this.ops=g.ops:this.ops=[]}static registerEmbed(g,C){this.handlers[g]=C}static unregisterEmbed(g){delete this.handlers[g]}static getHandler(g){const C=this.handlers[g];if(!C)throw new Error(`no handlers for embed type "${g}"`);return C}insert(g,C){const O={};return typeof g=="string"&&g.length===0?this:(O.insert=g,C!=null&&typeof C=="object"&&Object.keys(C).length>0&&(O.attributes=C),this.push(O))}delete(g){return g<=0?this:this.push({delete:g})}retain(g,C){if(typeof g=="number"&&g<=0)return this;const O={retain:g};return C!=null&&typeof C=="object"&&Object.keys(C).length>0&&(O.attributes=C),this.push(O)}push(g){let C=this.ops.length,O=this.ops[C-1];if(g=s(g),typeof O=="object"){if(typeof g.delete=="number"&&typeof O.delete=="number")return this.ops[C-1]={delete:O.delete+g.delete},this;if(typeof O.delete=="number"&&g.insert!=null&&(C-=1,O=this.ops[C-1],typeof O!="object"))return this.ops.unshift(g),this;if(l(g.attributes,O.attributes)){if(typeof g.insert=="string"&&typeof O.insert=="string")return this.ops[C-1]={insert:O.insert+g.insert},typeof g.attributes=="object"&&(this.ops[C-1].attributes=g.attributes),this;if(typeof g.retain=="number"&&typeof O.retain=="number")return this.ops[C-1]={retain:O.retain+g.retain},typeof g.attributes=="object"&&(this.ops[C-1].attributes=g.attributes),this}}return C===this.ops.length?this.ops.push(g):this.ops.splice(C,0,g),this}chop(){const g=this.ops[this.ops.length-1];return g&&typeof g.retain=="number"&&!g.attributes&&this.ops.pop(),this}filter(g){return this.ops.filter(g)}forEach(g){this.ops.forEach(g)}map(g){return this.ops.map(g)}partition(g){const C=[],O=[];return this.forEach(I=>{(g(I)?C:O).push(I)}),[C,O]}reduce(g,C){return this.ops.reduce(g,C)}changeLength(){return this.reduce((g,C)=>C.insert?g+o.default.length(C):C.delete?g-C.delete:g,0)}length(){return this.reduce((g,C)=>g+o.default.length(C),0)}slice(g=0,C=1/0){const O=[],I=new r.default(this.ops);let b=0;for(;b<C&&I.hasNext();){let P;b<g?P=I.next(g-b):(P=I.next(C-b),O.push(P)),b+=o.default.length(P)}return new f(O)}compose(g){const C=new r.default(this.ops),O=new r.default(g.ops),I=[],b=O.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){let L=b.retain;for(;C.peekType()==="insert"&&C.peekLength()<=L;)L-=C.peekLength(),I.push(C.next());b.retain-L>0&&O.next(b.retain-L)}const P=new f(I);for(;C.hasNext()||O.hasNext();)if(O.peekType()==="insert")P.push(O.next());else if(C.peekType()==="delete")P.push(C.next());else{const L=Math.min(C.peekLength(),O.peekLength()),$=C.next(L),h=O.next(L);if(h.retain){const S={};if(typeof $.retain=="number")S.retain=typeof h.retain=="number"?L:h.retain;else if(typeof h.retain=="number")$.retain==null?S.insert=$.insert:S.retain=$.retain;else{const T=$.retain==null?"insert":"retain",[w,B,z]=d($[T],h.retain),N=f.getHandler(w);S[T]={[w]:N.compose(B,z,T==="retain")}}const E=i.default.compose($.attributes,h.attributes,typeof $.retain=="number");if(E&&(S.attributes=E),P.push(S),!O.hasNext()&&l(P.ops[P.ops.length-1],S)){const T=new f(C.rest());return P.concat(T).chop()}}else typeof h.delete=="number"&&(typeof $.retain=="number"||typeof $.retain=="object"&&$.retain!==null)&&P.push(h)}return P.chop()}concat(g){const C=new f(this.ops.slice());return g.ops.length>0&&(C.push(g.ops[0]),C.ops=C.ops.concat(g.ops.slice(1))),C}diff(g,C){if(this.ops===g.ops)return new f;const O=[this,g].map($=>$.map(h=>{if(h.insert!=null)return typeof h.insert=="string"?h.insert:u;const S=$===g?"on":"with";throw new Error("diff() called "+S+" non-document")}).join("")),I=new f,b=e(O[0],O[1],C,!0),P=new r.default(this.ops),L=new r.default(g.ops);return b.forEach($=>{let h=$[1].length;for(;h>0;){let S=0;switch($[0]){case e.INSERT:S=Math.min(L.peekLength(),h),I.push(L.next(S));break;case e.DELETE:S=Math.min(h,P.peekLength()),P.next(S),I.delete(S);break;case e.EQUAL:S=Math.min(P.peekLength(),L.peekLength(),h);const E=P.next(S),T=L.next(S);l(E.insert,T.insert)?I.retain(S,i.default.diff(E.attributes,T.attributes)):I.push(T).delete(S);break}h-=S}}),I.chop()}eachLine(g,C=`
`){const O=new r.default(this.ops);let I=new f,b=0;for(;O.hasNext();){if(O.peekType()!=="insert")return;const P=O.peek(),L=o.default.length(P)-O.peekLength(),$=typeof P.insert=="string"?P.insert.indexOf(C,L)-L:-1;if($<0)I.push(O.next());else if($>0)I.push(O.next($));else{if(g(I,O.next(1).attributes||{},b)===!1)return;b+=1,I=new f}}I.length()>0&&g(I,{},b)}invert(g){const C=new f;return this.reduce((O,I)=>{if(I.insert)C.delete(o.default.length(I));else{if(typeof I.retain=="number"&&I.attributes==null)return C.retain(I.retain),O+I.retain;if(I.delete||typeof I.retain=="number"){const b=I.delete||I.retain;return g.slice(O,O+b).forEach(L=>{I.delete?C.push(L):I.retain&&I.attributes&&C.retain(o.default.length(L),i.default.invert(I.attributes,L.attributes))}),O+b}else if(typeof I.retain=="object"&&I.retain!==null){const b=g.slice(O,O+1),P=new r.default(b.ops).next(),[L,$,h]=d(I.retain,P.insert),S=f.getHandler(L);return C.retain({[L]:S.invert($,h)},i.default.invert(I.attributes,P.attributes)),O+1}}return O},0),C.chop()}transform(g,C=!1){if(C=!!C,typeof g=="number")return this.transformPosition(g,C);const O=g,I=new r.default(this.ops),b=new r.default(O.ops),P=new f;for(;I.hasNext()||b.hasNext();)if(I.peekType()==="insert"&&(C||b.peekType()!=="insert"))P.retain(o.default.length(I.next()));else if(b.peekType()==="insert")P.push(b.next());else{const L=Math.min(I.peekLength(),b.peekLength()),$=I.next(L),h=b.next(L);if($.delete)continue;if(h.delete)P.push(h);else{const S=$.retain,E=h.retain;let T=typeof E=="object"&&E!==null?E:L;if(typeof S=="object"&&S!==null&&typeof E=="object"&&E!==null){const w=Object.keys(S)[0];if(w===Object.keys(E)[0]){const B=f.getHandler(w);B&&(T={[w]:B.transform(S[w],E[w],C)})}}P.retain(T,i.default.transform($.attributes,h.attributes,C))}}return P.chop()}transformPosition(g,C=!1){C=!!C;const O=new r.default(this.ops);let I=0;for(;O.hasNext()&&I<=g;){const b=O.peekLength(),P=O.peekType();if(O.next(),P==="delete"){g-=Math.min(b,g-I);continue}else P==="insert"&&(I<g||!C)&&(g+=b);I+=b}return g}}f.Op=o.default,f.OpIterator=r.default,f.AttributeMap=i.default,f.handlers={},a.default=f,n.exports=f,n.exports.default=f})($t,$t.exports);var Se=Rr($t.exports);class ta extends Ft{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}ta.blotName="break";ta.tagName="BR";class Kt extends Al{}const xd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function jl(n){return n.replace(/[&<>"']/g,a=>xd[a])}class Et extends di{static allowedChildren=[Et,ta,Ft,Kt];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(a,e){const s=Et.order.indexOf(a),l=Et.order.indexOf(e);return s>=0||l>=0?s-l:a===e?0:a<e?-1:1}formatAt(a,e,s,l){if(Et.compare(this.statics.blotName,s)<0&&this.scroll.query(s,Ie.BLOT)){const i=this.isolate(a,e);l&&i.wrap(s,l)}else super.formatAt(a,e,s,l)}optimize(a){if(super.optimize(a),this.parent instanceof Et&&Et.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}}const Wi=1;class vt extends zs{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Uo(this)),this.cache.delta}deleteAt(a,e){super.deleteAt(a,e),this.cache={}}formatAt(a,e,s,l){e<=0||(this.scroll.query(s,Ie.BLOCK)?a+e===this.length()&&this.format(s,l):super.formatAt(a,Math.min(e,this.length()-a-1),s,l),this.cache={})}insertAt(a,e,s){if(s!=null){super.insertAt(a,e,s),this.cache={};return}if(e.length===0)return;const l=e.split(`
`),i=l.shift();i.length>0&&(a<this.length()-1||this.children.tail==null?super.insertAt(Math.min(a,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let o=this;l.reduce((r,u)=>(o=o.split(r,!0),o.insertAt(0,u),u.length),a+i.length)}insertBefore(a,e){const{head:s}=this.children;super.insertBefore(a,e),s instanceof ta&&s.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Wi),this.cache.length}moveChildren(a,e){super.moveChildren(a,e),this.cache={}}optimize(a){super.optimize(a),this.cache={}}path(a){return super.path(a,!0)}removeChild(a){super.removeChild(a),this.cache={}}split(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e&&(a===0||a>=this.length()-Wi)){const l=this.clone();return a===0?(this.parent.insertBefore(l,this),this):(this.parent.insertBefore(l,this.next),l)}const s=super.split(a,e);return this.cache={},s}}vt.blotName="block";vt.tagName="P";vt.defaultChild=ta;vt.allowedChildren=[ta,Et,Ft,Kt];class Ut extends Ft{attach(){super.attach(),this.attributes=new Bl(this.domNode)}delta(){return new Se().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(a,e){const s=this.scroll.query(a,Ie.BLOCK_ATTRIBUTE);s!=null&&this.attributes.attribute(s,e)}formatAt(a,e,s,l){this.format(s,l)}insertAt(a,e,s){if(s!=null){super.insertAt(a,e,s);return}const l=e.split(`
`),i=l.pop(),o=l.map(u=>{const d=this.scroll.create(vt.blotName);return d.insertAt(0,u),d}),r=this.split(a);o.forEach(u=>{this.parent.insertBefore(u,r)}),i&&this.parent.insertBefore(this.scroll.create("text",i),r)}}Ut.scope=Ie.BLOCK_BLOT;function Uo(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(xt).reduce((e,s)=>s.length()===0?e:e.insert(s.value(),Rt(s,{},a)),new Se).insert(`
`,Rt(n))}function Rt(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(a={...a,...n.formats()},e&&delete a["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?a:Rt(n.parent,a,e)}class Jt extends Ft{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(a,e,s){super(a,e),this.selection=s,this.textNode=document.createTextNode(Jt.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(a,e){if(this.savedLength!==0){super.format(a,e);return}let s=this,l=0;for(;s!=null&&s.statics.scope!==Ie.BLOCK_BLOT;)l+=s.offset(s.parent),s=s.parent;s!=null&&(this.savedLength=Jt.CONTENTS.length,s.optimize(),s.formatAt(l,Jt.CONTENTS.length,a,e),this.savedLength=0)}index(a,e){return a===this.textNode?0:super.index(a,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const a=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof Kt?this.prev:null,s=e?e.length():0,l=this.next instanceof Kt?this.next:null,i=l?l.text:"",{textNode:o}=this,r=o.data.split(Jt.CONTENTS).join("");o.data=Jt.CONTENTS;let u;if(e)u=e,(r||l)&&(e.insertAt(e.length(),r+i),l&&l.remove());else if(l)u=l,l.insertAt(0,r);else{const d=document.createTextNode(r);u=this.scroll.create(d),this.parent.insertBefore(u,this)}if(this.remove(),a){const d=(g,C)=>e&&g===e.domNode?C:g===o?s+C-1:l&&g===l.domNode?s+r.length+C:null,f=d(a.start.node,a.start.offset),_=d(a.end.node,a.end.offset);if(f!==null&&_!==null)return{startNode:u.domNode,startOffset:f,endNode:u.domNode,endOffset:_}}return null}update(a,e){if(a.some(s=>s.type==="characterData"&&s.target===this.textNode)){const s=this.restore();s&&(e.range=s)}}optimize(a){super.optimize(a);let{parent:e}=this;for(;e;){if(e.domNode.tagName==="A"){this.savedLength=Jt.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}}var zo={exports:{}};(function(n){var a=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function l(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function i(u,d,f,_,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var C=new l(f,_||u,g),O=e?e+d:d;return u._events[O]?u._events[O].fn?u._events[O]=[u._events[O],C]:u._events[O].push(C):(u._events[O]=C,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new s:delete u._events[d]}function r(){this._events=new s,this._eventsCount=0}r.prototype.eventNames=function(){var d=[],f,_;if(this._eventsCount===0)return d;for(_ in f=this._events)a.call(f,_)&&d.push(e?_.slice(1):_);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},r.prototype.listeners=function(d){var f=e?e+d:d,_=this._events[f];if(!_)return[];if(_.fn)return[_.fn];for(var g=0,C=_.length,O=new Array(C);g<C;g++)O[g]=_[g].fn;return O},r.prototype.listenerCount=function(d){var f=e?e+d:d,_=this._events[f];return _?_.fn?1:_.length:0},r.prototype.emit=function(d,f,_,g,C,O){var I=e?e+d:d;if(!this._events[I])return!1;var b=this._events[I],P=arguments.length,L,$;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),P){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,f),!0;case 3:return b.fn.call(b.context,f,_),!0;case 4:return b.fn.call(b.context,f,_,g),!0;case 5:return b.fn.call(b.context,f,_,g,C),!0;case 6:return b.fn.call(b.context,f,_,g,C,O),!0}for($=1,L=new Array(P-1);$<P;$++)L[$-1]=arguments[$];b.fn.apply(b.context,L)}else{var h=b.length,S;for($=0;$<h;$++)switch(b[$].once&&this.removeListener(d,b[$].fn,void 0,!0),P){case 1:b[$].fn.call(b[$].context);break;case 2:b[$].fn.call(b[$].context,f);break;case 3:b[$].fn.call(b[$].context,f,_);break;case 4:b[$].fn.call(b[$].context,f,_,g);break;default:if(!L)for(S=1,L=new Array(P-1);S<P;S++)L[S-1]=arguments[S];b[$].fn.apply(b[$].context,L)}}return!0},r.prototype.on=function(d,f,_){return i(this,d,f,_,!1)},r.prototype.once=function(d,f,_){return i(this,d,f,_,!0)},r.prototype.removeListener=function(d,f,_,g){var C=e?e+d:d;if(!this._events[C])return this;if(!f)return o(this,C),this;var O=this._events[C];if(O.fn)O.fn===f&&(!g||O.once)&&(!_||O.context===_)&&o(this,C);else{for(var I=0,b=[],P=O.length;I<P;I++)(O[I].fn!==f||g&&!O[I].once||_&&O[I].context!==_)&&b.push(O[I]);b.length?this._events[C]=b.length===1?b[0]:b:o(this,C)}return this},r.prototype.removeAllListeners=function(d){var f;return d?(f=e?e+d:d,this._events[f]&&o(this,f)):(this._events=new s,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=e,r.EventEmitter=r,n.exports=r})(zo);var wd=zo.exports,Xn=new WeakMap;const Qn=["error","warn","log","info"];let Kn="warn";function jo(n){if(Kn&&Qn.indexOf(n)<=Qn.indexOf(Kn)){for(var a=arguments.length,e=new Array(a>1?a-1:0),s=1;s<a;s++)e[s-1]=arguments[s];console[n](...e)}}function ya(n){return Qn.reduce((a,e)=>(a[e]=jo.bind(console,e,n),a),{})}ya.level=n=>{Kn=n};jo.level=ya.level;const On=ya("quill:events"),Td=["selectionchange","mousedown","mouseup","click"];Td.forEach(n=>{document.addEventListener(n,function(){for(var a=arguments.length,e=new Array(a),s=0;s<a;s++)e[s]=arguments[s];Array.from(document.querySelectorAll(".ql-container")).forEach(l=>{const i=Xn.get(l);i&&i.emitter&&i.emitter.handleDOM(...e)})})});class Le extends wd{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",On.error)}emit(){for(var a=arguments.length,e=new Array(a),s=0;s<a;s++)e[s]=arguments[s];return On.log.call(On,...e),super.emit(...e)}handleDOM(a){for(var e=arguments.length,s=new Array(e>1?e-1:0),l=1;l<e;l++)s[l-1]=arguments[l];(this.domListeners[a.type]||[]).forEach(i=>{let{node:o,handler:r}=i;(a.target===o||o.contains(a.target))&&r(a,...s)})}listenDOM(a,e,s){this.domListeners[a]||(this.domListeners[a]=[]),this.domListeners[a].push({node:e,handler:s})}}const Fn=ya("quill:selection");class Ra{constructor(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=a,this.length=e}}class Ed{constructor(a,e){this.emitter=e,this.scroll=a,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Ra(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,Le.sources.USER),1)}),this.emitter.on(Le.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const s=this.getNativeRange();s!=null&&s.start.node!==this.cursor.textNode&&this.emitter.once(Le.events.SCROLL_UPDATE,(l,i)=>{try{this.root.contains(s.start.node)&&this.root.contains(s.end.node)&&this.setNativeRange(s.start.node,s.start.offset,s.end.node,s.end.offset);const o=i.some(r=>r.type==="characterData"||r.type==="childList"||r.type==="attributes"&&r.target===this.root);this.update(o?Le.sources.SILENT:l)}catch{}})}),this.emitter.on(Le.events.SCROLL_OPTIMIZE,(s,l)=>{if(l.range){const{startNode:i,startOffset:o,endNode:r,endOffset:u}=l.range;this.setNativeRange(i,o,r,u),this.update(Le.sources.SILENT)}}),this.update(Le.sources.SILENT)}handleComposition(){this.emitter.on(Le.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(Le.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const a=this.cursor.restore();if(!a)return;setTimeout(()=>{this.setNativeRange(a.startNode,a.startOffset,a.endNode,a.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(Le.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(a,e){this.scroll.update();const s=this.getNativeRange();if(!(s==null||!s.native.collapsed||this.scroll.query(a,Ie.BLOCK))){if(s.start.node!==this.cursor.textNode){const l=this.scroll.find(s.start.node,!1);if(l==null)return;if(l instanceof xt){const i=l.split(s.start.offset);l.parent.insertBefore(this.cursor,i)}else l.insertBefore(this.cursor,s.start.node);this.cursor.attach()}this.cursor.format(a,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.scroll.length();a=Math.min(a,s-1),e=Math.min(a+e,s-1)-a;let l,[i,o]=this.scroll.leaf(a);if(i==null)return null;if(e>0&&o===i.length()){const[f]=this.scroll.leaf(a+1);if(f){const[_]=this.scroll.line(a),[g]=this.scroll.line(a+1);_===g&&(i=f,o=0)}}[l,o]=i.position(o,!0);const r=document.createRange();if(e>0)return r.setStart(l,o),[i,o]=this.scroll.leaf(a+e),i==null?null:([l,o]=i.position(o,!0),r.setEnd(l,o),r.getBoundingClientRect());let u="left",d;if(l instanceof Text){if(!l.data.length)return null;o<l.data.length?(r.setStart(l,o),r.setEnd(l,o+1)):(r.setStart(l,o-1),r.setEnd(l,o),u="right"),d=r.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;d=i.domNode.getBoundingClientRect(),o>0&&(u="right")}return{bottom:d.top+d.height,height:d.height,left:d[u],right:d[u],top:d.top,width:0}}getNativeRange(){const a=document.getSelection();if(a==null||a.rangeCount<=0)return null;const e=a.getRangeAt(0);if(e==null)return null;const s=this.normalizeNative(e);return Fn.info("getNativeRange",s),s}getRange(){const a=this.scroll.domNode;if("isConnected"in a&&!a.isConnected)return[null,null];const e=this.getNativeRange();return e==null?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Mn(this.root,document.activeElement)}normalizedToRange(a){const e=[[a.start.node,a.start.offset]];a.native.collapsed||e.push([a.end.node,a.end.offset]);const s=e.map(o=>{const[r,u]=o,d=this.scroll.find(r,!0),f=d.offset(this.scroll);return u===0?f:d instanceof xt?f+d.index(r,u):f+d.length()}),l=Math.min(Math.max(...s),this.scroll.length()-1),i=Math.min(l,...s);return new Ra(i,l-i)}normalizeNative(a){if(!Mn(this.root,a.startContainer)||!a.collapsed&&!Mn(this.root,a.endContainer))return null;const e={start:{node:a.startContainer,offset:a.startOffset},end:{node:a.endContainer,offset:a.endOffset},native:a};return[e.start,e.end].forEach(s=>{let{node:l,offset:i}=s;for(;!(l instanceof Text)&&l.childNodes.length>0;)if(l.childNodes.length>i)l=l.childNodes[i],i=0;else if(l.childNodes.length===i)l=l.lastChild,l instanceof Text?i=l.data.length:l.childNodes.length>0?i=l.childNodes.length:i=l.childNodes.length+1;else break;s.node=l,s.offset=i}),e}rangeToNative(a){const e=this.scroll.length(),s=(l,i)=>{l=Math.min(e-1,l);const[o,r]=this.scroll.leaf(l);return o?o.position(r,i):[null,-1]};return[...s(a.index,!1),...s(a.index+a.length,!0)]}setNativeRange(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Fn.info("setNativeRange",a,e,s,l),a!=null&&(this.root.parentNode==null||a.parentNode==null||s.parentNode==null))return;const o=document.getSelection();if(o!=null)if(a!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:r}=this.getNativeRange()||{};if(r==null||i||a!==r.startContainer||e!==r.startOffset||s!==r.endContainer||l!==r.endOffset){a instanceof Element&&a.tagName==="BR"&&(e=Array.from(a.parentNode.childNodes).indexOf(a),a=a.parentNode),s instanceof Element&&s.tagName==="BR"&&(l=Array.from(s.parentNode.childNodes).indexOf(s),s=s.parentNode);const u=document.createRange();u.setStart(a,e),u.setEnd(s,l),o.removeAllRanges(),o.addRange(u)}}else o.removeAllRanges(),this.root.blur()}setRange(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Le.sources.API;if(typeof e=="string"&&(s=e,e=!1),Fn.info("setRange",a),a!=null){const l=this.rangeToNative(a);this.setNativeRange(...l,e)}else this.setNativeRange(null);this.update(s)}update(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Le.sources.USER;const e=this.lastRange,[s,l]=this.getRange();if(this.lastRange=s,this.lastNative=l,this.lastRange!=null&&(this.savedRange=this.lastRange),!oi(e,this.lastRange)){if(!this.composing&&l!=null&&l.native.collapsed&&l.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const i=[Le.events.SELECTION_CHANGE,ms(this.lastRange),ms(e),a];this.emitter.emit(Le.events.EDITOR_CHANGE,...i),a!==Le.sources.SILENT&&this.emitter.emit(...i)}}}function Mn(n,a){try{a.parentNode}catch{return!1}return n.contains(a)}const Ld=/^[ -~]*$/;class Sd{constructor(a){this.scroll=a,this.delta=this.getDelta()}applyDelta(a){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const s=Hi(a),l=new Se;return Id(s.ops.slice()).reduce((o,r)=>{const u=$t.exports.Op.length(r);let d=r.attributes||{},f=!1,_=!1;if(r.insert!=null){if(l.retain(u),typeof r.insert=="string"){const O=r.insert;_=!O.endsWith(`
`)&&(e<=o||!!this.scroll.descendant(Ut,o)[0]),this.scroll.insertAt(o,O);const[I,b]=this.scroll.line(o);let P=Sa({},Rt(I));if(I instanceof vt){const[L]=I.descendant(xt,b);L&&(P=Sa(P,Rt(L)))}d=$t.exports.AttributeMap.diff(P,d)||{}}else if(typeof r.insert=="object"){const O=Object.keys(r.insert)[0];if(O==null)return o;const I=this.scroll.query(O,Ie.INLINE)!=null;if(I)(e<=o||!!this.scroll.descendant(Ut,o)[0])&&(_=!0);else if(o>0){const[b,P]=this.scroll.descendant(xt,o-1);b instanceof Kt?b.value()[P]!==`
`&&(f=!0):b instanceof Ft&&b.statics.scope===Ie.INLINE_BLOT&&(f=!0)}if(this.scroll.insertAt(o,O,r.insert[O]),I){const[b]=this.scroll.descendant(xt,o);if(b){const P=Sa({},Rt(b));d=$t.exports.AttributeMap.diff(P,d)||{}}}}e+=u}else if(l.push(r),r.retain!==null&&typeof r.retain=="object"){const O=Object.keys(r.retain)[0];if(O==null)return o;this.scroll.updateEmbedAt(o,O,r.retain[O])}Object.keys(d).forEach(O=>{this.scroll.formatAt(o,u,O,d[O])});const g=f?1:0,C=_?1:0;return e+=g+C,l.retain(g),l.delete(C),o+u+g+C},0),l.reduce((o,r)=>typeof r.delete=="number"?(this.scroll.deleteAt(o,r.delete),o):o+$t.exports.Op.length(r),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(s)}deleteText(a,e){return this.scroll.deleteAt(a,e),this.update(new Se().retain(a).delete(e))}formatLine(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(s).forEach(i=>{this.scroll.lines(a,Math.max(e,1)).forEach(o=>{o.format(i,s[i])})}),this.scroll.optimize();const l=new Se().retain(a).retain(e,ms(s));return this.update(l)}formatText(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s).forEach(i=>{this.scroll.formatAt(a,e,i,s[i])});const l=new Se().retain(a).retain(e,ms(s));return this.update(l)}getContents(a,e){return this.delta.slice(a,a+e)}getDelta(){return this.scroll.lines().reduce((a,e)=>a.concat(e.delta()),new Se)}getFormat(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=[],l=[];e===0?this.scroll.path(a).forEach(r=>{const[u]=r;u instanceof vt?s.push(u):u instanceof xt&&l.push(u)}):(s=this.scroll.lines(a,e),l=this.scroll.descendants(xt,a,e));const[i,o]=[s,l].map(r=>{const u=r.shift();if(u==null)return{};let d=Rt(u);for(;Object.keys(d).length>0;){const f=r.shift();if(f==null)return d;d=Ad(Rt(f),d)}return d});return{...i,...o}}getHTML(a,e){const[s,l]=this.scroll.line(a);if(s){const i=s.length();return s.length()>=l+e&&!(l===0&&e===i)?Ys(s,l,e,!0):Ys(this.scroll,a,e,!0)}return""}getText(a,e){return this.getContents(a,e).filter(s=>typeof s.insert=="string").map(s=>s.insert).join("")}insertContents(a,e){const s=Hi(e),l=new Se().retain(a).concat(s);return this.scroll.insertContents(a,s),this.update(l)}insertEmbed(a,e,s){return this.scroll.insertAt(a,e,s),this.update(new Se().retain(a).insert({[e]:s}))}insertText(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(a,e),Object.keys(s).forEach(l=>{this.scroll.formatAt(a,e.length,l,s[l])}),this.update(new Se().retain(a).insert(e,ms(s)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const a=this.scroll.children.head;if(a?.statics.blotName!==vt.blotName)return!1;const e=a;return e.children.length>1?!1:e.children.head instanceof ta}removeFormat(a,e){const s=this.getText(a,e),[l,i]=this.scroll.line(a+e);let o=0,r=new Se;l!=null&&(o=l.length()-i,r=l.delta().slice(i,i+o-1).insert(`
`));const d=this.getContents(a,e+o).diff(new Se().insert(s).concat(r)),f=new Se().retain(a).concat(d);return this.applyDelta(f)}update(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const l=this.delta;if(e.length===1&&e[0].type==="characterData"&&e[0].target.data.match(Ld)&&this.scroll.find(e[0].target)){const i=this.scroll.find(e[0].target),o=Rt(i),r=i.offset(this.scroll),u=e[0].oldValue.replace(Jt.CONTENTS,""),d=new Se().insert(u),f=new Se().insert(i.value()),_=s&&{oldRange:Zi(s.oldRange,-r),newRange:Zi(s.newRange,-r)};a=new Se().retain(r).concat(d.diff(f,_)).reduce((C,O)=>O.insert?C.insert(O.insert,o):C.push(O),new Se),this.delta=l.compose(a)}else this.delta=this.getDelta(),(!a||!oi(l.compose(a),this.delta))&&(a=l.diff(this.delta,s));return a}}function us(n,a,e){if(n.length===0){const[C]=Vn(e.pop());return a<=0?`</li></${C}>`:`</li></${C}>${us([],a-1,e)}`}const[{child:s,offset:l,length:i,indent:o,type:r},...u]=n,[d,f]=Vn(r);if(o>a)return e.push(r),o===a+1?`<${d}><li${f}>${Ys(s,l,i)}${us(u,o,e)}`:`<${d}><li>${us(n,a+1,e)}`;const _=e[e.length-1];if(o===a&&r===_)return`</li><li${f}>${Ys(s,l,i)}${us(u,o,e)}`;const[g]=Vn(e.pop());return`</li></${g}>${us(n,a-1,e)}`}function Ys(n,a,e){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(a,e);if(n instanceof Kt)return jl(n.value().slice(a,a+e)).replaceAll(" ","&nbsp;");if(n instanceof Qt){if(n.statics.blotName==="list-container"){const d=[];return n.children.forEachAt(a,e,(f,_,g)=>{const C="formats"in f&&typeof f.formats=="function"?f.formats():{};d.push({child:f,offset:_,length:g,indent:C.indent||0,type:C.list})}),us(d,-1,[])}const l=[];if(n.children.forEachAt(a,e,(d,f,_)=>{l.push(Ys(d,f,_))}),s||n.statics.blotName==="list")return l.join("");const{outerHTML:i,innerHTML:o}=n.domNode,[r,u]=i.split(`>${o}<`);return r==="<table"?`<table style="border: 1px solid #000;">${l.join("")}<${u}`:`${r}>${l.join("")}<${u}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function Ad(n,a){return Object.keys(a).reduce((e,s)=>{if(n[s]==null)return e;const l=a[s];return l===n[s]?e[s]=l:Array.isArray(l)?l.indexOf(n[s])<0?e[s]=l.concat([n[s]]):e[s]=l:e[s]=[l,n[s]],e},{})}function Vn(n){const a=n==="ordered"?"ol":"ul";switch(n){case"checked":return[a,' data-list="checked"'];case"unchecked":return[a,' data-list="unchecked"'];default:return[a,""]}}function Hi(n){return n.reduce((a,e)=>{if(typeof e.insert=="string"){const s=e.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return a.insert(s,e.attributes)}return a.push(e)},new Se)}function Zi(n,a){let{index:e,length:s}=n;return new Ra(e+a,s)}function Id(n){const a=[];return n.forEach(e=>{typeof e.insert=="string"?e.insert.split(`
`).forEach((l,i)=>{i&&a.push({insert:`
`,attributes:e.attributes}),l&&a.push({insert:l,attributes:e.attributes})}):a.push(e)}),a}class ra{static DEFAULTS={};constructor(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=a,this.options=e}}const vl="\uFEFF";class vi extends Ft{constructor(a,e){super(a,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(s=>{this.contentNode.appendChild(s)}),this.leftGuard=document.createTextNode(vl),this.rightGuard=document.createTextNode(vl),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(a,e){return a===this.leftGuard?0:a===this.rightGuard?1:super.index(a,e)}restore(a){let e=null,s;const l=a.data.split(vl).join("");if(a===this.leftGuard)if(this.prev instanceof Kt){const i=this.prev.length();this.prev.insertAt(i,l),e={startNode:this.prev.domNode,startOffset:i+l.length}}else s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this),e={startNode:s,startOffset:l.length};else a===this.rightGuard&&(this.next instanceof Kt?(this.next.insertAt(0,l),e={startNode:this.next.domNode,startOffset:l.length}):(s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this.next),e={startNode:s,startOffset:l.length}));return a.data=vl,e}update(a,e){a.forEach(s=>{if(s.type==="characterData"&&(s.target===this.leftGuard||s.target===this.rightGuard)){const l=this.restore(s.target);l&&(e.range=l)}})}}class Pd{isComposing=!1;constructor(a,e){this.scroll=a,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",a=>{this.isComposing||this.handleCompositionStart(a)}),this.scroll.domNode.addEventListener("compositionend",a=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(a)})})}handleCompositionStart(a){const e=a.target instanceof Node?this.scroll.find(a.target,!0):null;e&&!(e instanceof vi)&&(this.emitter.emit(Le.events.COMPOSITION_BEFORE_START,a),this.scroll.batchStart(),this.emitter.emit(Le.events.COMPOSITION_START,a),this.isComposing=!0)}handleCompositionEnd(a){this.emitter.emit(Le.events.COMPOSITION_BEFORE_END,a),this.scroll.batchEnd(),this.emitter.emit(Le.events.COMPOSITION_END,a),this.isComposing=!1}}class Cs{static DEFAULTS={modules:{}};static themes={default:Cs};modules={};constructor(a,e){this.quill=a,this.options=e}init(){Object.keys(this.options.modules).forEach(a=>{this.modules[a]==null&&this.addModule(a)})}addModule(a){const e=this.quill.constructor.import(`modules/${a}`);return this.modules[a]=new e(this.quill,this.options.modules[a]||{}),this.modules[a]}}const $d=n=>n.parentElement||n.getRootNode().host||null,Nd=n=>{const a=n.getBoundingClientRect(),e="offsetWidth"in n&&Math.abs(a.width)/n.offsetWidth||1,s="offsetHeight"in n&&Math.abs(a.height)/n.offsetHeight||1;return{top:a.top,right:a.left+n.clientWidth*e,bottom:a.top+n.clientHeight*s,left:a.left}},_l=n=>{const a=parseInt(n,10);return Number.isNaN(a)?0:a},Gi=(n,a,e,s,l,i)=>n<e&&a>s?0:n<e?-(e-n+l):a>s?a-n>s-e?n+l-e:a-s+i:0,Dd=(n,a)=>{const e=n.ownerDocument;let s=a,l=n;for(;l;){const i=l===e.body,o=i?{top:0,right:window.visualViewport?.width??e.documentElement.clientWidth,bottom:window.visualViewport?.height??e.documentElement.clientHeight,left:0}:Nd(l),r=getComputedStyle(l),u=Gi(s.left,s.right,o.left,o.right,_l(r.scrollPaddingLeft),_l(r.scrollPaddingRight)),d=Gi(s.top,s.bottom,o.top,o.bottom,_l(r.scrollPaddingTop),_l(r.scrollPaddingBottom));if(u||d)if(i)e.defaultView?.scrollBy(u,d);else{const{scrollLeft:f,scrollTop:_}=l;d&&(l.scrollTop+=d),u&&(l.scrollLeft+=u);const g=l.scrollLeft-f,C=l.scrollTop-_;s={left:s.left-g,top:s.top-C,right:s.right-g,bottom:s.bottom-C}}l=i||r.position==="fixed"?null:$d(l)}},Od=100,Fd=["block","break","cursor","inline","scroll","text"],Md=(n,a,e)=>{const s=new _s;return Fd.forEach(l=>{const i=a.query(l);i&&s.register(i)}),n.forEach(l=>{let i=a.query(l);i||e.error(`Cannot register "${l}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(s.register(i),i="blotName"in i?i.requiredContainer??null:null,o+=1,o>Od){e.error(`Cycle detected in registering blot requiredContainer: "${l}"`);break}}),s},gs=ya("quill"),yl=new _s;Qt.uiClass="ql-ui";class ue{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:yl,theme:"default"};static events=Le.events;static sources=Le.sources;static version="2.0.3";static imports={delta:Se,parchment:cd,"core/module":ra,"core/theme":Cs};static debug(a){a===!0&&(a="log"),ya.level(a)}static find(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Xn.get(a)||yl.find(a,e)}static import(a){return this.imports[a]==null&&gs.error(`Cannot import ${a}. Are you sure it was registered?`),this.imports[a]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const a=arguments.length<=0?void 0:arguments[0],e=!!(!(arguments.length<=1)&&arguments[1]),s="attrName"in a?a.attrName:a.blotName;typeof s=="string"?this.register(`formats/${s}`,a,e):Object.keys(a).forEach(l=>{this.register(l,a[l],e)})}else{const a=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],s=!!(!(arguments.length<=2)&&arguments[2]);this.imports[a]!=null&&!s&&gs.warn(`Overwriting ${a} with`,e),this.imports[a]=e,(a.startsWith("blots/")||a.startsWith("formats/"))&&e&&typeof e!="boolean"&&e.blotName!=="abstract"&&yl.register(e),typeof e.register=="function"&&e.register(yl)}}constructor(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=Vd(a,e),this.container=this.options.container,this.container==null){gs.error("Invalid Quill container",a);return}this.options.debug&&ue.debug(this.options.debug);const s=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Xn.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new Le;const l=mi.blotName,i=this.options.registry.query(l);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${l}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Sd(this.scroll),this.selection=new Ed(this.scroll,this.emitter),this.composition=new Pd(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(Le.events.EDITOR_CHANGE,o=>{o===Le.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(Le.events.SCROLL_UPDATE,(o,r)=>{const u=this.selection.lastRange,[d]=this.selection.getRange(),f=u&&d?{oldRange:u,newRange:d}:void 0;Gt.call(this,()=>this.editor.update(null,r,f),o)}),this.emitter.on(Le.events.SCROLL_EMBED_UPDATE,(o,r)=>{const u=this.selection.lastRange,[d]=this.selection.getRange(),f=u&&d?{oldRange:u,newRange:d}:void 0;Gt.call(this,()=>{const _=new Se().retain(o.offset(this)).retain({[o.statics.blotName]:r});return this.editor.update(_,[],f)},ue.sources.USER)}),s){const o=this.clipboard.convert({html:`${s}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof a=="string"){const s=a;a=document.createElement("div"),a.classList.add(s)}return this.container.insertBefore(a,e),a}blur(){this.selection.setRange(null)}deleteText(a,e,s){return[a,e,,s]=pa(a,e,s),Gt.call(this,()=>this.editor.deleteText(a,e),s,a,-1*e)}disable(){this.enable(!1)}editReadOnly(a){this.allowReadOnlyEdits=!0;const e=a();return this.allowReadOnlyEdits=!1,e}enable(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(a),this.container.classList.toggle("ql-disabled",!a)}focus(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),a.preventScroll||this.scrollSelectionIntoView()}format(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Le.sources.API;return Gt.call(this,()=>{const l=this.getSelection(!0);let i=new Se;if(l==null)return i;if(this.scroll.query(a,Ie.BLOCK))i=this.editor.formatLine(l.index,l.length,{[a]:e});else{if(l.length===0)return this.selection.format(a,e),i;i=this.editor.formatText(l.index,l.length,{[a]:e})}return this.setSelection(l,Le.sources.SILENT),i},s)}formatLine(a,e,s,l,i){let o;return[a,e,o,i]=pa(a,e,s,l,i),Gt.call(this,()=>this.editor.formatLine(a,e,o),i,a,0)}formatText(a,e,s,l,i){let o;return[a,e,o,i]=pa(a,e,s,l,i),Gt.call(this,()=>this.editor.formatText(a,e,o),i,a,0)}getBounds(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=null;if(typeof a=="number"?s=this.selection.getBounds(a,e):s=this.selection.getBounds(a.index,a.length),!s)return null;const l=this.container.getBoundingClientRect();return{bottom:s.bottom-l.top,height:s.height,left:s.left-l.left,right:s.right-l.left,top:s.top-l.top,width:s.width}}getContents(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-a;return[a,e]=pa(a,e),this.editor.getContents(a,e)}getFormat(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof a=="number"?this.editor.getFormat(a,e):this.editor.getFormat(a.index,a.length)}getIndex(a){return a.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(a){return this.scroll.leaf(a)}getLine(a){return this.scroll.line(a)}getLines(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof a!="number"?this.scroll.lines(a.index,a.length):this.scroll.lines(a,e)}getModule(a){return this.theme.modules[a]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof a=="number"&&(e=e??this.getLength()-a),[a,e]=pa(a,e),this.editor.getHTML(a,e)}getText(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof a=="number"&&(e=e??this.getLength()-a),[a,e]=pa(a,e),this.editor.getText(a,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(a,e,s){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ue.sources.API;return Gt.call(this,()=>this.editor.insertEmbed(a,e,s),l,a)}insertText(a,e,s,l,i){let o;return[a,,o,i]=pa(a,0,s,l,i),Gt.call(this,()=>this.editor.insertText(a,e,o),i,a,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(a,e,s){return[a,e,,s]=pa(a,e,s),Gt.call(this,()=>this.editor.removeFormat(a,e),s,a)}scrollRectIntoView(a){Dd(this.root,a)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const a=this.selection.lastRange,e=a&&this.selection.getBounds(a.index,a.length);e&&this.scrollRectIntoView(e)}setContents(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le.sources.API;return Gt.call(this,()=>{a=new Se(a);const s=this.getLength(),l=this.editor.deleteText(0,s),i=this.editor.insertContents(0,a),o=this.editor.deleteText(this.getLength()-1,1);return l.compose(i).compose(o)},e)}setSelection(a,e,s){a==null?this.selection.setRange(null,e||ue.sources.API):([a,e,,s]=pa(a,e,s),this.selection.setRange(new Ra(Math.max(0,a),e),s),s!==Le.sources.SILENT&&this.scrollSelectionIntoView())}setText(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le.sources.API;const s=new Se().insert(a);return this.setContents(s,e)}update(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Le.sources.USER;const e=this.scroll.update(a);return this.selection.update(a),e}updateContents(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le.sources.API;return Gt.call(this,()=>(a=new Se(a),this.editor.applyDelta(a)),e,!0)}}function Ji(n){return typeof n=="string"?document.querySelector(n):n}function Bn(n){return Object.entries(n??{}).reduce((a,e)=>{let[s,l]=e;return{...a,[s]:l===!0?{}:l}},{})}function Xi(n){return Object.fromEntries(Object.entries(n).filter(a=>a[1]!==void 0))}function Vd(n,a){const e=Ji(n);if(!e)throw new Error("Invalid Quill container");const l=!a.theme||a.theme===ue.DEFAULTS.theme?Cs:ue.import(`themes/${a.theme}`);if(!l)throw new Error(`Invalid theme ${a.theme}. Did you register it?`);const{modules:i,...o}=ue.DEFAULTS,{modules:r,...u}=l.DEFAULTS;let d=Bn(a.modules);d!=null&&d.toolbar&&d.toolbar.constructor!==Object&&(d={...d,toolbar:{container:d.toolbar}});const f=Sa({},Bn(i),Bn(r),d),_={...o,...Xi(u),...Xi(a)};let g=a.registry;return g?a.formats&&gs.warn('Ignoring "formats" option because "registry" is specified'):g=a.formats?Md(a.formats,_.registry,gs):_.registry,{..._,registry:g,container:e,theme:l,modules:Object.entries(f).reduce((C,O)=>{let[I,b]=O;if(!b)return C;const P=ue.import(`modules/${I}`);return P==null?(gs.error(`Cannot load ${I} module. Are you sure you registered it?`),C):{...C,[I]:Sa({},P.DEFAULTS||{},b)}},{}),bounds:Ji(_.bounds)}}function Gt(n,a,e,s){if(!this.isEnabled()&&a===Le.sources.USER&&!this.allowReadOnlyEdits)return new Se;let l=e==null?null:this.getSelection();const i=this.editor.delta,o=n();if(l!=null&&(e===!0&&(e=l.index),s==null?l=Qi(l,o,a):s!==0&&(l=Qi(l,e,s,a)),this.setSelection(l,Le.sources.SILENT)),o.length()>0){const r=[Le.events.TEXT_CHANGE,o,i,a];this.emitter.emit(Le.events.EDITOR_CHANGE,...r),a!==Le.sources.SILENT&&this.emitter.emit(...r)}return o}function pa(n,a,e,s,l){let i={};return typeof n.index=="number"&&typeof n.length=="number"?typeof a!="number"?(l=s,s=e,e=a,a=n.length,n=n.index):(a=n.length,n=n.index):typeof a!="number"&&(l=s,s=e,e=a,a=0),typeof e=="object"?(i=e,l=s):typeof e=="string"&&(s!=null?i[e]=s:l=e),l=l||Le.sources.API,[n,a,i,l]}function Qi(n,a,e,s){const l=typeof e=="number"?e:0;if(n==null)return null;let i,o;return a&&typeof a.transformPosition=="function"?[i,o]=[n.index,n.index+n.length].map(r=>a.transformPosition(r,s!==Le.sources.USER)):[i,o]=[n.index,n.index+n.length].map(r=>r<a||r===a&&s===Le.sources.USER?r:l>=0?r+l:Math.max(a,r+l)),new Ra(i,o-i)}class Ya extends Rl{}function Ki(n){return n instanceof vt||n instanceof Ut}function eo(n){return typeof n.updateContent=="function"}class Bd extends mi{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=vt;static allowedChildren=[vt,Ut,Ya];constructor(a,e,s){let{emitter:l}=s;super(a,e),this.emitter=l,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const a=this.batch;this.batch=!1,this.update(a)}emitMount(a){this.emitter.emit(Le.events.SCROLL_BLOT_MOUNT,a)}emitUnmount(a){this.emitter.emit(Le.events.SCROLL_BLOT_UNMOUNT,a)}emitEmbedUpdate(a,e){this.emitter.emit(Le.events.SCROLL_EMBED_UPDATE,a,e)}deleteAt(a,e){const[s,l]=this.line(a),[i]=this.line(a+e);if(super.deleteAt(a,e),i!=null&&s!==i&&l>0){if(s instanceof Ut||i instanceof Ut){this.optimize();return}const o=i.children.head instanceof ta?null:i.children.head;s.moveChildren(i,o),s.remove()}this.optimize()}enable(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",a?"true":"false")}formatAt(a,e,s,l){super.formatAt(a,e,s,l),this.optimize()}insertAt(a,e,s){if(a>=this.length())if(s==null||this.scroll.query(e,Ie.BLOCK)==null){const l=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(l),s==null&&e.endsWith(`
`)?l.insertAt(0,e.slice(0,-1),s):l.insertAt(0,e,s)}else{const l=this.scroll.create(e,s);this.appendChild(l)}else super.insertAt(a,e,s);this.optimize()}insertBefore(a,e){if(a.statics.scope===Ie.INLINE_BLOT){const s=this.scroll.create(this.statics.defaultChild.blotName);s.appendChild(a),super.insertBefore(s,e)}else super.insertBefore(a,e)}insertContents(a,e){const s=this.deltaToRenderBlocks(e.concat(new Se().insert(`
`))),l=s.pop();if(l==null)return;this.batchStart();const i=s.shift();if(i){const u=i.type==="block"&&(i.delta.length()===0||!this.descendant(Ut,a)[0]&&a<this.length()),d=i.type==="block"?i.delta:new Se().insert({[i.key]:i.value});Rn(this,a,d);const f=i.type==="block"?1:0,_=a+d.length()+f;u&&this.insertAt(_-1,`
`);const g=Rt(this.line(a)[0]),C=$t.exports.AttributeMap.diff(g,i.attributes)||{};Object.keys(C).forEach(O=>{this.formatAt(_-1,1,O,C[O])}),a=_}let[o,r]=this.children.find(a);if(s.length&&(o&&(o=o.split(r),r=0),s.forEach(u=>{if(u.type==="block"){const d=this.createBlock(u.attributes,o||void 0);Rn(d,0,u.delta)}else{const d=this.create(u.key,u.value);this.insertBefore(d,o||void 0),Object.keys(u.attributes).forEach(f=>{d.format(f,u.attributes[f])})}})),l.type==="block"&&l.delta.length()){const u=o?o.offset(o.scroll)+r:this.length();Rn(this,u,l.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(a){const e=this.path(a).pop();if(!e)return[null,-1];const[s,l]=e;return s instanceof xt?[s,l]:[null,-1]}line(a){return a===this.length()?this.line(a-1):this.descendant(Ki,a)}lines(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const s=(l,i,o)=>{let r=[],u=o;return l.children.forEachAt(i,o,(d,f,_)=>{Ki(d)?r.push(d):d instanceof Rl&&(r=r.concat(s(d,f,u))),u-=_}),r};return s(this,a,e)}optimize(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(a,e),a.length>0&&this.emitter.emit(Le.events.SCROLL_OPTIMIZE,a,e))}path(a){return super.path(a).slice(1)}remove(){}update(a){if(this.batch){Array.isArray(a)&&(this.batch=this.batch.concat(a));return}let e=Le.sources.USER;typeof a=="string"&&(e=a),Array.isArray(a)||(a=this.observer.takeRecords()),a=a.filter(s=>{let{target:l}=s;const i=this.find(l,!0);return i&&!eo(i)}),a.length>0&&this.emitter.emit(Le.events.SCROLL_BEFORE_UPDATE,e,a),super.update(a.concat([])),a.length>0&&this.emitter.emit(Le.events.SCROLL_UPDATE,e,a)}updateEmbedAt(a,e,s){const[l]=this.descendant(i=>i instanceof Ut,a);l&&l.statics.blotName===e&&eo(l)&&l.updateContent(s)}handleDragStart(a){a.preventDefault()}deltaToRenderBlocks(a){const e=[];let s=new Se;return a.forEach(l=>{const i=l?.insert;if(!!i)if(typeof i=="string"){const o=i.split(`
`);o.slice(0,-1).forEach(u=>{s.insert(u,l.attributes),e.push({type:"block",delta:s,attributes:l.attributes??{}}),s=new Se});const r=o[o.length-1];r&&s.insert(r,l.attributes)}else{const o=Object.keys(i)[0];if(!o)return;this.query(o,Ie.INLINE)?s.push(l):(s.length()&&e.push({type:"block",delta:s,attributes:{}}),s=new Se,e.push({type:"blockEmbed",key:o,value:i[o],attributes:l.attributes??{}}))}}),s.length()&&e.push({type:"block",delta:s,attributes:{}}),e}createBlock(a,e){let s;const l={};Object.entries(a).forEach(r=>{let[u,d]=r;this.query(u,Ie.BLOCK&Ie.BLOT)!=null?s=u:l[u]=d});const i=this.create(s||this.statics.defaultChild.blotName,s?a[s]:void 0);this.insertBefore(i,e||void 0);const o=i.length();return Object.entries(l).forEach(r=>{let[u,d]=r;i.formatAt(0,o,u,d)}),i}}function Rn(n,a,e){e.reduce((s,l)=>{const i=$t.exports.Op.length(l);let o=l.attributes||{};if(l.insert!=null){if(typeof l.insert=="string"){const r=l.insert;n.insertAt(s,r);const[u]=n.descendant(xt,s),d=Rt(u);o=$t.exports.AttributeMap.diff(d,o)||{}}else if(typeof l.insert=="object"){const r=Object.keys(l.insert)[0];if(r==null)return s;if(n.insertAt(s,r,l.insert[r]),n.scroll.query(r,Ie.INLINE)!=null){const[d]=n.descendant(xt,s),f=Rt(d);o=$t.exports.AttributeMap.diff(f,o)||{}}}}return Object.keys(o).forEach(r=>{n.formatAt(s,i,r,o[r])}),s+i},a)}const _i={scope:Ie.BLOCK,whitelist:["right","center","justify"]},Rd=new oa("align","align",_i),Yo=new ea("align","ql-align",_i),Wo=new $a("align","text-align",_i);class Ho extends $a{value(a){let e=super.value(a);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map(l=>`00${parseInt(l,10).toString(16)}`.slice(-2)).join("")}`):e}}const qd=new ea("color","ql-color",{scope:Ie.INLINE}),yi=new Ho("color","color",{scope:Ie.INLINE}),Ud=new ea("background","ql-bg",{scope:Ie.INLINE}),bi=new Ho("background","background-color",{scope:Ie.INLINE});class Wa extends Ya{static create(a){const e=super.create(a);return e.setAttribute("spellcheck","false"),e}code(a,e){return this.children.map(s=>s.length()<=1?"":s.domNode.innerText).join(`
`).slice(a,a+e)}html(a,e){return`<pre>
${jl(this.code(a,e))}
</pre>`}}class At extends vt{static TAB="  ";static register(){ue.register(Wa)}}class ki extends Et{}ki.blotName="code";ki.tagName="CODE";At.blotName="code-block";At.className="ql-code-block";At.tagName="DIV";Wa.blotName="code-block-container";Wa.className="ql-code-block-container";Wa.tagName="DIV";Wa.allowedChildren=[At];At.allowedChildren=[Kt,ta,Jt];At.requiredContainer=Wa;const Ci={scope:Ie.BLOCK,whitelist:["rtl"]},Zo=new oa("direction","dir",Ci),Go=new ea("direction","ql-direction",Ci),Jo=new $a("direction","direction",Ci),Xo={scope:Ie.INLINE,whitelist:["serif","monospace"]},Qo=new ea("font","ql-font",Xo);class zd extends $a{value(a){return super.value(a).replace(/["']/g,"")}}const Ko=new zd("font","font-family",Xo),er=new ea("size","ql-size",{scope:Ie.INLINE,whitelist:["small","large","huge"]}),tr=new $a("size","font-size",{scope:Ie.INLINE,whitelist:["10px","18px","32px"]}),jd=ya("quill:keyboard"),Yd=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Yl extends ra{static match(a,e){return["altKey","ctrlKey","metaKey","shiftKey"].some(s=>!!e[s]!==a[s]&&e[s]!==null)?!1:e.key===a.key||e.key===a.which}constructor(a,e){super(a,e),this.bindings={},Object.keys(this.options.bindings).forEach(s=>{this.options.bindings[s]&&this.addBinding(this.options.bindings[s])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const l=Hd(a);if(l==null){jd.warn("Attempted to add invalid keyboard binding",l);return}typeof e=="function"&&(e={handler:e}),typeof s=="function"&&(s={handler:s}),(Array.isArray(l.key)?l.key:[l.key]).forEach(o=>{const r={...l,key:o,...e,...s};this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)})}listen(){this.quill.root.addEventListener("keydown",a=>{if(a.defaultPrevented||a.isComposing||a.keyCode===229&&(a.key==="Enter"||a.key==="Backspace"))return;const l=(this.bindings[a.key]||[]).concat(this.bindings[a.which]||[]).filter(P=>Yl.match(a,P));if(l.length===0)return;const i=ue.find(a.target,!0);if(i&&i.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[r,u]=this.quill.getLine(o.index),[d,f]=this.quill.getLeaf(o.index),[_,g]=o.length===0?[d,f]:this.quill.getLeaf(o.index+o.length),C=d instanceof Al?d.value().slice(0,f):"",O=_ instanceof Al?_.value().slice(g):"",I={collapsed:o.length===0,empty:o.length===0&&r.length()<=1,format:this.quill.getFormat(o),line:r,offset:u,prefix:C,suffix:O,event:a};l.some(P=>{if(P.collapsed!=null&&P.collapsed!==I.collapsed||P.empty!=null&&P.empty!==I.empty||P.offset!=null&&P.offset!==I.offset)return!1;if(Array.isArray(P.format)){if(P.format.every(L=>I.format[L]==null))return!1}else if(typeof P.format=="object"&&!Object.keys(P.format).every(L=>P.format[L]===!0?I.format[L]!=null:P.format[L]===!1?I.format[L]==null:oi(P.format[L],I.format[L])))return!1;return P.prefix!=null&&!P.prefix.test(I.prefix)||P.suffix!=null&&!P.suffix.test(I.suffix)?!1:P.handler.call(this,o,I,P)!==!0})&&a.preventDefault()})}handleBackspace(a,e){const s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(a.index===0||this.quill.getLength()<=1)return;let l={};const[i]=this.quill.getLine(a.index);let o=new Se().retain(a.index-s).delete(s);if(e.offset===0){const[r]=this.quill.getLine(a.index-1);if(r&&!(r.statics.blotName==="block"&&r.length()<=1)){const d=i.formats(),f=this.quill.getFormat(a.index-1,1);if(l=$t.exports.AttributeMap.diff(d,f)||{},Object.keys(l).length>0){const _=new Se().retain(a.index+i.length()-2).retain(1,l);o=o.compose(_)}}}this.quill.updateContents(o,ue.sources.USER),this.quill.focus()}handleDelete(a,e){const s=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(a.index>=this.quill.getLength()-s)return;let l={};const[i]=this.quill.getLine(a.index);let o=new Se().retain(a.index).delete(s);if(e.offset>=i.length()-1){const[r]=this.quill.getLine(a.index+1);if(r){const u=i.formats(),d=this.quill.getFormat(a.index,1);l=$t.exports.AttributeMap.diff(u,d)||{},Object.keys(l).length>0&&(o=o.retain(r.length()-1).retain(1,l))}}this.quill.updateContents(o,ue.sources.USER),this.quill.focus()}handleDeleteRange(a){xi({range:a,quill:this.quill}),this.quill.focus()}handleEnter(a,e){const s=Object.keys(e.format).reduce((i,o)=>(this.quill.scroll.query(o,Ie.BLOCK)&&!Array.isArray(e.format[o])&&(i[o]=e.format[o]),i),{}),l=new Se().retain(a.index).delete(a.length).insert(`
`,s);this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(a.index+1,ue.sources.SILENT),this.quill.focus()}}const Wd={bindings:{bold:qn("bold"),italic:qn("italic"),underline:qn("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,a){return a.collapsed&&a.offset!==0?!0:(this.quill.format("indent","+1",ue.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,a){return a.collapsed&&a.offset!==0?!0:(this.quill.format("indent","-1",ue.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,a){a.format.indent!=null?this.quill.format("indent","-1",ue.sources.USER):a.format.list!=null&&this.quill.format("list",!1,ue.sources.USER)}},"indent code-block":to(!0),"outdent code-block":to(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,ue.sources.USER)}},tab:{key:"Tab",handler(n,a){if(a.format.table)return!0;this.quill.history.cutoff();const e=new Se().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(e,ue.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,ue.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,ue.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,a){const e={list:!1};a.format.indent&&(e.indent=!1),this.quill.formatLine(n.index,n.length,e,ue.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[a,e]=this.quill.getLine(n.index),s={...a.formats(),list:"checked"},l=new Se().retain(n.index).insert(`
`,s).retain(a.length()-e-1).retain(1,{list:"unchecked"});this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(n.index+1,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,a){const[e,s]=this.quill.getLine(n.index),l=new Se().retain(n.index).insert(`
`,a.format).retain(e.length()-s-1).retain(1,{header:null});this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(n.index+1,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const a=this.quill.getModule("table");if(a){const[e,s,l,i]=a.getTable(n),o=Zd(e,s,l,i);if(o==null)return;let r=e.offset();if(o<0){const u=new Se().retain(r).insert(`
`);this.quill.updateContents(u,ue.sources.USER),this.quill.setSelection(n.index+1,n.length,ue.sources.SILENT)}else if(o>0){r+=e.length();const u=new Se().retain(r).insert(`
`);this.quill.updateContents(u,ue.sources.USER),this.quill.setSelection(r,ue.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,a){const{event:e,line:s}=a,l=s.offset(this.quill.scroll);e.shiftKey?this.quill.setSelection(l-1,ue.sources.USER):this.quill.setSelection(l+s.length(),ue.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,a){if(this.quill.scroll.query("list")==null)return!0;const{length:e}=a.prefix,[s,l]=this.quill.getLine(n.index);if(l>e)return!0;let i;switch(a.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(n.index," ",ue.sources.USER),this.quill.history.cutoff();const o=new Se().retain(n.index-l).delete(e+1).retain(s.length()-2-l).retain(1,{list:i});return this.quill.updateContents(o,ue.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-e,ue.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[a,e]=this.quill.getLine(n.index);let s=2,l=a;for(;l!=null&&l.length()<=1&&l.formats()["code-block"];)if(l=l.prev,s-=1,s<=0){const i=new Se().retain(n.index+a.length()-e-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,ue.sources.USER),this.quill.setSelection(n.index-1,ue.sources.SILENT),!1}return!0}},"embed left":bl("ArrowLeft",!1),"embed left shift":bl("ArrowLeft",!0),"embed right":bl("ArrowRight",!1),"embed right shift":bl("ArrowRight",!0),"table down":ao(!1),"table up":ao(!0)}};Yl.DEFAULTS=Wd;function to(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(a,e){let{event:s}=e;const l=this.quill.scroll.query("code-block"),{TAB:i}=l;if(a.length===0&&!s.shiftKey){this.quill.insertText(a.index,i,ue.sources.USER),this.quill.setSelection(a.index+i.length,ue.sources.SILENT);return}const o=a.length===0?this.quill.getLines(a.index,1):this.quill.getLines(a);let{index:r,length:u}=a;o.forEach((d,f)=>{n?(d.insertAt(0,i),f===0?r+=i.length:u+=i.length):d.domNode.textContent.startsWith(i)&&(d.deleteAt(0,i.length),f===0?r-=i.length:u-=i.length)}),this.quill.update(ue.sources.USER),this.quill.setSelection(r,u,ue.sources.SILENT)}}}function bl(n,a){return{key:n,shiftKey:a,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(s){let{index:l}=s;n==="ArrowRight"&&(l+=s.length+1);const[i]=this.quill.getLeaf(l);return i instanceof Ft?(n==="ArrowLeft"?a?this.quill.setSelection(s.index-1,s.length+1,ue.sources.USER):this.quill.setSelection(s.index-1,ue.sources.USER):a?this.quill.setSelection(s.index,s.length+1,ue.sources.USER):this.quill.setSelection(s.index+s.length+1,ue.sources.USER),!1):!0}}}function qn(n){return{key:n[0],shortKey:!0,handler(a,e){this.quill.format(n,!e.format[n],ue.sources.USER)}}}function ao(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(a,e){const s=n?"prev":"next",l=e.line,i=l.parent[s];if(i!=null){if(i.statics.blotName==="table-row"){let o=i.children.head,r=l;for(;r.prev!=null;)r=r.prev,o=o.next;const u=o.offset(this.quill.scroll)+Math.min(e.offset,o.length()-1);this.quill.setSelection(u,0,ue.sources.USER)}}else{const o=l.table()[s];o!=null&&(n?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,ue.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,ue.sources.USER))}return!1}}}function Hd(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=ms(n);else return null;return n.shortKey&&(n[Yd]=n.shortKey,delete n.shortKey),n}function xi(n){let{quill:a,range:e}=n;const s=a.getLines(e);let l={};if(s.length>1){const i=s[0].formats(),o=s[s.length-1].formats();l=$t.exports.AttributeMap.diff(o,i)||{}}a.deleteText(e,ue.sources.USER),Object.keys(l).length>0&&a.formatLine(e.index,1,l,ue.sources.USER),a.setSelection(e.index,ue.sources.SILENT)}function Zd(n,a,e,s){return a.prev==null&&a.next==null?e.prev==null&&e.next==null?s===0?-1:1:e.prev==null?-1:1:a.prev==null?-1:a.next==null?1:null}const Gd=/font-weight:\s*normal/,Jd=["P","OL","UL"],so=n=>n&&Jd.includes(n.tagName),Xd=n=>{Array.from(n.querySelectorAll("br")).filter(a=>so(a.previousElementSibling)&&so(a.nextElementSibling)).forEach(a=>{a.parentNode?.removeChild(a)})},Qd=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(a=>a.getAttribute("style")?.match(Gd)).forEach(a=>{const e=n.createDocumentFragment();e.append(...a.childNodes),a.parentNode?.replaceChild(e,a)})};function Kd(n){n.querySelector('[id^="docs-internal-guid-"]')&&(Qd(n),Xd(n))}const em=/\bmso-list:[^;]*ignore/i,tm=/\bmso-list:[^;]*\bl(\d+)/i,am=/\bmso-list:[^;]*\blevel(\d+)/i,sm=(n,a)=>{const e=n.getAttribute("style"),s=e?.match(tm);if(!s)return null;const l=Number(s[1]),i=e?.match(am),o=i?Number(i[1]):1,r=new RegExp(`@list l${l}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),u=a.match(r),d=u&&u[1]==="bullet"?"bullet":"ordered";return{id:l,indent:o,type:d,element:n}},lm=n=>{const a=Array.from(n.querySelectorAll("[style*=mso-list]")),e=[],s=[];a.forEach(o=>{(o.getAttribute("style")||"").match(em)?e.push(o):s.push(o)}),e.forEach(o=>o.parentNode?.removeChild(o));const l=n.documentElement.innerHTML,i=s.map(o=>sm(o,l)).filter(o=>o);for(;i.length;){const o=[];let r=i.shift();for(;r;)o.push(r),r=i.length&&i[0]?.element===r.element.nextElementSibling&&i[0].id===r.id?i.shift():null;const u=document.createElement("ul");o.forEach(_=>{const g=document.createElement("li");g.setAttribute("data-list",_.type),_.indent>1&&g.setAttribute("class",`ql-indent-${_.indent-1}`),g.innerHTML=_.element.innerHTML,u.appendChild(g)});const d=o[0]?.element,{parentNode:f}=d??{};d&&f?.replaceChild(u,d),o.slice(1).forEach(_=>{let{element:g}=_;f?.removeChild(g)})}};function nm(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&lm(n)}const im=[nm,Kd],om=n=>{n.documentElement&&im.forEach(a=>{a(n)})},rm=ya("quill:clipboard"),cm=[[Node.TEXT_NODE,Cm],[Node.TEXT_NODE,no],["br",fm],[Node.ELEMENT_NODE,no],[Node.ELEMENT_NODE,gm],[Node.ELEMENT_NODE,pm],[Node.ELEMENT_NODE,bm],["li",_m],["ol, ul",ym],["pre",hm],["tr",km],["b",Un("bold")],["i",Un("italic")],["strike",Un("strike")],["style",vm]],um=[Rd,Zo].reduce((n,a)=>(n[a.keyName]=a,n),{}),lo=[Wo,bi,yi,Jo,Ko,tr].reduce((n,a)=>(n[a.keyName]=a,n),{});class dm extends ra{static DEFAULTS={matchers:[]};constructor(a,e){super(a,e),this.quill.root.addEventListener("copy",s=>this.onCaptureCopy(s,!1)),this.quill.root.addEventListener("cut",s=>this.onCaptureCopy(s,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],cm.concat(this.options.matchers??[]).forEach(s=>{let[l,i]=s;this.addMatcher(l,i)})}addMatcher(a,e){this.matchers.push([a,e])}convert(a){let{html:e,text:s}=a,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(l[At.blotName])return new Se().insert(s||"",{[At.blotName]:l[At.blotName]});if(!e)return new Se().insert(s||"",l);const i=this.convertHTML(e);return Xs(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||l.table)?i.compose(new Se().retain(i.length()-1).delete(1)):i}normalizeHTML(a){om(a)}convertHTML(a){const e=new DOMParser().parseFromString(a,"text/html");this.normalizeHTML(e);const s=e.body,l=new WeakMap,[i,o]=this.prepareMatching(s,l);return wi(this.quill.scroll,s,i,o,l)}dangerouslyPasteHTML(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ue.sources.API;if(typeof a=="string"){const l=this.convert({html:a,text:""});this.quill.setContents(l,e),this.quill.setSelection(0,ue.sources.SILENT)}else{const l=this.convert({html:e,text:""});this.quill.updateContents(new Se().retain(a).concat(l),s),this.quill.setSelection(a+l.length(),ue.sources.SILENT)}}onCaptureCopy(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.defaultPrevented)return;a.preventDefault();const[s]=this.quill.selection.getRange();if(s==null)return;const{html:l,text:i}=this.onCopy(s,e);a.clipboardData?.setData("text/plain",i),a.clipboardData?.setData("text/html",l),e&&xi({range:s,quill:this.quill})}normalizeURIList(a){return a.split(/\r?\n/).filter(e=>e[0]!=="#").join(`
`)}onCapturePaste(a){if(a.defaultPrevented||!this.quill.isEnabled())return;a.preventDefault();const e=this.quill.getSelection(!0);if(e==null)return;const s=a.clipboardData?.getData("text/html");let l=a.clipboardData?.getData("text/plain");if(!s&&!l){const o=a.clipboardData?.getData("text/uri-list");o&&(l=this.normalizeURIList(o))}const i=Array.from(a.clipboardData?.files||[]);if(!s&&i.length>0){this.quill.uploader.upload(e,i);return}if(s&&i.length>0){const o=new DOMParser().parseFromString(s,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(e,i);return}}this.onPaste(e,{html:s,text:l})}onCopy(a){const e=this.quill.getText(a);return{html:this.quill.getSemanticHTML(a),text:e}}onPaste(a,e){let{text:s,html:l}=e;const i=this.quill.getFormat(a.index),o=this.convert({text:s,html:l},i);rm.log("onPaste",o,{text:s,html:l});const r=new Se().retain(a.index).delete(a.length).concat(o);this.quill.updateContents(r,ue.sources.USER),this.quill.setSelection(r.length()-a.length,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(a,e){const s=[],l=[];return this.matchers.forEach(i=>{const[o,r]=i;switch(o){case Node.TEXT_NODE:l.push(r);break;case Node.ELEMENT_NODE:s.push(r);break;default:Array.from(a.querySelectorAll(o)).forEach(u=>{e.has(u)?e.get(u)?.push(r):e.set(u,[r])});break}}),[s,l]}}function Ha(n,a,e,s){return s.query(a)?n.reduce((l,i)=>{if(!i.insert)return l;if(i.attributes&&i.attributes[a])return l.push(i);const o=e?{[a]:e}:{};return l.insert(i.insert,{...o,...i.attributes})},new Se):n}function Xs(n,a){let e="";for(let s=n.ops.length-1;s>=0&&e.length<a.length;--s){const l=n.ops[s];if(typeof l.insert!="string")break;e=l.insert+e}return e.slice(-1*a.length)===a}function Ea(n,a){if(!(n instanceof Element))return!1;const e=a.query(n);return e&&e.prototype instanceof Ft?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function mm(n,a){return n.previousElementSibling&&n.nextElementSibling&&!Ea(n.previousElementSibling,a)&&!Ea(n.nextElementSibling,a)}const kl=new WeakMap;function ar(n){return n==null?!1:(kl.has(n)||(n.tagName==="PRE"?kl.set(n,!0):kl.set(n,ar(n.parentNode))),kl.get(n))}function wi(n,a,e,s,l){return a.nodeType===a.TEXT_NODE?s.reduce((i,o)=>o(a,i,n),new Se):a.nodeType===a.ELEMENT_NODE?Array.from(a.childNodes||[]).reduce((i,o)=>{let r=wi(n,o,e,s,l);return o.nodeType===a.ELEMENT_NODE&&(r=e.reduce((u,d)=>d(o,u,n),r),r=(l.get(o)||[]).reduce((u,d)=>d(o,u,n),r)),i.concat(r)},new Se):new Se}function Un(n){return(a,e,s)=>Ha(e,n,!0,s)}function pm(n,a,e){const s=oa.keys(n),l=ea.keys(n),i=$a.keys(n),o={};return s.concat(l).concat(i).forEach(r=>{let u=e.query(r,Ie.ATTRIBUTE);u!=null&&(o[u.attrName]=u.value(n),o[u.attrName])||(u=um[r],u!=null&&(u.attrName===r||u.keyName===r)&&(o[u.attrName]=u.value(n)||void 0),u=lo[r],u!=null&&(u.attrName===r||u.keyName===r)&&(u=lo[r],o[u.attrName]=u.value(n)||void 0))}),Object.entries(o).reduce((r,u)=>{let[d,f]=u;return Ha(r,d,f,e)},a)}function gm(n,a,e){const s=e.query(n);if(s==null)return a;if(s.prototype instanceof Ft){const l={},i=s.value(n);if(i!=null)return l[s.blotName]=i,new Se().insert(l,s.formats(n,e))}else if(s.prototype instanceof zs&&!Xs(a,`
`)&&a.insert(`
`),"blotName"in s&&"formats"in s&&typeof s.formats=="function")return Ha(a,s.blotName,s.formats(n,e),e);return a}function fm(n,a){return Xs(a,`
`)||a.insert(`
`),a}function hm(n,a,e){const s=e.query("code-block"),l=s&&"formats"in s&&typeof s.formats=="function"?s.formats(n,e):!0;return Ha(a,"code-block",l,e)}function vm(){return new Se}function _m(n,a,e){const s=e.query(n);if(s==null||s.blotName!=="list"||!Xs(a,`
`))return a;let l=-1,i=n.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(l+=1),i=i.parentNode;return l<=0?a:a.reduce((o,r)=>r.insert?r.attributes&&typeof r.attributes.indent=="number"?o.push(r):o.insert(r.insert,{indent:l,...r.attributes||{}}):o,new Se)}function ym(n,a,e){const s=n;let l=s.tagName==="OL"?"ordered":"bullet";const i=s.getAttribute("data-checked");return i&&(l=i==="true"?"checked":"unchecked"),Ha(a,"list",l,e)}function no(n,a,e){if(!Xs(a,`
`)){if(Ea(n,e)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return a.insert(`
`);if(a.length()>0&&n.nextSibling){let s=n.nextSibling;for(;s!=null;){if(Ea(s,e))return a.insert(`
`);const l=e.query(s);if(l&&l.prototype instanceof Ut)return a.insert(`
`);s=s.firstChild}}}return a}function bm(n,a,e){const s={},l=n.style||{};return l.fontStyle==="italic"&&(s.italic=!0),l.textDecoration==="underline"&&(s.underline=!0),l.textDecoration==="line-through"&&(s.strike=!0),(l.fontWeight?.startsWith("bold")||parseInt(l.fontWeight,10)>=700)&&(s.bold=!0),a=Object.entries(s).reduce((i,o)=>{let[r,u]=o;return Ha(i,r,u,e)},a),parseFloat(l.textIndent||0)>0?new Se().insert("	").concat(a):a}function km(n,a,e){const s=n.parentElement?.tagName==="TABLE"?n.parentElement:n.parentElement?.parentElement;if(s!=null){const i=Array.from(s.querySelectorAll("tr")).indexOf(n)+1;return Ha(a,"table",i,e)}return a}function Cm(n,a,e){let s=n.data;if(n.parentElement?.tagName==="O:P")return a.insert(s.trim());if(!ar(n)){if(s.trim().length===0&&s.includes(`
`)&&!mm(n,e))return a;s=s.replace(/[^\S\u00a0]/g," "),s=s.replace(/ {2,}/g," "),(n.previousSibling==null&&n.parentElement!=null&&Ea(n.parentElement,e)||n.previousSibling instanceof Element&&Ea(n.previousSibling,e))&&(s=s.replace(/^ /,"")),(n.nextSibling==null&&n.parentElement!=null&&Ea(n.parentElement,e)||n.nextSibling instanceof Element&&Ea(n.nextSibling,e))&&(s=s.replace(/ $/,"")),s=s.replaceAll("\xA0"," ")}return a.insert(s)}class xm extends ra{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(a,e){super(a,e),this.quill.on(ue.events.EDITOR_CHANGE,(s,l,i,o)=>{s===ue.events.SELECTION_CHANGE?l&&o!==ue.sources.SILENT&&(this.currentRange=l):s===ue.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===ue.sources.USER?this.record(l,i):this.transform(l)),this.currentRange=ei(this.currentRange,l))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",s=>{s.inputType==="historyUndo"?(this.undo(),s.preventDefault()):s.inputType==="historyRedo"&&(this.redo(),s.preventDefault())})}change(a,e){if(this.stack[a].length===0)return;const s=this.stack[a].pop();if(!s)return;const l=this.quill.getContents(),i=s.delta.invert(l);this.stack[e].push({delta:i,range:ei(s.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(s.delta,ue.sources.USER),this.ignoreChange=!1,this.restoreSelection(s)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(a,e){if(a.ops.length===0)return;this.stack.redo=[];let s=a.invert(e),l=this.currentRange;const i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(s=s.compose(o.delta),l=o.range)}else this.lastRecorded=i;s.length()!==0&&(this.stack.undo.push({delta:s,range:l}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(a){io(this.stack.undo,a),io(this.stack.redo,a)}undo(){this.change("undo","redo")}restoreSelection(a){if(a.range)this.quill.setSelection(a.range,ue.sources.USER);else{const e=Tm(this.quill.scroll,a.delta);this.quill.setSelection(e,ue.sources.USER)}}}function io(n,a){let e=a;for(let s=n.length-1;s>=0;s-=1){const l=n[s];n[s]={delta:e.transform(l.delta,!0),range:l.range&&ei(l.range,e)},e=l.delta.transform(e),n[s].delta.length()===0&&n.splice(s,1)}}function wm(n,a){const e=a.ops[a.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(s=>n.query(s,Ie.BLOCK)!=null):!1}function Tm(n,a){const e=a.reduce((l,i)=>l+(i.delete||0),0);let s=a.length()-e;return wm(n,a)&&(s-=1),s}function ei(n,a){if(!n)return n;const e=a.transformPosition(n.index),s=a.transformPosition(n.index+n.length);return{index:e,length:s-e}}class sr extends ra{constructor(a,e){super(a,e),a.root.addEventListener("drop",s=>{s.preventDefault();let l=null;if(document.caretRangeFromPoint)l=document.caretRangeFromPoint(s.clientX,s.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(s.clientX,s.clientY);l=document.createRange(),l.setStart(o.offsetNode,o.offset),l.setEnd(o.offsetNode,o.offset)}const i=l&&a.selection.normalizeNative(l);if(i){const o=a.selection.normalizedToRange(i);s.dataTransfer?.files&&this.upload(o,s.dataTransfer.files)}})}upload(a,e){const s=[];Array.from(e).forEach(l=>{l&&this.options.mimetypes?.includes(l.type)&&s.push(l)}),s.length>0&&this.options.handler.call(this,a,s)}}sr.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,a){if(!this.quill.scroll.query("image"))return;const e=a.map(s=>new Promise(l=>{const i=new FileReader;i.onload=()=>{l(i.result)},i.readAsDataURL(s)}));Promise.all(e).then(s=>{const l=s.reduce((i,o)=>i.insert({image:o}),new Se().retain(n.index).delete(n.length));this.quill.updateContents(l,Le.sources.USER),this.quill.setSelection(n.index+s.length,Le.sources.SILENT)})}};const Em=["insertText","insertReplacementText"];class Lm extends ra{constructor(a,e){super(a,e),a.root.addEventListener("beforeinput",s=>{this.handleBeforeInput(s)}),/Android/i.test(navigator.userAgent)||a.on(ue.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(a){xi({range:a,quill:this.quill})}replaceText(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(a.length===0)return!1;if(e){const s=this.quill.getFormat(a.index,1);this.deleteRange(a),this.quill.updateContents(new Se().retain(a.index).insert(e,s),ue.sources.USER)}else this.deleteRange(a);return this.quill.setSelection(a.index+e.length,0,ue.sources.SILENT),!0}handleBeforeInput(a){if(this.quill.composition.isComposing||a.defaultPrevented||!Em.includes(a.inputType))return;const e=a.getTargetRanges?a.getTargetRanges()[0]:null;if(!e||e.collapsed===!0)return;const s=Sm(a);if(s==null)return;const l=this.quill.selection.normalizeNative(e),i=l?this.quill.selection.normalizedToRange(l):null;i&&this.replaceText(i,s)&&a.preventDefault()}handleCompositionStart(){const a=this.quill.getSelection();a&&this.replaceText(a)}}function Sm(n){return typeof n.data=="string"?n.data:n.dataTransfer?.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const Am=/Mac/i.test(navigator.platform),Im=100,Pm=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||Am&&n.key==="a"&&n.ctrlKey===!0);class $m extends ra{isListening=!1;selectionChangeDeadline=0;constructor(a,e){super(a,e),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(a,e){let{line:s,event:l}=e;if(!(s instanceof Qt)||!s.uiNode)return!0;const i=getComputedStyle(s.domNode).direction==="rtl";return i&&l.key!=="ArrowRight"||!i&&l.key!=="ArrowLeft"?!0:(this.quill.setSelection(a.index-1,a.length+(l.shiftKey?1:0),ue.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",a=>{!a.defaultPrevented&&Pm(a)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+Im,this.isListening)return;this.isListening=!0;const a=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",a,{once:!0})}handleSelectionChange(){const a=document.getSelection();if(!a)return;const e=a.getRangeAt(0);if(e.collapsed!==!0||e.startOffset!==0)return;const s=this.quill.scroll.find(e.startContainer);if(!(s instanceof Qt)||!s.uiNode)return;const l=document.createRange();l.setStartAfter(s.uiNode),l.setEndAfter(s.uiNode),a.removeAllRanges(),a.addRange(l)}}ue.register({"blots/block":vt,"blots/block/embed":Ut,"blots/break":ta,"blots/container":Ya,"blots/cursor":Jt,"blots/embed":vi,"blots/inline":Et,"blots/scroll":Bd,"blots/text":Kt,"modules/clipboard":dm,"modules/history":xm,"modules/keyboard":Yl,"modules/uploader":sr,"modules/input":Lm,"modules/uiNode":$m});class Nm extends ea{add(a,e){let s=0;if(e==="+1"||e==="-1"){const l=this.value(a)||0;s=e==="+1"?l+1:l-1}else typeof e=="number"&&(s=e);return s===0?(this.remove(a),!0):super.add(a,s.toString())}canAdd(a,e){return super.canAdd(a,e)||super.canAdd(a,parseInt(e,10))}value(a){return parseInt(super.value(a),10)||void 0}}const Dm=new Nm("indent","ql-indent",{scope:Ie.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class Om extends vt{static blotName="blockquote";static tagName="blockquote"}class Fm extends vt{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(a){return this.tagName.indexOf(a.tagName)+1}}class Qs extends Ya{}Qs.blotName="list-container";Qs.tagName="OL";class Ks extends vt{static create(a){const e=super.create();return e.setAttribute("data-list",a),e}static formats(a){return a.getAttribute("data-list")||void 0}static register(){ue.register(Qs)}constructor(a,e){super(a,e);const s=e.ownerDocument.createElement("span"),l=i=>{if(!a.isEnabled())return;const o=this.statics.formats(e,a);o==="checked"?(this.format("list","unchecked"),i.preventDefault()):o==="unchecked"&&(this.format("list","checked"),i.preventDefault())};s.addEventListener("mousedown",l),s.addEventListener("touchstart",l),this.attachUI(s)}format(a,e){a===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(a,e)}}Ks.blotName="list";Ks.tagName="LI";Qs.allowedChildren=[Ks];Ks.requiredContainer=Qs;class Ti extends Et{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(a){super.optimize(a),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class Mm extends Ti{static blotName="italic";static tagName=["EM","I"]}class $l extends Et{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(a){const e=super.create(a);return e.setAttribute("href",this.sanitize(a)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(a){return a.getAttribute("href")}static sanitize(a){return lr(a,this.PROTOCOL_WHITELIST)?a:this.SANITIZED_URL}format(a,e){a!==this.statics.blotName||!e?super.format(a,e):this.domNode.setAttribute("href",this.constructor.sanitize(e))}}function lr(n,a){const e=document.createElement("a");e.href=n;const s=e.href.slice(0,e.href.indexOf(":"));return a.indexOf(s)>-1}class Vm extends Et{static blotName="script";static tagName=["SUB","SUP"];static create(a){return a==="super"?document.createElement("sup"):a==="sub"?document.createElement("sub"):super.create(a)}static formats(a){if(a.tagName==="SUB")return"sub";if(a.tagName==="SUP")return"super"}}class Bm extends Ti{static blotName="strike";static tagName=["S","STRIKE"]}class Rm extends Et{static blotName="underline";static tagName="U"}class qm extends vi{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(a){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const e=super.create(a);return typeof a=="string"&&(window.katex.render(a,e,{throwOnError:!1,errorColor:"#f00"}),e.setAttribute("data-value",a)),e}static value(a){return a.getAttribute("data-value")}html(){const{formula:a}=this.value();return`<span>${a}</span>`}}const oo=["alt","height","width"];class Um extends Ft{static blotName="image";static tagName="IMG";static create(a){const e=super.create(a);return typeof a=="string"&&e.setAttribute("src",this.sanitize(a)),e}static formats(a){return oo.reduce((e,s)=>(a.hasAttribute(s)&&(e[s]=a.getAttribute(s)),e),{})}static match(a){return/\.(jpe?g|gif|png)$/.test(a)||/^data:image\/.+;base64/.test(a)}static sanitize(a){return lr(a,["http","https","data"])?a:"//:0"}static value(a){return a.getAttribute("src")}format(a,e){oo.indexOf(a)>-1?e?this.domNode.setAttribute(a,e):this.domNode.removeAttribute(a):super.format(a,e)}}const ro=["height","width"];class zm extends Ut{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(a){const e=super.create(a);return e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","true"),e.setAttribute("src",this.sanitize(a)),e}static formats(a){return ro.reduce((e,s)=>(a.hasAttribute(s)&&(e[s]=a.getAttribute(s)),e),{})}static sanitize(a){return $l.sanitize(a)}static value(a){return a.getAttribute("src")}format(a,e){ro.indexOf(a)>-1?e?this.domNode.setAttribute(a,e):this.domNode.removeAttribute(a):super.format(a,e)}html(){const{video:a}=this.value();return`<a href="${a}">${a}</a>`}}const Vs=new ea("code-token","hljs",{scope:Ie.INLINE});class fa extends Et{static formats(a,e){for(;a!=null&&a!==e.domNode;){if(a.classList&&a.classList.contains(At.className))return super.formats(a,e);a=a.parentNode}}constructor(a,e,s){super(a,e,s),Vs.add(this.domNode,s)}format(a,e){a!==fa.blotName?super.format(a,e):e?Vs.add(this.domNode,e):(Vs.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Vs.value(this.domNode)||this.unwrap()}}fa.blotName="code-token";fa.className="ql-token";class qt extends At{static create(a){const e=super.create(a);return typeof a=="string"&&e.setAttribute("data-language",a),e}static formats(a){return a.getAttribute("data-language")||"plain"}static register(){}format(a,e){a===this.statics.blotName&&e?this.domNode.setAttribute("data-language",e):super.format(a,e)}replaceWith(a,e){return this.formatAt(0,this.length(),fa.blotName,!1),super.replaceWith(a,e)}}class qs extends Wa{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(a,e){a===qt.blotName&&(this.forceNext=!0,this.children.forEach(s=>{s.format(a,e)}))}formatAt(a,e,s,l){s===qt.blotName&&(this.forceNext=!0),super.formatAt(a,e,s,l)}highlight(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const l=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,i=qt.formats(this.children.head.domNode);if(e||this.forceNext||this.cachedText!==l){if(l.trim().length>0||this.cachedText==null){const o=this.children.reduce((u,d)=>u.concat(Uo(d,!1)),new Se),r=a(l,i);o.diff(r).reduce((u,d)=>{let{retain:f,attributes:_}=d;return f?(_&&Object.keys(_).forEach(g=>{[qt.blotName,fa.blotName].includes(g)&&this.formatAt(u,f,g,_[g])}),u+f):u},0)}this.cachedText=l,this.forceNext=!1}}html(a,e){const[s]=this.children.find(a);return`<pre data-language="${s?qt.formats(s.domNode):"plain"}">
${jl(this.code(a,e))}
</pre>`}optimize(a){if(super.optimize(a),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const e=qt.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}qs.allowedChildren=[qt];qt.requiredContainer=qs;qt.allowedChildren=[fa,Jt,Kt,ta];const jm=(n,a,e)=>{if(typeof n.versionString=="string"){const s=n.versionString.split(".")[0];if(parseInt(s,10)>=11)return n.highlight(e,{language:a}).value}return n.highlight(a,e).value};class nr extends ra{static register(){ue.register(fa,!0),ue.register(qt,!0),ue.register(qs,!0)}constructor(a,e){if(super(a,e),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((s,l)=>{let{key:i}=l;return s[i]=!0,s},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(ue.events.SCROLL_BLOT_MOUNT,a=>{if(!(a instanceof qs))return;const e=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(s=>{let{key:l,label:i}=s;const o=e.ownerDocument.createElement("option");o.textContent=i,o.setAttribute("value",l),e.appendChild(o)}),e.addEventListener("change",()=>{a.format(qt.blotName,e.value),this.quill.root.focus(),this.highlight(a,!0)}),a.uiNode==null&&(a.attachUI(e),a.children.head&&(e.value=qt.formats(a.children.head.domNode)))})}initTimer(){let a=null;this.quill.on(ue.events.SCROLL_OPTIMIZE,()=>{a&&clearTimeout(a),a=setTimeout(()=>{this.highlight(),a=null},this.options.interval)})}highlight(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(ue.sources.USER);const s=this.quill.getSelection();(a==null?this.quill.scroll.descendants(qs):[a]).forEach(i=>{i.highlight(this.highlightBlot,e)}),this.quill.update(ue.sources.SILENT),s!=null&&this.quill.setSelection(s,ue.sources.SILENT)}highlightBlot(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(e=this.languages[e]?e:"plain",e==="plain")return jl(a).split(`
`).reduce((l,i,o)=>(o!==0&&l.insert(`
`,{[At.blotName]:e}),l.insert(i)),new Se);const s=this.quill.root.ownerDocument.createElement("div");return s.classList.add(At.className),s.innerHTML=jm(this.options.hljs,e,a),wi(this.quill.scroll,s,[(l,i)=>{const o=Vs.value(l);return o?i.compose(new Se().retain(i.length(),{[fa.blotName]:o})):i}],[(l,i)=>l.data.split(`
`).reduce((o,r,u)=>(u!==0&&o.insert(`
`,{[At.blotName]:e}),o.insert(r)),i)],new WeakMap)}}nr.DEFAULTS={hljs:(()=>window.hljs)(),interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class Xt extends vt{static blotName="table";static tagName="TD";static create(a){const e=super.create();return a?e.setAttribute("data-row",a):e.setAttribute("data-row",Ei()),e}static formats(a){if(a.hasAttribute("data-row"))return a.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(a,e){a===Xt.blotName&&e?this.domNode.setAttribute("data-row",e):super.format(a,e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class qa extends Ya{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const a=this.children.head.formats(),e=this.children.tail.formats(),s=this.next.children.head.formats(),l=this.next.children.tail.formats();return a.table===e.table&&a.table===s.table&&a.table===l.table}return!1}optimize(a){super.optimize(a),this.children.forEach(e=>{if(e.next==null)return;const s=e.formats(),l=e.next.formats();if(s.table!==l.table){const i=this.splitAfter(e);i&&i.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class Aa extends Ya{static blotName="table-body";static tagName="TBODY"}class Nl extends Ya{static blotName="table-container";static tagName="TABLE";balanceCells(){const a=this.descendants(qa),e=a.reduce((s,l)=>Math.max(l.children.length,s),0);a.forEach(s=>{new Array(e-s.children.length).fill(0).forEach(()=>{let l;s.children.head!=null&&(l=Xt.formats(s.children.head.domNode));const i=this.scroll.create(Xt.blotName,l);s.appendChild(i),i.optimize()})})}cells(a){return this.rows().map(e=>e.children.at(a))}deleteColumn(a){const[e]=this.descendant(Aa);e==null||e.children.head==null||e.children.forEach(s=>{const l=s.children.at(a);l?.remove()})}insertColumn(a){const[e]=this.descendant(Aa);e==null||e.children.head==null||e.children.forEach(s=>{const l=s.children.at(a),i=Xt.formats(s.children.head.domNode),o=this.scroll.create(Xt.blotName,i);s.insertBefore(o,l)})}insertRow(a){const[e]=this.descendant(Aa);if(e==null||e.children.head==null)return;const s=Ei(),l=this.scroll.create(qa.blotName);e.children.head.children.forEach(()=>{const o=this.scroll.create(Xt.blotName,s);l.appendChild(o)});const i=e.children.at(a);e.insertBefore(l,i)}rows(){const a=this.children.head;return a==null?[]:a.children.map(e=>e)}}Nl.allowedChildren=[Aa];Aa.requiredContainer=Nl;Aa.allowedChildren=[qa];qa.requiredContainer=Aa;qa.allowedChildren=[Xt];Xt.requiredContainer=qa;function Ei(){return`row-${Math.random().toString(36).slice(2,6)}`}class Ym extends ra{static register(){ue.register(Xt),ue.register(qa),ue.register(Aa),ue.register(Nl)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(Nl).forEach(a=>{a.balanceCells()})}deleteColumn(){const[a,,e]=this.getTable();e!=null&&(a.deleteColumn(e.cellOffset()),this.quill.update(ue.sources.USER))}deleteRow(){const[,a]=this.getTable();a!=null&&(a.remove(),this.quill.update(ue.sources.USER))}deleteTable(){const[a]=this.getTable();if(a==null)return;const e=a.offset();a.remove(),this.quill.update(ue.sources.USER),this.quill.setSelection(e,ue.sources.SILENT)}getTable(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(a==null)return[null,null,null,-1];const[e,s]=this.quill.getLine(a.index);if(e==null||e.statics.blotName!==Xt.blotName)return[null,null,null,-1];const l=e.parent;return[l.parent.parent,l,e,s]}insertColumn(a){const e=this.quill.getSelection();if(!e)return;const[s,l,i]=this.getTable(e);if(i==null)return;const o=i.cellOffset();s.insertColumn(o+a),this.quill.update(ue.sources.USER);let r=l.rowOffset();a===0&&(r+=1),this.quill.setSelection(e.index+r,e.length,ue.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(a){const e=this.quill.getSelection();if(!e)return;const[s,l,i]=this.getTable(e);if(i==null)return;const o=l.rowOffset();s.insertRow(o+a),this.quill.update(ue.sources.USER),a>0?this.quill.setSelection(e,ue.sources.SILENT):this.quill.setSelection(e.index+l.children.length,e.length,ue.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(a,e){const s=this.quill.getSelection();if(s==null)return;const l=new Array(a).fill(0).reduce(i=>{const o=new Array(e).fill(`
`).join("");return i.insert(o,{table:Ei()})},new Se().retain(s.index));this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(s.index,ue.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(ue.events.SCROLL_OPTIMIZE,a=>{a.some(e=>["TD","TR","TBODY","TABLE"].includes(e.target.tagName)?(this.quill.once(ue.events.TEXT_CHANGE,(s,l,i)=>{i===ue.sources.USER&&this.balanceTables()}),!0):!1)})}}const co=ya("quill:toolbar");class Li extends ra{constructor(a,e){if(super(a,e),Array.isArray(this.options.container)){const s=document.createElement("div");s.setAttribute("role","toolbar"),Wm(s,this.options.container),a.container?.parentNode?.insertBefore(s,a.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){co.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{const l=this.options.handlers?.[s];l&&this.addHandler(s,l)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(ue.events.EDITOR_CHANGE,()=>{const[s]=this.quill.selection.getRange();this.update(s)})}addHandler(a,e){this.handlers[a]=e}attach(a){let e=Array.from(a.classList).find(l=>l.indexOf("ql-")===0);if(!e)return;if(e=e.slice(3),a.tagName==="BUTTON"&&a.setAttribute("type","button"),this.handlers[e]==null&&this.quill.scroll.query(e)==null){co.warn("ignoring attaching to nonexistent format",e,a);return}const s=a.tagName==="SELECT"?"change":"click";a.addEventListener(s,l=>{let i;if(a.tagName==="SELECT"){if(a.selectedIndex<0)return;const r=a.options[a.selectedIndex];r.hasAttribute("selected")?i=!1:i=r.value||!1}else a.classList.contains("ql-active")?i=!1:i=a.value||!a.hasAttribute("value"),l.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[e]!=null)this.handlers[e].call(this,i);else if(this.quill.scroll.query(e).prototype instanceof Ft){if(i=prompt(`Enter ${e}`),!i)return;this.quill.updateContents(new Se().retain(o.index).delete(o.length).insert({[e]:i}),ue.sources.USER)}else this.quill.format(e,i,ue.sources.USER);this.update(o)}),this.controls.push([e,a])}update(a){const e=a==null?{}:this.quill.getFormat(a);this.controls.forEach(s=>{const[l,i]=s;if(i.tagName==="SELECT"){let o=null;if(a==null)o=null;else if(e[l]==null)o=i.querySelector("option[selected]");else if(!Array.isArray(e[l])){let r=e[l];typeof r=="string"&&(r=r.replace(/"/g,'\\"')),o=i.querySelector(`option[value="${r}"]`)}o==null?(i.value="",i.selectedIndex=-1):o.selected=!0}else if(a==null)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){const o=e[l],r=o===i.getAttribute("value")||o!=null&&o.toString()===i.getAttribute("value")||o==null&&!i.getAttribute("value");i.classList.toggle("ql-active",r),i.setAttribute("aria-pressed",r.toString())}else{const o=e[l]!=null;i.classList.toggle("ql-active",o),i.setAttribute("aria-pressed",o.toString())}})}}Li.DEFAULTS={};function uo(n,a,e){const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add(`ql-${a}`),s.setAttribute("aria-pressed","false"),e!=null?(s.value=e,s.setAttribute("aria-label",`${a}: ${e}`)):s.setAttribute("aria-label",a),n.appendChild(s)}function Wm(n,a){Array.isArray(a[0])||(a=[a]),a.forEach(e=>{const s=document.createElement("span");s.classList.add("ql-formats"),e.forEach(l=>{if(typeof l=="string")uo(s,l);else{const i=Object.keys(l)[0],o=l[i];Array.isArray(o)?Hm(s,i,o):uo(s,i,o)}}),n.appendChild(s)})}function Hm(n,a,e){const s=document.createElement("select");s.classList.add(`ql-${a}`),e.forEach(l=>{const i=document.createElement("option");l!==!1?i.setAttribute("value",String(l)):i.setAttribute("selected","selected"),s.appendChild(i)}),n.appendChild(s)}Li.DEFAULTS={container:null,handlers:{clean(){const n=this.quill.getSelection();if(n!=null)if(n.length===0){const a=this.quill.getFormat();Object.keys(a).forEach(e=>{this.quill.scroll.query(e,Ie.INLINE)!=null&&this.quill.format(e,!1,ue.sources.USER)})}else this.quill.removeFormat(n.index,n.length,ue.sources.USER)},direction(n){const{align:a}=this.quill.getFormat();n==="rtl"&&a==null?this.quill.format("align","right",ue.sources.USER):!n&&a==="right"&&this.quill.format("align",!1,ue.sources.USER),this.quill.format("direction",n,ue.sources.USER)},indent(n){const a=this.quill.getSelection(),e=this.quill.getFormat(a),s=parseInt(e.indent||0,10);if(n==="+1"||n==="-1"){let l=n==="+1"?1:-1;e.direction==="rtl"&&(l*=-1),this.quill.format("indent",s+l,ue.sources.USER)}},link(n){n===!0&&(n=prompt("Enter link URL:")),this.quill.format("link",n,ue.sources.USER)},list(n){const a=this.quill.getSelection(),e=this.quill.getFormat(a);n==="check"?e.list==="checked"||e.list==="unchecked"?this.quill.format("list",!1,ue.sources.USER):this.quill.format("list","unchecked",ue.sources.USER):this.quill.format("list",n,ue.sources.USER)}}};const Zm='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',Gm='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',Jm='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',Xm='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',Qm='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',Km='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',ep='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',tp='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',mo='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',ap='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',sp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',lp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',np='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',ip='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',op='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',rp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',cp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',up='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',dp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',mp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',pp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',gp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',fp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',hp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',vp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',_p='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',yp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',bp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',kp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',Cp='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',xp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',wp='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',Tp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>';var Ws={align:{"":Zm,center:Gm,right:Jm,justify:Xm},background:Qm,blockquote:Km,bold:ep,clean:tp,code:mo,"code-block":mo,color:ap,direction:{"":sp,rtl:lp},formula:np,header:{"1":ip,"2":op,"3":rp,"4":cp,"5":up,"6":dp},italic:mp,image:pp,indent:{"+1":gp,"-1":fp},link:hp,list:{bullet:vp,check:_p,ordered:yp},script:{sub:bp,super:kp},strike:Cp,table:xp,underline:wp,video:Tp};const Ep='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let po=0;function go(n,a){n.setAttribute(a,`${n.getAttribute(a)!=="true"}`)}class Wl{constructor(a){this.select=a,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),go(this.label,"aria-expanded"),go(this.options,"aria-hidden")}buildItem(a){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const s=a.getAttribute("value");return s&&e.setAttribute("data-value",s),a.textContent&&e.setAttribute("data-label",a.textContent),e.addEventListener("click",()=>{this.selectItem(e,!0)}),e.addEventListener("keydown",l=>{switch(l.key){case"Enter":this.selectItem(e,!0),l.preventDefault();break;case"Escape":this.escape(),l.preventDefault();break}}),e}buildLabel(){const a=document.createElement("span");return a.classList.add("ql-picker-label"),a.innerHTML=Ep,a.tabIndex="0",a.setAttribute("role","button"),a.setAttribute("aria-expanded","false"),this.container.appendChild(a),a}buildOptions(){const a=document.createElement("span");a.classList.add("ql-picker-options"),a.setAttribute("aria-hidden","true"),a.tabIndex="-1",a.id=`ql-picker-options-${po}`,po+=1,this.label.setAttribute("aria-controls",a.id),this.options=a,Array.from(this.select.options).forEach(e=>{const s=this.buildItem(e);a.appendChild(s),e.selected===!0&&this.selectItem(s)}),this.container.appendChild(a)}buildPicker(){Array.from(this.select.attributes).forEach(a=>{this.container.setAttribute(a.name,a.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.container.querySelector(".ql-selected");a!==s&&(s?.classList.remove("ql-selected"),a!=null&&(a.classList.add("ql-selected"),this.select.selectedIndex=Array.from(a.parentNode.children).indexOf(a),a.hasAttribute("data-value")?this.label.setAttribute("data-value",a.getAttribute("data-value")):this.label.removeAttribute("data-value"),a.hasAttribute("data-label")?this.label.setAttribute("data-label",a.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let a;if(this.select.selectedIndex>-1){const s=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];a=this.select.options[this.select.selectedIndex],this.selectItem(s)}else this.selectItem(null);const e=a!=null&&a!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}}class ir extends Wl{constructor(a,e){super(a),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(s=>{s.classList.add("ql-primary")})}buildItem(a){const e=super.buildItem(a);return e.style.backgroundColor=a.getAttribute("value")||"",e}selectItem(a,e){super.selectItem(a,e);const s=this.label.querySelector(".ql-color-label"),l=a&&a.getAttribute("data-value")||"";s&&(s.tagName==="line"?s.style.stroke=l:s.style.fill=l)}}class or extends Wl{constructor(a,e){super(a),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(s=>{s.innerHTML=e[s.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(a,e){super.selectItem(a,e);const s=a||this.defaultItem;if(s!=null){if(this.label.innerHTML===s.innerHTML)return;this.label.innerHTML=s.innerHTML}}}const Lp=n=>{const{overflowY:a}=getComputedStyle(n,null);return a!=="visible"&&a!=="clip"};class rr{constructor(a,e){this.quill=a,this.boundsContainer=e||document.body,this.root=a.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Lp(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(a){const e=a.left+a.width/2-this.root.offsetWidth/2,s=a.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${s}px`,this.root.classList.remove("ql-flip");const l=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect();let o=0;if(i.right>l.right&&(o=l.right-i.right,this.root.style.left=`${e+o}px`),i.left<l.left&&(o=l.left-i.left,this.root.style.left=`${e+o}px`),i.bottom>l.bottom){const r=i.bottom-i.top,u=a.bottom-a.top+r;this.root.style.top=`${s-u}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const Sp=[!1,"center","right","justify"],Ap=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Ip=[!1,"serif","monospace"],Pp=["1","2","3",!1],$p=["small",!1,"large","huge"];class el extends Cs{constructor(a,e){super(a,e);const s=l=>{if(!document.body.contains(a.root)){document.body.removeEventListener("click",s);return}this.tooltip!=null&&!this.tooltip.root.contains(l.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(i=>{i.container.contains(l.target)||i.close()})};a.emitter.listenDOM("click",document.body,s)}addModule(a){const e=super.addModule(a);return a==="toolbar"&&this.extendToolbar(e),e}buildButtons(a,e){Array.from(a).forEach(s=>{(s.getAttribute("class")||"").split(/\s+/).forEach(i=>{if(!!i.startsWith("ql-")&&(i=i.slice(3),e[i]!=null))if(i==="direction")s.innerHTML=e[i][""]+e[i].rtl;else if(typeof e[i]=="string")s.innerHTML=e[i];else{const o=s.value||"";o!=null&&e[i][o]&&(s.innerHTML=e[i][o])}})})}buildPickers(a,e){this.pickers=Array.from(a).map(l=>{if(l.classList.contains("ql-align")&&(l.querySelector("option")==null&&Ms(l,Sp),typeof e.align=="object"))return new or(l,e.align);if(l.classList.contains("ql-background")||l.classList.contains("ql-color")){const i=l.classList.contains("ql-background")?"background":"color";return l.querySelector("option")==null&&Ms(l,Ap,i==="background"?"#ffffff":"#000000"),new ir(l,e[i])}return l.querySelector("option")==null&&(l.classList.contains("ql-font")?Ms(l,Ip):l.classList.contains("ql-header")?Ms(l,Pp):l.classList.contains("ql-size")&&Ms(l,$p)),new Wl(l)});const s=()=>{this.pickers.forEach(l=>{l.update()})};this.quill.on(Le.events.EDITOR_CHANGE,s)}}el.DEFAULTS=Sa({},Cs.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let n=this.container.querySelector("input.ql-image[type=file]");n==null&&(n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),n.classList.add("ql-image"),n.addEventListener("change",()=>{const a=this.quill.getSelection(!0);this.quill.uploader.upload(a,n.files),n.value=""}),this.container.appendChild(n)),n.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class cr extends rr{constructor(a,e){super(a,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",a=>{a.key==="Enter"?(this.save(),a.preventDefault()):a.key==="Escape"&&(this.cancel(),a.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;e!=null?this.textbox.value=e:a!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const s=this.quill.getBounds(this.quill.selection.savedRange);s!=null&&this.position(s),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${a}`)||""),this.root.setAttribute("data-mode",a)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:a}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",a,Le.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",a,Le.sources.USER)),this.quill.root.scrollTop=e;break}case"video":a=Np(a);case"formula":{if(!a)break;const e=this.quill.getSelection(!0);if(e!=null){const s=e.index+e.length;this.quill.insertEmbed(s,this.root.getAttribute("data-mode"),a,Le.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(s+1," ",Le.sources.USER),this.quill.setSelection(s+2,Le.sources.USER)}break}}this.textbox.value="",this.hide()}}function Np(n){let a=n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return a?`${a[1]||"https"}://www.youtube.com/embed/${a[2]}?showinfo=0`:(a=n.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${a[1]||"https"}://player.vimeo.com/video/${a[2]}/`:n}function Ms(n,a){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a.forEach(s=>{const l=document.createElement("option");s===e?l.setAttribute("selected","selected"):l.setAttribute("value",String(s)),n.appendChild(l)})}const Dp=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class Op extends cr{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(a,e){super(a,e),this.quill.on(Le.events.EDITOR_CHANGE,(s,l,i,o)=>{if(s===Le.events.SELECTION_CHANGE)if(l!=null&&l.length>0&&o===Le.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const r=this.quill.getLines(l.index,l.length);if(r.length===1){const u=this.quill.getBounds(l);u!=null&&this.position(u)}else{const u=r[r.length-1],d=this.quill.getIndex(u),f=Math.min(u.length()-1,l.index+l.length-d),_=this.quill.getBounds(new Ra(d,f));_!=null&&this.position(_)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(Le.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const a=this.quill.getSelection();if(a!=null){const e=this.quill.getBounds(a);e!=null&&this.position(e)}},1)})}cancel(){this.show()}position(a){const e=super.position(a),s=this.root.querySelector(".ql-tooltip-arrow");return s.style.marginLeft="",e!==0&&(s.style.marginLeft=`${-1*e-s.offsetWidth/2}px`),e}}class ur extends el{constructor(a,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=Dp),super(a,e),this.quill.container.classList.add("ql-bubble")}extendToolbar(a){this.tooltip=new Op(this.quill,this.options.bounds),a.container!=null&&(this.tooltip.root.appendChild(a.container),this.buildButtons(a.container.querySelectorAll("button"),Ws),this.buildPickers(a.container.querySelectorAll("select"),Ws))}}ur.DEFAULTS=Sa({},el.DEFAULTS,{modules:{toolbar:{handlers:{link(n){n?this.quill.theme.tooltip.edit():this.quill.format("link",!1,ue.sources.USER)}}}}});const Fp=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class Mp extends cr{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",a=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),a.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",a=>{if(this.linkRange!=null){const e=this.linkRange;this.restoreFocus(),this.quill.formatText(e,"link",!1,Le.sources.USER),delete this.linkRange}a.preventDefault(),this.hide()}),this.quill.on(Le.events.SELECTION_CHANGE,(a,e,s)=>{if(a!=null){if(a.length===0&&s===Le.sources.USER){const[l,i]=this.quill.scroll.descendant($l,a.index);if(l!=null){this.linkRange=new Ra(a.index-i,l.length());const o=$l.formats(l.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const r=this.quill.getBounds(this.linkRange);r!=null&&this.position(r);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class dr extends el{constructor(a,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=Fp),super(a,e),this.quill.container.classList.add("ql-snow")}extendToolbar(a){a.container!=null&&(a.container.classList.add("ql-snow"),this.buildButtons(a.container.querySelectorAll("button"),Ws),this.buildPickers(a.container.querySelectorAll("select"),Ws),this.tooltip=new Mp(this.quill,this.options.bounds),a.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(e,s)=>{a.handlers.link.call(a,!s.format.link)}))}}dr.DEFAULTS=Sa({},el.DEFAULTS,{modules:{toolbar:{handlers:{link(n){if(n){const a=this.quill.getSelection();if(a==null||a.length===0)return;let e=this.quill.getText(a);/^\S+@\S+\.\S+$/.test(e)&&e.indexOf("mailto:")!==0&&(e=`mailto:${e}`);const{tooltip:s}=this.quill.theme;s.edit("link",e)}else this.quill.format("link",!1,ue.sources.USER)}}}}});ue.register({"attributors/attribute/direction":Zo,"attributors/class/align":Yo,"attributors/class/background":Ud,"attributors/class/color":qd,"attributors/class/direction":Go,"attributors/class/font":Qo,"attributors/class/size":er,"attributors/style/align":Wo,"attributors/style/background":bi,"attributors/style/color":yi,"attributors/style/direction":Jo,"attributors/style/font":Ko,"attributors/style/size":tr},!0);ue.register({"formats/align":Yo,"formats/direction":Go,"formats/indent":Dm,"formats/background":bi,"formats/color":yi,"formats/font":Qo,"formats/size":er,"formats/blockquote":Om,"formats/code-block":At,"formats/header":Fm,"formats/list":Ks,"formats/bold":Ti,"formats/code":ki,"formats/italic":Mm,"formats/link":$l,"formats/script":Vm,"formats/strike":Bm,"formats/underline":Rm,"formats/formula":qm,"formats/image":Um,"formats/video":zm,"modules/syntax":nr,"modules/table":Ym,"modules/toolbar":Li,"themes/bubble":ur,"themes/snow":dr,"ui/icons":Ws,"ui/picker":Wl,"ui/icon-picker":or,"ui/color-picker":ir,"ui/tooltip":rr},!0);const Vp={props:{content:String,value:String,disabled:{type:Boolean,default:!1},options:{type:Object,default:()=>({})}},emits:["ready","change","input","blur","focus","update:value"],setup(n,{emit:a}){const e=n,s={theme:"snow",boundary:document.body,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},placeholder:"Insert content here ...",readOnly:!1},l=f=>{const _=new MutationObserver(g=>{g.forEach(()=>{})});return _.observe(f,{childList:!0,subtree:!0}),_},i=M(null);let o=null,r="";const u=(f,_)=>{for(const g in _)!f[g]||g!=="modules"?f[g]=_[g]:u(f[g],_[g]);return f},d=()=>{if(i.value){const f=u(s,e.options);f.readOnly=!!e.disabled,o=new ue(i.value,f),e.value&&o.clipboard.dangerouslyPasteHTML(e.value),o.on("selection-change",_=>{a(_?"focus":"blur",o)}),o.on("text-change",()=>{e.disabled&&o.enable(!1);let _=i.value.children[0].innerHTML;const g=o.getText();_==="<p><br></p>"&&(_=""),r=_,a("update:value",r),a("change",{html:_,text:g,quill:o})}),a("ready",o)}};return rt(()=>e.value,f=>{o&&f!==r?(r=f,o.clipboard.dangerouslyPasteHTML(f)):f||o.setText("")}),rt(()=>e.disabled,f=>{o&&o.enable(!f)}),Je(()=>{if(d(),i.value){const f=l(i.value);Ni(()=>{f.disconnect()})}}),qr(()=>{const f=i.value.previousSibling;f&&f.nodeType===1&&f.className.indexOf("ql-toolbar")>-1&&f.parentNode.removeChild(f)}),Ni(()=>{o=null}),(f,_)=>(c(),y("section",{ref_key:"editor",ref:i},null,512))}};const Bp={class:"am-desc-editor__header"},Rp={class:"am-desc-editor__header-warning"},qp=m("span",{class:"am-icon-triangle-info"},null,-1),Up={key:1,class:"am-quill-wrapper"},mr={props:{modelValue:{type:String,default:""},mode:{type:String,default:"html"}},emits:["update:modelValue","setMode"],setup(n,{emit:a}){const e=n;let s=R("amLabels"),l=M(e.mode),i=v({get:()=>e.modelValue,set:_=>{a("update:modelValue",_)}});function o(){l.value="text",a("setMode","text")}function r(){l.value="html",a("setMode","html")}const u={theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]]},readOnly:!1};let d=R("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),f=v(()=>({"--am-c-desce-text-op03":H(d.value.colorMainText,.03),"--am-c-desce-warn-op10":H(d.value.colorWarning,.1)}));return(_,g)=>t(l)?(c(),y("div",{key:0,class:"am-desc-editor",style:Ce(t(f))},[m("div",Bp,[A(Ur,null,{default:x(()=>[A(Ee,{category:t(l)==="text"?"primary":"secondary",type:t(l)==="text"?"filled":"plain",size:"small",onClick:o},{default:x(()=>[ce(k(t(s).text_mode),1)]),_:1},8,["category","type"]),A(Ee,{category:t(l)==="html"?"primary":"secondary",type:t(l)==="html"?"filled":"plain",size:"small",onClick:r},{default:x(()=>[ce(k(t(s).html_mode),1)]),_:1},8,["category","type"])]),_:1}),m("div",Rp,[qp,ce(" "+k(t(s).content_mode_tooltip),1)])]),t(l)==="html"?(c(),U(it,{key:0,modelValue:t(i),"onUpdate:modelValue":g[0]||(g[0]=C=>we(i)?i.value=C:i=C),type:"textarea",rows:3,style:{width:"100%"}},null,8,["modelValue"])):D("",!0),t(l)==="text"?(c(),y("div",Up,[A(Vp,{value:t(i),"onUpdate:value":g[1]||(g[1]=C=>we(i)?i.value=C:i=C),options:u},null,8,["value"])])):D("",!0)],4)):D("",!0)}};const zp=["innerHTML"],jp={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n,s=Ne(),l=R("settings");let i=R("amLabels"),o=v(()=>s.getters["entities/getEmployee"](s.getters["employee/getId"])),r=v(()=>s.getters["entities/getLocations"]),u=v(()=>r.value.map(I=>({value:I.id,label:I.name}))),d=M(null),f=M(!1),_=M({firstName:v({get:()=>s.getters["employee/getFirstName"],set:I=>{s.commit("employee/setFirstName",I||"")}}),lastName:v({get:()=>s.getters["employee/getLastName"],set:I=>{s.commit("employee/setLastName",I||"")}}),email:v({get:()=>s.getters["employee/getEmail"],set:I=>{s.commit("employee/setEmail",I||"")}}),phone:v({get:()=>s.getters["employee/getPhone"],set:I=>{s.commit("employee/setPhone",I||"")}}),locationId:v({get:()=>s.getters["employee/getLocationId"],set:I=>{s.commit("employee/setLocationId",I||"")}}),description:v({get:()=>s.getters["employee/getDescription"],set:I=>{s.commit("employee/setDescription",I||"")}})}),g=v(()=>({firstName:[{required:!0,message:i.enter_first_name_warning,trigger:["submit","change"]}],lastName:[{required:!0,message:i.enter_last_name_warning,trigger:["submit","change"]}],email:[{required:!0,message:i.enter_email_warning,trigger:["submit","change"]}],locationId:[{required:r.value.filter(I=>I.status==="visible").length>0,message:i.enter_location_warning,trigger:["submit","change"]}]})),C=M({firstName:{template:Ye.text,props:{itemName:"firstName",label:i.first_name_colon,placeholder:i.enter_first_name,class:v(()=>`am-caepif__item ${e.responsiveClass}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:i.last_name_colon,placeholder:i.enter_last_name,class:v(()=>`am-caepif__item ${e.responsiveClass}`)}},email:{template:Ye.text,props:{itemName:"email",label:i.email_colon,placeholder:i.enter_email,class:v(()=>`am-caepif__item ${e.responsiveClass}`)}},phone:{countryPhoneIso:v({get:()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:"",set:I=>{s.commit("auth/setProfileCountryPhoneIso",I?I.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:i.phone_colon,placeholder:i.enter_phone,defaultCode:v(()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:""),phoneError:v(()=>f.value),whatsAppLabel:i.whatsapp_opt_in_text,isWhatsApp:l.notifications.whatsAppEnabled&&l.notifications.whatsAppAccessToken&&l.notifications.whatsAppBusinessID&&l.notifications.whatsAppPhoneID,class:v(()=>`am-caepif__item ${e.responsiveClass}`)}}}),O=M({locationId:{template:Ye.select,props:{itemName:"locationId",label:`${i.location}:`,placeholder:i.select_location,class:v(()=>`am-caepif__item ${e.responsiveClass} ${l.zoom.enabled||"am-w-100"}`),options:u.value}}});return Zs(()=>{r.value.length||delete O.value.locationId}),a({employeeFormRef:d}),(I,b)=>{const P=yt,L=et;return c(),U(L,{ref_key:"employeeFormRef",ref:d,model:t(_),rules:t(g),"label-position":"top",class:q(["am-caepif",e.responsiveClass])},{default:x(()=>[m("div",{class:q(["am-caepif__block",[{"am-w-70":t(o).pictureFullPath},e.responsiveClass]])},[(c(!0),y(ee,null,fe(t(C),($,h)=>(c(),U(pt($.template),St({key:h,ref_for:!0,ref:"customerCollectorRef",modelValue:t(_)[h],"onUpdate:modelValue":S=>t(_)[h]=S,countryPhoneIso:$.countryPhoneIso,"onUpdate:countryPhoneIso":S=>$.countryPhoneIso=S},$.props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))],2),t(o).pictureFullPath?(c(),y("div",{key:0,class:q(["am-caepif__block am-w-30",e.responsiveClass])},[m("div",{class:"am-caepif__img",style:Ce({backgroundImage:`url(${t(o).pictureFullPath})`})},null,4)],2)):D("",!0),m("div",{class:q(["am-caepif__block",e.responsiveClass])},[(c(!0),y(ee,null,fe(t(O),($,h)=>(c(),U(pt($.template),St({key:h,ref_for:!0,ref:"customerCollectorRef",modelValue:t(_)[h],"onUpdate:modelValue":S=>t(_)[h]=S},$.props,ri($.handlers?$.handlers:{})),{default:x(()=>[$.slots&&$.slots.default?(c(),y("div",{key:0,innerHTML:$.slots.default},null,8,zp)):D("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128)),A(P,{label:t(i).description_colon},{default:x(()=>[A(mr,{modelValue:t(_).description,"onUpdate:modelValue":b[0]||(b[0]=$=>t(_).description=$),mode:t(s).getters["employee/getDescriptionMode"],onSetMode:b[1]||(b[1]=$=>t(s).commit("employee/setDescriptionMode",$))},null,8,["modelValue","mode"])]),_:1},8,["label"])],2)]),_:1},8,["model","rules","class"])}}};const Yp={class:"am-caes__category-header"},Wp={class:"am-caes__category-header__text"},Hp={class:"am-caes__service-header"},Zp={class:"am-caes__service-header__text"},Gp={class:"am-caes__service-content"},Jp={class:"am-caes__service-content__text"},Xp={class:"am-caes__service-content__text"},Qp={class:"am-caes__service-content__text"},Kp={class:"am-caes__service-content__inner am-caes__service-content__disabled"},eg={class:"am-caes__service-content__text"},tg={class:"am-caes__service-content__text"},ag={class:"am-caes__service-content__inner am-caes__service-content__disabled"},sg={class:"am-caes__service-content__text"},lg={class:"am-caes__service-content__text"},ng={class:"am-caes__service-content__inner am-caes__service-content__disabled"},ig={class:"am-caes__service-content__text"},og={class:"am-caes__service__week-days"},rg={class:"am-caes__service__week-periods"},cg={class:"am-caes__service__week-periods-item-range"},ug=ce(" - "),dg={class:"am-caes__service__date"},mg=m("span",{class:"am-icon-calendar"},null,-1),pg={class:"am-caes__service__week-periods"},gg={class:"am-caes__service__week-periods-item-range"},fg=ce(" - "),hg={name:"CabinetEmployeeProfileServices"},vg=Object.assign(hg,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=R("licence"),s=Ne(),l=R("amLabels"),i=M(""),o={components:{IconComponent:We},template:'<IconComponent icon="search"/>'},r=M([{label:"Mon",labelFull:"Monday",value:0},{label:"Tue",labelFull:"Tuesday",value:1},{label:"Wed",labelFull:"Wednesday",value:2},{label:"Thu",labelFull:"Thursday",value:3},{label:"Fri",labelFull:"Friday",value:4},{label:"Sat",labelFull:"Saturday",value:5},{label:"Sun",labelFull:"Sunday",value:6}]),u=M({}),d=v(()=>s.getters["employee/getEmployee"]),f=v(()=>s.getters["entities/getCategories"].filter(L=>L.status==="visible"&&L.serviceList.length>0&&(!i.value.trim()||L.serviceList.filter($=>$.name.toLowerCase().includes(i.value.toLowerCase().trim())).length))),_=M(f.value.length===1?"category_"+f.value[0].id:null),g=M(0);function C(L){const $=L.serviceList.filter(h=>d.value.serviceList[L.id][h.id].enabled);return $.length>0&&$.length<L.serviceList.length}function O(L){const $=L.serviceList.filter(h=>d.value.serviceList[L.id][h.id].enabled);u.value[L.id]=$.length!==0}function I(L,$){$.serviceList.forEach(h=>{s.commit("employee/setServiceEnabled",{categoryId:$.id,serviceId:h.id,value:L})})}Je(()=>{Rs&&(r.value=r.value.map((L,$)=>({...L,label:ko[$],labelFull:Co[$]}))),f.value.forEach(L=>{u.value[L.id]=L.serviceList.filter($=>d.value.serviceList[L.id][$.id].enabled).length!==0})});let b=R("amColors"),P=v(()=>({"--am-c-caes-primary":b.value.colorPrimary,"--am-c-caes-primary-op03":H(b.value.colorPrimary,.3),"--am-c-caes-text":b.value.colorMainText,"--am-c-caes-text-op03":H(b.value.colorMainText,.03),"--am-c-caes-text-op50":H(b.value.colorMainText,.5),"--am-c-caes-inp-bgr-op03":H(b.value.colorInpBgr,.03),"--am-c-caes-border":b.value.colorInpBorder}));return(L,$)=>{const h=va,S=_a,E=bs,T=ks;return c(),y("div",null,[m("div",null,[A(it,{modelValue:t(i),"onUpdate:modelValue":$[0]||($[0]=w=>we(i)?i.value=w:i=w),"prefix-icon":t(o),"aria-label":"Search"},null,8,["modelValue","prefix-icon"])]),A(T,{modelValue:t(_),"onUpdate:modelValue":$[2]||($[2]=w=>we(_)?_.value=w:_=w),class:"am-caes",style:Ce(t(P))},{default:x(()=>[(c(!0),y(ee,null,fe(t(f),w=>(c(),U(E,{key:"category_"+w.id,name:"category_"+w.id,class:"am-caes__category"},{title:x(()=>[m("div",Yp,[A(mt,{modelValue:t(u)[w.id],"onUpdate:modelValue":B=>t(u)[w.id]=B,indeterminate:C(w),onClick:B=>{B.stopPropagation(),we(_)?_.value=`category_${w.id}`:_=`category_${w.id}`},onChange:B=>I(B,w),onKeydown:Di(B=>{B.stopPropagation(),we(_)?_.value=`category_${w.id}`:_=`category_${w.id}`,t(u)[w.id]=!t(u)[w.id],I(t(u)[w.id],w)},["enter"])},null,8,["modelValue","onUpdate:modelValue","indeterminate","onClick","onChange","onKeydown"]),m("div",Wp,k(w.name),1)])]),default:x(()=>[A(T,{modelValue:t(g),"onUpdate:modelValue":$[1]||($[1]=B=>we(g)?g.value=B:g=B),class:"am-caes__inner"},{default:x(()=>[(c(!0),y(ee,null,fe(t(f).find(B=>B.id===w.id).serviceList.filter(B=>!t(i).trim()||B.name.toLowerCase().includes(t(i).toLowerCase())),B=>(c(),U(E,{key:`service_${B.id}`,name:`service_${B.id}`,class:"am-caes__service"},{title:x(()=>[m("div",Hp,[A(mt,{modelValue:t(d).serviceList[w.id][B.id].enabled,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].enabled=z,onClick:z=>{z.stopPropagation(),we(g)?g.value=`service_${B.id}`:g=`service_${B.id}`},onChange:z=>O(w),onKeydown:Di(z=>{z.stopPropagation(),we(g)?g.value=`service_${B.id}`:g=`service_${B.id}`,t(d).serviceList[w.id][B.id].enabled=!t(d).serviceList[w.id][B.id].enabled,O(w)},["enter"])},null,8,["modelValue","onUpdate:modelValue","onClick","onChange","onKeydown"]),m("div",Zp,k(B.name),1)])]),default:x(()=>[m("div",Gp,[m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",Jp,k(t(l).minimum_capacity),1),A(ht,{modelValue:t(d).serviceList[w.id][B.id].minCapacity,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].minCapacity=z,class:"am-caes__service-content__inner",min:1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])],2),m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",Xp,k(t(l).maximum_capacity),1),A(ht,{modelValue:t(d).serviceList[w.id][B.id].maxCapacity,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].maxCapacity=z,class:"am-caes__service-content__inner",min:t(d).serviceList[w.id][B.id].minCapacity,size:"small","aria-label":t(l).maximum_capacity},null,8,["modelValue","onUpdate:modelValue","min","aria-label"])],2),(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.enabled==="duration"?t(d).serviceList[w.id][B.id].customPricing.durations:[],(z,N)=>(c(),y(ee,{key:N},[t(d).serviceList[w.id][B.id].customPricing.enabled==="duration"?(c(),y("div",{key:0,class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",Qp,k(t(l).duration),1),m("div",Kp,k(t(hs)(N,t(l).h,t(l).min)),1)],2)):D("",!0),m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",eg,k(t(l).price),1),A(it,{modelValue:z.price,"onUpdate:modelValue":G=>z.price=G,class:"am-caes__service-content__inner",placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)],64))),128)),t(d).serviceList[w.id][B.id].customPricing.enabled==="period"||t(d).serviceList[w.id][B.id].customPricing.enabled===null?(c(),y("div",{key:0,class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",tg,k(t(l).duration),1),m("div",ag,k(t(hs)(B.duration,t(l).h,t(l).min)),1)],2)):D("",!0),t(d).serviceList[w.id][B.id].customPricing.enabled==="period"||t(d).serviceList[w.id][B.id].customPricing.enabled===null?(c(),y("div",{key:1,class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",sg,k(t(l).price),1),A(it,{modelValue:t(d).serviceList[w.id][B.id].price,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].price=z,class:"am-caes__service-content__inner",placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)):D("",!0),(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.enabled==="person"?t(d).serviceList[w.id][B.id].customPricing.persons:[],(z,N)=>(c(),y(ee,{key:N},[m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",lg,k(t(l).capacity),1),m("div",ng,k(z.from)+" - "+k(N),1)],2),m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",ig,k(t(l).price),1),A(it,{modelValue:z.price,"onUpdate:modelValue":G=>z.price=G,class:"am-caes__service-content__inner",placeholder:"",size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue"])],2)],64))),128))]),t(d).serviceList[w.id][B.id].customPricing.enabled==="period"&&!t(e).isLite&&!t(e).isStarter&&!t(e).isBasic?(c(),U(S,{key:0,class:"am-caes__service-tabs",stretch:!0},{default:x(()=>[t(d).serviceList[w.id][B.id].customPricing.periods.default.length?(c(),U(h,{key:0,label:t(l).week_days},{default:x(()=>[(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.periods.default,(z,N)=>(c(),y("div",{key:N,class:"am-caes__service__week"},[m("div",og,[(c(!0),y(ee,null,fe(t(r),(G,se)=>(c(),y("div",{key:se,class:q(["am-caes__service__week-day",{"am-caes__service__week-day-selected":z.days.indexOf(G.value)!==-1}])},[m("span",null,k(G.label),1)],2))),128))]),m("div",rg,[(c(!0),y(ee,null,fe(z.ranges,(G,se)=>(c(),y("div",{key:se,class:"am-caes__service__week-periods-item"},[m("div",cg,[m("span",null,k(G.from),1),ug,m("span",null,k(G.to),1)]),m("div",{class:q([a.responsiveClass,"am-caes__service__week-periods-item-price"])},[A(it,{modelValue:G.price,"onUpdate:modelValue":j=>G.price=j,placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)]))),128))])]))),128))]),_:2},1032,["label"])):D("",!0),t(d).serviceList[w.id][B.id].customPricing.periods.custom.length?(c(),U(h,{key:1,label:t(l).custom_days},{default:x(()=>[(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.periods.custom,(z,N)=>(c(),y("div",{key:N,class:"am-caes__service__week"},[m("div",dg,[mg,ce(k(t(nt)(z.dates.start))+" - "+k(t(nt)(z.dates.end)),1)]),m("div",pg,[(c(!0),y(ee,null,fe(z.ranges,(G,se)=>(c(),y("div",{key:se,class:"am-caes__service__week-periods-item"},[m("div",gg,[m("span",null,k(G.from),1),fg,m("span",null,k(G.to),1)]),m("div",{class:q([a.responsiveClass,"am-caes__service__week-periods-item-price"])},[A(it,{modelValue:G.price,"onUpdate:modelValue":j=>G.price=j,placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)]))),128))])]))),128))]),_:2},1032,["label"])):D("",!0)]),_:2},1024)):D("",!0)]),_:2},1032,["name"]))),128))]),_:2},1032,["modelValue"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])])}}});const La={props:{modelValue:{type:String},id:{type:String,default:""},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},includeEndTime:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},placeholder:{type:String,default:""},name:{type:String},effect:{type:String,default:"light",validator(n){return["dark","light"].includes(n)}},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="clock"/>'})},suffixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="arrow-up"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="close"/>'})},start:{type:String,default:""},end:{type:String,default:""},step:{type:String,default:""},minTime:{type:String,default:""},maxTime:{type:String,default:""},format:{type:String,default:"HH:mm"},popperClass:{type:String,default:""},class:{type:String,default:""},parentClass:{type:String,default:""}},emits:["update:modelValue"],setup(n,{emit:a}){const e=n,{modelValue:s}=li(e),l=v({get:()=>s.value,set:d=>{a("update:modelValue",d)}}),i=M(null);let o=R("amFonts",M({fontFamily:"Amelia Roboto, sans-serif",fontUrl:"",customFontFamily:"",fontFormat:"",customFontSelected:!1})),r=R("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),u=v(()=>({"--am-c-timeselect-shadow":H(r.value.colorInpText,.05),"--am-c-timeselect-text-op60":H(r.value.colorInpText,.6),"--am-c-timeselect-text-op40":H(r.value.colorInpText,.4),"--am-c-timeselect-text-op10":H(r.value.colorInpText,.03),"--am-font-family":o.value.fontFamily}));return Je(()=>{const d=document.querySelector("[id^='el-popper-container']");d.style.setProperty("--am-c-option-bgr",r.value.colorDropBgr),d.style.setProperty("--am-c-option-border",r.value.colorDropBorder),d.style.setProperty("--am-c-option-text",r.value.colorDropText),d.style.setProperty("--am-c-option-text-op65",H(r.value.colorDropText,.65)),d.style.setProperty("--am-c-option-text-op50",H(r.value.colorDropText,.5)),d.style.setProperty("--am-c-option-hover",H(r.value.colorDropText,.1)),d.style.setProperty("--am-c-option-selected",r.value.colorPrimary),d.style.setProperty("--am-c-option-selected-op10",H(r.value.colorPrimary,.1)),d.style.setProperty("--am-c-option-img-bgr",r.value.colorSuccess),d.style.setProperty("--am-c-option-img-text",r.value.colorMainBgr),d.style.setProperty("--am-font-family",o.value.fontFamily)}),(d,f)=>{const _=zr;return c(),y("div",{class:q(["am-time-select__wrapper",n.parentClass]),style:Ce(t(u))},[A(_,{id:e.id,ref_key:"amTimeSelect",ref:i,modelValue:t(l),"onUpdate:modelValue":f[0]||(f[0]=g=>we(l)?l.value=g:null),class:q(["am-time-select",[`am-time-select--${n.size}`,{"am-time-select--disabled":n.disabled},{"am-time-select--prefix":e.prefixIcon},{"am-time-select--suffix":e.suffixIcon||e.clearIcon&&d.pross.clearable},e.class]]),disabled:e.disabled,placeholder:e.placeholder,"clear-icon":e.clearIcon,clearable:e.clearable,editable:e.editable,name:e.name,"popper-class":`am-time-select__popper${e.popperClass?" "+e.popperClass:e.popperClass}`,"prefix-icon":e.prefixIcon,"suffix-icon":e.suffixIcon,end:e.end,"max-time":e.maxTime,"min-time":e.minTime,start:e.start,step:e.step,format:e.format,"include-end-time":e.includeEndTime,effect:e.effect},null,8,["id","modelValue","class","disabled","placeholder","clear-icon","clearable","editable","name","popper-class","prefix-icon","suffix-icon","end","max-time","min-time","start","step","format","include-end-time","effect"])],6)}}};const _g={class:"am-csd__period-header"},yg={class:"am-csd__period-content__inner"},bg=m("span",{class:"am-icon-clearable"},null,-1),kg={name:"WorkPeriod"},Cg=Object.assign(kg,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},periodIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:a}){const e=n;let s=Ne();const l=R("settings");let i=R("amLabels"),o=R("pageWidth"),r=M(null),u=v(()=>e.visibility);const{width:d}=ja(r),f=v(()=>st(d.value));rt(u,ne=>{ne&&setTimeout(()=>{I.value=JSON.parse(JSON.stringify(E.value[e.periodIndex]))},300)});let _=M(!1),g=M(null),C=M("");function O(){_.value=!1,C.value=""}let I=M(null),b=M({startTime:v({get:()=>T.value.startTime,set:ne=>{T.value.startTime=ne}}),endTime:v({get:()=>T.value.endTime,set:ne=>{T.value.endTime=ne}}),periodServiceList:v({get:()=>T.value.periodServiceList,set:ne=>{T.value.periodServiceList=ne}}),periodLocationList:v({get:()=>T.value.periodLocationList,set:ne=>{T.value.periodLocationList=ne}})}),P=M(null),L=v(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),$=M();Be("formWrapper",$);let h=M(s.getters["entities/getLocations"]),S=v(()=>{let ne=xo(s),te=T.value.periodServiceList.filter(oe=>ne.map(ie=>ie.id).indexOf(oe)===-1);return ne.concat(s.getters["entities/getServices"].filter(oe=>te.indexOf(oe.id)!==-1))}),E=v(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].periodList),T=v(()=>e.periodIndex!==null?E.value[e.periodIndex]:null);function w(ne){return Dt(Bt(ne)-l.general.timeSlotLength)}function B(ne){let te=Dt(Bt(ne)+l.general.timeSlotLength);return te==="00:00"?null:te}function z(){P.value.validate(ne=>{ne&&a("close")})}function N(){e.isNew?E.value.pop():E.value[e.periodIndex]=I.value,a("close")}let G=R("amFonts"),se=R("amColors"),j=v(()=>({"--am-c-csd-text":se.value.colorMainText,"--am-c-csd-bgr":se.value.colorMainBgr,"--am-c-csd-text-op10":H(se.value.colorMainText,.1),"--am-c-scroll-op30":H(se.value.colorPrimary,.3),"--am-c-scroll-op10":H(se.value.colorPrimary,.1),"--am-font-family":G.value.fontFamily}));return(ne,te)=>{const oe=yt,ie=et;return c(),U(za,{visibility:t(e).visibility,style:Ce(t(j)),"custom-class":`am-csd am-csd__period${t(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":N},wo({footer:x(()=>[m("div",{class:q(["am-csd__period-footer",t(f)])},[A(Ee,{category:"secondary",type:"plain",size:t(o)>430?"default":"small",onClick:N},{default:x(()=>[ce(k(t(i).cancel),1)]),_:1},8,["size"]),A(Ee,{size:t(o)>430?"default":"small",onClick:z},{default:x(()=>[ce(k(t(i).save),1)]),_:1},8,["size"])],2)]),default:x(()=>[t(T)?(c(),y("div",{key:0,ref_key:"popupPeriodRef",ref:r,class:"am-csd__period-content"},[m("div",yg,[t(_)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:O,onTriggerClose:O},{title:x(()=>[bg,ce(" "+k(t(C)),1)]),_:1},512)):D("",!0),A(ie,{ref_key:"periodFormRef",ref:P,class:"am-csd__period-form",rules:t(L),model:t(b),"label-position":"top"},{default:x(()=>[A(oe,{label:`${t(i).time}:`,prop:"startTime",class:q(["am-csd__period-form__item am-w-50",t(f)])},{default:x(()=>[A(La,{modelValue:t(T).startTime,"onUpdate:modelValue":te[0]||(te[0]=K=>t(T).startTime=K),placeholder:t(i).from,start:"00:00",end:w("24:00"),"min-time":t(e).periodIndex===0?null:w(t(E)[t(e).periodIndex-1].endTime),"max-time":t(e).periodIndex===t(E).length-1?null:t(T).endTime,step:t(Dt)(t(l).general.timeSlotLength)},null,8,["modelValue","placeholder","end","min-time","max-time","step"])]),_:1},8,["label","class"]),A(oe,{label:`${t(i).time}:`,prop:"endTime",class:q(["am-csd__period-form__item am-w-50",t(f)])},{default:x(()=>[A(La,{modelValue:t(T).endTime,"onUpdate:modelValue":te[1]||(te[1]=K=>t(T).endTime=K),placeholder:t(i).to_upper,disabled:!t(T).startTime,start:B("00:00"),end:"24:00","min-time":t(T).startTime,"max-time":t(e).periodIndex===t(E).length-1?null:B(t(E)[t(e).periodIndex+1].startTime),step:t(Dt)(t(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","min-time","max-time","step"])]),_:1},8,["label","class"]),A(oe,{label:`${t(i).heading_services}:`,prop:"periodServiceList",class:"am-csd__period-form__item"},{default:x(()=>[A(He,{modelValue:t(T).periodServiceList,"onUpdate:modelValue":te[2]||(te[2]=K=>t(T).periodServiceList=K),placeholder:`${t(i).all_services}`,multiple:"",clearable:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(S),K=>(c(),U(qe,{key:K.id,value:K.id,label:K.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(h).length>0?(c(),U(oe,{key:0,label:`${t(i).location}:`,prop:"periodLocationList",class:"am-csd__period-form__item"},{default:x(()=>[A(He,{modelValue:t(T).periodLocationList,"onUpdate:modelValue":te[3]||(te[3]=K=>t(T).periodLocationList=K),placeholder:`${t(i).all_locations}`,multiple:"",clearable:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(h),K=>(c(),U(qe,{key:K.id,value:K.id,label:K.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0)]),_:1},8,["rules","model"])])],512)):D("",!0)]),_:2},[t(e).title?{name:"header",fn:x(()=>[m("div",_g,k(t(e).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const xg={class:"am-csd__timeOut-header"},wg={class:"am-csd__timeOut-content__inner"},Tg=m("span",{class:"am-icon-clearable"},null,-1),Eg={name:"WorkTimeOut"},Lg=Object.assign(Eg,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},timeOutIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:a}){const e=n;let s=Ne();const l=R("settings");let i=R("amLabels"),o=R("pageWidth"),r=M(null),u=v(()=>e.visibility);const{width:d}=ja(r),f=v(()=>st(d.value));rt(u,j=>{j&&setTimeout(()=>{I.value=JSON.parse(JSON.stringify(h.value[e.timeOutIndex]))},300)});let _=M(!1),g=M(null),C=M("");function O(){_.value=!1,C.value=""}let I=M(null),b=M({startTime:v({get:()=>E.value.startTime,set:j=>{E.value.startTime=j}}),endTime:v({get:()=>E.value.endTime,set:j=>{E.value.endTime=j}})}),P=M(null),L=v(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),$=M();Be("formWrapper",$);let h=v(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].timeOutList),S=v(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].periodList),E=v(()=>e.timeOutIndex!==null?h.value[e.timeOutIndex]:null);v(()=>S.value.length?w(S.value[0].startTime):"00:00"),v(()=>S.value.length?T(S.value[S.value.length-1].endTime):"00:00");function T(j){return Dt(Bt(j)-l.general.timeSlotLength)}function w(j){let ne=Dt(Bt(j)+l.general.timeSlotLength);return ne==="00:00"?null:ne}function B(){P.value.validate(j=>{j&&a("close")})}function z(){e.isNew?h.value.pop():h.value[e.timeOutIndex]=I.value,a("close")}let N=R("amFonts"),G=R("amColors"),se=v(()=>({"--am-c-csd-text":G.value.colorMainText,"--am-c-csd-bgr":G.value.colorMainBgr,"--am-c-csd-text-op10":H(G.value.colorMainText,.1),"--am-c-scroll-op30":H(G.value.colorPrimary,.3),"--am-c-scroll-op10":H(G.value.colorPrimary,.1),"--am-font-family":N.value.fontFamily}));return(j,ne)=>{const te=yt,oe=et;return c(),U(za,{visibility:t(e).visibility,style:Ce(t(se)),"custom-class":`am-csd am-csd__timeOut${t(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":z},wo({footer:x(()=>[m("div",{class:q(["am-csd__timeOut-footer",t(f)])},[A(Ee,{category:"secondary",type:"plain",size:t(o)>430?"default":"small",onClick:z},{default:x(()=>[ce(k(t(i).cancel),1)]),_:1},8,["size"]),A(Ee,{size:t(o)>430?"default":"small",onClick:B},{default:x(()=>[ce(k(t(i).save),1)]),_:1},8,["size"])],2)]),default:x(()=>[t(E)?(c(),y("div",{key:0,ref_key:"popupTimeOutRef",ref:r,class:"am-csd__timeOut-content"},[m("div",wg,[t(_)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:O,onTriggerClose:O},{title:x(()=>[Tg,ce(" "+k(t(C)),1)]),_:1},512)):D("",!0),A(oe,{ref_key:"timeOutFormRef",ref:P,class:"am-csd__timeOut-form",rules:t(L),model:t(b),"label-position":"top"},{default:x(()=>[A(te,{label:`${t(i).time}:`,prop:"startTime",class:q(["am-csd__timeOut-form__item am-w-50",t(f)])},{default:x(()=>[A(La,{modelValue:t(E).startTime,"onUpdate:modelValue":ne[0]||(ne[0]=ie=>t(E).startTime=ie),placeholder:t(i).from,start:w(t(S)[0].startTime),end:T(t(S)[t(S).length-1].endTime),step:t(Dt)(t(l).general.timeSlotLength),"max-time":t(h)[t(e).timeOutIndex].endTime},null,8,["modelValue","placeholder","start","end","step","max-time"])]),_:1},8,["label","class"]),A(te,{label:`${t(i).time}:`,prop:"endTime",class:q(["am-csd__timeOut-form__item am-w-50",t(f)])},{default:x(()=>[A(La,{modelValue:t(E).endTime,"onUpdate:modelValue":ne[1]||(ne[1]=ie=>t(E).endTime=ie),placeholder:t(i).to_upper,disabled:!t(E).startTime,start:w(t(S)[0].startTime),end:T(t(S)[t(S).length-1].endTime),"min-time":t(h)[t(e).timeOutIndex].startTime,step:t(Dt)(t(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","end","min-time","step"])]),_:1},8,["label","class"])]),_:1},8,["rules","model"])])],512)):D("",!0)]),_:2},[t(e).title?{name:"header",fn:x(()=>[m("div",xg,k(t(e).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const Sg={class:"am-cc__edit"},Ag=m("span",{class:"am-icon-edit"},null,-1),Ig={class:"am-cc__edit-text"},Pg=m("span",{class:"am-icon-search"},null,-1),$g={class:"am-cc__edit-text"},Ng=m("span",{class:"am-icon-clearable"},null,-1),Dg={class:"am-cc__edit-text"},Og=m("span",{class:"am-icon-clearable"},null,-1),Fg={class:"am-cc__edit-text"},Mg={name:"DotsPopup"},ha=Object.assign(Mg,{props:{index:{type:Number,default:0},referenceClass:{type:String,default:""},haveDuplicate:{type:Boolean,default:!1},haveDelete:{type:Boolean,default:!0},haveEdit:{type:Boolean,default:!0},haveView:{type:Boolean,default:!1}},emits:["remove","edit","duplicate"],setup(n,{emit:a}){const e=n;let s=R("amLabels"),l=M(!1);function i(){l.value=!0}function o(){a("edit",e.index),d()}function r(){a("remove",e.index),d()}function u(){a("duplicate",e.index),d()}function d(){l.value=!1}let f=R("amFonts"),_=R("amColors"),g=v(()=>({"--am-c-cc-error":_.value.colorError,"--am-c-cc-error-op15":H(_.value.colorError,.15),"--am-c-cc-bgr":_.value.colorMainBgr,"--am-c-cc-text":_.value.colorMainText,"--am-c-cc-text-op10":H(_.value.colorMainText,.1),"--am-c-cc-text-op15":H(_.value.colorMainText,.15),"--am-font-family":f.value.fontFamily}));return(C,O)=>{const I=Gs;return c(),U(I,{ref:"editRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[m("span",{class:q(["am-cc__edit-btn am-icon-dots-vertical",t(e).referenceClass]),onClick:i},null,2)]),default:x(()=>[zt((c(),y("div",Sg,[t(e).haveEdit?(c(),y("div",{key:0,class:"am-cc__edit-item",onClick:o},[Ag,m("span",Ig,k(t(s).edit),1)])):D("",!0),t(e).haveView?(c(),y("div",{key:1,class:"am-cc__edit-item",onClick:o},[Pg,m("span",$g,k(t(s).view),1)])):D("",!0),t(e).haveDelete?(c(),y("div",{key:2,class:"am-cc__edit-item am-delete",onClick:r},[Ng,m("span",Dg,k(t(s).delete),1)])):D("",!0),t(e).haveDuplicate?(c(),y("div",{key:3,class:"am-cc__edit-item am-clone",onClick:u},[Og,m("span",Fg,k(t(s).duplicate),1)])):D("",!0)])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])}}});const Vg={class:"am-caeper__heading-item am-w-20"},Bg={class:"am-caeper__heading-item am-w-40"},Rg={class:"am-caeper__heading-item am-w-40"},qg={key:1},Ug={class:"am-caeper__heading-item am-w-20"},zg={key:0,class:"am-caeper__error"},jg={name:"WorkPeriods"},pr=Object.assign(jg,{props:{title:{type:String,default:""},type:{type:String,default:""},index:{type:Number,default:0},enabled:{type:Boolean,default:!1},headerVisible:{type:Boolean,default:!0},applyToAllDaysVisible:{type:Boolean,default:!0},footerVisible:{type:Boolean,default:!0},editVisible:{type:Boolean,default:!0},error:{type:String,default:""},responsiveClass:{type:String,default:""}},emits:["addPeriod"],setup(n,{emit:a}){const e=n;let s=Ne(),l=R("amLabels"),i=v(()=>s.getters["entities/getLocations"]),o=v(()=>s.getters["entities/getServices"]),r=v(()=>xo(s)),u=v(()=>{let L=s.getters["employee/getEmployee"];switch(e.type){case"weekDayList":return L.weekDayList[e.index].periodList;case"specialDayList":return L.specialDayList[e.index].periodList}return[]}),d=v(()=>{let L=s.getters["employee/getEmployee"];return e.type==="weekDayList"?L.weekDayList[e.index].timeOutList:[]}),f=M(null),_=M(null),g=M(null);function C(){u.value.push({id:null,locationId:null,startTime:"",endTime:"",periodLocationList:[],periodServiceList:[],editing:!0}),g.value=!0,f.value=u.value.length-1,a("addPeriod")}function O(){let L=[];s.getters["employee/getEmployee"].weekDayList[e.index].periodList.forEach($=>{L.push({id:null,locationId:null,startTime:$.startTime,endTime:$.endTime,periodLocationList:[...$.periodLocationList],periodServiceList:[...$.periodServiceList],editing:!1})}),s.getters["employee/getEmployee"].weekDayList.forEach(($,h)=>{h!==e.index&&($.periodList=JSON.parse(JSON.stringify(L)))})}function I(){return!u.value.length||!u.value.filter(L=>L.startTime&&L.endTime).length||u.value[u.value.length-1].endTime!=="00:00"}let b=R("amColors"),P=v(()=>({"--am-c-caeper-bgr":b.value.colorMainBgr,"--am-c-caeper-text":b.value.colorMainText,"--am-c-caeper-text-op80":H(b.value.colorMainText,.8)}));return(L,$)=>zt((c(),y("div",{class:"am-caeper",style:Ce(t(P))},[t(e).headerVisible&&t(u).length?(c(),y("div",{key:0,class:q(["am-caeper__heading",t(e).responsiveClass])},[m("div",Vg,k(t(l).time),1),m("div",Bg,k(t(l).service_colon),1),m("div",Rg,k(t(l).location),1)],2)):D("",!0),(c(!0),y(ee,null,fe(t(u),(h,S)=>(c(),y("div",{key:S,class:"am-caeper__content"},[m("div",{class:q(["am-caeper__content-item am-w-20",t(e).responsiveClass])},k(h.startTime?h.startTime.substring(0,5):"")+" - "+k(h.endTime?h.endTime.substring(0,5):""),3),m("div",{class:q(["am-caeper__content-item am-w-40",[t(e).responsiveClass,{"am-cabinet-empty":!h.periodServiceList.length}]])},k(h.periodServiceList.filter(E=>t(r).map(T=>T.id).indexOf(E)!==-1).map(E=>t(o).find(T=>T.id===E).name).join(", ")),3),m("div",{class:q(["am-caeper__content-item am-w-40",[t(e).responsiveClass,{"am-cabinet-empty":!h.periodLocationList.length}]])},k(h.periodLocationList.map(E=>t(i).find(T=>T.id===E).name).join(", ")),3),t(e).editVisible?(c(),U(ha,{key:0,index:S,onRemove:E=>t(u).splice(S,1),onEdit:E=>we(f)?f.value=S:f=S},null,8,["index","onRemove","onEdit"])):D("",!0)]))),128)),t(d).length?(c(),y("span",qg,k(t(l).breaks),1)):D("",!0),t(e).headerVisible&&t(d).length?(c(),y("div",{key:2,class:q(["am-caeper__heading",t(e).responsiveClass])},[m("div",Ug,k(t(l).time),1)],2)):D("",!0),(c(!0),y(ee,null,fe(t(d),(h,S)=>(c(),y("div",{key:S,class:"am-caeper__content"},[m("div",{class:q(["am-caeper__content-item am-w-20",t(e).responsiveClass])},k(h.startTime?h.startTime.substring(0,5):"")+" - "+k(h.endTime?h.endTime.substring(0,5):""),3),t(e).editVisible?(c(),U(ha,{key:0,index:S,onRemove:E=>t(d).splice(S,1),onEdit:E=>we(_)?_.value=S:_=S},null,8,["index","onRemove","onEdit"])):D("",!0)]))),128)),t(e).footerVisible?(c(),y("div",{key:3,class:q(["am-caeper__footer",[{"am-error":t(e).error},t(e).responsiveClass]])},[t(e).error?(c(),y("div",zg,k(t(e).error),1)):D("",!0),I()?(c(),U(Ee,{key:1,prefix:"plus",size:"small",onClick:$[0]||($[0]=h=>C())},{default:x(()=>[ce(k(t(l).add_period),1)]),_:1})):D("",!0),t(e).applyToAllDaysVisible?(c(),U(Ee,{key:2,size:"small",category:"secondary",type:"plain",onClick:O},{default:x(()=>[ce(k(t(l).apply_to_all_days),1)]),_:1})):D("",!0)],2)):D("",!0),A(Cg,{title:t(e).title,visibility:t(f)!==null,origin:t(e).type,"period-index":t(f),"origin-index":n.index,"is-new":t(g),onClose:$[1]||($[1]=()=>{we(f)?f.value=null:f=null,we(g)?g.value=null:g=null})},null,8,["title","visibility","origin","period-index","origin-index","is-new"]),A(Lg,{title:t(l).break_hours,visibility:t(_)!==null,origin:t(e).type,"time-out-index":t(_),"origin-index":n.index,"is-new":!1,"is-break":!0,onClose:$[2]||($[2]=()=>{we(_)?_.value=null:_=null})},null,8,["title","visibility","origin","time-out-index","origin-index"])],4)),[[To,t(e).enabled]])}});const Yg={class:"am-caewh__header"},Wg={class:"am-caewh__header-text"},Hg={class:"am-caewh__content"},Zg={name:"WeekDays"},Gg=Object.assign(Zg,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=Ne(),s=R("amLabels"),l=v(()=>e.getters["employee/getEmployee"]),i=M([{label:s.weekday_monday,value:"monday"},{label:s.weekday_tuesday,value:"tuesday"},{label:s.weekday_wednesday,value:"wednesday"},{label:s.weekday_thursday,value:"thursday"},{label:s.weekday_friday,value:"friday"},{label:s.weekday_saturday,value:"saturday"},{label:s.weekday_sunday,value:"sunday"}]),o=R("amColors"),r=v(()=>({"--am-c-caewh-primary":o.value.colorPrimary,"--am-c-caewh-bgr":o.value.colorMainBgr,"--am-c-caewh-text":o.value.colorMainText,"--am-c-caewh-text-op03":H(o.value.colorMainText,.03),"--am-c-caewh-bgr-op03":H(o.value.colorInpBgr,.03)}));return(u,d)=>(c(),y("div",{class:"am-caewh",style:Ce(t(r))},[(c(!0),y(ee,null,fe(t(l).weekDayList,(f,_)=>(c(),y("div",{key:_,class:"am-caewh__item"},[m("div",Yg,[m("div",Wg,k(t(i)[_].label),1),A(lt,{modelValue:f.enabled,"onUpdate:modelValue":g=>f.enabled=g,size:"small","aria-label":t(i)[_].label},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),m("div",Hg,[A(pr,{title:t(s).working_hours,enabled:f.enabled,index:_,type:"weekDayList","responsive-class":t(a).responsiveClass},null,8,["title","enabled","index","responsive-class"])])]))),128))],4))}});const Jg={class:"am-caesd__item"},Xg={class:"am-caesd__item-header"},Qg={key:2},Kg={key:0,class:"am-caesd__footer"},ef={name:"SpecialDays"},tf=Object.assign(ef,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=Ne(),s=R("amLabels"),l=R("localLanguage"),i=v(()=>e.getters["employee/getEmployee"].specialDayList),o=Qe({data:null,index:null}),r=M({range:v({get:()=>e.getters["employee/getEmployee"].specialDayList[o.index].range,set:h=>{e.getters["employee/getEmployee"].specialDayList[o.index].range=h}})}),u=M([]),d=v(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}]}));function f(h){i.value.splice(h,1)}function _(h){o.index=h,o.data=JSON.parse(JSON.stringify(i.value[h]))}function g(h){let S=[];i.value[h].periodList.forEach(E=>{S.push({id:null,locationId:null,startTime:E.startTime,endTime:E.endTime,periodLocationList:[...E.periodLocationList],periodServiceList:[...E.periodServiceList],editing:!1})}),e.getters["employee/getEmployee"].specialDayList.push({id:null,range:[],periodList:S}),o.index=i.value.length-1,o.data={}}let C=M("");function O(h){let S=e.getters["employee/getEmployee"].specialDayList[h].periodList;u.value[h].validate(E=>{E&&S.length>0?(C.value="",o.index=null,o.data=null):C.value="Please add period to special day"})}function I(h){Object.keys(o.data).length===0?i.value.pop():i.value[h]=o.data,o.index=null,o.data=null,C.value=""}function b(){i.value.push({id:null,range:[],periodList:[]}),o.index=i.value.length-1,o.data={}}function P(h,S){h?u.value[S]=h:u.value.splice(S,1)}let L=R("amColors"),$=v(()=>({"--am-c-caesd-bgr":L.value.colorMainBgr,"--am-c-caesd-text":L.value.colorMainText,"--am-c-caesd-text-op03":H(L.value.colorMainText,.03),"--am-c-caesd-text-op80":H(L.value.colorMainText,.8)}));return(h,S)=>{const E=yt,T=et;return c(),y("div",{class:"am-caesd",style:Ce(t($))},[(c(!0),y(ee,null,fe(t(i),(w,B)=>(c(),y("div",{key:B,class:"am-caesd__content"},[m("div",Jg,[m("div",Xg,[t(o).index!==B?(c(),y(ee,{key:0},[m("div",null,k(w.range[0]?t(nt)(t(ye)(w.range[0]).format("YYYY-MM-DD")):"")+" - "+k(w.range[1]?t(nt)(t(ye)(w.range[1]).format("YYYY-MM-DD")):""),1),A(ha,{index:B,"have-duplicate":!0,onRemove:z=>f(B),onEdit:z=>_(B),onDuplicate:z=>g(B)},null,8,["index","onRemove","onEdit","onDuplicate"])],64)):D("",!0),t(o).index===B?(c(),U(T,{key:1,ref_for:!0,ref:z=>P(z,B),class:"am-caesd__form",rules:t(d),model:t(r),"label-position":"top"},{default:x(()=>[A(E,{prop:"range"},{default:x(()=>[A(Yt,{modelValue:t(r).range,"onUpdate:modelValue":S[0]||(S[0]=z=>t(r).range=z),type:"daterange",size:"small","popper-class":"am-cap__datepicker-popper","prefix-icon":Ge({components:{IconComponent:We},template:"<IconComponent icon='calendar'/>"}),format:t(jt)(),placeholder:t(s).select_date,lang:t(l)},null,8,["modelValue","prefix-icon","format","placeholder","lang"])]),_:1})]),_:2},1032,["rules","model"])):D("",!0),t(C)?(c(),y("div",Qg)):D("",!0)]),m("div",{class:q(["am-caesd__item-inner",{"am-editable":t(o).index===B}])},[A(pr,{title:t(s).special_days,enabled:!0,index:B,type:"specialDayList","apply-to-all-days-visible":!1,"header-visible":t(o).index===B,"edit-visible":t(o).index===B,"footer-visible":t(o).index===B,error:t(o).index===B?t(C):"","responsive-class":t(a).responsiveClass,onAddPeriod:S[1]||(S[1]=()=>{we(C)?C.value="":C=""})},null,8,["title","index","header-visible","edit-visible","footer-visible","error","responsive-class"])],2)]),t(o).index===B?(c(),y("div",Kg,[A(Ee,{category:"secondary",type:"plain",size:"small",onClick:z=>I(B)},{default:x(()=>[ce(k(t(s).cancel),1)]),_:2},1032,["onClick"]),A(Ee,{size:"small",onClick:z=>O(B)},{default:x(()=>[ce(k(t(s).save),1)]),_:2},1032,["onClick"])])):D("",!0)]))),128)),t(i).length===0?(c(),U(Ia,{key:0,heading:t(s).no_special_days_yet},null,8,["heading"])):D("",!0),t(o).index===null?(c(),y("div",{key:1,class:q(t(i).length===0?"add-btn":"")},[A(Ee,{size:"small",onClick:S[2]||(S[2]=w=>b())},{default:x(()=>[ce(k(t(s).add_special_day),1)]),_:1})],2)):D("",!0)],4)}}});const af={key:0,class:"am-caedo__title_emp"},sf={class:"am-caedo__heading-item am-w-50"},lf={class:"am-caedo__heading-item am-w-30"},nf={class:"am-caedo__heading-item am-w-20"},of={class:"am-caedo__content-item"},rf={key:0,class:"am-caedo__wrapper"},cf={class:"am-caedo__footer"},uf={key:4,class:"am-caedo__title_global"},df={class:"am-caedo__heading-item am-w-50"},mf={class:"am-caedo__heading-item am-w-30"},pf={class:"am-caedo__heading-item am-w-20"},gf={class:"am-caedo__content-item"},ff={name:"DaysOff"},hf=Object.assign(ff,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=Ne(),s=R("amLabels"),l=R("localLanguage");const i=R("settings");let o=v(()=>e.getters["employee/getEmployee"].dayOffList),r=M([]),u=Qe({data:null,index:null}),d=M({range:v({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].range,set:S=>{e.getters["employee/getEmployee"].dayOffList[u.index].range=S}}),name:v({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].name,set:S=>{e.getters["employee/getEmployee"].dayOffList[u.index].name=S}}),repeat:v({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].repeat,set:S=>{e.getters["employee/getEmployee"].dayOffList[u.index].repeat=S}})}),f=M([]),_=v(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}],name:[{required:!0,message:s.days_off_name_warning,trigger:["submit","change"]}]}));function g(S){o.value.splice(S,1)}function C(S){u.index=S,u.data=JSON.parse(JSON.stringify(o.value[S]))}function O(S){f.value[S].validate(E=>{E&&(u.index=null,u.data=null)})}function I(S){Object.keys(u.data).length===0?o.value.pop():o.value[S]=u.data,u.index=null,u.data=null}function b(){o.value.push({id:null,name:"",repeat:!1,range:[]}),u.index=o.value.length-1,u.data={}}function P(S){let E=S.range[0]?nt(ye(S.range[0]).format("YYYY-MM-DD")):"",T=S.range[1]?nt(ye(S.range[1]).format("YYYY-MM-DD")):"";return`${E} - ${T}`}function L(S,E){S?f.value[E]=S:f.value.splice(E,1)}Je(()=>{r.value=i.daysOff.map(S=>new Object({range:[S.startDate,S.endDate],name:S.name,repeat:S.repeat}))});let $=R("amColors"),h=v(()=>({"--am-c-caedo-bgr":$.value.colorMainBgr,"--am-c-caedo-text":$.value.colorMainText,"--am-c-caedo-text-op80":H($.value.colorMainText,.8),"--am-c-caedo-text-op03":H($.value.colorMainText,.03)}));return(S,E)=>{const T=yt,w=et;return c(),y("div",{class:"am-caedo",style:Ce(t(h))},[t(r).length?(c(),y("span",af,k(t(s).employee_days_off),1)):D("",!0),t(o).length||t(r).length?(c(),y("div",{key:1,class:q(["am-caedo__heading",t(a).responsiveClass])},[m("div",sf,k(t(s).date),1),m("div",lf,k(t(s).name),1),m("div",nf,k(t(s).days_off_repeat_yearly),1)],2)):D("",!0),(c(!0),y(ee,null,fe(t(o),(B,z)=>(c(),y("div",{key:z,class:"am-caedo__content"},[m("div",of,[m("div",{class:q(["am-caedo__content-item__inner am-w-50",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},k(t(s).date),3),ce(" "+k(P(B)),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-30",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},k(t(s).name),3),ce(" "+k(B.name),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-20",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},k(t(s).days_off_repeat_yearly),3),ce(" "+k(B.repeat?t(s).yes:t(s).no),1)],2),t(u).index===null?(c(),U(ha,{key:0,index:z,onRemove:N=>g(z),onEdit:N=>C(z)},null,8,["index","onRemove","onEdit"])):D("",!0)]),t(u).index===z?(c(),y("div",rf,[A(w,{ref_for:!0,ref:N=>L(N,z),class:"am-caedo__form",rules:t(_),model:t(d),"label-position":"top"},{default:x(()=>[A(T,{label:`${t(s).date}:`,prop:"range"},{default:x(()=>[A(Yt,{modelValue:t(d).range,"onUpdate:modelValue":E[0]||(E[0]=N=>t(d).range=N),type:"daterange","popper-class":"am-cap__datepicker-popper",format:t(jt)(),placeholder:t(s).select_date,lang:t(l)},null,8,["modelValue","format","placeholder","lang"])]),_:1},8,["label"]),A(T,{label:`${t(s).name}:`,prop:"name"},{default:x(()=>[A(it,{modelValue:t(d).name,"onUpdate:modelValue":E[1]||(E[1]=N=>t(d).name=N)},null,8,["modelValue"])]),_:1},8,["label"]),A(T,{prop:"repeat"},{default:x(()=>[A(mt,{modelValue:t(d).repeat,"onUpdate:modelValue":E[2]||(E[2]=N=>t(d).repeat=N),label:t(s).days_off_repeat_yearly},null,8,["modelValue","label"])]),_:1})]),_:2},1032,["rules","model"]),m("div",cf,[A(Ee,{category:"secondary",size:"small",type:"plain",onClick:N=>I(z)},{default:x(()=>[ce(k(t(s).cancel),1)]),_:2},1032,["onClick"]),A(Ee,{size:"small",onClick:N=>O(z)},{default:x(()=>[ce(k(t(s).save),1)]),_:2},1032,["onClick"])])])):D("",!0)]))),128)),t(o).length===0&&t(r).length===0?(c(),U(Ia,{key:2,heading:t(s).no_days_off_yet},null,8,["heading"])):D("",!0),t(u).index===null?(c(),y("div",{key:3,class:q(t(o).length===0&&t(r).length===0?"add-btn":"")},[A(Ee,{size:"small",onClick:E[3]||(E[3]=B=>b())},{default:x(()=>[ce(k(t(s).add_day_off),1)]),_:1})],2)):D("",!0),t(r).length?(c(),y("span",uf,k(t(s).company_days_off),1)):D("",!0),t(r).length?(c(),y("div",{key:5,class:q(["am-caedo__heading",t(a).responsiveClass])},[m("div",df,k(t(s).date),1),m("div",mf,k(t(s).name),1),m("div",pf,k(t(s).days_off_repeat_yearly),1)],2)):D("",!0),(c(!0),y(ee,null,fe(t(r),(B,z)=>(c(),y("div",{key:z,class:"am-caedo__content"},[m("div",gf,[m("div",{class:q(["am-caedo__content-item__inner am-w-50",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},k(t(s).date),3),ce(" "+k(P(B)),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-30",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},k(t(s).name),3),ce(" "+k(B.name),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-20",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},k(t(s).days_off_repeat_yearly),3),ce(" "+k(B.repeat?t(s).yes:t(s).no),1)],2)])]))),128))],4)}}});const vf={class:"am-cc__edit"},_f={class:"am-cc__edit-text"},yf={class:"am-cc__edit-text"},bf={class:"am-cc__edit"},kf={class:"am-cc__edit-text"},Cf={class:"am-cc__edit-text"},xf={class:"am-cc__edit"},wf={class:"am-cc__edit-text"},Tf={class:"am-cc__edit-text"},Ef={name:"StripeConnect"},Lf=Object.assign(Ef,{setup(n){let a=Ne(),e=R("amLabels"),s=v(()=>a.getters["auth/getStripeProvider"]),l=M(!1);function i(C){C.stopPropagation(),l.value=!l.value}function o(C){Zc(a,C),d()}function r(){Jc(a),d()}function u(){Gc(a),d()}function d(){l.value=!1}let f=R("amFonts"),_=R("amColors"),g=v(()=>({"--am-c-cc-error":_.value.colorError,"--am-c-cc-error-op15":H(_.value.colorError,.15),"--am-c-cc-bgr":_.value.colorMainBgr,"--am-c-cc-text":_.value.colorMainText,"--am-c-cc-text-op10":H(_.value.colorMainText,.1),"--am-c-cc-text-op15":H(_.value.colorMainText,.15),"--am-font-family":f.value.fontFamily}));return(C,O)=>{const I=Gs;return t(s)&&t(s).id&&t(s).completed?(c(),U(I,{key:0,ref:"stripeConnectRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[A(Ee,{onClick:i},{default:x(()=>[ce(k(t(e).stripe_connect)+" "+k("("+(t(s).email?t(s).email:t(s).id)+")"),1)]),_:1})]),default:x(()=>[zt((c(),y("div",vf,[m("div",{class:"am-cc__edit-item",onClick:O[0]||(O[0]=b=>r())},[m("span",_f,k(t(e).stripe_preview),1)]),m("div",{class:"am-cc__edit-item",onClick:O[1]||(O[1]=b=>u())},[m("span",yf,k(t(e).disconnect),1)])])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])):t(s)&&t(s).id&&!t(s).completed?(c(),U(I,{key:1,ref:"stripeConnectRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[A(Ee,{onClick:i},{default:x(()=>[ce(k(t(e).stripe_connect)+" "+k("("+(t(s).email?t(s).email:t(s).id)+")"),1)]),_:1})]),default:x(()=>[zt((c(),y("div",bf,[m("div",{class:"am-cc__edit-item",onClick:O[2]||(O[2]=b=>o(t(s).type))},[m("span",kf,k(t(e).stripe_onboard),1)]),m("div",{class:"am-cc__edit-item",onClick:O[3]||(O[3]=b=>u())},[m("span",Cf,k(t(e).disconnect),1)])])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])):(c(),U(I,{key:2,ref:"stripeConnectRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[A(Ee,{onClick:i},{default:x(()=>[ce(k(t(e).stripe_connect),1)]),_:1})]),default:x(()=>[zt((c(),y("div",xf,[m("div",{class:"am-cc__edit-item",onClick:O[4]||(O[4]=b=>o("standard"))},[m("span",wf,k(t(e).stripe_account_standard),1)]),m("div",{class:"am-cc__edit-item",onClick:O[5]||(O[5]=b=>o("express"))},[m("span",Tf,k(t(e).stripe_account_express),1)])])),[[t(ia),d]])]),_:1},8,["visible","popper-style"]))}}});const Sf=["innerHTML"],Af={key:2,class:"am-caedo__apple"},If={class:"am-caedo__apple__connect"},Pf={props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=M(""),s=M("error"),l=M(!1);function i(){l.value=!1,e.value=""}const o=Ne(),r=R("baseUrls"),u=R("settings");let d=R("amLabels"),f=v(()=>o.getters["auth/getGoogleLoading"]||o.getters["auth/getOutlookLoading"]||o.getters["auth/getAppleLoading"]||o.getters["auth/getStripeLoading"]||o.getters["auth/getZoomLoading"]),_=v(()=>{let T=o.getters["auth/getZoomUsers"];return T.length?T.map(w=>({value:w.id,label:`${w.first_name} ${w.last_name} (${w.email})`})):[]}),g=v(()=>{let T=o.getters["auth/getGoogleCalendars"];return T.length?T.map(w=>({value:w.calendarId,label:w.summary})):[]}),C=v(()=>{let T=o.getters["auth/getOutlookCalendars"];return T.length?T.map(w=>({value:w.id,label:w.name})):[]}),O=v(()=>{let T=o.getters["auth/getAppleCalendars"];return T.length?T.map(w=>({value:w.id,label:w.name})):[]}),I=M(null),b=M({iCloudId:v({get:()=>o.getters["employee/getEmployeeAppleCalendarICloudId"],set:T=>{o.commit("employee/setEmployeeAppleCalendarICloudId",T||"")}}),appSpecificPassword:v({get:()=>o.getters["employee/getEmployeeAppleCalendarAppSpecificPassword"],set:T=>{o.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",T||null)}})}),P=v(()=>o.getters["employee/getGoogleToken"]?d.google_sign_out:d.google_sign_in),L=v(()=>o.getters["employee/getOutlookToken"]?d.outlook_sign_out:d.outlook_sign_in),$=M({googleId:v({get:()=>o.getters["employee/getGoogleCalendarId"],set:T=>{o.commit("employee/setGoogleCalendarId",T||"")}}),googleBtn:"",outlookId:v({get:()=>o.getters["employee/getOutlookCalendarId"],set:T=>{o.commit("employee/setOutlookCalendarId",T||"")}}),outlookBtn:"",zoomUserId:v({get:()=>o.getters["employee/getZoomUserId"],set:T=>{o.commit("employee/setZoomUserId",T||"")}}),appleId:v({get:()=>o.getters["employee/getAppleCalendarId"],set:T=>{o.commit("employee/setAppleCalendarId",T||"")}})}),h=M({googleId:{template:Ye.select,props:{itemName:"googleId",label:d.google_calendar,placeholder:"",class:v(()=>`am-caepif__item ${a.responsiveClass}`),disabled:v(()=>!o.getters["employee/getGoogleToken"]),clearable:!1,options:g.value,loading:v(()=>o.getters["auth/getGoogleLoading"]),loadingIcon:"loading"}},googleBtn:{template:Ge(Ee),props:{class:v(()=>`am-caepif__item am-google-calendar-button ${a.responsiveClass}`),category:v(()=>"primary")},slots:{default:v(()=>`<img src="${r.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/google-button.svg" alt="Google" />${P.value}`)},handlers:{click:()=>{o.getters["employee/getGoogleToken"]?Uc(o):qc(o)}}},outlookId:{template:Ye.select,props:{itemName:"outlookId",label:d.outlook_calendar,placeholder:"",class:v(()=>`am-caepif__item ${a.responsiveClass}`),disabled:v(()=>!o.getters["employee/getOutlookToken"]),clearable:!1,options:C.value,loading:v(()=>o.getters["auth/getOutlookLoading"]),loadingIcon:"loading"}},outlookBtn:{template:Ge(Ee),props:{class:v(()=>`am-caepif__item am-outlook-button ${a.responsiveClass}`),category:v(()=>"primary")},slots:{default:v(()=>`<div class="am-outlook-img"><img src="${r.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/outlook-calendar.png" alt="Outlook"/></div>${L.value}`)},handlers:{click:()=>{o.getters["employee/getOutlookToken"]?Yc(o):jc(o)}}},zoomUserId:{template:Ye.select,props:{itemName:"zoomUserId",label:d.zoom_user,placeholder:d.zoom_user_placeholder,class:v(()=>`am-caepif__item ${a.responsiveClass}`),options:_.value}},appleId:{template:Ye.select,props:{itemName:"appleId",label:d.apple_calendar,placeholder:d.apple_calendar_placeholder,class:v(()=>`am-caepif__item ${a.responsiveClass}`),disabled:!1,clearable:v(()=>!xa.value),options:v(()=>O.value),loading:v(()=>o.getters["auth/getAppleLoading"]),loadingText:"Loading..."}}});Je(()=>{u.appleCalendar&&I.value&&(I.value.contentVisibility=xa.value)}),Zs(()=>{u.zoom.enabled||delete h.value.zoomUserId,u.googleCalendar.enabled||(delete h.value.googleId,delete h.value.googleBtn),u.outlookCalendar.enabled||(delete h.value.outlookId,delete h.value.outlookBtn),u.appleCalendar||delete h.value.appleId});function S(T){const w={iCloudId:T.getters["employee/getEmployeeAppleCalendarICloudId"],appSpecificPassword:T.getters["employee/getEmployeeAppleCalendarAppSpecificPassword"]};De.post("/apple/connect/"+T.getters["employee/getId"],{employeeAppleCalendar:w}).then(()=>{T.commit("employee/setEmployeeAppleCalendarICloudId",w.iCloudId),T.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",w.appSpecificPassword),jn(T)}).catch(B=>{l.value=!0,e.value=B.response.data.message,s.value="error"}).finally(()=>{l.value=!0})}function E(T){T.commit("auth/setAppleLoading",!0),De.post("/apple/disconnect-employee/"+T.getters["employee/getId"]).then(()=>{T.commit("employee/setEmployeeAppleCalendarICloudId",null),T.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",null),xa.value=!1,jn(T),O.value=T.getters["auth/getAppleCalendars"]}).catch(w=>{console.log(w)}).finally(()=>{T.commit("auth/setAppleLoading",!1)})}return(T,w)=>{const B=yt,z=et;return t(f)?(c(),U(Wt,{key:1})):(c(),U(z,{key:0,ref:"employeeFormRef",model:t($),"label-position":"top",class:q(["am-caedo",a.responsiveClass])},{default:x(()=>[t(u).payments.stripe.enabled&&t(u).payments.stripe.connect.enabled?(c(),U(Lf,{key:0})):D("",!0),m("div",{class:q(["am-caepif__block",a.responsiveClass])},[(c(!0),y(ee,null,fe(t(h),(N,G)=>(c(),U(pt(N.template),St({key:G,ref_for:!0,ref:"customerCollectorRef",modelValue:t($)[G],"onUpdate:modelValue":se=>t($)[G]=se},N.props,ri(N.handlers?N.handlers:{})),{default:x(()=>[N.slots&&N.slots.default?(c(),y("div",{key:0,innerHTML:N.slots.default},null,8,Sf)):D("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128))],2),t(l)?(c(),U(_t,{key:1,type:"error","show-border":!0,"close-after":5e3,onClose:i,onTriggerClose:i},{default:x(()=>[ce(k(t(e)),1)]),_:1})):D("",!0),t(u).appleCalendar?(c(),y("div",Af,[A(Lo,null,{default:x(()=>[A(Eo,{ref_key:"appleVisibility",ref:I,side:!0,delay:500},{heading:x(()=>[ce(k(t(d).apple_calendar_personal),1)]),default:x(()=>[m("div",If,[A(B,{label:t(d).apple_icloud_id,class:"am-caedo__apple__connect__item"},{default:x(()=>[A(it,{modelValue:t(b).iCloudId,"onUpdate:modelValue":w[0]||(w[0]=N=>t(b).iCloudId=N),disabled:t(xa),placeholder:t(d).apple_icloud_id},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),A(B,{label:t(d).apple_app_specific_password,class:"am-caedo__apple__connect__item"},{default:x(()=>[A(it,{modelValue:t(b).appSpecificPassword,"onUpdate:modelValue":w[1]||(w[1]=N=>t(b).appSpecificPassword=N),type:"password","show-password":!0,disabled:t(xa),placeholder:t(d).apple_app_specific_password},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),A(Ee,{onClick:w[2]||(w[2]=N=>t(xa)?E(t(o)):S(t(o)))},{default:x(()=>[ce(k(t(xa)?t(d).apple_disconnect:t(d).apple_connect),1)]),_:1})])]),_:1},512)]),_:1})])):D("",!0)]),_:1},8,["model","class"]))}}};const $f={props:{tabActive:{type:String,required:!0},passwordActive:{type:Boolean,default:!1}},emits:["changePassword","savePassword","saveChanges"],setup(n,{emit:a}){const e=n;let s=R("amLabels");function l(){e.tabActive==="password"?a("savePassword"):a("saveChanges")}let i=R("amColors"),o=v(()=>({"--am-c-caepf-text-op15":H(i.value.colorMainText,.15)}));return(r,u)=>(c(),y("div",{class:q(["am-caepf",{"am-single-btn":e.tabActive!=="details"||e.passwordActive}]),style:Ce(t(o))},[e.tabActive==="details"&&!e.passwordActive?(c(),U(Ee,{key:0,size:"medium",category:"secondary",type:"plain",onClick:u[0]||(u[0]=d=>a("changePassword"))},{default:x(()=>[ce(k(t(s).change_password),1)]),_:1})):D("",!0),A(Ee,{size:"medium",onClick:l},{default:x(()=>[ce(k(e.tabActive!=="password"?t(s).save:t(s).change_password),1)]),_:1})],6))}},Nf={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n,s=Ne();let l=R("amLabels"),i=M(null),o=M({newPass:v({get:()=>s.getters["auth/getNewPassword"],set:d=>{s.commit("auth/setNewPassword",d||"")}}),confirmPass:v({get:()=>s.getters["auth/getConfirmPassword"],set:d=>{s.commit("auth/setConfirmPassword",d||"")}})}),r=M({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:l.new_password_colon,placeholder:"",minLength:3,class:v(()=>`am-capp__item ${e.responsiveClass}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:l.new_password_colon_retype,placeholder:"",minLength:3,class:v(()=>`am-capp__item ${e.responsiveClass}`)}}}),u=M({newPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"},{validator:()=>s.getters["auth/getNewPassword"]===s.getters["auth/getConfirmPassword"],message:l.passwords_not_match,trigger:"submit"}]});return a({passFormRef:i}),(d,f)=>{const _=et;return c(),U(_,{ref_key:"passFormRef",ref:i,model:t(o),rules:t(u),"label-position":"top",class:q(["am-capi__form",n.responsiveClass])},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),(g,C)=>(c(),U(pt(g.template),St({key:g.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:t(o)[C],"onUpdate:modelValue":O=>t(o)[C]=O},g.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"])}}};const Df=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),Of={name:"CabinetEmployeeProfile"},Ff=Object.assign(Of,{setup(n){let a=Ne();const e=R("settings");let s=R("amLabels"),l=M(null);const{width:i}=ja(l);let o=v(()=>st(i.value));Be("pageWidth",i);let r=v(()=>a.getters["entities/getReady"]);const u=M("details");let d=M(""),f=M("success"),_=M(!1);function g(){_.value=!1}function C(){_.value=!1,d.value=""}let O=M(null),I=v(()=>a.getters["employee/getEmployee"]),b=v(()=>a.getters["auth/getGoogleLoading"]||a.getters["auth/getOutlookLoading"]||a.getters["auth/getAppleLoading"]||a.getters["auth/getStripeLoading"]||a.getters["auth/getZoomLoading"]),P=M(!1),L=R("timeZone");function $(){O.value.employeeFormRef.validate(z=>{!z||(P.value=!0,De.post("/users/providers/"+I.value.id,jr(a,L.value),Object.assign(ze(a),{params:{source:"cabinet-provider"}})).then(()=>{d.value=s.profile_data_success,f.value="success"}).catch(N=>{d.value=N.response.data.message,f.value="error"}).finally(()=>{_.value=!0,P.value=!1}))})}let h=M(null),S=M(!1);function E(){S.value=!0,u.value="password"}function T(){h.value.passFormRef.validate(z=>{if(z){let N=a.getters["auth/getProfile"];P.value=!0,De.post("/users/providers/"+N.id,{password:a.getters["auth/getNewPassword"]},ze(a)).then(()=>{d.value=s.password_success,S.value=!1,u.value="details",a.commit("auth/setNewPassword",""),a.commit("auth/setConfirmPassword","")}).catch(()=>{_.value=!0}).finally(()=>{P.value=!1})}})}let w=R("amColors"),B=v(()=>({"--am-c-caep-primary":w.value.colorPrimary,"--am-c-caep-text":w.value.colorMainText,"--am-c-caep-text-op10":H(w.value.colorMainText,.1)}));return(z,N)=>{const G=va,se=_a;return c(),y("div",{ref_key:"pageContainer",ref:l,class:"am-caep",style:Ce(t(B))},[t(r)&&!t(P)&&!t(b)?(c(),y("div",{key:0,class:q(["am-caep__inner",t(o)])},[t(_)?(c(),U(_t,{key:0,type:t(f),"show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:C,onTriggerClose:C},{title:x(()=>[Df,ce(" "+k(t(d)),1)]),_:1},8,["type"])):D("",!0),A(se,{modelValue:u.value,"onUpdate:modelValue":N[0]||(N[0]=j=>u.value=j)},{default:x(()=>[A(G,{label:t(s).details,name:"details",onClick:g},{default:x(()=>[A(jp,{ref_key:"detailsRef",ref:O,"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"]),t(e).roles.allowConfigureServices?(c(),U(G,{key:0,label:t(s).heading_services,name:"services"},{default:x(()=>[A(vg,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0),t(e).roles.allowConfigureSchedule?(c(),U(G,{key:1,label:t(s).working_hours,name:"workingHours"},{default:x(()=>[A(Gg,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0),t(e).roles.allowConfigureSpecialDays?(c(),U(G,{key:2,label:t(s).special_days,name:"specialDays"},{default:x(()=>[A(tf,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0),t(e).roles.allowConfigureDaysOff?(c(),U(G,{key:3,label:t(s).days_off,name:"daysOff"},{default:x(()=>[A(hf,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0),t(S)?(c(),U(G,{key:4,label:t(s).password,name:"password"},{default:x(()=>[t(P)?(c(),U(wl,{key:1,"item-direction":"column",count:2})):(c(),U(Nf,{key:0,ref_key:"changePassRef",ref:h},null,512))]),_:1},8,["label"])):D("",!0),t(e).zoom.enabled||t(e).googleCalendar.enabled||t(e).outlookCalendar.enabled||t(e).appleCalendar||t(e).payments.stripe.enabled&&t(e).payments.stripe.connect.enabled?(c(),U(G,{key:5,label:t(s).integrations_settings,name:"integrations"},{default:x(()=>[A(Pf,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0)]),_:1},8,["modelValue"]),A($f,{"tab-active":u.value,"password-active":t(S),onChangePassword:E,onSavePassword:T,onSaveChanges:$},null,8,["tab-active","password-active"])],2)):(c(),U(Wt,{key:1}))],4)}}});function gr(n,a){De.get("/users/customers",{params:Js(n)}).then(e=>{a(e.data.data.users)}).catch(()=>{a([])})}function Hs(n,a="",e={},s=()=>{}){n.commit("customerInfo/setLoading",!0),setTimeout(()=>{gr(Object.assign({search:a,page:1,limit:at.general.customersFilterLimit,skipCount:1},e),l=>{n.commit("customerInfo/setCustomers",l),n.commit("customerInfo/setLoading",!1),s()})},500)}function Si(n){n.getters["customerInfo/getCustomers"].length||Hs(n)}const Mf={key:0,class:"am-capf__zone"},Vf={class:"am-capf__menu"},Bf=m("span",{class:"am-icon-filter"},null,-1),Rf={key:0},qf={key:0,class:"am-capf__list"},Uf={name:"CabinetFilters"},Ai=Object.assign(Uf,{props:{paramList:{type:[Object,Array],default:()=>[]},stepKey:{type:String,default:""},responsiveClass:{type:String,default:""},empty:{type:Boolean,default:!1}},emits:["changeFilters","addAppointment"],setup(n,{emit:a}){const e=n;let s=Ne(),l=v(()=>s.getters["entities/getReady"]),i=v(()=>s.getters.getLoading),o=M({customers:!1,events:!1}),r=v(()=>e.stepKey==="packages"?"packagesList":e.stepKey);const u=R("shortcodeData"),d=R("settings");let f=R("amCustomize");const _=R("labels"),g=R("localLanguage");let C=v(()=>d.general.usedLanguages.includes(g.value)),O=v(()=>{let te=Qe({..._});if(e.stepKey){let oe=f.value[r.value].translations;oe&&Object.keys(oe).forEach(ie=>{oe[ie][g.value]&&C.value?te[ie]=oe[ie][g.value]:oe[ie].default&&(te[ie]=oe[ie].default)})}return te});function I(te){return te==="customers"?"user":te==="services"?"service":te==="providers"?"employee":te==="locations"?"locations":te==="packages"?"shipment":te==="events"?"star-outline":""}function b(){a("changeFilters")}let P=R("containerWidth"),L={components:{IconComponent:We},template:'<IconComponent icon="filter"/>'},$=M(!1),h=M({dates:v({get:()=>s.getters["cabinetFilters/getDates"],set:te=>{Yr(te[0],te[1]),s.commit("cabinetFilters/setDates",te),a("changeFilters")}}),customers:v({get:()=>s.getters["cabinetFilters/getCustomers"],set:te=>{s.commit("cabinetFilters/setCustomers",te||[])}}),services:v({get:()=>s.getters["cabinetFilters/getServices"],set:te=>{s.commit("cabinetFilters/setServices",te)}}),providers:v({get:()=>s.getters["cabinetFilters/getProviders"],set:te=>{s.commit("cabinetFilters/setProviders",te)}}),locations:v({get:()=>s.getters["cabinetFilters/getLocations"],set:te=>{s.commit("cabinetFilters/setLocations",te)}}),packages:v({get:()=>s.getters["cabinetFilters/getPackages"],set:te=>{s.commit("cabinetFilters/setPackages",te)}}),events:v({get:()=>s.getters["cabinetFilters/getEvents"],set:te=>{s.commit("cabinetFilters/setEvents",te||[])}})}),S=v(()=>e.stepKey==="events"?s.getters["cabinetFilters/getEventFiltersOption"](u.value.cabinetType):e.stepKey==="packages"?s.getters["cabinetFilters/getPackageFilterOptions"]:s.getters["cabinetFilters/getAppointmentFilterOptions"](u.value.cabinetType)),E=v(()=>{let te=0;return Object.keys(S.value).forEach(oe=>{f.value[r.value].options[`${oe}Filter`].visibility&&(oe==="customers"||oe==="events"||S.value[oe].length>0)&&te++}),te});function T(te,oe){switch(te){case"customers":B(oe);break;case"events":z(oe);break}}function w(){u.value.cabinetType==="employee"&&B("",s.getters["auth/getPreloadedCustomers"])}function B(te="",oe=[]){if(o.value.customers=!0,oe.length){s.dispatch("cabinetFilters/injectCustomerOptions",oe),o.value.customers=!1;return}setTimeout(()=>{gr({search:te,page:1,limit:at.general.customersFilterLimit,skipCount:1},ie=>{s.dispatch("cabinetFilters/injectCustomerOptions",ie),s.getters["auth/getPreloadedCustomers"].length===0&&s.commit("auth/setPreloadedCustomers",ie),o.value.customers=!1})},500)}function z(te="",oe=[]){if(o.value.events=!0,oe.length){s.dispatch("cabinetFilters/injectEventsOptions",oe),o.value.events=!1;return}setTimeout(()=>{uc({dates:[ye().format("YYYY-MM-DD")],timeZone:s.getters["cabinet/getTimeZone"],group:!0,page:1,limit:d.general.itemsPerPageBackEnd,search:te},ie=>{s.dispatch("cabinetFilters/injectEventsOptions",ie),o.value.events=!1})},500)}let N=v(()=>f.value[r.value].options),G=v(()=>e.stepKey==="appointments"?u.value.cabinetType==="employee"?N.value.servicesFilter.visibility||N.value.customersFilter.visibility||N.value.locationsFilter.visibility:N.value.servicesFilter.visibility||N.value.providersFilter.visibility||N.value.locationsFilter.visibility:e.stepKey==="events"?u.value.cabinetType==="employee"?N.value.eventsFilter.visibility||N.value.customersFilter.visibility||N.value.locationsFilter.visibility:N.value.eventsFilter.visibility||N.value.providersFilter.visibility||N.value.locationsFilter.visibility:N.value.packagesFilter.visibility||N.value.servicesFilter.visibility||N.value.providersFilter.visibility||N.value.locationsFilter.visibility),se=v(()=>e.stepKey==="appointments"?u.value.cabinetType==="employee"?!!(S.value.services.length||S.value.customers.length||S.value.locations.length):!!(S.value.services.length||S.value.providers.length||S.value.locations.length):e.stepKey==="events"?u.value.cabinetType==="employee"?!!(S.value.events.length||S.value.customers.length||S.value.locations.length):!!(S.value.events.length||S.value.providers.length||S.value.locations.length):!!(S.value.packages.length||S.value.services.length||S.value.providers.length||S.value.locations.length));Je(()=>{w()});let j=R("amColors"),ne=v(()=>({"--am-c-capf-heading-text":j.value.colorMainText,"--am-c-capf-text":j.value.colorInpText,"--am-c-capf-text-op10":H(j.value.colorInpText,.1),"--am-c-select-border":j.value.colorInpBorder,"--am-c-select-bgr":j.value.colorInpBgr}));return(te,oe)=>!t(i)&&t(l)?(c(),y("div",{key:0,class:"am-capf",style:Ce(t(ne))},[t(P)<=480&&t(N).timeZone.visibility&&t(e).stepKey!=="packages"?(c(),y("div",Mf,[A(zn,{size:"small"})])):D("",!0),m("div",Vf,[t(P)<=480&&t(N).timeZone.visibility&&t(e).stepKey==="packages"?(c(),U(zn,{key:0,size:"small"})):D("",!0),t(e).stepKey!=="packages"?(c(),U(Yt,{key:1,modelValue:t(h).dates,"onUpdate:modelValue":oe[0]||(oe[0]=ie=>t(h).dates=ie),type:"daterange",editable:!1,size:"small",clearable:!1,format:t(jt)(),style:Ce(t(ne)),lang:t(g),class:q(["am-capf__menu-datepicker",t(e).responsiveClass]),"popper-class":"am-capf__menu-datepicker-popper","start-placeholder":t(O).start_date,"end-placeholder":t(O).end_date},null,8,["modelValue","format","style","lang","class","start-placeholder","end-placeholder"])):D("",!0),!t(e).empty&&t(G)&&t(se)?(c(),U(Ee,{key:2,icon:t(L),"icon-only":t(P)<=700,"custom-class":"am-capf__menu-btn",size:"small",category:"primary","aria-label":t(O).filters,type:t(N).filterBtn?t(N).filterBtn.buttonType:"filled",onClick:oe[1]||(oe[1]=ie=>we($)?$.value=!t($):$=!t($))},{default:x(()=>[Bf,t(P)>700?(c(),y("span",Rf,k(t(O).filters),1)):D("",!0)]),_:1},8,["icon","icon-only","aria-label","type"])):D("",!0)]),A(ga,{name:"am-slide-fade"},{default:x(()=>[t($)&&!t(e).empty?(c(),y("div",qf,[(c(!0),y(ee,null,fe(Object.keys(t(S)),ie=>(c(),y(ee,{key:ie},[(t(S)[ie].length>0||ie==="customers"||ie==="events")&&t(f)[t(r)].options[`${ie}Filter`].visibility?(c(),y("span",{key:0,class:q(["am-capf__list-item",[{"am-selected":t(h)[ie].length>0},`am-capf__list-item-${t(E)}`,t(e).responsiveClass]])},[A(He,{id:`am-select-${ie}`,modelValue:t(h)[ie],"onUpdate:modelValue":K=>t(h)[ie]=K,multiple:ie!=="customers"&&ie!=="events",loading:ie!=="customers"&&ie!=="events"?!1:t(o)[ie],remote:"",clearable:"",filterable:ie==="customers"||ie==="events",placeholder:t(O)[ie+(ie==="customers"?"":"_dropdown")],"prefix-icon":I(ie),"collapse-tags":!0,size:"small","popper-class":"am-filter-select-popper","remote-method":K=>{T(ie,K)},onChange:b,onClear:w},{default:x(()=>[(c(!0),y(ee,null,fe(t(S)[ie],K=>(c(),U(qe,{key:K.id,value:K.id,label:K.firstName?K.firstName+" "+K.lastName:K.name},null,8,["value","label"]))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","multiple","loading","filterable","placeholder","prefix-icon","remote-method"])],2)):D("",!0)],64))),128))])):D("",!0)]),_:1})],4)):D("",!0)}});function zf(n,a){let e=n.getters["entities/getService"](a.serviceId),s=0,l=0;return a.bookings.forEach(i=>{if(["approved","pending"].includes(i.status)){let o=i.duration?i.duration:e.duration;o>s&&(s=o);let r=0;i.extras.forEach(u=>{r+=e.extras.find(f=>f.id===u.extraId).duration*u.quantity}),r>l&&(l=r)}}),s+l}function fr(n,a,e){for(let s in n)n[s].appointments.forEach(l=>{let i={};l.bookings.forEach(r=>{r.customerId in i||(i[r.customerId]=[]),i[r.customerId][r.id]=r.status});let o={};for(let r in i)for(let u in i[r])(!(r in o)||i[r][u]==="approved"||i[r][u]==="pending")&&(o[r]=u);l.bookings.forEach(r=>{r.customerId in o&&parseInt(r.id)!==parseInt(o[r.customerId])||(a===""&&(l.bookingStart=Tl(l.bookingStart),l.bookingEnd=Tl(l.bookingEnd)),e||(l.bookings=[r]))})});if(a===""){let s={};for(let l in n)n[l].appointments.forEach(i=>{let o=i.bookingStart.split(" ")[0];o in s?s[o].appointments.push(i):s[o]={appointments:[i],date:o}});return s}return n}function hr(n,a){let e=[];return n.forEach(s=>{if(["approved","pending"].includes(s.status)&&s.customFields){let l=JSON.parse(s.customFields);Object.keys(l).forEach(i=>{if(l[i]){let o=l[i].type==="file"?l[i]?.value?l[i].value:"":l[i].value;(Array.isArray(o)?o.length:o)&&e.push({label:l[i].label,value:o})}})}}),a==="customer"?e:[...new Set(e.filter(s=>s.value).map(s=>s.label))].map(s=>new Object({label:s}))}function jf(n,a){let e={};return n.forEach(s=>{["approved","pending"].includes(s.status)&&s.extras.forEach(l=>{l.extraId in e||(e[l.extraId]={quantity:0,price:l.price,name:a.extras.find(i=>i.id===l.extraId).name}),e[l.extraId].quantity=e[l.extraId].quantity+l.quantity})}),e}const Yf={class:"am-cc__periods-date"},Wf={class:"am-cc__periods-time"},Hf={key:0,class:"am-cc__periods-link__list"},Zf=["href"],Gf=m("span",{class:"am-icon-link"},null,-1),Jf=["href"],Xf=m("span",{class:"am-icon-link"},null,-1),Qf=["href"],Kf=m("span",{class:"am-icon-link"},null,-1),eh=["href"],th=m("span",{class:"am-icon-link"},null,-1),ah={name:"TemplatePeriods"},sh=Object.assign(ah,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n,e=R("amLabels");let s=R("containerWidth"),l=v(()=>st(s.value));return(i,o)=>(c(),y("div",{class:q(["am-cc__periods",t(l)])},[(c(!0),y(ee,null,fe(t(a).data,(r,u)=>(c(),y("div",{key:u,class:"am-cc__periods-item"},[m("span",Yf,k(t(nt)(r.date)),1),m("span",Wf,k(`${t(vs)(r.startTime)} - ${t(vs)(r.endTime)}`),1),r.googleMeetLink||r.zoomLink||r.lessonSpaceLink||r.microsoftTeamsLink?(c(),y("div",Hf,[r.googleMeetLink?(c(),y("a",{key:0,class:"am-cc__periods-link",href:r.googleMeetLink,target:"_blank"},[Gf,ce(" "+k(t(e).google_meet_link),1)],8,Zf)):D("",!0),r.microsoftTeamsLink?(c(),y("a",{key:1,class:"am-cc__periods-link",href:r.microsoftTeamsLink,target:"_blank"},[Xf,ce(" "+k(t(e).microsoft_teams_link),1)],8,Jf)):D("",!0),r.zoomLink?(c(),y("a",{key:2,class:"am-cc__periods-link",href:r.zoomLink,target:"_blank"},[Kf,ce(" "+k(t(e).zoom_link),1)],8,Qf)):D("",!0),r.lessonSpaceLink?(c(),y("a",{key:3,class:"am-cc__periods-link",href:r.lessonSpaceLink,target:"_blank"},[th,ce(" "+k(t(e).lesson_space_link),1)],8,eh)):D("",!0)])):D("",!0)]))),128))],2))}});const lh={class:"am-cc__extras-name"},nh={key:0,class:"am-cc__extras-duration"},ih={key:1,class:"am-cc__extras-price"},oh={key:2,class:"am-cc__extras-quantity"},rh={name:"TemplateExtras"},ch=Object.assign(rh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n,e=R("amLabels"),s=R("shortcodeData");let l=R("containerWidth"),i=v(()=>st(l.value));return(o,r)=>(c(),y("div",{class:q(["am-cc__extras",t(i)])},[(c(!0),y(ee,null,fe(t(a).data,(u,d)=>(c(),y("div",{key:d,class:"am-cc__extras-item"},[m("span",lh,k(u.name),1),u.duration||u.price||u.quantity?(c(),y("div",{key:0,class:q(["am-cc__extras-item__inner",[{"am-flex-space":!u.price&&u.duration},{"am-flex-end":!u.duration}]])},[u.duration?(c(),y("span",nh,k(t(hs)(u.duration,t(e).h,t(e).min)),1)):D("",!0),t(s).cabinetType==="customer"&&u.price?(c(),y("span",ih,k(t(tt)(u.price)),1)):D("",!0),u.quantity?(c(),y("span",oh," x"+k(u.quantity),1)):D("",!0)],2)):D("",!0)]))),128))],2))}});const uh={class:"am-cc__tickets-item_inner"},dh={class:"am-cc__tickets-name"},mh={class:"am-cc__tickets-calc"},ph={key:0,class:"am-cc__tickets-price"},gh={name:"TemplateTickets"},fh=Object.assign(gh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n,e=R("amLabels"),s=R("shortcodeData");let l=R("containerWidth"),i=v(()=>st(l.value));return(o,r)=>(c(),y("div",{class:q(["am-cc__tickets",t(i)])},[(c(!0),y(ee,null,fe(t(a).data,(u,d)=>(c(),y("div",{key:d,class:"am-cc__tickets-item"},[m("div",uh,[m("span",dh,k(u.name),1),m("span",mh,k(`${u.persons} ${u.persons>1?t(e).event_tickets:t(e).event_ticket}${t(s).cabinetType==="customer"?" x "+t(tt)(u.price):""}`),1)]),t(s).cabinetType==="customer"?(c(),y("div",ph,k(t(tt)(u.persons*u.price)),1)):D("",!0)]))),128))],2))}});const hh=["innerHTML"],vh={key:0,class:"am-cc__cf-value"},_h={class:"am-cc__cf-value__inner"},yh={name:"TemplateCustomFields"},bh=Object.assign(yh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n;let e=R("containerWidth"),s=v(()=>st(e.value));function l(i){return i?Array.isArray(i)?i.length===0?"/":i.map(o=>typeof o=="object"&&o!==null&&!Array.isArray(o)?o.name||"/":o||"/").join(", "):i:"/"}return(i,o)=>(c(),y("div",{class:q(["am-cc__cf",t(s)])},[(c(!0),y(ee,null,fe(t(a).data,(r,u)=>(c(),y("div",{key:u,class:"am-cc__cf-item"},[m("span",{class:"am-cc__cf-name",innerHTML:r.label},null,8,hh),"value"in r?(c(),y("div",vh,[m("span",_h,k(l(r.value)),1)])):D("",!0)]))),128))],2))}});const kh={class:"am-cc__employee-heading"},Ch={class:"am-cc__employee-heading__inner"},xh={class:"am-cc__employee-name"},wh=["innerHTML"],Th={key:1,class:"am-cc__employee-wrapper"},Eh={class:"am-cc__employee-heading"},Lh={class:"am-cc__employee-heading__inner"},Sh={class:"am-cc__employee-name"},Ah=["innerHTML"],Ih={name:"TemplateEmployee"},Ph=Object.assign(Ih,{props:{data:{type:[Object,Array]}},setup(n){const a=n;let e=v(()=>!Array.isArray(a.data)),s=R("containerWidth"),l=v(()=>st(s.value));function i(u){let d=u.firstName.charAt(0).toUpperCase(),f=u.lastName.charAt(0).toUpperCase();return`${d}${f}`}function o(u){return u.pictureThumbPath?{backgroundImage:`url(${u.pictureThumbPath})`}:{}}function r(u){return u&&u.includes("<!-- Content -->")?u.slice(16).length:u?u.length:!1}return(u,d)=>(c(),y("div",{class:q(["am-cc__employee",t(l)])},[t(e)?(c(),y(ee,{key:0},[m("div",kh,[m("span",{class:"am-cc__employee-img",style:Ce(o(t(a).data))},[t(a).data.pictureThumbPath?D("",!0):(c(),y(ee,{key:0},[ce(k(i(t(a).data)),1)],64))],4),m("div",Ch,[m("span",xh,k(`${t(a).data.firstName} ${t(a).data.lastName}`),1),t(a).data.badge?(c(),y("span",{key:0,class:"am-cc__employee-badge",style:Ce({background:t(a).data.badge.color})},k(t(a).data.badge.content),5)):D("",!0)])]),t(a).data.description?(c(),y("div",{key:0,class:q(["am-cc__employee-desc",{"ql-description":t(a).data.description.includes("<!-- Content -->")}]),innerHTML:t(a).data.description},null,10,wh)):D("",!0)],64)):(c(),y("div",Th,[(c(!0),y(ee,null,fe(t(a).data,f=>(c(),y(ee,{key:f.id},[m("div",Eh,[m("span",{class:"am-cc__employee-img",style:Ce(o(f))},[f.pictureThumbPath?D("",!0):(c(),y(ee,{key:0},[ce(k(i(f)),1)],64))],4),m("div",Lh,[m("span",Sh,k(`${f.firstName} ${f.lastName}`),1),f.badge?(c(),y("span",{key:0,class:"am-cc__employee-badge",style:Ce({background:f.badge.color})},k(f.badge.content),5)):D("",!0)])]),r(f.description)?(c(),y("div",{key:0,class:q(["am-cc__employee-desc",{"ql-description":f.description.includes("<!-- Content -->")}]),innerHTML:f.description},null,10,Ah)):D("",!0)],64))),128))]))],2))}});const $h={class:"am-cc__customers-item_inner"},Nh={class:"am-cc__customers-name"},Dh={class:"am-cc__customers-info"},Oh={class:"am-cc__customers-info"},Fh={name:"TemplateCustomers"},Mh=Object.assign(Fh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n;let e=R("containerWidth"),s=v(()=>st(e.value));return(l,i)=>(c(),y("div",{class:q(["am-cc__customers",t(s)])},[(c(!0),y(ee,null,fe(t(a).data,(o,r)=>(c(),y("div",{key:r,class:"am-cc__customers-item"},[m("div",$h,[m("span",Nh,k(o.firstName)+" "+k(o.lastName),1),m("span",Dh,k(o.email),1),m("span",Oh,k(o.phone),1)])]))),128))],2))}});const Vh={class:"am-cc__popover-inner"},Bh={key:0,class:"am-cc__popover-heading"},Rh={name:"CollapseCardPopoverTemplate"},ss=Object.assign(Rh,{props:{headerText:{type:String,default:""},type:{type:String,required:!0},contentData:{type:[Array,Object,String],default:""}},setup(n){const a=n;let e=M({period:Ge(sh),extras:Ge(ch),ticket:Ge(fh),customField:Ge(bh),employee:Ge(Ph),customers:Ge(Mh)}),s=R("amFonts"),l=R("amColors"),i=v(()=>({"--am-c-cc-primary":l.value.colorPrimary,"--am-c-cc-primary-op70":H(l.value.colorPrimary,.7),"--am-c-cc-success":l.value.colorSuccess,"--am-c-cc-success-op15":H(l.value.colorSuccess,.15),"--am-c-cc-bgr":l.value.colorMainBgr,"--am-c-cc-text":l.value.colorMainText,"--am-c-cc-text-op10":H(l.value.colorMainText,.1),"--am-c-cc-text-op15":H(l.value.colorMainText,.15),"--am-c-cc-text-op70":H(l.value.colorMainText,.7),"--am-c-cc-text-op80":H(l.value.colorMainText,.8),"--am-c-cc-text-op90":H(l.value.colorMainText,.9),"--am-c-scroll-op30":H(l.value.colorPrimary,.3),"--am-c-scroll-op10":H(l.value.colorPrimary,.1),"--am-font-family":s.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(o,r)=>{const u=Gs;return c(),U(u,{"show-arrow":!1,persistent:!1,width:"auto","popper-class":"am-cc__popover","popper-style":t(i),trigger:"click"},{reference:x(()=>[_o(o.$slots,"default")]),default:x(()=>[m("div",Vh,[t(a).headerText?(c(),y("div",Bh,k(t(a).headerText),1)):D("",!0),(c(),U(pt(t(e)[t(a).type]),{class:"am-cc__popover-content",data:t(a).contentData},null,8,["data"]))])]),_:3},8,["popper-style"])}}});function qh(n){let a=ni(null,n.coupon,n.tax?n.tax[0]:null,n.price-n.price/100*n.discount,!1);return a.price-a.discount+a.tax}const ls=Qe(window.wpAmeliaLabels);function fo(n,a,e,s=null){e.type==="package"&&n.commit("cabinet/setPackageLoading",!0),e.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!0),e.type==="event"&&n.commit("cabinet/setEventsLoading",!0),n.commit("cabinet/setPaymentLinkLoader",e.bookings?e.bookings[0].id:e.id);let l=JSON.parse(JSON.stringify(e)),i=JSON.parse(JSON.stringify(n.getters["auth/getProfile"]));i.birthday=null,l.customer=i,l.type!=="package"?(l[l.type]=e,l.booking=e.bookings[0],l.paymentId=e.bookings[0].payments[0].id):l=Object.assign(l,l.package),De.post("/payments/link",{data:l,paymentMethod:a}).then(o=>{!o.data.data.error&&o.data.data.paymentLink?window.location.href=o.data.data.paymentLink:n.commit("cabinet/setPaymentLinkError",{value:!0,type:e.type})}).catch(o=>{n.commit("cabinet/setPaymentLinkError",{value:!0,type:e.type})}).finally(()=>{n.commit("cabinet/setPaymentLinkLoader",null),e.type==="package"&&n.commit("cabinet/setPackageLoading",!1),e.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!1),e.type==="event"&&n.commit("cabinet/setEventsLoading",!1)})}function ti(n,a){if(n.type!=="package"&&(!n.bookings||n.bookings.length===0))return!1;a=JSON.parse(a);let e=a&&"payments"in a&&a.payments&&"paymentLinks"in a.payments&&a.payments.paymentLinks?a.payments.paymentLinks:at.payments.paymentLinks,s=!1;switch(n.type){case"package":s=!n.end||ye(n.end,"YYYY-MM-DD HH:mm").isAfter(ye());break;case"appointment":s=ye(n.bookingStart,"YYYY-MM-DD HH:mm:ss").isAfter(ye())&&n.bookings[0].payments.length>0;break;case"event":s=ye(n.periods[n.periods.length-1].periodEnd,"YYYY-MM-DD HH:mm:ss").isAfter(ye())&&n.bookings[0].payments.length>0;break}return ai(at).length&&at&&e&&e.enabled&&s}function ai(n){typeof n=="string"&&(n=JSON.parse(n));let a=[];return n=n.payments,at.payments.wc.enabled?a.push({value:"wc",label:ls.wc}):at.payments.mollie.enabled&&(!("mollie"in n)||n.mollie.enabled)?a.push({value:"mollie",label:ls.on_line}):(at.payments.payPal.enabled&&(!("payPal"in n)||n.payPal.enabled)&&a.push({value:"payPal",label:ls.pay_pal}),at.payments.stripe.enabled&&(!("stripe"in n)||n.stripe.enabled)&&a.push({value:"stripe",label:ls.credit_card}),at.payments.razorpay.enabled&&(!("razorpay"in n)||n.razorpay.enabled)&&a.push({value:"razorpay",label:ls.razorpay}),at.payments.square.enabled&&(!("square"in n)||n.square.enabled)&&a.push({value:"square",label:ls.square})),a}function Cl(n,a){switch(a.type){case"appointment":{let e=ci(n,{price:a.bookings[0].price,persons:a.bookings[0].persons,aggregatedPrice:a.bookings[0].aggregatedPrice,extras:a.bookings[0].extras,serviceId:null,tax:a.bookings[0].tax,coupon:a.bookings[0].coupon},!1);return e.total-e.discount+e.tax>a.bookings[0].payments.filter(s=>s.status!=="refunded"&&s.status!=="pending").reduce((s,l)=>s+l.amount,0)}case"event":return Io(a)>a.bookings[0].payments.filter(e=>e.status!=="refunded"&&e.status!=="pending").reduce((e,s)=>e+s.amount,0);case"package":return qh(a)>a.payments.filter(e=>e.status!=="refunded"&&e.status!=="pending").reduce((e,s)=>e+s.amount,0)}}const Uh={class:"am-cc__edit"},zh=["onClick"],jh={class:"am-cc__edit-text"},Yh={name:"PaymentButton"},vr=Object.assign(Yh,{props:{reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},type:{type:String},btnSize:{type:String,default:"mini"},class:{type:String,default:""}},setup(n){const a=n;let e=Ne();const s=R("amLabels");let l=v(()=>ai(a.bookable.settings)),i=v(()=>e.getters["cabinet/getPaymentLinkLoader"]),o={components:{IconComponent:We},template:'<IconComponent icon="arrow-down"></IconComponent>'},r=M(!1);function u(I){I.stopPropagation(),l.value.length===1?fo(e,l.value[0].value,a.reservation):r.value=!r.value}function d(){r.value=!1}let f=M(!1);function _(){f.value=!1}let g=R("amFonts"),C=R("amColors"),O=v(()=>({"--am-c-cc-primary":C.value.colorPrimary,"--am-c-cc-primary-op70":H(C.value.colorPrimary,.7),"--am-c-cc-error":C.value.colorError,"--am-c-cc-error-op15":H(C.value.colorError,.15),"--am-c-cc-warning":C.value.colorWarning,"--am-c-cc-warning-op15":H(C.value.colorWarning,.15),"--am-c-cc-success":C.value.colorSuccess,"--am-c-cc-success-op15":H(C.value.colorSuccess,.15),"--am-c-cc-bgr":C.value.colorMainBgr,"--am-c-cc-text":C.value.colorMainText,"--am-c-cc-text-op10":H(C.value.colorMainText,.1),"--am-c-cc-text-op15":H(C.value.colorMainText,.15),"--am-c-cc-text-op70":H(C.value.colorMainText,.7),"--am-c-cc-text-op90":H(C.value.colorMainText,.9),"--am-font-family":g.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(I,b)=>{const P=Gs;return t(ti)(t(a).reservation,t(a).bookable.settings)?(c(),U(P,{key:0,ref:"payRef",visible:t(r),persistent:!1,"show-arrow":!1,"popper-class":"am-cc__popper","popper-style":t(O),trigger:"click"},{reference:x(()=>[A(Ee,{size:t(a).btnSize,type:t(a).type,suffix:t(l).length>1&&t(Cl)(t(e),t(a).reservation)?t(o):"",class:q([{"am-button-single":t(l).length===1||!t(Cl)(t(e),t(a).reservation)},t(a).class]),loading:!!t(i),"loading-icon":"loading",disabled:!t(Cl)(t(e),t(a).reservation),onClick:u},{default:x(()=>[ce(k(t(Cl)(t(e),t(a).reservation)?t(s).pay_now_btn:t(s).paid),1)]),_:1},8,["size","type","suffix","class","loading","disabled"])]),default:x(()=>[zt((c(),y("div",Uh,[(c(!0),y(ee,null,fe(t(ai)(t(a).bookable.settings),L=>zt((c(),y("div",{key:L.value,class:"am-cc__edit-item",onClick:$=>t(fo)(t(e),L.value,t(a).reservation)},[m("span",jh,k(L.label),1)],8,zh)),[[t(ia),d]])),128))])),[[t(ia),_]])]),_:1},8,["visible","popper-style"])):D("",!0)}}}),ns=Qe(window.wpAmeliaLabels);function _r(){return[{value:"approved",label:ns.approved,icon:"check",color:"var(--am-c-success)"},{value:"pending",label:ns.pending,icon:"refresh",color:"var(--am-c-warning)"},{value:"canceled",label:ns.canceled,icon:"close",color:"var(--am-c-error)"},{value:"rejected",label:ns.rejected,icon:"info-reverse",color:"var(--am-c-main-text)"},{value:"waiting",label:ns.waiting,icon:"clock",color:"var(--am-c-warning)"},{value:"no-show",label:ns["no-show"],icon:"clock",color:"var(--am-c-warning)"}]}const Wh={name:"CollapseCard"},ho=Object.assign(Wh,{props:{id:{type:[Number],default:0},status:{type:String,default:""}},emits:["statusChange"],setup(n,{emit:a}){const e=n,s=R("shortcodeData");let l=R("amLabels"),i=Ne(),o=v(()=>_r().filter(f=>f.value!=="waiting"));function r(){u.value=!0,De.post("/appointments/status/"+e.id,{status:d.value},Object.assign(ze(i),{params:{source:"cabinet-provider"}})).then(f=>{let _=l.value.appointment_status_changed+l.value[f.data.data.status].toLowerCase(),g="success";"maximumCapacityReached"in f.data.data&&f.data.data.maximumCapacityReached===!0&&(_=l.value.maximum_capacity_reached,g="error",d.value=e.status),a("statusChange",_,g),u.value=!1}).catch(f=>{let _=l.value.error,g="error";"response"in f&&"data"in f.response&&"data"in f.response.data&&"timeSlotUnavailable"in f.response.data.data&&f.response.data.data.timeSlotUnavailable===!0&&(_=l.value.time_slot_unavailable),d.value=e.status,a("statusChange",_,g),u.value=!1})}let u=M(!1),d=M("");return Je(()=>{d.value=e.status}),(f,_)=>(c(),y("div",null,[t(d)&&t(s).cabinetType==="employee"?(c(),U(He,{key:0,modelValue:t(d),"onUpdate:modelValue":_[0]||(_[0]=g=>we(d)?d.value=g:d=g),"prefix-icon":t(o).find(g=>g.value===t(d)).icon,"prefix-icon-color":t(o).find(g=>g.value===t(d)).color,disabled:t(u),size:"small",onClick:_[1]||(_[1]=g=>g.stopPropagation()),onChange:r},{default:x(()=>[(c(!0),y(ee,null,fe(t(o),g=>(c(),U(qe,{key:g.value,value:g.value,label:g.label},{default:x(()=>[m("span",{class:q(`am-icon-${g.icon}`),style:Ce(`color: ${g.color}`)},null,6),ce(" "+k(g.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","prefix-icon","prefix-icon-color","disabled"])):D("",!0)]))}});const Hh={class:"am-cc__time"},Zh={key:0,class:"am-cc__name"},Gh={key:0,class:"am-cc__name"},Jh={key:1,class:"am-cc__places"},Xh={key:2,class:"am-cc__customer"},Qh={key:0,class:"am-cc__edit"},Kh=m("span",{class:"am-icon-edit"},null,-1),ev={class:"am-cc__edit-text"},tv={key:0,class:"am-cc__edit"},av=m("span",{class:"am-icon-users-plus"},null,-1),sv={class:"am-cc__edit-text"},lv={class:"am-cc__edit"},nv=m("span",{class:"am-icon-user"},null,-1),iv={class:"am-cc__edit-text"},ov={class:"am-cc__edit"},rv=m("span",{class:"am-icon-date-time"},null,-1),cv={class:"am-cc__edit-text"},uv=m("span",{class:"am-icon-clearable"},null,-1),dv={class:"am-cc__edit-text"},mv={class:"am-cc__content-inner"},pv={class:"am-cc__data"},gv=m("span",{class:"am-icon-user"},null,-1),fv={class:"am-cc__data-text"},hv={class:"am-cc__data"},vv=m("span",{class:"am-icon-user"},null,-1),_v={class:"am-cc__data-text"},yv={key:2,class:"am-cc__data"},bv=m("span",{class:"am-icon-payments"},null,-1),kv={class:"am-cc__data-text"},Cv={key:3,class:"am-cc__data"},xv=m("span",{class:"am-icon-clock"},null,-1),wv={class:"am-cc__data-text"},Tv={class:"am-cc__data"},Ev=m("span",{class:"am-icon-clock"},null,-1),Lv={class:"am-cc__data-text"},Sv={key:5,class:"am-cc__data link"},Av=m("span",{class:"am-icon-link"},null,-1),Iv=["href"],Pv={key:6,class:"am-cc__data link"},$v=m("span",{class:"am-icon-link"},null,-1),Nv=["href"],Dv={key:7,class:"am-cc__data link"},Ov=m("span",{class:"am-icon-link"},null,-1),Fv=["href"],Mv={key:8,class:"am-cc__data link"},Vv=m("span",{class:"am-icon-link"},null,-1),Bv=["href"],Rv={class:"am-cc__data"},qv=m("span",{class:"am-icon-border-plus"},null,-1),Uv={class:"am-cc__data-text"},zv={class:"am-cc__data"},jv=m("span",{class:"am-icon-file-text"},null,-1),Yv={class:"am-cc__data-text"},Wv={class:"am-cc__data"},Hv=m("span",{class:"am-icon-tickets"},null,-1),Zv={class:"am-cc__data-text"},Gv=m("span",{class:"am-icon-locations"},null,-1),Jv=["href"],Xv={key:1,class:"am-cc__data-text"},Qv={name:"CollapseCard"},yr=Object.assign(Qv,{props:{id:{type:Number,default:0},start:{type:[String,Object,Array,Function],required:!0},name:{type:String,default:""},employee:{type:[Object,Array],default:()=>{}},customers:{type:[Array],default:()=>{}},location:{type:[String,Object],default:""},price:{type:Number,default:0},duration:{type:Number,default:0},periods:{type:Array,default:()=>{}},extras:{type:Object,default:()=>{}},tickets:{type:Object,default:()=>{}},customFields:{type:Array,default:()=>[]},googleMeetLink:{type:String,default:""},microsoftTeamsLink:{type:String,default:""},zoomLink:{type:String,default:""},lessonSpaceLink:{type:String,default:""},reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},booking:{type:Object,default:()=>{}},isPackageBooking:{type:Boolean,default:!1},responsiveClass:{type:String,default:""},parentWidth:{type:Number,default:1200},customizedOptions:{type:Object,required:!0}},emits:["cancelBooking","rescheduling","editAppointment","editEvent","addEventAttendee","listEventAttendees","statusChange"],setup(n,{emit:a}){const e=n,s=R("shortcodeData"),l=R("settings");let i=R("originKey");const o=R("amLabels");let r=M(!1);function u(E){E.stopPropagation(),r.value=!r.value}function d(){r.value=!1}function f(){a("cancelBooking",e.booking),r.value=!1}function _(E){a("edit"+E.charAt(0).toUpperCase()+E.slice(1),e.reservation),r.value=!1}function g(E){a("addEventAttendee",E),r.value=!1}function C(E){a("listEventAttendees",E),r.value=!1}function O(){a("rescheduling",e.reservation,e.booking),r.value=!1}function I(E){return Array.isArray(E)?o.value.event_staff:!Array.isArray(E)&&E.rank&&E.rank==="organizer"?o.value.event_organizer:`${e.employee.firstName} ${e.employee.lastName}`}let b=v(()=>e.reservation.type==="event"?e.reservation.maxCapacity-e.reservation.places+"/"+e.reservation.maxCapacity:""),P=v(()=>{if(e.reservation.type==="appointment")return{label:o.value[s.value.cabinetType==="employee"||e.booking.status==="approved"?e.reservation.status:e.booking.status],class:s.value.cabinetType==="employee"||e.booking.status==="approved"?e.reservation.status:e.booking.status};if(e.reservation.type==="event"){if(s.value.cabinetType==="customer")return{label:o.value[e.booking.status],class:e.booking.status};switch(e.reservation.status){case"rejected":case"canceled":return{label:o.value.canceled,class:"canceled"};case"full":return{label:o.value.full,class:"full"};case"waiting":return{label:o.value.waiting_list,class:"waiting"};case"upcoming":return{label:o.value.upcoming,class:"upcoming"};case"approved":if(e.reservation.closed)return{label:o.value.closed,class:"closed"};if(e.reservation.opened&&e.reservation.places>0)return{label:o.value.opened,class:"opened"}}}return{label:"",class:""}}),L=v(()=>e.reservation&&e.reservation.type==="appointment"&&s.value.cabinetType==="employee"&&l.roles.allowWriteAppointments?e.parentWidth<=440?"70px":e.parentWidth<=690?"130px":"160px":"auto"),$=R("amFonts"),h=R("amColors"),S=v(()=>({"--am-c-cc-primary":h.value.colorPrimary,"--am-c-cc-primary-op15":H(h.value.colorPrimary,.15),"--am-c-cc-primary-op70":H(h.value.colorPrimary,.7),"--am-c-cc-error":h.value.colorError,"--am-c-cc-error-op15":H(h.value.colorError,.15),"--am-c-cc-warning":h.value.colorWarning,"--am-c-cc-warning-op15":H(h.value.colorWarning,.15),"--am-c-cc-success":h.value.colorSuccess,"--am-c-cc-success-op15":H(h.value.colorSuccess,.15),"--am-c-cc-bgr":h.value.colorMainBgr,"--am-c-cc-text":h.value.colorMainText,"--am-c-cc-text-op03":H(h.value.colorMainText,.03),"--am-c-cc-text-op10":H(h.value.colorMainText,.1),"--am-c-cc-text-op15":H(h.value.colorMainText,.15),"--am-c-cc-text-op70":H(h.value.colorMainText,.7),"--am-c-cc-text-op90":H(h.value.colorMainText,.9),"--am-font-family":$.value.fontFamily,"--am-status-width":L.value,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(E,T)=>{const w=Gs;return c(),y("div",{class:"am-cc",style:Ce(t(S))},[A(Lo,null,{default:x(()=>[A(Eo,{"heading-class":"am-cc__heading-wrapper",side:t(e).parentWidth>500},{heading:x(()=>[m("div",{class:q(["am-cc__heading",t(e).responsiveClass])},[m("div",{class:q(["am-cc__heading-info",t(e).responsiveClass])},[m("div",{class:q(["am-cc__heading-info__part",t(e).responsiveClass])},[m("div",Hh,k(t(e).start),1),t(e).parentWidth>650?(c(),y("div",Zh,k(t(e).name),1)):D("",!0),t(e).reservation.type==="event"&&t(s).cabinetType==="employee"&&t(e).parentWidth<=650?(c(),y("div",{key:1,class:q(["am-cc__places",t(e).responsiveClass])},k(t(b)),3)):D("",!0),t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(e).customers.length===1&&t(e).customizedOptions.customer.visibility&&t(e).parentWidth<=650?(c(),y("div",{key:2,class:q(["am-cc__customer",t(e).responsiveClass])},k(`${t(e).customers[0].firstName} ${t(e).customers[0].lastName}`),3)):D("",!0),t(e).reservation&&t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(l).roles.allowWriteAppointments&&t(e).parentWidth<=650?(c(),U(ho,{key:3,id:t(e).reservation.id,status:t(e).reservation.status,class:"am-cc__status am-cc__status--dropdown",onStatusChange:T[0]||(T[0]=(B,z)=>t(a)("statusChange",B,z))},null,8,["id","status"])):t(e).booking&&t(e).parentWidth<=650?(c(),y("div",{key:4,class:q(["am-cc__status",`am-cc__status-${t(P).class}`])},k(t(P).label),3)):D("",!0)],2),m("div",{class:q(["am-cc__heading-info__part",t(e).responsiveClass])},[t(e).parentWidth<=650?(c(),y("div",Gh,k(t(e).name),1)):D("",!0),t(e).reservation.type==="event"&&t(s).cabinetType==="employee"&&t(e).parentWidth>650?(c(),y("div",Jh,k(t(b)),1)):D("",!0),t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(e).customers.length===1&&t(e).customizedOptions.customer.visibility&&t(e).parentWidth>650?(c(),y("div",Xh,k(`${t(e).customers[0].firstName} ${t(e).customers[0].lastName}`),1)):D("",!0),t(e).reservation&&t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(l).roles.allowWriteAppointments&&t(e).parentWidth>650?(c(),U(ho,{key:3,id:t(e).reservation.id,status:t(e).reservation.status,class:"am-cc__status am-cc__status--dropdown",onStatusChange:T[1]||(T[1]=(B,z)=>t(a)("statusChange",B,z))},null,8,["id","status"])):t(e).booking&&t(e).parentWidth>650?(c(),y("div",{key:4,class:q(["am-cc__status",`am-cc__status-${t(P).class}`])},k(t(P).label),3)):D("",!0)],2)],2),t(s).cabinetType==="employee"?(c(),y("div",{key:0,class:q(["am-cc__heading-actions",t(e).responsiveClass])},[t(e).reservation.type!=="appointment"||t(l).roles.allowWriteAppointments?(c(),U(w,{key:0,ref:"editRef",visible:t(r),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(S),trigger:"click"},{reference:x(()=>[t(e).reservation?(c(),y("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:u})):D("",!0)]),default:x(()=>[t(e).reservation.type==="appointment"&&t(l).roles.allowWriteAppointments||t(e).reservation.type==="event"&&t(l).roles.allowWriteEvents?zt((c(),y("div",Qh,[m("div",{class:"am-cc__edit-item am-edit",onClick:T[2]||(T[2]=B=>_(t(e).reservation.type))},[Kh,m("span",ev,k(t(o).edit),1)])])),[[t(ia),d]]):D("",!0),t(e).reservation.type==="event"?(c(),y(ee,{key:1},[t(l).roles.allowWriteEvents?zt((c(),y("div",tv,[m("div",{class:"am-cc__edit-item am-edit",onClick:T[3]||(T[3]=B=>g(t(e).reservation))},[av,m("span",sv,k(t(o).event_add_attendee),1)])])),[[t(ia),d]]):D("",!0),zt((c(),y("div",lv,[m("div",{class:"am-cc__edit-item am-edit",onClick:T[4]||(T[4]=B=>C(t(e).reservation))},[nv,m("span",iv,k(t(o).attendees),1)])])),[[t(ia),d]])],64)):D("",!0)]),_:1},8,["visible","popper-style"])):D("",!0)],2)):(t(e).booking&&t(e).booking.status==="approved"||t(e).booking.status==="pending"||t(e).booking.status==="waiting")&&(!t(e).isPackageBooking&&t(e).booking.price>0&&t(ti)(t(e).reservation,t(e).bookable.settings)||!!(t(e).reservation.cancelable||t(l).roles.allowCustomerReschedule&&t(e).reservation.reschedulable))?(c(),y("div",{key:1,class:q(["am-cc__heading-actions",t(e).responsiveClass])},[t(e).booking.status!=="waiting"&&!t(e).isPackageBooking&&t(e).booking.price>0&&t(ti)(t(e).reservation,t(e).bookable.settings)?(c(),U(vr,{key:0,reservation:t(e).reservation,bookable:t(e).bookable},null,8,["reservation","bookable"])):D("",!0),t(e).reservation.cancelable||t(l).roles.allowCustomerReschedule&&t(e).reservation.reschedulable?(c(),U(w,{key:1,ref:"editRef",visible:t(r),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(S),trigger:"click"},{reference:x(()=>[t(e).booking?(c(),y("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:u})):D("",!0)]),default:x(()=>[zt((c(),y("div",ov,[t(e).reservation.type==="appointment"&&t(l).roles.allowCustomerReschedule&&t(e).reservation.reschedulable?(c(),y("div",{key:0,class:"am-cc__edit-item",onClick:O},[rv,m("span",cv,k(t(o).reschedule),1)])):D("",!0),t(e).reservation.cancelable?(c(),y("div",{key:1,class:"am-cc__edit-item am-delete",onClick:f},[uv,m("span",dv,k(t(o).cancel),1)])):D("",!0)])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])):D("",!0)],2)):D("",!0)],2)]),default:x(()=>[m("div",{class:q(["am-cc__content",t(e).responsiveClass])},[m("div",mv,[t(i)==="capc"&&n.customizedOptions.employee.visibility?(c(),y(ee,{key:0},[(Array.isArray(t(e).employee)?t(e).employee.length:Object.keys(t(e).employee).length)?(c(),U(ss,{key:0,"header-text":Array.isArray(t(e).employee)?t(o).view_employees:t(o).provider_profile,type:"employee","content-data":t(e).employee},{default:x(()=>[m("div",pv,[gv,m("span",fv,k(I(t(e).employee)),1)])]),_:1},8,["header-text","content-data"])):D("",!0)],64)):D("",!0),t(i)==="cape"&&t(e).reservation.type==="appointment"&&t(e).customers.length>1&&t(e).customizedOptions.customer.visibility?(c(),y(ee,{key:1},[t(e).customers.length?(c(),U(ss,{key:0,"header-text":t(o).customers,type:"customers","content-data":t(e).customers},{default:x(()=>[m("div",hv,[vv,m("span",_v,k(t(o).customers),1)])]),_:1},8,["header-text","content-data"])):D("",!0)],64)):D("",!0),t(e).price&&t(e).customizedOptions.price.visibility?(c(),y("div",yv,[bv,m("span",kv,k(t(tt)(t(e).price)),1)])):D("",!0),t(e).duration?(c(),y("div",Cv,[xv,m("span",wv,k(t(hs)(t(e).duration,t(o).h,t(o).min)),1)])):D("",!0),n.periods.length?(c(),U(ss,{key:4,"header-text":t(o).event_timetable,type:"period","content-data":t(e).periods},{default:x(()=>[m("div",Tv,[Ev,m("span",Lv,k(t(o).event_timetable),1)])]),_:1},8,["header-text","content-data"])):D("",!0),t(e).googleMeetLink?(c(),y("div",Sv,[Av,m("a",{class:"am-cc__data-text link",href:t(e).googleMeetLink,target:"_blank",tabindex:"-1"},k(t(o).google_meet_link),9,Iv)])):D("",!0),t(e).microsoftTeamsLink?(c(),y("div",Pv,[$v,m("a",{class:"am-cc__data-text link",href:t(e).microsoftTeamsLink,target:"_blank",tabindex:"-1"},k(t(o).microsoft_teams_link),9,Nv)])):D("",!0),t(e).zoomLink?(c(),y("div",Dv,[Ov,m("a",{class:"am-cc__data-text link",href:t(e).zoomLink,target:"_blank",tabindex:"-1"},k(t(o).zoom_link),9,Fv)])):D("",!0),t(e).lessonSpaceLink?(c(),y("div",Mv,[Vv,m("a",{class:"am-cc__data-text link",href:t(e).lessonSpaceLink,target:"_blank",tabindex:"-1"},k(t(o).lesson_space_link),9,Bv)])):D("",!0),Object.keys(t(e).extras).length?(c(),U(ss,{key:9,"header-text":`${Object.keys(t(e).extras).length} ${t(o).extras}`,type:"extras","content-data":t(e).extras},{default:x(()=>[m("div",Rv,[qv,m("span",Uv,k(`${Object.keys(t(e).extras).length} ${t(o).extras}`),1)])]),_:1},8,["header-text","content-data"])):D("",!0),t(e).customFields.length?(c(),U(ss,{key:10,"header-text":t(o).custom_fields,type:"customField","content-data":t(e).customFields},{default:x(()=>[m("div",zv,[jv,m("span",Yv,k(t(o).custom_fields),1)])]),_:1},8,["header-text","content-data"])):D("",!0),Object.keys(t(e).tickets).length?(c(),U(ss,{key:11,"header-text":t(o).event_tickets,type:"ticket","content-data":t(e).tickets},{default:x(()=>[m("div",Wv,[Hv,m("span",Zv,k(t(o).event_tickets),1)])]),_:1},8,["header-text","content-data"])):D("",!0),t(e).location?(c(),y("div",{key:12,class:q(["am-cc__data",{link:t(e).location.address}])},[Gv,t(e).location.address?(c(),y("a",{key:0,class:"am-cc__data-text",href:`https://maps.google.com/?q=${t(e).location.address}`,target:"_blank",tabindex:"-1"},k(t(e).location.name),9,Jv)):(c(),y("span",Xv,k(t(e).location.name),1))],2)):D("",!0)])],2)]),_:1},8,["side"])]),_:1})],4)}}});const Kv={class:"am-csd__header"},e_={class:"am-csd__header-text"},t_=m("span",{class:"am-icon-clearable"},null,-1),a_={class:"am-csd__footer"},s_={name:"AppointmentBooking"},br=Object.assign(s_,{props:{visibility:{type:Boolean,default:!1},appointment:{type:Object,default:null},employees:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},slotsParams:{type:Object,default:()=>{}},isPackage:{type:Boolean,default:!1},labels:{type:Object,required:!0},customizedOptions:{type:Object,required:!0}},emits:["close","success","error","employee-selection","location-selection"],setup(n,{emit:a}){const e=n;let s=Ne();const l=R("settings");let i=M("");function o(J){i.value=J.toLowerCase()}let r=v(()=>i.value?e.employees.filter(J=>`${J.firstName} ${J.lastName}`.toLowerCase().includes(i.value)&&J.show):e.employees.filter(J=>J.show)),u=M("");function d(J){u.value=J.toLowerCase()}let f=v(()=>u.value?e.locations.filter(J=>J.name.toLowerCase().includes(u.value)):e.locations),_=R("amLabels"),g=M(null),C=M(null);rt(()=>e.appointment,J=>{setTimeout(()=>{G.value++},200);let he=JSON.parse(JSON.stringify(J));he&&he.bookingStart&&(g.value=he.bookingStart.split(" ")[0],C.value=he.bookingStart.split(" ")[1].substring(0,5))});let O=M(null),I=M(0),b=R("sidebarCollapsed");window.addEventListener("resize",P);function P(){O.value&&(I.value=O.value.offsetWidth)}rt(b,J=>{J?setTimeout(()=>{L()},1500):setTimeout(()=>{L()},500)});function L(){I.value=O.value.offsetWidth}Je(()=>{ii(()=>{I.value=O.value.offsetWidth})});let $=v(()=>e.visibility);rt($,J=>{J&&setTimeout(()=>{I.value=O.value.offsetWidth},300)});let h=v(()=>st(I.value)),S=M(!1),E=M(null),T=M("");function w(){S.value=!1,T.value=""}let B=M(null),z=v(()=>B.value?B.value.calendarSlotsLoading:!0),N=R("cabinetType"),G=M(0),se=M(!1),j=M({employee:null,location:null}),ne=M(!0),te=M(!0),oe=v(()=>e.appointment&&!e.appointment.id&&(e.employees.length||e.locations.length)&&(e.customizedOptions.employee.visibility||e.customizedOptions.location.visibility)&&(ne.value||te.value)),ie=M(null),K=v(()=>oe.value?{employee:[{required:"employee"in e.customizedOptions?e.customizedOptions.employee.required:!1,message:_.value.please_select_employee,trigger:"submit"}],location:[{required:"location"in e.customizedOptions?e.customizedOptions.location.required:!1,message:_.value.please_select_location,trigger:"submit"}]}:{}),me=v(()=>{let J={};return j.value.employee?J.providerIds=[j.value.employee]:"providerIds"in e.slotsParams&&e.slotsParams.providerIds.length&&(J.providerIds=e.slotsParams.providerIds),j.value.location?J.locationId=j.value.location:"locationId"in e.slotsParams&&e.slotsParams.locationId?J.locationId=e.slotsParams.locationId:J.locationId=null,Object.assign({},e.slotsParams,J)});function Ae(){ie.value&&ie.value.clearValidate(),se.value=!0,G.value++,a("employee-selection",j.value.employee),a("location-selection",j.value.location)}function Ve(J){j.value.employee=J,Ae()}function Q(){oe.value&&(j.value.employee=null,j.value.location=null,ne.value=!0,te.value=!0,Ae()),a("close")}rt($,J=>{J&&e.employees.length===1&&(j.value.employee=e.employees[0].id,ne.value=!1),J&&e.locations.length===1&&(j.value.location=e.locations[0].id,te.value=!1),J&&(e.locations.length===1||e.employees.length===1)&&Ae()});let ve=M();Be("formWrapper",ve);let X=v(()=>s.getters["entities/getService"](e.appointment.serviceId).duration);Be("calendarSlotDuration",X);let F=M(!0);Be("calendarChangeSideBar",F);let Z=M(0);Be("calendarServiceDuration",Z);function W(){"id"in e.appointment?de():xe()}function le(J){let he=J?"UTC":s.getters["cabinet/getTimeZone"],ge=g.value+" "+C.value,Fe=null,ke=null;if(J){let ba=Fi(ge);ke=Oi(ba),Fe=ba}else Fe=ge;return{utcOffset:ke,bookingStart:Fe,timeZone:he}}function de(){B.value.calendarSlotsLoading=!0;let J=le(!1);Us()===s.getters["cabinet/getTimeZone"]&&l.general.showClientTimeZone&&(J.utcOffset=Oi(Fi(g.value+" "+C.value))),De.post("/bookings/reassign/"+e.appointment.bookings.filter(he=>he.status==="approved"||he.status==="pending")[0].id,J,Object.assign(ze(s),{params:{source:"cabinet-"+N.value}})).then(()=>{B.value.calendarSlotsLoading=!1,a("success",{message:_.value.appointment_rescheduled})}).catch(he=>{B.value.calendarSlotsLoading=!1,he.response&&(!("data"in he.response.data)&&"message"in he.response.data&&(S.value=!0,T.value=he.response.data.message,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"customerAlreadyBooked"in he.response.data.data&&(S.value=!0,T.value=e.labels.customer_already_booked_app,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"cancelBookingUnavailable"in he.response.data.data&&(S.value=!0,T.value=e.labels.booking_cancel_exception,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"timeSlotUnavailable"in he.response.data.data&&he.response.data.data.timeSlotUnavailable===!0&&(S.value=!0,T.value=e.labels.time_slot_unavailable,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"rescheduleBookingUnavailable"in he.response.data.data&&he.response.data.data.rescheduleBookingUnavailable===!0&&(S.value=!0,T.value=e.labels.booking_reschedule_exception,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500))),a("error")})}function ae(){B.value.calendarSlotsLoading=!0;let J=le(l.general.showClientTimeZone&&s.getters["cabinet/getTimeZone"]===Us()),he=JSON.parse(JSON.stringify(e.appointment));he.bookingStart=J.bookingStart,he.bookings[0].utcOffset=J.utcOffset,he.bookings[0].timeZone=J.timeZone,he.providerId=parseInt(_e.value),he.locationId=parseInt(pe.value),De.post("/bookings",he,ze(s)).then(ge=>{B.value.calendarSlotsLoading=!1,Zr(s,ge),a("success",{message:_.value.booking_added_success})}).catch(ge=>{B.value.calendarSlotsLoading=!1,ge.response&&("customerAlreadyBooked"in ge.response.data.data&&ge.response.data.data.customerAlreadyBooked===!0&&(S.value=!0,T.value=e.labels.customer_already_booked_app,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"timeSlotUnavailable"in ge.response.data.data&&ge.response.data.data.timeSlotUnavailable===!0&&(S.value=!0,T.value=e.labels.time_slot_unavailable,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"packageBookingUnavailable"in ge.response.data.data&&ge.response.data.data.packageBookingUnavailable===!0&&(S.value=!0,T.value=e.labels.package_booking_unavailable,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500)),"customerBlocked"in ge.response.data.data&&ge.response.data.data.customerBlocked===!0&&(S.value=!0,T.value=e.labels.customer_blocked,setTimeout(function(){dt(ve.value,E.value.$el,0,300)},500))),a("error",ge)})}function xe(){oe.value?ie.value.validate(J=>{J?ae():setTimeout(()=>{dt(ve.value,ie.value.$el,0,300)},200)}):ae()}let _e=M(null),pe=M(null),Te=M(null);function $e(J,he){if(Te.value=he,se.value=!1,!e.appointment.bookingStart){let Fe=So(Object.keys(he));return{calendarStartDate:Fe[0],calendarEventSlots:[],calendarEventDate:Fe[0],calendarEventSlot:null}}let ge=e.appointment.bookingStart.split(" ");return{calendarStartDate:ge[0],calendarEventSlots:ge[0]in he?Object.keys(he[ge[0]]):[],calendarEventDate:ge[0],calendarEventSlot:ge[1].slice(0,5)}}Be("useSlotsCallback",$e),Be("useRange",()=>{if(!e.appointment.bookingStart)return{start:null,end:null};let J=e.appointment.bookingStart.split(" ")[0];return{start:ye(J,"YYYY-MM-DD").startOf("month").subtract(6,"days").format("YYYY-MM-DD"),end:ye(J,"YYYY-MM-DD").endOf("month").add(12,"days").format("YYYY-MM-DD")}}),Be("useSelectedDuration",()=>{});function Oe(){let J=Object.keys(Te.value[g.value]);J.length&&(_e.value=C.value&&Te.value[g.value][C.value]?Te.value[g.value][C.value][0].e:Te.value[g.value][J[0]][0].e,pe.value=C.value&&Te.value[g.value][C.value]?Te.value[g.value][C.value][0].l:Te.value[g.value][J[0]][0].l)}Be("useBusySlots",()=>[]),Be("useSelectedDate",(J,he)=>(g.value=he,e.appointment&&e.appointment.bookingStart&&(C.value=e.appointment.bookingStart.split(" ")[1].substring(0,5)),Oe(),Object.keys(Te.value[he]))),Be("useSelectedTime",(J,he)=>{C.value=he.substring(0,5),g.value?Oe():e.appointment&&(g.value=e.appointment.bookingStart.split(" ")[0],Oe())}),Be("useDeselectedDate",()=>{g.value="",C.value="",_e.value=null,pe.value=null});let Re=R("amFonts"),be=R("amColors"),Ue=v(()=>({"--am-c-csd-text":be.value.colorMainText,"--am-c-csd-bgr":be.value.colorMainBgr,"--am-c-csd-text-op10":H(be.value.colorMainText,.1),"--am-c-scroll-op30":H(be.value.colorPrimary,.3),"--am-c-scroll-op10":H(be.value.colorPrimary,.1),"--am-font-family":Re.value.fontFamily}));return(J,he)=>{const ge=yt,Fe=et;return c(),U(za,{visibility:t(e).visibility,"custom-class":"am-csd am-csd__reschedule",style:Ce(t(Ue)),position:"center"},{footer:x(()=>[m("div",a_,[A(Ee,{category:"secondary",size:t(I)<=360?"small":"default",type:t(e).customizedOptions.cancelBtn.buttonType,disabled:t(se)||t(z),onClick:Q},{default:x(()=>[ce(k(n.labels.cancel),1)]),_:1},8,["size","type","disabled"]),A(Ee,{size:t(I)<=360?"small":"default",type:t(e).customizedOptions.continueBtn.buttonType,disabled:!!(t(se)||t(z)||!t(g)||!t(C)),onClick:W},{default:x(()=>[ce(k(n.labels.continue),1)]),_:1},8,["size","type","disabled"])])]),default:x(()=>[m("div",{ref_key:"popupInnerRef",ref:O,class:"am-csd__inner"},[m("div",Kv,[m("div",e_,k(n.labels.no_selected_slot_requirements),1),m("div",{class:"am-csd__header-btn",onClick:Q},[A(We,{icon:"close"})])]),m("div",{ref_key:"rescheduleRef",ref:ve,class:"am-csd__content"},[t(S)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:E,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:w,onTriggerClose:w},{title:x(()=>[t_,ce(" "+k(t(T)),1)]),_:1},512)):D("",!0),t(oe)?(c(),U(Fe,{key:1,ref_key:"packageFormRef",ref:ie,class:"am-csd__filter-wrapper",rules:t(K),model:t(j),"label-position":"top"},{default:x(()=>[m("div",{class:q(["am-csd__filter am-csd__filter-employee",t(h)])},[t(e).employees.length&&t(ne)&&t(e).customizedOptions.employee.visibility?(c(),U(ge,{key:0,class:q([{"am-csd__filter-full":!(t(e).locations.length&&t(te)&&t(e).customizedOptions.location.visibility)},t(h)]),label:`${t(_).package_appointment_employee}:`,prop:"employee"},{default:x(()=>[A(He,{modelValue:t(j).employee,"onUpdate:modelValue":he[0]||(he[0]=ke=>t(j).employee=ke),clearable:"",filterable:t(e).customizedOptions.employee.filterable,placeholder:`${t(_).package_select_employee}...`,"fit-input-width":!0,"popper-class":"am-csd__filter-employees",disabled:t(se),"filter-method":o,onChange:Ae},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),ke=>(c(),U(qe,{key:ke.id,value:ke.id,label:`${ke.firstName} ${ke.lastName}`},{default:x(()=>[A(Wr,{identifier:ke.id,label:`${ke.firstName} ${ke.lastName}`,price:0,"image-thumb":ke.pictureThumbPath,description:ke.description,"dialog-title":t(_).employee_information_package,"dialog-button-text":t(_).select_this_employee_package,badge:ke.badge,onClick:Ve},null,8,["identifier","label","image-thumb","description","dialog-title","dialog-button-text","badge"])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):D("",!0),t(e).locations.length&&t(te)&&t(e).customizedOptions.location.visibility?(c(),U(ge,{key:1,class:q([{"am-csd__filter-full":!(t(e).employees.length&&t(ne)&&t(e).customizedOptions.employee.visibility)},t(h)]),label:`${t(_).package_appointment_location}:`,prop:"location"},{default:x(()=>[A(He,{modelValue:t(j).location,"onUpdate:modelValue":he[1]||(he[1]=ke=>t(j).location=ke),clearable:"",filterable:t(e).customizedOptions.location.filterable,placeholder:`${t(_).package_select_location}...`,"fit-input-width":!0,disabled:t(se),"filter-method":d,onChange:Ae},{default:x(()=>[(c(!0),y(ee,null,fe(t(f),ke=>(c(),U(qe,{key:ke.id,value:ke.id,label:ke.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):D("",!0)],2)]),_:1},8,["rules","model"])):D("",!0),t(e).appointment!==null?(c(),U(Hr,{key:2,id:0,ref_key:"calendarRef",ref:B,"preselect-slot":!1,"load-counter":t(G),"end-time":t(e).customizedOptions.endTimeVisibility.visibility,"time-zone":t(e).customizedOptions.timeZoneVisibility.visibility,"show-estimated-pricing":t(e).appointment.id&&"estimatedPricingVisibility"in t(e).customizedOptions?t(e).customizedOptions.estimatedPricingVisibility.visibility:!1,"show-indicator-pricing":t(e).appointment.id&&"indicatorPricingVisibility"in t(e).customizedOptions?t(e).customizedOptions.indicatorPricingVisibility.visibility:!1,"show-slot-pricing":t(e).appointment.id&&"slotPricingVisibility"in t(e).customizedOptions?t(e).customizedOptions.slotPricingVisibility.visibility:!1,"label-slots-selected":n.labels.date_time_slots_selected,"fetched-slots":null,"service-id":parseInt(t(e).appointment.serviceId),"is-package":t(e).appointment.bookings[0].packageCustomerService!==null,date:t(e).appointment&&t(e).appointment.bookingStart?t(e).appointment.bookingStart.split(" ")[0]:"","slots-params":t(me)},null,8,["load-counter","end-time","time-zone","show-estimated-pricing","show-indicator-pricing","show-slot-pricing","label-slots-selected","service-id","is-package","date","slots-params"])):D("",!0)],512)],512)]),_:1},8,["visibility","style"])}}});const l_={class:"am-csd__inner"},n_={class:"am-csd__header"},i_={class:"am-csd__header-text"},o_={class:"am-csd__content"},r_={class:"am-ccpss__heading"},c_={class:"am-csd__footer"},u_={name:"CancelBooking"},Ua=Object.assign(u_,{props:{visibility:{type:Boolean,required:!0},title:{type:String,default:""},description:{type:String,default:""},closeBtnText:{type:String,required:!0},confirmBtnText:{type:String,required:!0},loading:{type:Boolean,default:!1},count:{type:Number,default:1},customizedOptions:{type:Object,required:!0}},emits:["close","confirm","decline"],setup(n,{emit:a}){const e=n;let s=R("containerWidth"),l=R("amFonts"),i=R("amColors"),o=v(()=>({"--am-c-csd-text":i.value.colorMainText,"--am-c-csd-bgr":i.value.colorMainBgr,"--am-font-family":l.value.fontFamily}));return(r,u)=>{const d=Ol,f=Fl;return c(),U(za,{visibility:t(e).visibility,"custom-class":"am-csd am-csd__cancel",style:Ce(t(o)),position:"center"},{footer:x(()=>[m("div",c_,[A(Ee,{category:"secondary",size:t(s)<=360?"small":"default",type:n.customizedOptions.cancelBtn.buttonType,disabled:n.loading,onClick:u[1]||(u[1]=()=>{a("decline")})},{default:x(()=>[ce(k(t(e).closeBtnText),1)]),_:1},8,["size","type","disabled"]),A(Ee,{category:"danger",size:t(s)<=360?"small":"default",type:n.customizedOptions.confirmBtn.buttonType,disabled:n.loading,onClick:u[2]||(u[2]=()=>{a("confirm")})},{default:x(()=>[ce(k(t(e).confirmBtnText),1)]),_:1},8,["size","type","disabled"])])]),default:x(()=>[m("div",l_,[n.loading?(c(),U(f,{key:1,animated:"",class:"am-ccpss"},{template:x(()=>[m("div",r_,[A(d,{variant:"rect"})]),(c(!0),y(ee,null,fe(new Array(t(e).count),_=>(c(),y("div",{key:_,class:"am-ccpss__text"},[A(d,{variant:"rect"})]))),128))]),_:1})):(c(),y(ee,{key:0},[m("div",n_,[m("div",i_,k(t(e).title),1),m("div",{class:"am-csd__header-btn",onClick:u[0]||(u[0]=()=>{a("close")})},[A(We,{icon:"close"})])]),m("div",o_,[m("p",null,k(t(e).description),1)])],64))])]),_:1},8,["visibility","style"])}}});const d_={name:"CabinetAppointmentsList"},kr=Object.assign(d_,{props:{groupedAppointments:{type:Object,default:null},responsiveClass:{type:String,default:""},pageWidth:{type:Number},isPackageBooking:{type:Boolean,default:!1},stepKey:{type:String,required:!0}},emits:["booked","canceled","editAppointment","statusChange"],setup(n,{emit:a}){const e=n;let s=Ne(),l=R("originKey");const i=R("settings");let o=R("amLabels"),r=R("cabinetType"),u=M(null),d=M(null),f=M(null);function _(z=null){d.value=null,a("booked",z)}let g=M(!1);function C(){g.value=!0,De.post("/bookings/cancel/"+u.value.id,{type:"appointment"},Object.assign(ze(s),{params:{source:"cabinet-"+r.value}})).then(()=>{u.value=null,a("canceled",{message:o.value.appointment_canceled})}).catch(z=>{console.log(z)}).finally(()=>{g.value=!1})}function O(z){let N={total:0,bookable:0,discount:0,tax:0};return z.bookings.forEach(G=>{if(G.status==="approved"||G.status==="pending"){let se=ci(s,{price:G.price,persons:G.persons,aggregatedPrice:G.aggregatedPrice,extras:G.extras,tax:G.tax,coupon:G.coupon},!1);N.total+=se.total,N.bookable+=se.bookable,N.discount+=se.discount,N.tax+=se.tax}}),N.total-N.discount+N.tax}function I(z){let N=[],G=0,se=z;se.bookings.forEach(ne=>{ne.extras.forEach(te=>{N.push({id:te.extraId,quantity:te.quantity})}),"duration"in ne&&ne.duration&&ne.duration>G&&(ne.status==="approved"||ne.status==="pending")&&(G=ne.duration)});let j={serviceId:se.serviceId,serviceDuration:G||null,locationId:se.locationId,providerIds:[se.providerId],extras:JSON.stringify(N),excludeAppointmentId:se.isGroup?null:se.id,group:1,timeZone:s.getters["cabinet/getTimeZone"],page:"cabinet",structured:!0};d.value=z,f.value=j}function b(z){return s.getters["entities/getEmployee"](z)}function P(z){return z.bookings.filter(N=>N.status!=="rejected"&&N.status!=="canceled").map(N=>{if("info"in N&&N.info){let G="customer"in N?N.customer:{};return Object.assign(G,JSON.parse(N.info))}else return N.customer})}let L=R("amCustomize");const $=R("labels"),h=R("localLanguage");let S=v(()=>i.general.usedLanguages.includes(h.value));function E(z){let N=Qe({...$}),G=L.value[z].translations;return G&&Object.keys(G).forEach(se=>{G[se][h.value]&&S.value?N[se]=G[se][h.value]:G[se].default&&(N[se]=G[se].default)}),N}function T(z){return L.value[z].options}let w=R("amColors"),B=v(()=>({"--am-c-capa-bgr":w.value.colorMainBgr,"--am-c-capa-text":w.value.colorMainText,"--am-c-capa-text-op70":H(w.value.colorMainText,.7),"--am-c-capa-text-op25":H(w.value.colorMainText,.25),"--am-c-capa-primary":w.value.colorPrimary}));return(z,N)=>(c(),y(ee,null,[m("div",{class:q(["am-capa__wrapper",[{"am-no-border":t(e).groupedAppointments&&Object.keys(t(e).groupedAppointments).length===1},t(e).responsiveClass]]),style:Ce(t(B))},[(c(!0),y(ee,null,fe(t(e).groupedAppointments,(G,se)=>(c(),y("div",{key:se,class:"am-capa"},[m("div",{class:q(["am-capa__date",[{"am-today":t(nt)(se)===t(nt)(t(Ke)().format("YYYY-MM-DD"))},{"am-no-flag":t(e).groupedAppointments&&Object.keys(t(e).groupedAppointments).length===1},t(e).responsiveClass]])},k(t(nt)(se)),3),(c(!0),y(ee,null,fe(G.appointments,(j,ne)=>(c(),y(ee,{key:ne},[t(s).getters["entities/getService"](j.serviceId)?(c(),U(yr,{key:0,start:t(vs)(j.bookingStart.split(" ")[1].slice(0,5)),name:t(s).getters["entities/getService"](j.serviceId).name,employee:b(j.provider.id),customers:P(j),price:O(j),duration:t(zf)(t(s),j),periods:[],extras:t(jf)(j.bookings,t(s).getters["entities/getService"](j.serviceId)),tickets:[],"custom-fields":t(hr)(j.bookings,t(r)),location:j.locationId?t(s).getters["entities/getLocation"](j.locationId):null,"google-meet-link":j.googleMeetUrl,"microsoft-teams-link":j.microsoftTeamsUrl,"zoom-link":j.zoomMeeting?j.zoomMeeting.joinUrl:"","lesson-space-link":j.lessonSpace,bookable:j.service,reservation:j,booking:j.bookings[0],"is-package-booking":t(e).isPackageBooking,"responsive-class":t(e).responsiveClass,"parent-width":t(e).pageWidth,"customized-options":T(t(e).stepKey),onCancelBooking:N[0]||(N[0]=te=>{we(u)?u.value=te:u=te}),onRescheduling:I,onEditAppointment:N[1]||(N[1]=te=>{t(a)("editAppointment",te)}),onStatusChange:N[2]||(N[2]=(te,oe)=>t(a)("statusChange",te,oe))},null,8,["start","name","employee","customers","price","duration","extras","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","is-package-booking","responsive-class","parent-width","customized-options"])):D("",!0)],64))),128))]))),128))],6),t(l)==="capc"?(c(),U(Ua,{key:0,visibility:t(u)!==null,title:E("cancelAppointment").cancel_appointment,description:E("cancelAppointment").confirm_cancel_appointment,"close-btn-text":E("cancelAppointment").close,"confirm-btn-text":E("cancelAppointment").confirm,"customized-options":T("cancelAppointment"),loading:t(g),onClose:N[3]||(N[3]=G=>we(u)?u.value=null:u=null),onDecline:N[4]||(N[4]=G=>we(u)?u.value=null:u=null),onConfirm:C},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):D("",!0),t(l)==="capc"?(c(),U(br,{key:1,visibility:t(d)!==null,appointment:t(d),"slots-params":t(f),labels:E("rescheduleAppointment"),"customized-options":T("rescheduleAppointment"),onClose:N[5]||(N[5]=G=>we(d)?d.value=null:d=null),onSuccess:_,onError:N[6]||(N[6]=()=>{})},null,8,["visibility","appointment","slots-params","labels","customized-options"])):D("",!0)],64))}});const m_={style:{float:"right"}},p_={class:"am-capai-def__notify"},g_=["innerHTML"],f_={class:"am-capai-def__notify"},h_=["innerHTML"],v_={props:{slotsProps:{type:Object,required:!0},slotsLoading:{type:Boolean,required:!0},isDisabledDate:{type:Function,required:!0},freeSlots:{type:Object,required:!0},times:{type:Array,required:!0},getFreeTimes:{type:Function,required:!0}},emits:["removeSlots","fetchSlots","changedSlotCondition","getSelectedDatesTimes","filterOut","getFreeTimes","selectDate","selectTime"],setup(n,{expose:a,emit:e}){const s=n;let l=Ne(),i=R("amLabels"),o=R("localLanguage");const r=R("settings");let u=R("licence"),d=R("slotsPricing");function f(F){return""}let _=F=>{let Z=ye(F).format("YYYY-MM-DD");return Z in d.value?"am-slots-"+d.value[Z].type:""};const g=M(null);let{width:C}=ja(g),O=v(()=>st(C.value)),I=M({categoryId:v({get:()=>l.getters["appointment/getCategoryId"],set:F=>{l.commit("appointment/setCategoryId",F||null)}}),serviceId:v({get:()=>l.getters["appointment/getServiceId"],set:F=>{l.commit("appointment/setServiceId",F||null)}}),providerId:v({get:()=>l.getters["appointment/getProviderId"],set:F=>{l.commit("appointment/setProviderId",F||null)}}),locationId:v({get:()=>l.getters["appointment/getLocationId"],set:F=>{l.commit("appointment/setLocationId",F||null)}}),lessonSpace:v({get:()=>l.getters["appointment/getLessonSpace"],set:F=>{l.commit("appointment/setLessonSpace",F||"")}}),startDate:v({get:()=>l.getters["appointment/getStartDate"],set:F=>{l.commit("appointment/setStartDate",F||"")}}),startTime:v({get:()=>l.getters["appointment/getStartTime"],set:F=>{l.commit("appointment/setStartTime",F||"")}}),notifyParticipants:v({get:()=>l.getters["appointment/getNotifyParticipants"],set:F=>{l.commit("appointment/setNotifyParticipants",F)}}),createPaymentLinks:v({get:()=>l.getters["appointment/getCreatePaymentLinks"],set:F=>{l.commit("appointment/setCreatePaymentLinks",F)}}),internalNotes:v({get:()=>l.getters["appointment/getInternalNotes"],set:F=>{l.commit("appointment/setInternalNotes",F||"")}})}),b=v(()=>({serviceId:[{required:!0,message:i.value.please_select_service,trigger:["submit","change"]}],startDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],startTime:[{required:!0,message:i.value.select_time_warning,trigger:["submit","change"]}]})),P=v(()=>l.getters["entities/filteredCategories"](l.getters["appointment/getSelection"])),L=M(l.getters["entities/filteredCategories"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),$=M("");function h(F){$.value=F.toLowerCase()}let S=v(()=>$.value?L.value.filter(F=>F.name.toLowerCase().includes($.value)):L.value),E=v(()=>l.getters["entities/filteredServices"](l.getters["appointment/getSelection"])),T=M(l.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null}));function w(F){let Z=l.getters["entities/getService"](F),W=Z&&Z.settings?JSON.parse(Z.settings):null,le=W&&"payments"in W&&W.payments&&"paymentLinks"in W.payments&&W.payments.paymentLinks?W.payments.paymentLinks:r.payments.paymentLinks;return le&&le.enabled}let B=M("");function z(F){B.value=F.toLowerCase()}let N=v(()=>B.value?T.value.filter(F=>F.name.toLowerCase().includes(B.value)):T.value),G=v(()=>l.getters["appointment/getId"]&&l.getters["appointment/getServiceId"]&&T.value.map(F=>F.id).indexOf(l.getters["appointment/getServiceId"])===-1?l.getters["entities/getService"](l.getters["appointment/getServiceId"]):null),se=v(()=>l.getters["entities/filteredLocations"](l.getters["appointment/getSelection"])),j=M(l.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),ne=M("");function te(F){ne.value=F.toLowerCase()}let oe=v(()=>ne.value?j.value.filter(F=>F.name.toLowerCase().includes(ne.value)):j.value),ie=v(()=>l.getters["appointment/getId"]&&l.getters["appointment/getLocationId"]&&j.value.map(F=>F.id).indexOf(l.getters["appointment/getLocationId"])===-1?l.getters["entities/getLocation"](l.getters["appointment/getLocationId"]):null),K=M(l.getters["entities/getSpaces"]);function me(){l.commit("appointment/setTargetedDate",null),l.commit("appointment/setStartDate",null),l.commit("appointment/setStartTime",null),e("removeSlots")}function Ae(F,Z=null,W=!1){let le=l.getters["appointment/getTargetedDate"];!F&&!le?F=ye().toDate():!F&&le&&(F=le),l.commit("appointment/setTargetedDate",F&&W?F:le),I.value.serviceId&&e("fetchSlots",F,Z,W)}function Ve(){I.value.startDate&&Ae(I.value.startDate)}function Q(F){e("selectTime",F)}function ve(F){F?e("selectDate",F):me()}function X(F){F?(clearTimeout(this.searchSpacesTimer),l.commit("auth/setSpacesLoading",!0),De.get("/entities",{params:{types:["spaces"],lessonSpaceSearch:F}}).then(Z=>{K.value=Z.data.data.spaces}).catch(Z=>{console.log(Z)}).finally(()=>{l.commit("auth/setSpacesLoading",!1)})):K.value=l.getters["entities/getSpaces"]}return rt(()=>I.value.serviceId,F=>{l.dispatch("appointment/updateEmployeeService",F||null),F&&(l.dispatch("appointment/recreateAllBookingCustomFields",{label:i.value.required_field}),Ve())}),Je(()=>{T.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setServiceId",T.value[0].id),j.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setLocationId",j.value[0].id)}),a({detailsFormRef:g}),(F,Z)=>{const W=yt,le=Ml,de=et;return c(),U(de,{ref_key:"detailsFormRef",ref:g,model:t(I),rules:t(b),class:"am-capai-def"},{default:x(()=>[t(L).length>1?(c(),U(W,{key:0,label:`${t(i).category}`,class:"am-capai-def__item"},{default:x(()=>[A(He,{modelValue:t(I).categoryId,"onUpdate:modelValue":Z[0]||(Z[0]=ae=>t(I).categoryId=ae),clearable:"",filterable:"",placeholder:`${t(i).select_service_category}`,"filter-method":h},{default:x(()=>[(c(!0),y(ee,null,fe(t(S),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name,disabled:t(I).serviceId&&typeof t(P).find(xe=>xe.id===ae.id)>"u"},null,8,["value","label","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),A(W,{label:`${t(i).services_dropdown}`,prop:"serviceId",class:"am-capai-def__item"},{default:x(()=>[A(He,{modelValue:t(I).serviceId,"onUpdate:modelValue":Z[1]||(Z[1]=ae=>t(I).serviceId=ae),disabled:t(T).length===1,clearable:"",filterable:"",placeholder:`${t(i).select_service}`,"filter-method":z},{default:x(()=>[(c(!0),y(ee,null,fe(t(N),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name,disabled:typeof t(E).find(xe=>xe.id===ae.id)>"u"},null,8,["value","label","disabled"]))),128)),t(G)?(c(),U(qe,{key:t(G).id,value:t(G).id,label:t(G).name},null,8,["value","label"])):D("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),!t(u).isStarter&&t(j).length>1?(c(),U(W,{key:1,label:`${t(i).location}`,class:"am-capai-def__item"},{default:x(()=>[A(He,{modelValue:t(I).locationId,"onUpdate:modelValue":Z[2]||(Z[2]=ae=>t(I).locationId=ae),disabled:t(j).length===1,clearable:"",filterable:"",placeholder:`${t(i).select_location}`,"filter-method":te,onChange:Ve},{default:x(()=>[(c(!0),y(ee,null,fe(t(oe),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name,disabled:t(ie)===null&&typeof t(se).find(xe=>xe.id===ae.id)>"u"},null,8,["value","label","disabled"]))),128)),t(ie)?(c(),U(qe,{key:t(ie).id,value:t(ie).id,label:t(ie).name},null,8,["value","label"])):D("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])):D("",!0),t(r).lessonSpace.enabled?(c(),U(W,{key:2,label:`${t(i).lesson_space}`,class:"am-capai-def__item"},{default:x(()=>[A(He,{modelValue:t(I).lessonSpace,"onUpdate:modelValue":Z[3]||(Z[3]=ae=>t(I).lessonSpace=ae),filterable:"",clearable:"",remote:"","remote-method":X,placeholder:`${t(i).select}`},{default:x(()=>[(c(),U(qe,{key:0,value:0,label:t(i).lesson_space_new_space},null,8,["label"])),(c(!0),y(ee,null,fe(t(K),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),A(W,{label:`${t(i).date}`,prop:"startDate",class:q(["am-capai-def__item am-w-50",t(O)])},{default:x(()=>[A(Yt,{modelValue:t(I).startDate,"onUpdate:modelValue":Z[4]||(Z[4]=ae=>t(I).startDate=ae),type:"date",format:t(jt)(),placeholder:t(i).select_date,clearable:!0,lang:t(o),disabled:!t(I).serviceId,"disabled-date":(ae,xe)=>t(s).isDisabledDate(ae,null,!0,xe),"popper-class":n.slotsLoading?"am-slots-loader":"","cell-class-name":t(_),onPanelChange:Z[5]||(Z[5]=ae=>{Ae(ae,null,!0)}),onChange:ve,onFocus:Z[6]||(Z[6]=ae=>t(I).serviceId&&!t(I).startDate?Ae(null,null,!0):!1)},null,8,["modelValue","format","placeholder","lang","disabled","disabled-date","popper-class","cell-class-name"])]),_:1},8,["label","class"]),A(W,{label:`${t(i).time}`,prop:"startTime",class:q(["am-capai-def__item am-w-50",t(O)])},{default:x(()=>[A(He,{modelValue:t(I).startTime,"onUpdate:modelValue":Z[7]||(Z[7]=ae=>t(I).startTime=ae),placeholder:`${t(i).select_time}`,disabled:!t(I).startDate,"prefix-icon":"clock",onChange:Q},{default:x(()=>[(c(!0),y(ee,null,fe(t(s).getFreeTimes(null,{date:t(I).startDate,times:t(s).times,time:t(I).startTime},!0),ae=>(c(),U(qe,{key:ae,value:ae,label:ae},{default:x(()=>[ce(k(t(vs)(ae))+" ",1),m("span",m_,k(f()),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label","class"]),A(W,{class:"am-capai-def__item"},{default:x(()=>[m("div",p_,[A(mt,{modelValue:t(I).notifyParticipants,"onUpdate:modelValue":Z[8]||(Z[8]=ae=>t(I).notifyParticipants=ae),label:t(i).notify_customers},null,8,["modelValue","label"]),A(le,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(i).notify_customers_tooltip},null,8,g_)]),default:x(()=>[A(We,{icon:"info-reverse"})]),_:1})])]),_:1}),t(I).notifyParticipants&&t(I).serviceId&&w(t(I).serviceId)?(c(),U(W,{key:3,class:"am-capai-def__item"},{default:x(()=>[m("div",f_,[A(mt,{modelValue:t(I).createPaymentLinks,"onUpdate:modelValue":Z[9]||(Z[9]=ae=>t(I).createPaymentLinks=ae),label:t(i).generate_payment_links},null,8,["modelValue","label"]),A(le,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(i).generate_payment_links_tooltip},null,8,h_)]),default:x(()=>[A(We,{icon:"info-reverse"})]),_:1})])]),_:1})):D("",!0),A(W,{label:`${t(i).note_internal}`,class:"am-capai-def__item"},{default:x(()=>[A(it,{modelValue:t(I).internalNotes,"onUpdate:modelValue":Z[10]||(Z[10]=ae=>t(I).internalNotes=ae),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};function Cr(n,a){return Object.assign({},a,{gender:a.gender?a.gender:"",note:a.note?a.note:"",phone:a.phone?a.phone:"",birthday:a.birthday?ye(a.birthday.date.split(" ")[0]).toDate():null,translations:a.translations?JSON.parse(a.translations):{defaultLanguage:""}})}function __(n){let a=n.getters["customerInfo/getCustomer"];return Object.assign({},a,{birthday:a.birthday?ye(a.birthday).format("YYYY-MM-DD"):null,translations:a.translations.defaultLanguage?JSON.stringify(a.translations):null})}const y_=m("span",{class:"am-icon-triangle-info"},null,-1),b_={key:0,class:"am-capai-warn__content"},k_={key:0,class:"am-capai-warn__heading"},C_={key:1,class:"am-capai-warn__text"},xr={props:{heading:{type:String,default:""},text:{type:String,default:""}},setup(n){const a=n;let e=R("amColors"),s=v(()=>({"--am-c-warning":e.value.colorWarning,"--am-c-warning-op10":H(e.value.colorWarning,.1),"--am-c-main-text":e.value.colorMainText,"--am-c-main-text-op10":H(e.value.colorMainText,.1)}));return(l,i)=>(c(),y("div",{class:"am-capai-warn",style:Ce(t(s))},[y_,a.heading||a.text?(c(),y("div",b_,[a.heading?(c(),y("div",k_,k(a.heading),1)):D("",!0),a.text?(c(),y("div",C_,k(a.text),1)):D("",!0)])):D("",!0)],4))}};const x_={class:"am-cap-aec__header"},w_=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),wr={props:{visibility:{type:Boolean,required:!0},customCss:{type:Object,default:()=>{}},responsiveClass:{type:String,default:""}},emits:["update:visibility","addedCustomer"],setup(n,{emit:a}){const e=n,s=R("settings");let l=R("amLabels");const i=Ne();let o=M("details"),r=M(null),u=M(!1),d=M("success"),f=M("");function _(){u.value=!1,i.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let g=v(()=>i.getters["customerInfo/getCustomerId"]),C=v(()=>{let j=[];return s.wordpress.locale in i.getters["entities/getSettings"].languages&&j.push({value:i.getters["entities/getSettings"].languages[s.wordpress.locale].wp_locale,label:i.getters["entities/getSettings"].languages[s.wordpress.locale].name}),s.general.usedLanguages.forEach(ne=>{ne in i.getters["entities/getSettings"].languages&&j.push({value:i.getters["entities/getSettings"].languages[ne].wp_locale,label:i.getters["entities/getSettings"].languages[ne].name})}),j}),O=M(null),I=M(!1),b=M({firstName:v({get:()=>i.getters["customerInfo/getCustomerFirstName"],set:j=>{i.commit("customerInfo/setCustomerFirstName",j||"")}}),lastName:v({get:()=>i.getters["customerInfo/getCustomerLastName"],set:j=>{i.commit("customerInfo/setCustomerLastName",j||"")}}),email:v({get:()=>i.getters["customerInfo/getCustomerEmail"],set:j=>{i.commit("customerInfo/setCustomerEmail",j||"")}}),phone:v({get:()=>i.getters["customerInfo/getCustomerPhone"],set:j=>{i.commit("customerInfo/setCustomerPhone",j||"")}}),language:v({get:()=>i.getters["customerInfo/getCustomerLanguage"],set:j=>{i.commit("customerInfo/setCustomerLanguage",j||"")}}),gender:v({get:()=>i.getters["customerInfo/getCustomerGender"],set:j=>{i.commit("customerInfo/setCustomerGender",j||"")}}),birthday:v({get:()=>i.getters["customerInfo/getCustomerBirthday"]||"",set:j=>{i.commit("customerInfo/setCustomerBirthday",j?ye(j).format("YYYY-MM-DD"):"")}}),note:v({get:()=>i.getters["customerInfo/getCustomerNote"],set:j=>{i.commit("customerInfo/setCustomerNote",j||"")}})}),P=M({firstName:[{required:!0,message:l.value.enter_first_name_warning,trigger:["submit","blur"]}],lastName:[{required:!0,message:l.value.enter_last_name_warning,trigger:["submit","blur"]}]}),L=M({firstName:{template:Ye.text,props:{itemName:"firstName",label:l.value.first_name_colon,placeholder:l.value.enter_first_name,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="user"/>'})}},lastName:{template:Ye.text,props:{itemName:"lastName",label:l.value.last_name_colon,placeholder:l.value.enter_last_name,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="user"/>'})}},email:{template:Ye.text,props:{itemName:"email",label:l.value.email_colon,placeholder:l.value.enter_email,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="email"/>'})}},phone:{countryPhoneIso:v({get:()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]||"",set:j=>{i.commit("customerInfo/setCustomerCountryPhoneIso",j?j.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:l.value.phone_colon,placeholder:l.value.enter_phone,defaultCode:v(()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]?i.getters["customerInfo/getCustomerCountryPhoneIso"]:s.general.phoneDefaultCountryCode&&s.general.phoneDefaultCountryCode!=="auto"?s.general.phoneDefaultCountryCode:""),phoneError:v(()=>I.value),whatsAppLabel:l.value.whatsapp_opt_in_text,isWhatsApp:s.notifications.whatsAppEnabled&&s.notifications.whatsAppAccessToken&&s.notifications.whatsAppBusinessID&&s.notifications.whatsAppPhoneID,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}},language:{template:Ye.select,props:{itemName:"language",label:l.value.notification_language,placeholder:l.value.language,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:`
          <IconComponent icon="pennant"/>`}),options:C.value}},gender:{template:Ye.select,props:{itemName:"gender",label:l.value.gender,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:`
          <IconComponent icon="gender"/>`}),options:[{label:l.value.female,value:"female"},{label:l.value.male,value:"male"}]}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:l.value.date_of_birth,placeholder:l.value.enter_date_of_birth,clearable:!0,readonly:!1,class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}},note:{template:Ye["text-area"],props:{itemName:"note",label:l.value.note_internal,itemType:"textarea",class:v(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}}});function $(){i.dispatch("customerInfo/resetCustomer"),a("update:visibility",!1)}let h=v(()=>i.getters["customerInfo/getLoading"]);function S(){O.value.validate(j=>{if(!j){o.value="details";return}i.commit("customerInfo/setLoading",!0);let ne=__(i);const te={};for(const oe in B){const ie=B[oe],K=T[oe];te[oe]={label:ie.label,type:ie.type,value:typeof K=="string"?K.trim():K}}ne.customFields=JSON.stringify(te),De.post("/users/customers"+(ne.id?"/"+ne.id:""),ne,Object.assign(ze(i),{params:{source:"cabinet-provider"}})).then(oe=>{i.commit("auth/setPreloadedCustomers",i.getters["auth/getPreloadedCustomers"].concat([oe.data.data.user]).sort((ie,K)=>ie.id-K.id)),a("addedCustomer",oe.data.data.user),$()}).catch(oe=>{"response"in oe&&oe.response&&(f.value=oe.response.data.message,u.value=!0)}).finally(()=>{i.commit("customerInfo/setLoading",!1)})})}Gr(()=>{g.value!==null&&N()});const E=M(null),T=Qe({}),w=Qe({}),B=Qe({});function z(j,ne){if(w[ne]={template:Ye[j.type],props:{id:ne,itemName:ne.toString(),label:j.label,options:j.options,class:`am-cap-aec-cf__item am-cf-width-${j.width}`}},j.type==="text-area"&&(w[ne].props.itemType="textarea"),j.type==="datepicker"&&(w[ne].props.weekStartsFromDay=s.wordpress.startOfWeek),j.type==="file"){let te=i.getters["auth/getProfile"]?i.getters["auth/getProfile"].id:null;w[ne].props={...w[ne].props,btnLabel:l.value.upload_file_here,isUpload:!0,bookingId:te,source:"cabinet-customer"}}}function N(){const j=i.getters["entities/getCustomFields"],ne=v(()=>{const te=i.getters["customerInfo/getCustomerCustomFields"];return te?JSON.parse(te):null});j.filter(te=>te.saveType==="customer"&&te.type!=="content").forEach(te=>{const{id:oe}=te,ie=g.value&&ne.value?ne.value[oe]?.value:null;B[oe]={...te,value:ie??(te.type==="checkbox"||te.type==="file"?[]:"")},T[oe]=B[oe].value??"",z(te,oe)})}let G=R("amColors"),se=v(()=>({"--am-c-aec-text":G.value.colorMainText}));return(j,ne)=>{const te=et,oe=va,ie=_a;return c(),U(za,{visibility:e.visibility,position:"center","custom-class":"am-slide-popup-aec","custom-css":{...n.customCss,...t(se)},"onUpdate:visibility":$},{header:x(()=>[m("div",x_,[t(g)?(c(),y(ee,{key:0},[ce(k(t(l).edit_customer),1)],64)):(c(),y(ee,{key:1},[ce(k(t(l).add_customer),1)],64))])]),footer:x(()=>[A(Ee,{type:"plain",category:"secondary",onClick:$},{default:x(()=>[ce(k(t(l).cancel),1)]),_:1}),A(Ee,{onClick:S},{default:x(()=>[ce(k(t(l).save),1)]),_:1})]),default:x(()=>[t(u)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:r,type:t(d),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:_,onTriggerClose:_},{title:x(()=>[w_,ce(" "+k(t(f)),1)]),_:1},8,["type"])):D("",!0),t(h)?(c(),U(Wt,{key:2})):(c(),U(ie,{key:1,modelValue:t(o),"onUpdate:modelValue":ne[0]||(ne[0]=K=>we(o)?o.value=K:o=K)},{default:x(()=>[A(oe,{class:"am-cap__tabs-item",label:t(l).details,name:"details"},{default:x(()=>[A(te,{ref_key:"customerFormRef",ref:O,model:t(b),rules:t(P),"label-position":"top",class:"am-cap-aec__form"},{default:x(()=>[(c(!0),y(ee,null,fe(t(L),(K,me)=>(c(),U(pt(K.template),St({key:me},K.props,{modelValue:t(b)[me],"onUpdate:modelValue":Ae=>t(b)[me]=Ae,countryPhoneIso:K.countryPhoneIso,"onUpdate:countryPhoneIso":Ae=>K.countryPhoneIso=Ae}),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["label"]),Object.keys(t(B)).length?(c(),U(oe,{key:0,class:"am-cap__tabs-item",label:t(l).custom_fields,name:"customFields"},{default:x(()=>[t(h)?D("",!0):(c(),U(te,{key:0,ref_key:"customFieldsFormRef",ref:E,model:t(T),"label-position":"top",class:q(["am-cap-aec__form",n.responsiveClass])},{default:x(()=>[(c(!0),y(ee,null,fe(Object.keys(t(B)),K=>(c(),y(ee,{key:K},[K in t(T)?(c(),U(pt(t(w)[K]?.template),St({key:0,modelValue:t(T)[K],"onUpdate:modelValue":me=>t(T)[K]=me},t(w)[K]?.props),null,16,["modelValue","onUpdate:modelValue"])):D("",!0)],64))),128))]),_:1},8,["model","class"]))]),_:1},8,["label"])):D("",!0)]),_:1},8,["modelValue"]))]),_:1},8,["visibility","custom-css"])}}};const T_={class:"am-cap__cust-option"},E_={class:"am-cap__cust-option__heading"},L_={key:0,class:"am-cap__cust-option__inner"},S_={key:1,class:"am-cap__cust-option__inner"},A_={class:"am-capai-cuf__content"},I_={class:"am-capai-cuf__bulk-label"},P_={key:0,class:"am-capai-customer__data"},$_=m("span",{class:"am-icon-phone"},null,-1),N_=["href"],D_={key:1,class:"am-capai-customer__data"},O_=m("span",{class:"am-icon-email"},null,-1),F_=["href"],M_={props:{responsiveClass:{type:String,default:""},capacityWarning:{type:String,default:""},appointmentCapacity:{type:Number,default:0},savedAppointment:{type:Object,default:()=>{}}},emits:["changedSlotCondition"],setup(n,{expose:a,emit:e}){const s=n;let l=Ne();const i=R("shortcodeData"),o=R("settings");let r=R("amCustomize"),u=R("amLabels"),d=R("pageWidth"),f=v(()=>l.getters["appointment/getEmployeeService"]),_=M(null),g=M({customersIds:v({get:()=>l.getters["customerInfo/getCustomersIds"],set:K=>l.commit("customerInfo/setCustomersIds",K)})}),C=M({customersIds:[{required:!0,message:u.value.select_customers,trigger:["submit","change"]}]}),O=v(()=>l.getters["customerInfo/getLoading"]),I=v(()=>l.getters["customerInfo/getCustomers"]),b=M(o.general.defaultAppointmentStatus),P=v(()=>_r().filter(K=>l.getters["appointment/getId"]?K.value!=="waiting":(K.value==="approved"||K.value==="pending")&&K.value!=="no-show")),L=v(()=>l.getters["appointment/getBookings"]?l.getters["appointment/getBookings"]:[]),$=M(!1);function h(K){l.commit("customerInfo/setCustomersIds",[K.id].concat(l.getters["customerInfo/getCustomersIds"])),l.commit("customerInfo/setCustomers",[K].concat(l.getters["customerInfo/getCustomers"])),S()}function S(){let K=l.getters["appointment/getBookings"].map(X=>parseInt(X.customer.id)),me=!1,Ae=f.value.settings?JSON.parse(f.value.settings):null;g.value.customersIds.filter(X=>!K.includes(X)).forEach(X=>{let F={};s.savedAppointment&&s.savedAppointment.bookings.forEach(Z=>{parseInt(Z.customer.id)===parseInt(X)&&(F=Z)}),me=l.getters["appointment/getBookings"].length>1,l.getters["appointment/getBookings"].push(Object.assign({id:null,customer:I.value.find(Z=>Z.id===parseInt(X)),persons:1,status:Ae&&"general"in Ae&&"defaultAppointmentStatus"in Ae.general?Ae.general.defaultAppointmentStatus:o.general.defaultAppointmentStatus,duration:Object.keys(f.value.customPricing.durations)[0],extras:f.value.extras.map(Z=>new Object({extraId:Z.id,quantity:0})),customFields:{}},F)),l.dispatch("appointment/resetBookingCustomFields",l.getters["appointment/getBookings"].length-1),l.dispatch("appointment/addCustomFieldsFormRules",{key:l.getters["appointment/getBookings"].length-1,label:u.value.required_field}),l.commit("appointment/setBooking",{index:l.getters["appointment/getBookings"].length-1,value:l.getters["appointment/getBookings"][l.getters["appointment/getBookings"].length-1]})});let Ve=K.filter(X=>!g.value.customersIds.includes(X)),Q=[];l.getters["appointment/getBookings"].forEach((X,F)=>{Ve.indexOf(X.customer.id)!==-1&&Q.push(F)});let ve=l.getters["appointment/getBookings"].length;for(let X=ve-1;X>=0;X--)Q.indexOf(X)!==-1&&(me=!0,l.dispatch("appointment/removeBooking",X));me&&e("changedSlotCondition")}function E(){l.dispatch("customerInfo/resetCustomer"),$.value=!0}function T(K){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),$.value=!0,De.get("/users/customers/"+K,Object.assign({params:{source:"cabinet-provider"}},ze(l))).then(me=>{l.commit("customerInfo/setCustomer",Cr(l,me.data.data.user))}).catch(me=>{console.log(me)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}function w(K){l.dispatch("appointment/removeBooking",K),l.dispatch("appointment/deleteAllCustomFieldsFormRules"),l.dispatch("appointment/addAllCustomFieldsFormRules",{label:u.value.required_field}),e("changedSlotCondition")}const{noShowData:B}=R("noShowData");function z(K,me){return K&&me?"am-w-50":""}function N(K){K&&l.commit("appointment/setAllBookingsStatus",K)}function G(K,me){l.commit("appointment/setBookingStatus",{index:K,value:me})}function se(K,me){l.commit("appointment/setBookingPersons",{index:K,value:me}),e("changedSlotCondition")}function j(K,me){l.commit("appointment/setBookingDuration",{index:K,value:me}),e("changedSlotCondition")}let ne=v(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerPhone.visibility:!0),te=v(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerEmail.visibility:!0),oe=R("amColors"),ie=v(()=>({"--am-c-card-text":oe.value.colorMainText}));return Je(()=>{if(l.getters["appointment/getId"]){let K=l.getters["appointment/getBookings"].map(me=>me.customer.id);l.commit("customerInfo/setCustomersIds",K),Hs(l,"",{limit:K.length,customers:K},()=>{l.commit("customerInfo/setCustomers",l.getters["customerInfo/getCustomers"].concat(l.getters["auth/getPreloadedCustomers"].filter(me=>l.getters["customerInfo/getCustomers"].map(Ae=>Ae.id).indexOf(me.id)===-1)).sort((me,Ae)=>me.id-Ae.id))})}else l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),a({customersFormRef:_}),(K,me)=>{const Ae=yt,Ve=et;return c(),y("div",{class:"am-capai-cuf",style:Ce(t(ie))},[s.capacityWarning?(c(),U(xr,{key:0,heading:s.capacityWarning},null,8,["heading"])):D("",!0),m("div",{class:q(["am-capai-cuf__heading",s.responsiveClass])},[A(Ve,{ref_key:"customersFormRef",ref:_,model:t(g),rules:t(C),class:q(["am-capai-cuf__heading-form",s.responsiveClass])},{default:x(()=>[A(Ae,{prop:"customersIds",class:"am-capai-cuf__heading-form__item"},{default:x(()=>[A(He,{modelValue:t(g).customersIds,"onUpdate:modelValue":me[0]||(me[0]=Q=>t(g).customersIds=Q),filterable:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","popper-class":"am-capai-cuf__popper-customer",placeholder:`${t(u).select_customers}`,"remote-method":Q=>{t(Hs)(t(l),Q)},loading:t(O),onChange:S,onFocus:me[1]||(me[1]=Q=>t(Si)(t(l)))},{default:x(()=>[(c(!0),y(ee,null,fe(t(I),Q=>(c(),U(qe,{key:Q.id,disabled:t(f)?.maxCapacity===n.appointmentCapacity&&t(g).customersIds.indexOf(Q.id)===-1,value:Q.id,label:Q.email&&t(te)?Q.email:Q.firstName+" "+Q.lastName},{default:x(()=>[m("div",T_,[m("div",E_,k(Q.firstName+" "+Q.lastName),1),t(te)&&Q.email?(c(),y("div",L_,k(Q.email),1)):D("",!0),t(ne)&&Q.phone?(c(),y("div",S_,k(Q.phone),1)):D("",!0)])]),_:2},1032,["disabled","value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})]),_:1},8,["model","rules","class"]),t(o).roles.allowWriteCustomers?(c(),U(Ee,{key:0,class:q(["am-capai-cuf__heading-add",s.responsiveClass]),size:"default",prefix:"plus",icon:"plus","icon-only":t(d)<=540,disabled:t(f)?.maxCapacity===n.appointmentCapacity,onClick:E},{default:x(()=>[ce(k(t(u).new_customer),1)]),_:1},8,["class","icon-only","disabled"])):D("",!0)],2),m("div",A_,[t(l).getters["appointment/getBookings"].length>1?(c(),y("div",{key:0,class:q(["am-capai-cuf__bulk",s.responsiveClass])},[m("div",I_,k(t(u).change_group_status),1),A(He,{modelValue:t(b),"onUpdate:modelValue":me[2]||(me[2]=Q=>we(b)?b.value=Q:b=Q),clearable:"",size:"small",placeholder:"Group Status","popper-class":"am-capai-cuf__popper","parent-class":`am-capai-cuf__bulk-status ${s.responsiveClass}`,"prefix-icon":t(b)?t(P).find(Q=>Q.value===t(b)).icon:"circle-empty","prefix-icon-color":t(b)?t(P).find(Q=>Q.value===t(b)).color:"var(--am-c-select-text-op40)",onChange:N},{default:x(()=>[(c(!0),y(ee,null,fe(t(P),Q=>(c(),U(qe,{key:Q.value,value:Q.value,label:Q.label},{default:x(()=>[m("span",{class:q(`am-icon-${Q.icon}`),style:Ce(`color: ${Q.color}`)},null,6),ce(" "+k(Q.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","parent-class","prefix-icon","prefix-icon-color"])],2)):D("",!0),(c(!0),y(ee,null,fe(t(L),(Q,ve)=>(c(),y("div",{key:ve,class:q(["am-capai-cuf__card",s.responsiveClass])},[m("div",{class:q(["am-capai-cuf__card-info",s.responsiveClass])},[m("div",{class:q(["am-capai-customer__name",t(B)(Q.customer.noShowCount).class])},[t(B)(Q.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(B)(Q.customer.noShowCount).icon}`)},null,2)):D("",!0),ce(" "+k(Q.customer.firstName+" "+Q.customer.lastName),1)],2),Q.customer.phone&&t(ne)?(c(),y("div",P_,[$_,m("a",{href:`tel:${Q.customer.phone}`},k(Q.customer.phone),9,N_)])):D("",!0),Q.customer.email&&t(te)?(c(),y("div",D_,[O_,m("a",{href:`mailto:${Q.customer.email}`},k(Q.customer.email),9,F_)])):D("",!0)],2),m("div",{class:q(["am-capai-cuf__card-booking",s.responsiveClass])},[A(He,{modelValue:Q.status,"onUpdate:modelValue":X=>Q.status=X,"prefix-icon":t(P).find(X=>X.value===Q.status).icon,"prefix-icon-color":t(P).find(X=>X.value===Q.status).color,"popper-class":"am-capai-cuf__popper",size:"small",onChange:X=>G(ve,X)},{default:x(()=>[(c(!0),y(ee,null,fe(t(P),X=>(c(),U(qe,{key:X.value,value:X.value,label:t(P).find(F=>F.value===Q.status).label},{default:x(()=>[m("span",{class:q(`am-icon-${X.icon}`),style:Ce(`color: ${X.color}`)},null,6),ce(" "+k(X.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","prefix-icon","prefix-icon-color","onChange"]),t(f).maxCapacity>1?(c(),U(He,{key:0,modelValue:Q.persons,"onUpdate:modelValue":X=>Q.persons=X,"parent-class":`${z(t(f).maxCapacity>1,t(f).customPricing.enabled==="duration")} ${s.responsiveClass}`,placeholder:t(u).persons,"prefix-icon":"users","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:X=>se(ve,X)},{default:x(()=>[(c(!0),y(ee,null,fe(t(f)?.maxCapacity,X=>(c(),U(qe,{key:X,disabled:n.appointmentCapacity-Q.persons+X>t(f)?.maxCapacity,value:X,label:X},null,8,["disabled","value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):D("",!0),t(f).customPricing.durations.enabled==="duration"?(c(),U(He,{key:1,modelValue:Q.duration,"onUpdate:modelValue":X=>Q.duration=X,"parent-class":`${z(t(f).maxCapacity>1,t(f).customPricing.durations.enabled==="duration")} ${s.responsiveClass}`,placeholder:t(u).duration,"prefix-icon":"clock","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:X=>j(ve,X)},{default:x(()=>[(c(!0),y(ee,null,fe(Object.keys(t(f).customPricing.durations),X=>(c(),U(qe,{key:X,value:X,label:t(hs)(X,t(u).h,t(u).min)},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):D("",!0)],2),A(ha,{index:ve,"reference-class":s.responsiveClass,"have-edit":t(o).roles.allowWriteCustomers,onRemove:w,onEdit:X=>T(Q.customer.id)},null,8,["index","reference-class","have-edit","onEdit"])],2))),128))]),t($)?(c(),U(wr,{key:1,visibility:t($),"responsive-class":s.responsiveClass,"onUpdate:visibility":me[3]||(me[3]=Q=>we($)?$.value=Q:$=Q),onAddedCustomer:h},null,8,["visibility","responsive-class"])):D("",!0)],4)}}};const V_=m("span",{class:"am-icon-email"},null,-1),B_=["href"],R_=m("span",{class:"am-icon-phone"},null,-1),q_=["href"],U_={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n;let s=Ne();const l=R("shortcodeData");let i=R("amCustomize");const o=R("settings");let r=R("amLabels"),u=M(null),d=M({}),f=v(()=>s.getters["appointment/getCustomFieldsRules"]),_=M({}),g=v(()=>s.getters["appointment/getCustomFields"]),C=v(()=>s.getters["appointment/getServiceId"]),O=v(()=>s.getters["customerInfo/getCustomersIds"]),I=M(null);function b(E,T){let w=s.getters["appointment/getBookings"][E].id;(T.type!=="file"||w)&&(d.value[`${E}cf${T.id}`]=v({get:()=>{let B=s.getters["appointment/getBookings"][E].customFields[T.id]?.value;return B||""},set:B=>s.dispatch("appointment/updateBookingCustomField",{bookingKey:E,fieldId:T.id,value:B})}))}function P(E,T){let w=s.getters["appointment/getBookings"][E].id;(T.type!=="file"||w)&&(_.value[E][T.id]={template:Ye[T.type],props:{id:T.id,itemName:`${E}cf${T.id}`,label:T.label,options:T.options,class:`am-capai-cfields__item am-cf-width-${T.width}`}}),(T.type==="checkbox"||T.type==="radio")&&(_.value[E][T.id].props.options=_.value[E][T.id].props.options.map(B=>({...B,value:B.label}))),T.type==="text-area"&&(_.value[E][T.id].props={..._.value[E][T.id].props,itemType:"textarea"}),T.type==="file"&&w&&(_.value[E][T.id].props={..._.value[E][T.id].props,btnLabel:r.value.upload_file_here,isUpload:!1,bookingId:w}),T.type==="datepicker"&&(_.value[E][T.id].props={..._.value[E][T.id].props,weekStartsFromDay:o.wordpress.startOfWeek})}function L(){d.value={},s.getters["appointment/getBookings"].forEach((E,T)=>{_.value[T]={},s.getters["appointment/getCustomFields"].forEach(w=>{b(T,w),P(T,w)})})}const{noShowData:$}=R("noShowData");let h=v(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),S=v(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0);return rt([C,O],()=>{L()}),Zs(()=>{L()}),Je(()=>{s.getters["appointment/getBookings"].filter(E=>E.status!=="canceled"&&E.status!=="rejected").length<2&&(I.value=0)}),a({customFieldsFormRef:u}),(E,T)=>{const w=bs,B=ks,z=et;return c(),U(z,{ref_key:"customFieldsFormRef",ref:u,model:t(d),rules:t(f),"label-position":"top",class:q(["am-capai-cfields am-capai-cfields__form",e.responsiveClass])},{default:x(()=>[A(B,{modelValue:t(I),"onUpdate:modelValue":T[0]||(T[0]=N=>we(I)?I.value=N:I=N),class:"am-capai-collapse",accordion:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(s).getters["appointment/getBookings"].filter(N=>N.status!=="canceled"&&N.status!=="rejected"),(N,G)=>(c(),U(w,{key:G,name:G,class:"am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-customer__name",[{"am-pb-16":!(N.customer.email&&t(S)||N.customer.phone&&t(h))},t($)(N.customer.noShowCount).class]])},[t($)(N.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t($)(N.customer.noShowCount).icon}`)},null,2)):D("",!0),ce(" "+k(N.customer.firstName+" "+N.customer.lastName),1)],2)]),default:x(()=>[N.customer.email&&t(S)||N.customer.phone&&t(h)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",e.responsiveClass])},[N.customer.email&&t(S)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",e.responsiveClass])},[V_,m("a",{href:`mailto:${N.customer.email}`},k(N.customer.email),9,B_)],2)):D("",!0),N.customer.phone&&t(h)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",e.responsiveClass])},[R_,m("a",{href:`tel:${N.customer.phone}`},k(N.customer.phone),9,q_)],2)):D("",!0)],2)):D("",!0),(c(!0),y(ee,null,fe(t(g),se=>(c(),y(ee,{key:G+"_"+se.id},[G in t(_)&&`${G}cf${se.id}`in t(d)?(c(),U(pt(t(_)[G][se.id].template),St({key:0,modelValue:t(d)[`${G}cf${se.id}`],"onUpdate:modelValue":j=>t(d)[`${G}cf${se.id}`]=j},t(_)[G][se.id].props),null,16,["modelValue","onUpdate:modelValue"])):D("",!0)],64))),128))]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["model","rules","class"])}}};const z_={key:0,class:"am-capai-ext__heading-extra"},j_=m("span",{class:"am-icon-email"},null,-1),Y_=["href"],W_=m("span",{class:"am-icon-phone"},null,-1),H_=["href"],Z_={class:"am-capai-ext__wrapper"},G_={class:"am-capai-ext__inner-info"},J_={class:"am-capai-ext__inner-name"},X_={key:0,class:"am-capai-ext__inner-duration"},Q_={class:"am-capai-ext__total"},K_={props:{responsiveClass:{type:String,default:""}},emits:["changedSlotCondition"],setup(n,{emit:a}){const e=n,s=Ne(),l=R("shortcodeData");let i=R("amCustomize"),o=R("amLabels"),r=v(()=>s.getters["appointment/getEmployeeService"]),u=v(()=>s.getters["appointment/getBookings"]),d=M(null);function f(L,$,h){L.duration&&(h.extras[$].quantity===0||h.extras[$].quantity===1)&&a("changedSlotCondition")}function _(L){return L.extras.length?L.extras.reduce(($,h)=>$+("price"in h?h.price:r.value.extras.find(S=>S.id===h.extraId).price)*h.quantity,0):0}function g(L){return L.filter($=>$.quantity>0).length}const{noShowData:C}=R("noShowData");let O=v(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),I=v(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),b=R("amColors"),P=v(()=>({"--am-c-ext-text-op60":H(b.value.colorMainText,.6)}));return Je(()=>{u.value.filter(L=>L.status!=="canceled"&&L.status!=="rejected").length<2&&(d.value=0)}),(L,$)=>{const h=bs,S=ks;return c(),U(S,{modelValue:t(d),"onUpdate:modelValue":$[0]||($[0]=E=>we(d)?d.value=E:d=E),class:"am-capai-ext am-capai-collapse",accordion:"",style:Ce(t(P))},{default:x(()=>[(c(!0),y(ee,null,fe(t(u).filter(E=>E.status!=="canceled"&&E.status!=="rejected"),(E,T)=>(c(),U(h,{key:T,name:T,class:"am-capai-ext__item am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-ext__heading",{"am-pb-16":!(E.customer.email&&t(I)||E.customer.phone&&t(O))}])},[m("div",{class:q(["am-capai-customer__name",t(C)(E.customer.noShowCount).class])},[t(C)(E.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(C)(E.customer.noShowCount).icon}`)},null,2)):D("",!0),ce(" "+k(E.customer.firstName+" "+E.customer.lastName),1)],2),g(E.extras)>0?(c(),y("div",z_,k(`${t(o).extras}: ${g(E.extras)}`),1)):D("",!0)],2)]),default:x(()=>[E.customer.email&&t(I)||E.customer.phone&&t(O)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",e.responsiveClass])},[E.customer.email&&t(I)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",e.responsiveClass])},[j_,m("a",{href:`mailto:${E.customer.email}`},k(E.customer.email),9,Y_)],2)):D("",!0),E.customer.phone&&t(O)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",e.responsiveClass])},[W_,m("a",{href:`tel:${E.customer.phone}`},k(E.customer.phone),9,H_)],2)):D("",!0)],2)):D("",!0),m("div",Z_,[(c(!0),y(ee,null,fe(t(r).extras,(w,B)=>(c(),y("div",{key:B,class:q(["am-capai-ext__inner",[{"am-border-bottom":B!==t(r).extras.length-1},e.responsiveClass]])},[m("div",G_,[m("div",J_,k(w.name),1),w.duration?(c(),y("div",X_,k(`${t(o).duration}: ${t(hs)(w.duration,t(o).h,t(o).min)}`),1)):D("",!0)]),m("div",{class:q(["am-capai-ext__inner-selection",e.responsiveClass])},[m("div",{class:q(["am-capai-ext__inner-price",e.responsiveClass])},[w.price?(c(),y(ee,{key:0},[ce(k(t(tt)("price"in E.extras[B]?E.extras[B].price:w.price)),1)],64)):(c(),y(ee,{key:1},[ce(k(t(o).free),1)],64))],2),A(ht,{modelValue:E.extras[B].quantity,"onUpdate:modelValue":z=>E.extras[B].quantity=z,class:q(e.responsiveClass),size:"small",min:0,max:w.maxQuantity,onChange:z=>f(w,B,E)},null,8,["modelValue","onUpdate:modelValue","class","max","onChange"])],2)],2))),128)),m("div",Q_,k(`${t(o).subtotal}: ${t(tt)(_(E))}`),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};const ey={class:"am-fs__rs-every"},ty={key:1},ay={class:"am-fs__rs-on-week"},sy=["onClick"],ly={key:2},ny={class:"am-fs__rs-on-month"},iy={class:"am-fs__rs-ends"},oy={class:"am-fs__rs-ends-choose"},ry={class:"am-fs__rs-ends-options"},cy={class:"am-fs__rs-ends-after"},uy={class:"am-fs__rs-summary"},dy={key:0},my={key:1},py={key:0},gy=ce(", "),fy={key:0},hy={key:1},vy={name:"RecurringSetup"},_y=Object.assign(vy,{props:{service:{type:Object,default:()=>{}},startDate:{type:String,default:""},startTime:{type:String,default:""},maxDate:{type:String,default:""},globalClass:{type:String,default:""}},setup(n){const a=n;let e=R("amLabels"),s=R("amCustomize"),l=Ne(),i=R("containerWidth",0),o=v(()=>i.value<560||i.value-240<520),r=v({get:()=>l.getters["recurring/getRepeatType"],set:E=>{l.commit("recurring/setRepeatType",E)}}),u=v({get:()=>l.getters["recurring/getRepeatInterval"],set:E=>{l.commit("recurring/setRepeatInterval",E)}}),d=v({get:()=>l.getters["recurring/getOccurrenceType"],set:E=>{l.commit("recurring/setOccurrenceType",E)}}),f=v({get:()=>l.getters["recurring/getOccurrenceDate"]?l.getters["recurring/getOccurrenceDate"]:new Date(a.startDate),set:E=>{l.commit("recurring/setOccurrenceDate",E)}}),_=v({get:()=>l.getters["recurring/getOccurrenceCount"],set:E=>{l.commit("recurring/setOccurrenceCount",E)}}),g=v({get:()=>l.getters["recurring/getMonthly"],set:E=>{l.commit("recurring/setMonthly",E)}});const C=M([{label:e.value.recurrence_day,labelPlural:e.value.recurrence_days,value:"daily"},{label:e.value.recurrence_week,labelPlural:e.value.recurrence_weeks,value:"weekly"},{label:e.value.recurrence_month,labelPlural:e.value.recurrence_months,value:"monthly"}]),O=M([{label:e.value.recurrence_specific_date,value:0},{label:e.value.recurrence_first,value:1},{label:e.value.recurrence_second,value:2},{label:e.value.recurrence_third,value:3},{label:e.value.recurrence_fourth,value:4},{label:e.value.recurrence_last,value:5}]);let I=M(ye(a.startDate).format("dddd").toLowerCase()),b=M([{label:"Mon",labelFull:"Monday",value:"monday",selected:!1},{label:"Tue",labelFull:"Tuesday",value:"tuesday",selected:!1},{label:"Wed",labelFull:"Wednesday",value:"wednesday",selected:!1},{label:"Thu",labelFull:"Thursday",value:"thursday",selected:!1},{label:"Fri",labelFull:"Friday",value:"friday",selected:!1},{label:"Sat",labelFull:"Saturday",value:"saturday",selected:!1},{label:"Sun",labelFull:"Sunday",value:"sunday",selected:!1}]),P=v(()=>b.value.find(E=>E.value===ye(a.startDate,"YYYY-MM-DD").format("dddd").toLowerCase()).labelFull);function L(E){f.value=ye(E,"YYYY-MM-DD").toDate()}function $(E,T=!1){let w=b.value.find(B=>B.value===E);w.selected=T?!0:!w.selected,l.commit("recurring/setDays",{value:E,selected:w.selected})}Je(()=>{Rs&&(b.value=b.value.map((T,w)=>({...T,label:ko[w],labelFull:Co[w]})));let E=l.getters["recurring/getDays"].filter(T=>T.selected);E.length===0?$(b.value.find(T=>I.value&&T.value===I.value).value,!0):E.forEach(T=>{$(T.value,!0)}),a.service.recurringCycle!=="all"&&l.commit("recurring/setRepeatType",a.service.recurringCycle)});let h=R("amColors"),S=v(()=>({"--am-c-rs-text":h.value.colorMainText,"--am-c-rs-text-op60":H(h.value.colorMainText,.6),"--am-c-rs-bgr":h.value.colorMainBgr,"--am-c-rs-primary":h.value.colorPrimary,"--am-c-rs-inp-border":h.value.colorInpBorder}));return(E,T)=>(c(),y("div",{class:q(["am-fs__rs",[{"am-fs__rs-mobile":t(o)},t(a).globalClass]]),style:Ce(t(S))},[t(s)&&t(s).recurringStep&&t(s).recurringStep.options.heading.visibility?(c(),y(ee,{key:0},[m("p",null,k(t(e).recurrence),1),m("span",null,k(t(e).recurrence_choosing_time),1)],64)):D("",!0),m("p",null,k(t(e).repeat_every)+":",1),m("div",ey,[A(t(ht),{modelValue:t(u),"onUpdate:modelValue":T[0]||(T[0]=w=>we(u)?u.value=w:u=w),min:1,max:100},null,8,["modelValue"]),A(t(He),{modelValue:t(r),"onUpdate:modelValue":T[1]||(T[1]=w=>we(r)?r.value=w:r=w),disabled:t(a).service.recurringCycle!=="all"},{default:x(()=>[(c(!0),y(ee,null,fe(C.value,(w,B)=>(c(),U(t(qe),{key:B,label:w.label,value:w.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),t(r)==="weekly"?(c(),y("div",ty,[m("p",null,k(`${t(e).recurrence_repeat_on}:`),1),m("div",ay,[(c(!0),y(ee,null,fe(t(b),(w,B)=>(c(),y("div",{key:B,class:q({"am-fs__rs-on-week-selected":t(b).find(z=>z.value===w.value).selected}),onClick:z=>$(w.value)},k(w.label),11,sy))),128))])])):D("",!0),t(r)==="monthly"?(c(),y("div",ly,[m("p",null,k(`${t(e).recurrence_repeat_on}:`),1),m("div",ny,[A(t(He),{modelValue:t(g),"onUpdate:modelValue":T[2]||(T[2]=w=>we(g)?g.value=w:g=w)},{default:x(()=>[(c(!0),y(ee,null,fe(O.value,(w,B)=>(c(),U(t(qe),{key:B,label:w.label+(B!==0?" "+t(P):""),value:w.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):D("",!0),m("p",null,k(`${t(e).recurrence_ends}:`),1),m("span",null,k(t(e).recurrence_choose_ends),1),m("div",iy,[m("div",oy,[A(t(Vl),{modelValue:t(d),"onUpdate:modelValue":T[3]||(T[3]=w=>we(d)?d.value=w:d=w)},{default:x(()=>[A(t(Pa),{value:"On"},{default:x(()=>[ce(k(t(e).recurrence_on),1)]),_:1}),A(t(Pa),{value:"After"},{default:x(()=>[ce(k(t(e).recurrence_after),1)]),_:1})]),_:1},8,["modelValue"])]),m("div",ry,[A(t(Jr),{"calendar-minimum-date":t(a).startDate,disabled:t(d)!=="On","input-placeholder":t(e).recurrence_select_date,"calendar-maximum-date":t(a).maxDate,onSelectedDate:L},null,8,["calendar-minimum-date","disabled","input-placeholder","calendar-maximum-date"]),m("div",cy,[A(t(ht),{modelValue:t(_),"onUpdate:modelValue":T[4]||(T[4]=w=>we(_)?_.value=w:_=w),disabled:t(d)!=="After",min:1,max:100},null,8,["modelValue","disabled"]),m("span",null,k(` ${t(e).occurrences}`),1)])])]),m("div",uy,[m("p",null,k(`${t(e).appointment_repeats}:`),1),m("p",null,[ce(k(`${t(e).recurrence_every} ${t(u)>1?t(u):""} ${C.value.find(w=>w.value===t(r))?C.value.find(w=>w.value===t(r)).label:""}`)+" ",1),t(r)==="weekly"?(c(),y("span",dy,k(`${t(e).repeats_on} ${t(b).filter(w=>w.selected).map(w=>w.labelFull).join(", ")}`),1)):D("",!0),t(r)==="monthly"?(c(),y("span",my,[ce(k(` ${t(e).repeats_on} ${O.value[t(g)].label}`)+" ",1),t(g)!==0?(c(),y("span",py,k(` ${t(P)}`),1)):D("",!0),gy])):D("",!0),m("span",null,k(` ${t(e).repeats_from} ${t(nt)(t(a).startDate)} ${t(e).repeats_at} ${t(vs)(t(a).startTime)}`),1)]),m("p",null,[t(d)==="After"?(c(),y("span",fy,k(t(e).number_of_recurrences)+" "+k(` ${t(_)}`),1)):t(f)?(c(),y("span",hy,k(t(e).ends_on)+" "+k(` ${t(nt)(t(Xr)(t(f)))}`),1)):D("",!0)])])],6))}});const yy={class:"am-capai-recurr__enable"},by={key:0,class:"am-capai-recurr__content"},ky={key:1,class:"am-capai-recurr__list"},Cy={class:"am-capai-recurr__list-heading"},xy={class:"am-capai-recurr__list-heading__text"},wy=m("span",{class:"am-icon-refresh"},null,-1),Ty={class:"am-capai-recurr__table"},Ey={key:2,class:"am-capai-recurr__actions"},Ly={props:{responsiveClass:{type:String,default:""},maximumBookingStartDate:{type:String,required:!0},slotsLoading:{type:Boolean,required:!0},slotsProps:{type:Object,required:!0},freeSlots:{type:Object,required:!0},getFreeTimes:{type:Function,required:!0},isDisabledDate:{type:Function,required:!0},getSelectedDatesTimes:{type:Function,required:!0}},emits:["fetchSlots"],setup(n,{emit:a}){const e=n,s=Ne(),l=R("settings");let i=R("amLabels"),o=R("localLanguage"),r=v(()=>s.getters["appointment/getEmployeeService"]),u=M(!1),d=M(2),f=M(!1),_=R("recurringList"),g=M(!0);function C(){let T=s.getters["recurring/getOccurrenceType"]==="On"?Ke(s.getters["recurring/getOccurrenceDate"]).format("YYYY-MM-DD"):null,w=Qr(e.maximumBookingStartDate,Ke(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),T,l.general.numberOfDaysAvailableForBooking,s.getters["recurring/getRepeatType"],s.getters["recurring/getRepeatInterval"],s.getters["recurring/getDays"],s.getters["recurring/getMonthly"]);d.value=s.getters["recurring/getOccurrenceType"]==="On"?Object.keys(w).length:s.getters["recurring/getOccurrenceCount"],f.value=!0;let B=So(Object.keys(w));Ao(Object.assign({startDateTime:Ke(s.getters["appointment/getStartDate"]).startOf("month").subtract(6,"days").format("YYYY-MM-DD"),endDateTime:B.length?Ke(B[B.length-1]).endOf("month").add(11,"days").format("YYYY-MM-DD"):Ke().add(l.general.numberOfDaysAvailableForBooking,"days").format("YYYY-MM-DD")},e.slotsProps),null,z=>{let N=Kr(r.value,z,w,Ke(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),s.getters["appointment/getStartTime"],T,s.getters["recurring/getOccurrenceType"]==="After"?s.getters["recurring/getOccurrenceCount"]:null);_.value=[],Object.keys(N).forEach(G=>{_.value.push(Object.assign({date:Ke(G).toDate(),editing:!1},N[G]))}),f.value=!1})}function O(){_.value=null}function I(T){let w=Ke(_.value[T].date).format("YYYY-MM-DD");_.value[T].times=Object.keys(e.freeSlots[w]);let B=e.getSelectedDatesTimes(T,!1);w in B&&_.value[T].time in B[w]&&(_.value[T].time="")}function b(T){_.value.splice(T,1)}function P(T){_.value[T].editing=!0}function L(T){_.value[T].editing=!1}let $=M(null);function h(T,w,B=!1){!T&&!$.value?T=Ke().toDate():!T&&$.value&&(T=$.value),$.value=T&&B?T:$.value,a("fetchSlots",T,w,B)}let S=R("amColors"),E=v(()=>({"--am-c-recurr-bgr-op05":H(S.value.colorPrimary,.05),"--am-c-warning-op10":H(S.value.colorWarning,.1),"--am-c-main-text-op10":H(S.value.colorMainText,.1)}));return rt(u,T=>{T||(_.value=null)}),(T,w)=>(c(),y("div",{class:"am-capai-recurr",style:Ce(t(E))},[m("div",yy,[A(mt,{modelValue:t(u),"onUpdate:modelValue":w[0]||(w[0]=B=>we(u)?u.value=B:u=B),label:"Enable Recurring appointment"},null,8,["modelValue"])]),t(u)?(c(),y("div",by,[!t(f)&&!t(_)?(c(),U(_y,{key:0,"start-date":t(Ke)(t(s).getters["appointment/getStartDate"]).format("YYYY-MM-DD"),"start-time":t(s).getters["appointment/getStartTime"],"max-date":t(e).maximumBookingStartDate,service:t(r)},null,8,["start-date","start-time","max-date","service"])):(c(),y(ee,{key:1},[t(_)?(c(),y("div",ky,[m("div",Cy,[m("div",xy,[wy,m("div",null,k(`${t(_).length} appointments total`),1)]),m("div",{class:"am-capai-recurr__list-heading__action",onClick:w[1]||(w[1]=()=>{we(g)?g.value=!t(g):g=!t(g)})},k(t(g)?t(i).show_less:t(i).show_more),1)]),t(g)?(c(),y(ee,{key:0},[t(_).filter(B=>B.isSubstituteDate||B.isSubstituteTime).length?(c(),U(xr,{key:0,heading:t(i).recurring_unavailable_slots,text:t(i).recurring_sub_message1},null,8,["heading","text"])):D("",!0),m("div",Ty,[(c(!0),y(ee,null,fe(t(_),(B,z)=>(c(),y("div",{key:z,class:q(["am-capai-recurr__row",[{"am-warn":B.isSubstituteDate||B.isSubstituteTime},t(e).responsiveClass]])},[m("div",{class:q(["am-capai-recurr__row-num",t(e).responsiveClass])},k(z+1),3),m("div",{class:q(["am-capai-recurr__row-date",[{"am-disable":!B.editing},t(e).responsiveClass]])},[A(Yt,{modelValue:B.date,"onUpdate:modelValue":N=>B.date=N,type:"date",format:t(jt)(),placeholder:"Pick a day",size:"small",lang:t(o),"disabled-date":(N,G)=>t(e).isDisabledDate(N,B.editing,!1,G),"popper-class":t(e).slotsLoading?"slots-loader":"",onPanelChange:N=>{h(N,z,!0)},onChange:N=>I(z),onFocus:N=>h(B.date,z,!0)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date","popper-class","onPanelChange","onChange","onFocus"])],2),m("div",{class:q(["am-capai-recurr__row-time",[{"am-disable":!B.editing},t(e).responsiveClass]])},[A(He,{modelValue:B.time,"onUpdate:modelValue":N=>B.time=N,size:"small",placeholder:`${t(i).select_time}`,disabled:!B.date},{default:x(()=>[(c(!0),y(ee,null,fe(B.editing?t(e).getFreeTimes(z,t(_)[z],!1):t(_)[z].times,N=>(c(),U(qe,{key:N,value:N,label:N},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])],2),m("div",{class:q(["am-capai-recurr__row-actions",t(e).responsiveClass])},[B.editing?(c(),U(Ee,{key:1,category:"primary",size:"small",onClick:N=>L(z)},{default:x(()=>[ce(k(t(i).save),1)]),_:2},1032,["onClick"])):(c(),U(ha,{key:0,index:z,onRemove:b,onEdit:P},null,8,["index"]))],2)],2))),128))])],64)):D("",!0)])):(c(),U(Wt,{key:0,count:t(d)},null,8,["count"]))],64)),t(f)?D("",!0):(c(),y("div",Ey,[t(_)?D("",!0):(c(),U(Ee,{key:0,category:"primary",size:"medium",onClick:w[2]||(w[2]=B=>C())},{default:x(()=>[ce(k(t(i).recurring_list),1)]),_:1})),t(_)?(c(),U(Ee,{key:1,category:"secondary",type:"plain",size:"medium",onClick:w[3]||(w[3]=B=>O())},{default:x(()=>[ce(k(t(i).recurring_settings),1)]),_:1})):D("",!0)]))])):D("",!0)],4))}};const Sy=m("span",{class:"am-icon-email"},null,-1),Ay=["href"],Iy=m("span",{class:"am-icon-phone"},null,-1),Py=["href"],$y={class:"am-capai-linked__list"},Ny={class:"am-capai-linked__list-index"},Dy={class:"am-capai-linked__list-date"},Oy=m("span",{class:"am-icon-calendar"},null,-1),Fy={class:"am-capai-linked__list-action"},My={props:{responsiveClass:{type:String,default:""},linkedAppointments:{type:Array,required:!0}},emits:["editLinkedAppointment"],setup(n,{emit:a}){const e=n;let s=Ne();const l=R("shortcodeData");let i=R("amCustomize"),o=M(null);function r(I){return e.linkedAppointments.filter(b=>b.bookings.filter(P=>parseInt(P.customer.id)===parseInt(I.customer.id)).length)}const{noShowData:u}=R("noShowData");let d=R("amLabels");function f(I){s.commit("appointment/resetAppointment",{providerId:s.getters["auth/getProfile"].id}),s.commit("customerInfo/setCustomers",[]),s.commit("customerInfo/setCustomersIds",[]),a("editLinkedAppointment",I)}let _=v(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),g=v(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),C=R("amColors"),O=v(()=>({"--am-c-linked-bgr-op05":H(C.value.colorMainText,.05)}));return Je(()=>{s.getters["appointment/getBookings"].filter(I=>I.status!=="canceled"&&I.status!=="rejected").length<2&&(o.value=0)}),(I,b)=>{const P=bs,L=ks;return c(),U(L,{modelValue:t(o),"onUpdate:modelValue":b[0]||(b[0]=$=>we(o)?o.value=$:o=$),class:"am-capai-collapse am-capai-linked",accordion:"",style:Ce(t(O))},{default:x(()=>[(c(!0),y(ee,null,fe(t(s).getters["appointment/getBookings"],($,h)=>(c(),y(ee,{key:h},[r($).length?(c(),U(P,{key:0,name:h,class:"am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-customer__name",[{"am-pb-16":!($.customer.email&&t(g)||$.customer.phone&&t(_))},t(u)($.customer.noShowCount).class]])},[t(u)($.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(u)($.customer.noShowCount).icon}`)},null,2)):D("",!0),ce(" "+k($.customer.firstName+" "+$.customer.lastName),1)],2)]),default:x(()=>[$.customer.email&&t(g)||$.customer.phone&&t(_)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",t(e).responsiveClass])},[$.customer.email&&t(g)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",t(e).responsiveClass])},[Sy,m("a",{href:`mailto:${$.customer.email}`},k($.customer.email),9,Ay)],2)):D("",!0),$.customer.phone&&t(_)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",t(e).responsiveClass])},[Iy,m("a",{href:`tel:${$.customer.phone}`},k($.customer.phone),9,Py)],2)):D("",!0)],2)):D("",!0),m("div",$y,[(c(!0),y(ee,null,fe(r($),(S,E)=>(c(),y("div",{key:$.id+"-"+E,class:q(["am-capai-linked__list-item",t(e).responsiveClass])},[m("div",Ny,k(E+1),1),m("div",Dy,[Oy,ce(" "+k(t(ec)(S.bookingStart)),1)]),m("div",Fy,[A(Ee,{category:"primary",size:"small",onClick:T=>f(S)},{default:x(()=>[ce(k(t(d).edit),1)]),_:2},1032,["onClick"])])],2))),128))])]),_:2},1032,["name"])):D("",!0)],64))),128))]),_:1},8,["modelValue","style"])}}},Bs=Qe(window.wpAmeliaLabels);function Tr(n){if(n.gateway==="onSite")return Bs.on_site;if(n.gateway==="wc")return n.gatewayTitle;if(n.gateway)return n.gateway.charAt(0).toUpperCase()+n.gateway.slice(1)}function si(n){switch(n){case"paid":return Bs.paid;case"pending":return Bs.pending;case"partiallyPaid":return Bs.partially_paid;case"refunded":return Bs.refunded}}function ds(n,a){switch(n){case"paid":return{icon:"am-icon-checkmark-circle",color:a.colorSuccess};case"pending":return{icon:"am-icon-refresh",color:a.colorWarning};case"partiallyPaid":return{icon:"am-icon-prepaid",color:a.colorPrimary};case"refunded":return{icon:"am-icon-refund",color:a.colorError}}}const Vy={class:"am-capai-pay__heading-status"},By={class:"am-capai-pay__heading-status__text"},Ry=m("span",{class:"am-icon-email"},null,-1),qy=["href"],Uy=m("span",{class:"am-icon-phone"},null,-1),zy=["href"],jy={class:"am-capai-pay__row-label"},Yy={class:"am-capai-pay__row-value"},Wy={class:"am-capai-pay__row-label"},Hy={class:"am-capai-pay__row-value"},Zy={class:"am-capai-pay__row-label"},Gy={class:"am-capai-pay__row-value"},Jy={key:0,class:"am-divider"},Xy={class:"am-capai-pay__row-label"},Qy={class:"am-capai-pay__row-label"},Ky={class:"am-capai-pay__row-label"},eb={class:"am-capai-pay__row-label"},tb={class:"am-capai-pay__row-label"},ab={class:"am-capai-pay__row-label"},sb={class:"am-capai-pay__row-label"},lb={class:"am-capai-pay__row-label"},nb={class:"am-capai-pay__row-label"},ib={class:"am-capai-pay__row-label"},ob={class:"am-capai-pay__row-label"},rb={props:{responsiveClass:{type:String,default:""},savedAppointment:{type:Object,default:()=>{}}},setup(n){const a=n;let e=Ne();const s=R("shortcodeData");let l=R("amCustomize"),i=R("pageWidth"),o=R("amLabels"),r=v(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerPhone.visibility:!0),u=v(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerEmail.visibility:!0),d=M(null),f=v(()=>e.getters["appointment/getEmployeeService"]),_=v(()=>e.getters["appointment/getBookings"].filter(b=>"id"in b&&b.id&&b.status!=="canceled"&&b.status!=="rejected")),g=v(()=>{let b=[];return _.value.forEach((P,L)=>{let $=tc(e.getters["appointment/getAppointmentData"],a.savedAppointment,P,f.value);b.push(ci(e,{price:$?ac(f.value,P.persons,P.duration):P.price,persons:P.persons,aggregatedPrice:P.aggregatedPrice,extras:P.extras.filter(h=>"id"in h&&h.id),serviceId:e.getters["appointment/getServiceId"],tax:P.tax,coupon:P.coupon,wcTax:P.payments.filter(h=>h.wcOrderId&&h.wcItemTaxValue).reduce((h,S)=>h+S.wcItemTaxValue,0)},!1)),b[L].deposit=P.payments.length&&(P.payments[0].status==="paid"||P.payments[0].status==="partiallyPaid")?P.payments[0].amount:0,b[L].paid=P.payments.filter(h=>h.status==="paid"||h.status==="partiallyPaid").reduce((h,S)=>h+S.amount,0),b[L].refunded=P.payments.filter(h=>h.status==="refunded").reduce((h,S)=>h+S.amount,0),b[L].status=P.payments.reduce((h,S)=>h+S.amount,0),P.payments.filter(h=>h.status!=="refunded").length===0?b[L].status="refunded":b[L].paid-(b[L].total-b[L].discount+b[L].tax+b[L].wcTax)===0?b[L].status="paid":b[L].paid?b[L].status="partiallyPaid":b[L].status="pending"}),b});const{noShowData:C}=R("noShowData");let O=R("amColors"),I=v(()=>({"--am-c-pay-text-op03":H(O.value.colorMainText,.03)}));return Je(()=>{e.getters["appointment/getBookings"].filter(b=>b.status!=="canceled"&&b.status!=="rejected").length<2&&(d.value=0)}),(b,P)=>{const L=bs,$=ks;return c(),U($,{modelValue:t(d),"onUpdate:modelValue":P[0]||(P[0]=h=>we(d)?d.value=h:d=h),class:"am-capai-collapse am-capai-pay",accordion:"",style:Ce(t(I))},{default:x(()=>[(c(!0),y(ee,null,fe(t(_),(h,S)=>(c(),U(L,{key:S,name:S,class:"am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-pay__heading",{"am-pb-16":!(h.customer.email&&t(u)||h.customer.phone&&t(r))}])},[m("div",{class:q(["am-capai-customer__name",t(C)(h.customer.noShowCount).class])},[t(C)(h.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(C)(h.customer.noShowCount).icon}`)},null,2)):D("",!0),ce(" "+k(h.customer.firstName+" "+h.customer.lastName),1)],2),m("div",Vy,[m("span",{class:q(t(ds)(t(g)[S].status,t(O)).icon),style:Ce({color:t(ds)(t(g)[S].status,t(O)).color})},null,6),m("div",By,k(t(si)(t(g)[S].status)),1)])],2)]),default:x(()=>[h.customer.email&&t(u)||h.customer.phone&&t(r)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",t(a).responsiveClass])},[h.customer.email&&t(u)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",t(a).responsiveClass])},[Ry,m("a",{href:`mailto:${h.customer.email}`},k(h.customer.email),9,qy)],2)):D("",!0),h.customer.phone&&t(r)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",t(a).responsiveClass])},[Uy,m("a",{href:`tel:${h.customer.phone}`},k(h.customer.phone),9,zy)],2)):D("",!0)],2)):D("",!0),m("div",{class:q(["am-capai-pay__content",t(a).responsiveClass])},[(c(!0),y(ee,null,fe(h.payments,(E,T)=>(c(),y(ee,{key:T},[m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",jy,k(t(o).date),1),m("div",Yy,k(t(nt)(E.dateTime.split(" ")[0])),1)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Wy,k(t(o).payment_method),1),m("div",Hy,k(t(Tr)(E)),1)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Zy,k(t(o).status),1),m("div",Gy,[m("span",{class:q(t(ds)(E.status,t(O)).icon),style:Ce({color:t(ds)(E.status,t(O)).color})},null,6),ce(" "+k(t(si)(E.status)),1)])],2)],64))),128)),t(i)>480?(c(),y("div",Jy)):D("",!0),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Xy,k(t(o).price),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].bookable)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Qy,k(t(o).extras),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].total-t(g)[S].bookable)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Ky,k(t(o).subtotal),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].total)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",eb,k(t(o).discount_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].discount)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",tb,k(t(o).tax),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].tax)),3)],2),t(g)[S].wcTax?(c(),y("div",{key:1,class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",ab,k(t(o).tax)+" (Woo) ",1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].wcTax)),3)],2)):D("",!0),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",sb,k(t(o).paid_deposit),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].deposit)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",lb,k(t(o).paid_remaining_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].paid?t(g)[S].paid-t(g)[S].deposit:0)),3)],2),t(g)[S].refunded?(c(),y("div",{key:2,class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",nb,k(t(o).refunded),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].refunded)),3)],2)):D("",!0),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",ib,k(t(o).due),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].paid-(t(g)[S].total-t(g)[S].discount+t(g)[S].tax+t(g)[S].wcTax))),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",ob,k(t(o).total),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},k(t(tt)(t(g)[S].total-t(g)[S].discount+t(g)[S].tax+t(g)[S].wcTax)),3)],2)],2)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};const cb={class:"am-capai__footer"},ub={name:"CabinetAppointment"},db=Object.assign(ub,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},linkedAppointments:{type:Array,default:()=>[]}},emits:["close","save","editLinkedAppointment"],setup(n,{emit:a}){const e=n;let s=Ne(),l=R("amLabels");R("settings");let i=R("licence");const o=M("details"),r=M(null);let u=v(()=>s.getters["appointment/getEmployeeService"]),d=M(null),f=M(""),_=v(()=>s.getters["appointment/getBookings"].length?s.getters["appointment/getBookings"].filter(X=>X.status==="approved"||X.status==="pending").map(X=>X.persons).reduce((X,F)=>X+F,0):0),g=M(null),C=v(()=>s.getters["appointment/getCustomFields"]),O=M(null);Be("recurringList",O);function I(X,F){let Z=ye(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),W={};return s.getters["appointment/getStartDate"]&&s.getters["appointment/getStartTime"]&&!F&&(W[Z]={},W[Z][s.getters["appointment/getStartTime"]]=!0),O.value&&O.value.forEach((le,de)=>{if(le.time&&(X!==null?de!==X:!0)){let ae=ye(le.date).format("YYYY-MM-DD");ae in W||(W[ae]={}),W[ae][le.time]=!0}}),W}function b(X,F,Z){if(F.date===null)return[];let W=ye(F.date).format("YYYY-MM-DD"),le=I(X,Z),de=F.time?Bt(F.time):null;if(W in le){let ae=F.times.filter(_e=>!Object.keys(le[W]).includes(_e)),xe=[];return ae.forEach(_e=>{let pe=Bt(_e),Te=!0;Object.keys(le[W]).map($e=>Bt($e)).sort(($e,Oe)=>$e-Oe).forEach($e=>{pe<$e?pe+u.value.duration+u.value.timeAfter>$e&&(Te=!1):$e+u.value.duration+u.value.timeAfter>pe&&(Te=!1)}),Te&&(de!==null&&pe>de&&xe.indexOf(F.time)===-1&&xe.push(F.time),xe.push(_e))}),P(W,le,xe)}return P(W,le,F.times)}function P(X,F,Z){let W=[],le=!1,de=ye(X,"YYYY-MM-DD").subtract(1,"days").format("YYYY-MM-DD");if(de in F){let xe=Object.keys(F[de]).map(pe=>Bt(pe)).sort((pe,Te)=>pe-Te),_e=xe[xe.length-1]+u.value.duration+u.value.timeAfter;_e>86400&&(Z.forEach(pe=>{_e-86400<=Bt(pe)&&W.push(pe)}),Z=W,le=!0)}let ae=ye(X,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");if(ae in F){let xe=Object.keys(F[ae]).map(_e=>Bt(_e)).sort((_e,pe)=>_e-pe);xe[0]-u.value.duration-u.value.timeAfter<0&&(Z.forEach(_e=>{let pe=Bt(_e);(pe+u.value.duration+u.value.timeAfter<=86400||xe[0]>=pe+u.value.duration+u.value.timeAfter-86400)&&W.push(_e)}),le=!0)}return le?W:Z}let L=M({});Be("slotsPricing",L);let $=M(""),h=M({}),S=M([]);function E(X){S.value=Object.keys(h.value[ye(X).format("YYYY-MM-DD")])}function T(X){let F=h.value[ye(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")][X][0].l;F&&s.commit("appointment/setLocationId",F)}function w(X,F,Z,W){let le=ye(X).format("YYYY-MM-DD");return typeof W>"u"&&!(le in h.value&&(F?b(null,{date:X,times:Object.keys(h.value[le])},Z).length:!0))}let B=M(!1),z=v(()=>{let X={};return s.getters["appointment/getBookings"].filter(F=>F.status==="pending"||F.status==="approved").forEach(F=>{F.extras.forEach(Z=>{Z.quantity&&!(Z.extraId in X)&&(X[Z.extraId]={id:Z.extraId,quantity:Z.quantity})})}),{serviceId:s.getters["appointment/getServiceId"],serviceDuration:Math.max.apply(Math,s.getters["appointment/getBookings"].filter(F=>F.status!=="canceled"&&F.status!=="rejected").map(F=>F.duration)),providerIds:s.getters["appointment/getProviderId"]?[s.getters["appointment/getProviderId"]]:[],locationId:s.getters["appointment/getLocationId"],extras:JSON.stringify(Object.values(X)),persons:_.value?_.value:1,excludeAppointmentId:s.getters["appointment/getId"],group:s.getters["appointment/getId"]?0:1,timeZone:s.getters["cabinet/getTimeZone"],monthsLoad:1,page:"appointments",structured:!0}});function N(X=!1){s.getters["appointment/getStartDate"]&&G(s.getters["appointment/getStartDate"],null,!1,X)}function G(X,F=null,Z=!1,W=!1){s.getters["appointment/getServiceId"]&&(B.value=!0,Ao(Object.assign({startDateTime:X?ye(X).startOf("month").subtract(6,"days").format("YYYY-MM-DD"):null,endDateTime:X?ye(X).endOf("month").add(6,"days").format("YYYY-MM-DD"):null},z.value),{},(le,de,ae,xe)=>{if($.value=xe,s.getters["appointment/getStartDate"]&&F===null&&!Z){let pe=ye(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD");pe in le?(s.getters["appointment/getStartTime"]&&!(s.getters["appointment/getStartTime"]in le[pe])&&!W&&s.commit("appointment/setStartTime",null),S.value=Object.keys(le[pe]),h.value=le):W||(h.value={},s.commit("appointment/setStartTime",null),s.commit("appointment/setStartDate",null),s.commit("appointment/setTargetedDate",null),S.value=[])}else h.value=le;let _e=!i.isLite&&!i.isStarter&&!i.isBasic?sc(s,le,s.getters["appointment/getServiceId"]):null;L.value=_e?_e.dates:{},B.value=!1},()=>{}))}function se(){h.value={},$.value=null,O.value=null}function j(X){if(X){if(X===1)return{class:"am-no-show-1",icon:"no-show-1"};if(X===2)return{class:"am-no-show-2",icon:"no-show-2"};if(X>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Be("noShowData",{noShowData:j});let ne=M(!1),te=M("");function oe(){ne.value=!1,te.value=""}let ie=M(!1),K=M(null);function me(){const X=new Promise(W=>{g.value?.customFieldsFormRef?g.value.customFieldsFormRef.validate(le=>{le?W(!0):(o.value="customFields",W(!1))}):W(!0)}),F=new Promise(W=>{d.value?.customersFormRef?d.value.customersFormRef.validate(le=>{!le||!s.getters["customerInfo/getCustomersIds"].length?(o.value="customers",W(!1)):W(!0)}):W(!0)}),Z=new Promise(W=>{r.value?.detailsFormRef?r.value.detailsFormRef.validate(le=>{!le||!s.getters["appointment/getServiceId"]||!s.getters["appointment/getStartDate"]||!s.getters["appointment/getStartTime"]?(o.value="details",W(!1)):W(!0)}):W(!0)});Promise.all([X,F,Z]).then(W=>{if(!W.includes(!1)){if(f.value=s.getters["appointment/getBookings"].filter(le=>le.status!=="canceled"&&le.status!=="rejected").map(le=>le.persons).reduce((le,de)=>le+de,0)>u.value.maxCapacity?l.value.select_max_customer_count_warning+" "+u.value.maxCapacity:"",f.value){o.value="customers";return}Ae()}})}function Ae(){let X=[];s.getters["appointment/getBookings"].forEach(le=>{let de={};Object.keys(le.customFields).forEach(ae=>{de[ae]=Object.assign({},le.customFields[ae],{value:le.customFields[ae].type==="datepicker"?le.customFields[ae].value?ye(le.customFields[ae].value).format("YYYY-MM-DD"):null:le.customFields[ae].value})}),X.push(Object.assign({},le,{customerId:le.customer.id,extras:le.extras.filter(ae=>ae.quantity),customFields:de}))});let F=[];if(K.value){let le=K.value.bookings.map(ae=>"id"in ae&&ae.id),de=X.map(ae=>"id"in ae&&ae.id);F=K.value.bookings.filter(ae=>le.filter(xe=>!de.includes(xe)).includes(ae.id)).map(ae=>new Object({id:ae.id}))}let Z=s.getters["cabinet/getTimeZone"],W={serviceId:s.getters["appointment/getServiceId"],providerId:s.getters["appointment/getProviderId"],locationId:s.getters["appointment/getLocationId"],bookings:X,removedBookings:F,bookingStart:ye(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")+" "+s.getters["appointment/getStartTime"],utc:Z==="UTC",timeZone:Z==="UTC"?null:Z,notifyParticipants:s.getters["appointment/getNotifyParticipants"]?1:0,internalNotes:s.getters["appointment/getInternalNotes"],id:s.getters["appointment/getId"],payment:{gateway:"onSite"},recurring:O.value?O.value.map(le=>new Object({bookingStart:ye(le.date).format("YYYY-MM-DD")+" "+le.time,providerId:le.slot[0][0],locationId:le.slot[0][1]})):[],lessonSpace:s.getters["appointment/getLessonSpace"]?"https://www.thelessonspace.com/space/"+s.getters["appointment/getLessonSpace"]:null,createPaymentLinks:s.getters["appointment/getCreatePaymentLinks"]?1:0};ie.value=!0,De.post("/appointments"+(s.getters["appointment/getId"]?"/"+s.getters["appointment/getId"]:""),W,Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(le=>{le.data.data.appointment.id&&Ve("save")}).catch(le=>{te.value=l.value.error,"response"in le&&"data"in le.response&&"data"in le.response.data&&("timeSlotUnavailable"in le.response.data.data&&le.response.data.data.timeSlotUnavailable===!0&&(te.value=l.value.time_slot_unavailable,o.value="details"),"customerAlreadyBooked"in le.response.data.data&&le.response.data.data.customerAlreadyBooked===!0&&(te.value=l.value.customer_already_booked,o.value="customers")),ne.value=!0}).finally(()=>{ie.value=!1})}function Ve(X){s.commit("appointment/setActive",!1),a(X)}Je(()=>{if(s.commit("appointment/setActive",!0),s.getters["appointment/getId"]){K.value=JSON.parse(JSON.stringify(s.getters["appointment/getAppointmentData"]));let X=s.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null}),F=s.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null});s.getters["appointment/getId"]&&s.getters["appointment/getServiceId"]&&F.map(W=>W.id).indexOf(s.getters["appointment/getServiceId"])===-1||s.getters["appointment/getId"]&&s.getters["appointment/getLocationId"]&&X.map(W=>W.id).indexOf(s.getters["appointment/getLocationId"])===-1||N(!0)}s.getters["appointment/getServiceId"]&&(s.dispatch("appointment/updateEmployeeService",s.getters["appointment/getServiceId"]),s.dispatch("appointment/addAllCustomFieldsFormRules",{label:l.value.required_field}))});let Q=R("amColors"),ve=v(()=>({"--am-c-capai-text":Q.value.colorMainText,"--am-c-capai-text-op10":H(Q.value.colorMainText,.1),"--am-c-capai-primary":Q.value.colorPrimary,"--am-c-cust-no1":Q.value.colorMainText,"--am-c-cust-no1-bgr":H(Q.value.colorMainText,.1),"--am-c-cust-no2":Q.value.colorWarning,"--am-c-cust-no2-bgr":H(Q.value.colorWarning,.1),"--am-c-cust-no3":Q.value.colorError,"--am-c-cust-no3-bgr":H(Q.value.colorError,.1),"--am-c-cust-link":H(Q.value.colorMainText,.5),"--am-c-cust-text":Q.value.colorMainText}));return(X,F)=>{const Z=va,W=_a;return t(ie)?(c(),U(Wt,{key:1})):(c(),y("div",{key:0,class:q(["am-capai",[{"am-no-border":!0},t(e).responsiveClass]]),style:Ce(t(ve))},[t(ne)?(c(),U(_t,{key:0,class:"am-asi__top-message am-asi__top-message-error",type:"error","show-icon":!0,"show-border":!0,"close-after":5e3,onClose:oe,onTriggerClose:oe},{title:x(()=>[ce(k(t(te)),1)]),_:1})):D("",!0),A(W,{modelValue:o.value,"onUpdate:modelValue":F[1]||(F[1]=le=>o.value=le)},{default:x(()=>[A(Z,{label:t(l).details,name:"details"},{default:x(()=>[A(v_,{ref_key:"appointmentDetailsRef",ref:r,"slots-props":t(z),"slots-loading":t(B),"free-slots":t(h),"is-disabled-date":w,times:t(S),"get-free-times":b,onRemoveSlots:se,onFetchSlots:G,onSelectDate:E,onSelectTime:T},null,8,["slots-props","slots-loading","free-slots","times"])]),_:1},8,["label"]),t(u)?(c(),U(Z,{key:0,label:t(l).customers,name:"customers"},{default:x(()=>[A(M_,{ref_key:"appointmentCustomersRef",ref:d,"responsive-class":t(e).responsiveClass,"capacity-warning":t(f),"appointment-capacity":t(_),"saved-appointment":t(K),onChangedSlotCondition:N},null,8,["responsive-class","capacity-warning","appointment-capacity","saved-appointment"])]),_:1},8,["label"])):D("",!0),t(u)&&t(u).extras.length&&t(s).getters["appointment/getBookings"].length?(c(),U(Z,{key:1,label:t(l).extras,name:"extras"},{default:x(()=>[A(K_,{"responsive-class":t(e).responsiveClass,onChangedSlotCondition:N},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0),t(u)&&t(C).length&&t(s).getters["appointment/getBookings"].length?(c(),U(Z,{key:2,label:t(l).custom_fields,name:"customFields"},{default:x(()=>[A(U_,{ref_key:"appointmentCustomFieldsRef",ref:g,"responsive-class":t(e).responsiveClass},null,8,["responsive-class"])]),_:1},8,["label"])):D("",!0),t(s).getters["appointment/getId"]&&n.linkedAppointments.length?(c(),U(Z,{key:3,label:t(l).linked,name:"linked"},{default:x(()=>[A(My,{"linked-appointments":n.linkedAppointments,"responsive-class":t(e).responsiveClass,onEditLinkedAppointment:F[0]||(F[0]=le=>t(a)("editLinkedAppointment",le))},null,8,["linked-appointments","responsive-class"])]),_:1},8,["label"])):D("",!0),t(u)&&t(u).recurringCycle!=="disabled"&&t(s).getters["appointment/getStartDate"]&&t(s).getters["appointment/getStartTime"]&&!t(s).getters["appointment/getId"]&&!!t(s).getters["customerInfo/getCustomersIds"].length?(c(),U(Z,{key:4,label:t(l).recurring,name:"recurring"},{default:x(()=>[A(Ly,{"free-slots":t(h),"slots-props":t(z),"maximum-booking-start-date":t($),"get-free-times":b,"get-selected-dates-times":I,"is-disabled-date":w,"slots-loading":t(B),"responsive-class":t(e).responsiveClass,onFetchSlots:G},null,8,["free-slots","slots-props","maximum-booking-start-date","slots-loading","responsive-class"])]),_:1},8,["label"])):D("",!0),t(s).getters["appointment/getId"]?(c(),U(Z,{key:5,label:t(l).payment,name:"payment"},{default:x(()=>[A(rb,{"responsive-class":t(e).responsiveClass,"saved-appointment":t(K)},null,8,["responsive-class","saved-appointment"])]),_:1},8,["label"])):D("",!0)]),_:1},8,["modelValue"]),m("div",cb,[A(Ee,{category:"secondary",size:"default",type:"plain",onClick:F[2]||(F[2]=()=>{t(a)("close")})},{default:x(()=>[ce(k(t(l).cancel),1)]),_:1}),A(Ee,{size:"default",onClick:me},{default:x(()=>[ce(k(t(l).save),1)]),_:1})])],6))}}});const mb={key:0,class:"el-skeleton-item-wrapper-title"},pb={name:"AuthSkeleton"},Ii=Object.assign(pb,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const a=n;return(e,s)=>{const l=Ol,i=Fl;return c(),U(i,{animated:"",class:q(["am-asi-el-skeleton",[{"am-asi":t(a).mainClass}]])},{template:x(()=>[t(a).centerFirst?(c(),y("div",mb,[A(l,{variant:"rect"})])):D("",!0),(c(!0),y(ee,null,fe(new Array(t(a).count),o=>(c(),y("div",{key:o,class:"el-skeleton-item-wrapper"},[A(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});const gb={key:0,class:"am-icon-checkmark-circle-full"},fb={key:1,class:"am-icon-clearable"},hb={key:2,class:"am-cap__actions"},vb={name:"CabinetAppointments",key:"appointments"},_b=Object.assign(vb,{props:{loadBookingsCounter:{type:Number,default:0},appointments:{type:Object,default:null}},setup(n){const a=n;let e=Ne();const s=R("settings");let l=R("amCustomize");const i=R("shortcodeData"),o=R("labels"),r=R("localLanguage");let u=v(()=>s.general.usedLanguages.includes(r.value)),d=v(()=>{let ie=Qe({...o}),K=l.value.appointments.translations;return K&&Object.keys(K).forEach(me=>{K[me][r.value]&&u.value?ie[me]=K[me][r.value]:K[me].default&&(ie[me]=K[me].default)}),ie});Be("amLabels",d);const f=M(null),{width:_}=ja(f);let g=v(()=>st(_.value));Be("pageWidth",_);let C=M(null),O=M(!1),I=M("success"),b=M("");function P(){O.value=!1,e.commit("cabinet/setPaymentLinkError",{value:!1,type:"appointment"})}let L=R("cabinetType");e.commit("cabinetFilters/setDates",ui(L.value));let $=v(()=>e.getters["cabinet/getAppointmentsLoading"]),h=v(()=>e.getters["entities/getReady"]),S=M(null),E=M(0),T=M(1);function w(ie){T.value=ie,B(null,ie)}function B(ie=null,K=1){e.commit("cabinet/setAppointmentsLoading",!0);let me=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getAppointmentsFilters"])),Ae=e.getters["cabinet/getTimeZone"];me.dates=me.dates.map(Q=>ye(Q).format("YYYY-MM-DD")),me.timeZone=Ae,me.source="cabinet-"+L.value,me.page=K,e.commit("auth/setLoadingAppointmentsCounter",e.getters["auth/getLoadingAppointmentsCounter"]+1);let Ve=e.getters["auth/getLoadingAppointmentsCounter"];De.get("/appointments",Object.assign(ze(e),{params:Js(me)})).then(Q=>{Ve===e.getters["auth/getLoadingAppointmentsCounter"]&&(E.value=Q.data.data.total,S.value=fr(Q.data.data.appointments,Ae,L.value==="provider"))}).catch(Q=>{Q?.response?.data?.data?.reauthorize!==void 0&&Q.response.data.data.reauthorize&&e.dispatch("auth/logout"),console.log(Q)}).finally(()=>{Ve===e.getters["auth/getLoadingAppointmentsCounter"]&&(e.commit("cabinet/setAppointmentsLoading",!1),ie&&"message"in ie&&(O.value=!0,b.value=ie.message,I.value="success",f.value&&C.value&&setTimeout(function(){dt(f.value,C.value.$el,0,300)},500)))})}let z=M([]);function N(ie){e.commit("cabinet/setAppointmentsLoading",!0),De.get("/appointments/"+ie.id,Object.assign({params:{source:"cabinet-"+L.value,timeZone:e.getters["cabinet/getTimeZone"]}},ze(e))).then(K=>{let me=K.data.data.appointment.bookingStart.split(" "),Ae=e.getters["entities/getService"](K.data.data.appointment.serviceId),Ve=[];K.data.data.appointment.bookings.forEach(Q=>{let ve=[];Ae.extras.sort((F,Z)=>F.position-Z.position).forEach(F=>{ve.push({extraId:F.id,quantity:0});let Z=Q.extras.find(W=>W.extraId===F.id);typeof Z<"u"&&(ve[ve.length-1]=Z)});let X=Q.customFields?JSON.parse(Q.customFields):{};Object.keys(X).forEach(F=>{X[F]=Object.assign({},X[F],{value:X[F].type==="datepicker"?X[F].value?ye(X[F].value).toDate():"":X[F].value})}),Ve.push({id:Q.id,customer:ie.bookings.find(F=>F.id===Q.id).customer,persons:Q.persons,status:Q.status,duration:Q.duration?Q.duration.toString():null,extras:ve,customFields:X,payments:Q.payments,price:Q.price,aggregatedPrice:Q.aggregatedPrice,tax:Q.tax,coupon:Q.coupon})}),e.commit("appointment/setAppointment",{id:K.data.data.appointment.id,categoryId:Ae.categoryId,serviceId:K.data.data.appointment.serviceId,providerId:K.data.data.appointment.providerId,locationId:K.data.data.appointment.locationId,internalNotes:K.data.data.appointment.internalNotes,lessonSpace:K.data.data.appointment.lessonSpace!==null?K.data.data.appointment.lessonSpace.split("https://www.thelessonspace.com/space/")[1]:null,startDate:ye(me[0]).toDate(),startTime:me[1].substring(0,5),bookings:Ve,notifyParticipants:!!K.data.data.appointment.notifyParticipants,createPaymentLinks:!!K.data.data.appointment.createPaymentLinks}),z.value=K.data.data.recurring,G.value=!0}).catch(K=>{console.log(K)}).finally(()=>{e.commit("cabinet/setAppointmentsLoading",!1)})}let G=M(!1);function se(){O.value=!0,b.value=d.value.appointment_saved,I.value="success",f.value&&C.value&&setTimeout(function(){dt(f.value,C.value.$el,0,300)},500),B(),te()}function j(ie,K){b.value=ie,I.value=K,O.value=!0}function ne(){oe(),G.value=!0}function te(){G.value=!1,oe()}function oe(){e.commit("appointment/resetAppointment",{providerId:e.getters["auth/getProfile"].id}),e.commit("customerInfo/setCustomers",[]),e.commit("customerInfo/setCustomersIds",[])}return rt(()=>a.loadBookingsCounter,()=>{B()}),Je(()=>{B()}),(ie,K)=>(c(),y("div",{ref_key:"pageContainer",ref:f,class:q(["am-cap am-capa-main",{"am-capai-main":t(G)}])},[m("div",{class:q(["am-capa-main__inner",t(g)])},[t(O)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:C,type:t(I),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:P,onTriggerClose:P},{title:x(()=>[t(I)==="success"?(c(),y("span",gb)):D("",!0),t(I)==="error"?(c(),y("span",fb)):D("",!0),ce(" "+k(t(b)),1)]),_:1},8,["type"])):D("",!0),!t(G)&&t(h)?(c(),U(Ai,{key:1,"step-key":"appointments","responsive-class":t(g),empty:!1,onAddAppointment:ne,onChangeFilters:B},null,8,["responsive-class"])):D("",!0),t(i).cabinetType==="employee"&&t(s).roles.allowWriteAppointments&&!t(G)&&t(h)?(c(),y("div",hb,[A(Ee,{prefix:"plus",size:"small",category:"primary",type:t(l).appointments.options.newAppBtn.buttonType,onClick:ne},{default:x(()=>[m("span",null,k(t(d).new_appointment),1)]),_:1},8,["type"])])):D("",!0),!t($)&&t(h)?(c(),y(ee,{key:3},[!t(G)&&t(S)&&Object.keys(t(S)).length>0?(c(),U(kr,{key:0,"grouped-appointments":t(S),"page-width":t(_),"responsive-class":t(g),"step-key":"appointments",onCanceled:B,onBooked:B,onEditAppointment:N,onStatusChange:j},null,8,["grouped-appointments","page-width","responsive-class"])):t(G)?D("",!0):(c(),U(Ia,{key:1,heading:t(d).no_app_found,text:t(d).have_no_app},null,8,["heading","text"])),!t(G)&&t(S)&&Object.keys(t(S)).length>0&&t(E)>t(s).general.itemsPerPageBackEnd?(c(),U(Sl,{key:2,"page-size":t(s).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(E),"current-page":t(T),onCurrentChange:w},null,8,["page-size","total","current-page"])):D("",!0),t(G)?(c(),U(db,{key:3,"page-width":t(_),"responsive-class":t(g),"linked-appointments":t(z),onEditLinkedAppointment:N,onClose:te,onSave:se},null,8,["page-width","responsive-class","linked-appointments"])):D("",!0)],64)):(c(),U(Ii,{key:4}))],2)],2))}});function ys(n,a,e={},s={}){for(let l in a)l in n&&a[l]&&typeof a[l]=="object"?(l in s||(s[l]={}),ys(n[l],a[l],l in e?e[l]:n[l],s[l]),Object.keys(s[l]).length===0&&delete s[l]):l in e?s[l]=e[l]:l in n?s[l]=n[l]:s[l]=a[l];return s}function yb(n){at.activation.stash&&De.post("/stash",{},Object.assign(ze(n),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(()=>{})}function bb(n,a){let e=n.getters["event/getDefaultEvent"],s=[],l={};a.customTickets.length&&a.bookings.forEach(r=>{r.ticketsData.forEach(u=>{l[u.eventTicketId]=!0})}),a.customTickets.forEach(r=>{JSON.parse(r.dateRanges).forEach((u,d)=>{d in s||s.push({enabled:u.enabled,range:[ye(u.startDate,"YYYY-MM-DD").toDate(),ye(u.endDate,"YYYY-MM-DD").toDate()],tickets:[]}),s[d].tickets.push({price:u.price})}),r.booked=r.id in l});let i=!a.description||a.description.startsWith("<!-- Content -->")?"text":"html",o=a.description?a.description.replace("<!-- Content -->",""):"";return Object.assign({},a,{description:o,descriptionMode:i,tags:a.tags.map(r=>r.name),organizerId:a.organizerId,periods:a.periods.map(r=>new Object({id:r.id,eventId:r.eventId,appleCalendarEventId:r.appleCalendarEventId,googleCalendarEventId:r.googleCalendarEventId,googleMeetUrl:r.googleMeetUrl,outlookCalendarEventId:r.outlookCalendarEventId,startDate:ye(r.periodStart.split(" ")[0],"YYYY-MM-DD").toDate(),endDate:ye(r.periodEnd.split(" ")[0],"YYYY-MM-DD").toDate(),startTime:r.periodStart.split(" ")[1].substring(0,5),endTime:r.periodEnd.split(" ")[1].substring(0,5)})),bookingOpens:{disabled:a.bookingOpens===null,date:a.bookingOpens?ye(a.bookingOpens.split(" ")[0],"YYYY-MM-DD").toDate():null,time:a.bookingOpens?a.bookingOpens.split(" ")[1].substring(0,5):null},bookingOpensRec:a.bookingOpensRec==="same",bookingCloses:{disabled:a.bookingCloses===null,date:a.bookingCloses?ye(a.bookingCloses.split(" ")[0],"YYYY-MM-DD").toDate():null,time:a.bookingCloses?a.bookingCloses.split(" ")[1].substring(0,5):null},bookingClosesRec:a.bookingClosesRec==="same",recurringEnabled:a.recurring&&a.recurring.cycle!==null,recurring:a.recurring!==null?Object.assign({},a.recurring,{until:a.recurring.until?ye(a.recurring.until.split(" ")[0],"YYYY-MM-DD").toDate():null,monthDate:a.recurring.monthDate?ye(a.recurring.monthDate.split(" ")[0],"YYYY-MM-DD").toDate():null}):e.recurring,depositEnabled:a.depositPayment!=="disabled",depositPayment:a.depositPayment!=="disabled"?a.depositPayment:"percentage",customTicketsRangesEnabled:s.length>0,customTicketsRanges:s,maxCustomCapacity:a.maxCustomCapacity===null?1:a.maxCustomCapacity,maxCustomCapacityEnabled:a.maxCustomCapacity!==null,closeAfterMinEnabled:a.closeAfterMin!==null,closeAfterMinBookings:a.closeAfterMinBookings,closeAfterMin:a.closeAfterMin===null?1:a.closeAfterMin,maxExtraPeopleEnabled:a.maxExtraPeople!==null,maxExtraPeople:a.maxExtraPeople===null?0:a.maxExtraPeople,locationId:a.locationId===null&&a.customLocation?0:a.locationId,settings:ys(at,e.settings,a.settings?JSON.parse(a.settings):{},{})})}function kb(n){let a=n.getters["event/getDefaultEvent"],e=[];n.getters["event/getCustomTickets"].forEach((l,i)=>{let o=[];n.getters["event/getCustomTicketsRanges"].filter(r=>r.range[0]&&r.range[1]).forEach(r=>{o.push({startDate:ye(r.range[0]).format("YYYY-MM-DD"),endDate:ye(r.range[1]).format("YYYY-MM-DD"),price:r.tickets[i].price})}),e.push(Object.assign({},l,{dateRanges:JSON.stringify(o)}))});let s=ys(ys(at,a.settings,{},{}),a.settings,n.getters["event/getSettings"],{});return Object.keys(n.getters["event/getSettings"]).forEach(l=>{Object.keys(n.getters["event/getSettings"][l]).forEach(i=>{n.getters["event/getSettings"][l][i]!==null&&typeof n.getters["event/getSettings"][l][i]=="object"?(Object.keys(n.getters["event/getSettings"][l][i]).forEach(o=>{(n.getters["event/getSettings"][l][i][o]===at[l][i][o]||at[l][i][o]&&(n.getters["event/getSettings"][l][i][o]===""||n.getters["event/getSettings"][l][i][o]===null))&&delete s[l][i][o]}),typeof s[l][i]=="object"&&Object.keys(s[l][i]).length===0&&delete s[l][i]):l in at&&i in at[l]&&(s[l][i]===at[l][i]||at[l][i]&&(n.getters["event/getSettings"][l][i]===""||n.getters["event/getSettings"][l][i]===null))&&delete s[l][i]}),Object.keys(s[l]).length===0&&delete s[l]}),{aggregatedPrice:n.getters["event/getAggregatedPrice"],bookMultipleTimes:n.getters["event/getBookMultipleTimes"],bookingCloses:!n.getters["event/getBookingClosesDisabled"]&&n.getters["event/getBookingClosesDate"]&&n.getters["event/getBookingClosesTime"]?ye(n.getters["event/getBookingClosesDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingClosesTime"]+":00":null,bookingClosesRec:n.getters["event/getBookingClosesRec"]?"same":"calculate",bookingOpens:!n.getters["event/getBookingOpensDisabled"]&&n.getters["event/getBookingOpensDate"]&&n.getters["event/getBookingOpensTime"]?ye(n.getters["event/getBookingOpensDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingOpensTime"]+":00":null,bookingOpensRec:n.getters["event/getBookingOpensRec"]?"same":"calculate",bringingAnyone:n.getters["event/getBringingAnyone"],closeAfterMin:n.getters["event/getCloseAfterMinEnabled"]?n.getters["event/getCloseAfterMin"]:null,closeAfterMinBookings:n.getters["event/getCloseAfterMinBookings"],color:n.getters["event/getColor"],customLocation:n.getters["event/getCustomLocation"],customPricing:n.getters["event/getCustomPricing"],customTickets:e,deposit:n.getters["event/getDeposit"],depositPayment:n.getters["event/getDepositEnabled"]?n.getters["event/getDepositPayment"]:"disabled",depositPerPerson:n.getters["event/getDepositPerPerson"],description:n.getters["event/getDescription"]&&n.getters["event/getDescriptionMode"]==="text"?"<!-- Content -->"+n.getters["event/getDescription"]:n.getters["event/getDescription"],fullPayment:n.getters["event/getFullPayment"],gallery:n.getters["event/getGallery"],id:n.getters["event/getId"],locationId:n.getters["event/getLocationId"]===0?null:n.getters["event/getLocationId"],maxCapacity:n.getters["event/getMaxCapacity"],maxCustomCapacity:n.getters["event/getMaxCustomCapacityEnabled"]?n.getters["event/getMaxCustomCapacity"]:null,maxExtraPeople:n.getters["event/getMaxExtraPeopleEnabled"]?n.getters["event/getMaxExtraPeople"]:null,name:n.getters["event/getName"],notifyParticipants:n.getters["event/getNotifyParticipants"],organizerId:n.getters["event/getOrganizerId"],parentId:n.getters["event/getParentId"],periods:Er(n),price:n.getters["event/getPrice"],providers:n.getters["event/getId"]?n.getters["event/getProviders"]:[{id:n.getters["auth/getProfile"].id,firstName:n.getters["auth/getProfile"].firstName,lastName:n.getters["auth/getProfile"].lastName,email:n.getters["auth/getProfile"].email,type:"provider"}],recurring:n.getters["event/getRecurringEnabled"]?Object.assign({},n.getters["event/getRecurring"],{until:ye(n.getters["event/getRecurringUntil"]).format("YYYY-MM-DD"),monthDate:n.getters["event/getRecurringMonthDate"]?ye(n.getters["event/getRecurringMonthDate"]).format("YYYY-MM-DD"):null}):null,settings:Object.keys(s).length?JSON.stringify(s):null,show:n.getters["event/getShow"],tags:n.getters["event/getTags"].map(l=>new Object({name:l})),timeZone:n.getters["cabinet/getTimeZone"],translations:n.getters["event/getTranslations"],utc:n.getters["cabinet/getTimeZone"]==="UTC",zoomUserId:n.getters["event/getZoomUserId"]}}function Er(n){return n.getters["event/getPeriods"].map(a=>new Object({id:a.id,eventId:a.eventId,appleCalendarEventId:a.appleCalendarEventId,googleCalendarEventId:a.googleCalendarEventId,googleMeetUrl:a.googleMeetUrl,outlookCalendarEventId:a.outlookCalendarEventId,microsoftTeamsUrl:a.microsoftTeamsUrl,periodStart:n.getters["cabinet/getTimeZone"]==="UTC"?ye(a.startDate).utc().format("YYYY-MM-DD")+" "+a.startTime+":00":ye(a.startDate).format("YYYY-MM-DD")+" "+a.startTime+":00",periodEnd:n.getters["cabinet/getTimeZone"]==="UTC"?ye(a.endDate).utc().format("YYYY-MM-DD")+" "+a.endTime+":00":ye(a.endDate).format("YYYY-MM-DD")+" "+a.endTime+":00"}))}const xl=Qe(window.wpAmeliaLabels);function vo(n,a={}){return Object.assign(a,{id:n.id,eventId:n.event.id,customer:n.customer,customerId:n.customer.id,persons:n.persons,customFields:n.customFields?JSON.parse(n.customFields):{},ticketsData:n.ticketsData,status:n.status,tax:n.tax,price:n.price,coupon:n.coupon,payments:n.payments})}function Lr(n){let a={};return Object.keys(n.getters["attendee/getCustomFields"]).forEach(e=>{a[e]={label:n.getters["attendee/getCustomFields"][e].label,type:n.getters["attendee/getCustomFields"][e].type,value:n.getters["attendee/getCustomFields"][e].type==="datepicker"?n.getters["attendee/getCustomFields"][e].value?ye(n.getters["attendee/getCustomFields"][e].value).format("YYYY-MM-DD"):null:n.getters["attendee/getCustomFields"][e].value}}),{id:n.getters["attendee/getId"],type:"event",eventId:n.getters["attendee/getEventId"],bookings:[{customerId:n.getters["attendee/getCustomerId"],persons:n.getters["attendee/getPersons"],customFields:a,ticketsData:n.getters["attendee/getTickets"],status:n.getters["attendee/getStatus"],coupon:n.getters["attendee/getCoupon"]}],status:n.getters["attendee/getStatus"],validateCoupon:!1,isBackendOrCabinet:!0,createPaymentLinks:!1,payment:{gateway:"onSite"}}}function fs(n,a,e=null){let s=a.customFields,l=e&&e.customPricing?e.customTickets.map((i,o)=>new Object({eventTicketId:i.id,persons:o===0&&!Object.keys(a.ticketsData).length?1:0,price:i.price})):[];return e&&(n.getters["entities/getCustomFields"].filter(i=>i.allEvents||i.events.map(o=>o.id).indexOf(e.id)!==-1&&i.type!=="content"&&i.type!=="file").forEach(i=>{s[i.id]={type:i.type,label:i.label,value:i.id in s?s[i.id].value:i.type==="checkbox"||i.type==="file"?[]:"",width:i.width,options:i.options,id:i.id,required:i.required}}),e.customPricing&&Object.keys(a.ticketsData).forEach(i=>{let o=l.find(r=>r.eventTicketId===a.ticketsData[i].eventTicketId);o.id=a.ticketsData[i].id,o.persons=a.ticketsData[i].persons,o.price=a.ticketsData[i].price,o.customerBookingId=a.ticketsData[i].customerBookingId})),Object.assign({},a,{eventId:e?e.id:null,customFields:s,ticketsData:l})}function Sr(){return[{label:xl.approved,value:"approved",icon:"check",color:"var(--am-c-success)"},{label:xl.waiting,value:"waiting",icon:"clock",color:"var(--am-c-warning)"},{label:xl.canceled,value:"canceled",icon:"close",color:"var(--am-c-error)"},{label:xl["no-show"],value:"no-show",icon:"clock",color:"var(--am-c-warning)"}]}function Ar(n){let a=0;return n.getters["attendee/getTickets"].length?n.getters["attendee/getTickets"].forEach(e=>{e.persons&&(a+=n.getters["attendee/getAggregatedPrice"]?e.price*e.persons:e.price)}):a=n.getters["attendee/getAggregatedPrice"]?n.getters["attendee/getPrice"]*n.getters["attendee/getPersons"]:n.getters["attendee/getPrice"],ni(null,n.getters["attendee/getCoupon"],n.getters["attendee/getTax"]&&n.getters["attendee/getTax"].length?n.getters["attendee/getTax"][0]:null,a,!1)}const Cb=["innerHTML"],xb=["innerHTML"],wb={setup(n,{expose:a}){let e=Ne(),s=R("amLabels"),l=R("licence");const i=R("settings");let o=M(e.getters["entities/getLocations"]),r=M(e.getters["entities/getTags"]),u=M("");function d(P){u.value=P.toLowerCase()}let f=v(()=>u.value?r.value.filter(P=>P.name.toLowerCase().includes(u.value)):r.value),_=M(null),g=M({name:v({get:()=>e.getters["event/getName"],set:P=>{e.commit("event/setName",P)}}),locationId:v({get:()=>e.getters["event/getLocationId"],set:P=>{e.commit("event/setLocationId",P)}}),customLocation:v({get:()=>e.getters["event/getCustomLocation"],set:P=>{e.commit("event/setCustomLocation",P)}}),organizerId:v({get:()=>e.getters["event/getOrganizerId"],set:P=>{e.commit("event/setOrganizerId",P)}}),zoomUserId:v({get:()=>e.getters["event/getZoomUserId"],set:P=>{e.commit("event/setZoomUserId",P)}}),tags:v({get:()=>e.getters["event/getTags"],set:P=>{e.commit("event/setTags",P)}}),notifyParticipants:v({get:()=>e.getters["event/getNotifyParticipants"],set:P=>{e.commit("event/setNotifyParticipants",P)}}),description:v({get:()=>e.getters["event/getDescription"],set:P=>{e.commit("event/setDescription",P||"")}})}),C=v(()=>g.value.organizerId!==null);function O(P){e.commit("event/setOrganizerId",P?e.getters["auth/getProfile"].id:null)}let I=v(()=>({name:[{required:!0,message:s.value.please_enter_name,trigger:["submit","change"]}]})),b=v(()=>{let P=e.getters["auth/getZoomUsers"];return P.length?P.map(L=>({value:L.id,label:`${L.first_name} ${L.last_name} (${L.email})`})):[]});return a({detailsFormRef:_}),(P,L)=>{const $=yt,h=Ml,S=et;return c(),U(S,{ref_key:"detailsFormRef",ref:_,model:t(g),rules:t(I),class:"am-capei-def"},{default:x(()=>[A($,{prop:"name",label:`${t(s).name}:`,class:"am-capei-def__item"},{default:x(()=>[A(it,{modelValue:t(g).name,"onUpdate:modelValue":L[0]||(L[0]=E=>t(g).name=E),placeholder:t(s).enter_event_name},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),!t(l).isStarter&&t(o).length>1?(c(),U($,{key:0,label:`${t(s).event_select_address}:`,class:"am-capei-def__item"},{default:x(()=>[A(He,{modelValue:t(g).locationId,"onUpdate:modelValue":L[1]||(L[1]=E=>t(g).locationId=E),placeholder:t(s).select},{default:x(()=>[(c(),U(qe,{key:0,value:0,label:t(s).event_custom_address},null,8,["label"])),(c(!0),y(ee,null,fe(t(o),E=>(c(),U(qe,{key:E.id,value:E.id,label:E.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),t(g).locationId?D("",!0):(c(),U($,{key:1,label:`${t(s).event_custom_address}:`,class:"am-capei-def__item"},{default:x(()=>[A(it,{modelValue:t(g).customLocation,"onUpdate:modelValue":L[2]||(L[2]=E=>t(g).customLocation=E)},null,8,["modelValue"])]),_:1},8,["label"])),t(i).zoom.enabled?(c(),U($,{key:2,label:`${t(s).zoom_user}:`,class:"am-capei-def__item"},{default:x(()=>[A(He,{modelValue:t(g).zoomUserId,"onUpdate:modelValue":L[3]||(L[3]=E=>t(g).zoomUserId=E),clearable:"",placeholder:t(s).zoom_user_placeholder},{default:x(()=>[(c(!0),y(ee,null,fe(t(b),E=>(c(),U(qe,{key:E.value,value:E.value,label:E.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),!t(l).isStarter&&(t(i).googleCalendar.enabled||t(i).outlookCalendar.enabled||t(i).appleCalendar)&&(t(e).getters["employee/getGoogleCalendarId"]||t(e).getters["employee/getOutlookCalendarId"]||t(e).getters["employee/getAppleCalendarId"])?(c(),U($,{key:3,class:"am-capei-def__item am-capei-def__item-tool"},{default:x(()=>[A(lt,{modelValue:t(C),"onUpdate:modelValue":L[4]||(L[4]=E=>we(C)?C.value=E:C=E),disabled:t(g).organizerId&&t(g).organizerId!==t(e).getters["auth/getProfile"].id,"active-text":t(s).event_organizer,"aria-label":t(s).event_organizer,onChange:O},null,8,["modelValue","disabled","active-text","aria-label"]),A(h,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).event_organizer_tooltip},null,8,Cb)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1})):D("",!0),A($,{label:`${t(s).event_tags}:`,class:"am-capei-def__item"},{default:x(()=>[A(He,{modelValue:t(g).tags,"onUpdate:modelValue":L[5]||(L[5]=E=>t(g).tags=E),clearable:"",filterable:"",multiple:"","allow-create":!0,placeholder:t(s).event_tags_select_or_create,"filter-method":d},{default:x(()=>[(c(!0),y(ee,null,fe(t(f),(E,T)=>(c(),U(qe,{key:T,value:E.name,label:E.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),A($,{class:"am-capei-def__item am-capei-def__item-tool"},{default:x(()=>[A(lt,{modelValue:t(g).notifyParticipants,"onUpdate:modelValue":L[6]||(L[6]=E=>t(g).notifyParticipants=E),"active-text":t(s).notify_attendees,"aria-label":t(s).notify_attendees},null,8,["modelValue","active-text","aria-label"]),A(h,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).notify_attendees_tooltip},null,8,xb)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1}),A($,{prop:"description",label:t(s).description_colon,class:"am-capei-def__item"},{default:x(()=>[A(mr,{modelValue:t(g).description,"onUpdate:modelValue":L[7]||(L[7]=E=>t(g).description=E),mode:t(e).getters["event/getDescriptionMode"],onSetMode:L[8]||(L[8]=E=>t(e).commit("event/setDescriptionMode",E))},null,8,["modelValue","mode"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};const Tb={class:"am-capei-per__segment"},Eb={key:0,class:"am-capei-per__delete"},Lb={class:"am-capei-per__segment"},Sb=["innerHTML"],Ab={class:"am-capei-per__segment"},Ib=["innerHTML"],Pb={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:a}){const e=n;let s=v(()=>st(e.pageWidth));const l=Ne(),i=R("settings");let o=R("amLabels"),r=R("localLanguage"),u=M(Ke());function d($){let h=b.value.periods.map(S=>S.endDate).filter(S=>S instanceof Date&&!isNaN(S));return Ke($)<u.value||Ke($)>Ke(new Date(Math.max(...h)))}function f($,h){const S=Ke($)<u.value;return(h?Ke($)>Ke(h):!1)||S}function _($,h){return h?Ke($)<Ke(h):Ke($)<u.value}function g(){let $=!0;I.value.validate(h=>{h||($=!1)}),$&&b.value.periods.push({eventId:l.getters["event/getId"]?l.getters["event/getId"]:null,startDate:null,endDate:null,startTime:null,endTime:null})}function C($){l.getters["event/getId"]&&b.value.periods[$]?.id&&b.value.periods[$].id&&b.value.periods.forEach((h,S)=>{S!==$&&!h?.id&&(b.value.periods[S].id=b.value.periods[$].id,b.value.periods[S].eventId=b.value.periods[$].eventId,b.value.periods[S].appleCalendarEventId=b.value.periods[$].appleCalendarEventId,b.value.periods[S].googleCalendarEventId=b.value.periods[$].googleCalendarEventId,b.value.periods[S].googleMeetUrl=b.value.periods[$].googleMeetUrl,b.value.periods[S].outlookCalendarEventId=b.value.periods[$].outlookCalendarEventId,b.value.periods[S].microsoftTeamsUrl=b.value.periods[$].microsoftTeamsUrl)}),b.value.periods.splice($,1)}let O=v(()=>l.getters["event/getRecurringEnabled"]),I=M(null),b=M({periods:v({get:()=>l.getters["event/getPeriods"],set:$=>{l.commit("event/setPeriods",$)}}),bookingOpensDisabled:v({get:()=>l.getters["event/getBookingOpensDisabled"],set:$=>{l.commit("event/setBookingOpensDisabled",$)}}),bookingOpensDate:v({get:()=>l.getters["event/getBookingOpensDate"],set:$=>{l.commit("event/setBookingOpensDate",$)}}),bookingOpensTime:v({get:()=>l.getters["event/getBookingOpensTime"],set:$=>{l.commit("event/setBookingOpensTime",$)}}),bookingOpensRec:v({get:()=>l.getters["event/getBookingOpensRec"],set:$=>{l.commit("event/setBookingOpensRec",$)}}),bookingClosesDisabled:v({get:()=>l.getters["event/getBookingClosesDisabled"],set:$=>{l.commit("event/setBookingClosesDisabled",$)}}),bookingClosesDate:v({get:()=>l.getters["event/getBookingClosesDate"],set:$=>{l.commit("event/setBookingClosesDate",$)}}),bookingClosesTime:v({get:()=>l.getters["event/getBookingClosesTime"],set:$=>{l.commit("event/setBookingClosesTime",$)}}),bookingClosesRec:v({get:()=>l.getters["event/getBookingClosesRec"],set:$=>{l.commit("event/setBookingClosesRec",$)}})});a({periodsFormRef:I});let P=R("amColors"),L=v(()=>({"--am-c-capei-per-text":P.value.colorMainText,"--am-c-capei-per-text-op03":H(P.value.colorMainText,.03),"--am-c-capei-per-inp-bgr-op03":H(P.value.colorInpBgr,.03)}));return($,h)=>{const S=yt,E=Ml,T=et;return c(),U(T,{ref_key:"periodsFormRef",ref:I,model:t(b),"label-position":"top",class:"am-capei-per",style:Ce(t(L))},{default:x(()=>[m("div",Tb,[(c(!0),y(ee,null,fe(t(b).periods,(w,B)=>(c(),y(ee,{key:B},[A(S,{prop:"periods."+B+".startDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},label:`${t(o).start_date}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(Yt,{modelValue:w.startDate,"onUpdate:modelValue":z=>w.startDate=z,format:t(jt)(),lang:t(r),"disabled-date":z=>f(z,w.endDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),A(S,{prop:"periods."+B+".endDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},label:`${t(o).end_date}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(Yt,{modelValue:w.endDate,"onUpdate:modelValue":z=>w.endDate=z,format:t(jt)(),lang:t(r),"disabled-date":z=>_(z,w.startDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),A(S,{prop:"periods."+B+".startTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},label:`${t(o).start_time}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(La,{modelValue:w.startTime,"onUpdate:modelValue":z=>w.startTime=z,start:"00:00",end:t(Dt)(t(Bt)("24:00")-t(i).general.timeSlotLength),"min-time":null,"max-time":w.endTime,step:t(Dt)(t(i).general.timeSlotLength),clearable:!1,placeholder:t(o).select_time},null,8,["modelValue","onUpdate:modelValue","end","max-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),A(S,{prop:"periods."+B+".endTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},label:`${t(o).end_time}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(La,{modelValue:w.endTime,"onUpdate:modelValue":z=>w.endTime=z,disabled:!w.startTime,start:"00:00",end:"24:00","min-time":w.startTime,"max-time":null,step:t(Dt)(t(i).general.timeSlotLength),clearable:!1,placeholder:t(o).select_time},null,8,["modelValue","onUpdate:modelValue","disabled","min-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),t(b).periods.length>1?(c(),y("div",Eb,[A(Ee,{size:"default",category:"danger",onClick:z=>C(B)},{default:x(()=>[ce(k(t(o).delete_period),1)]),_:2},1032,["onClick"])])):D("",!0)],64))),128)),A(Ee,{size:"default",onClick:h[0]||(h[0]=w=>g())},{default:x(()=>[ce(k(t(o).add_period),1)]),_:1})]),m("div",Lb,[A(mt,{modelValue:t(b).bookingOpensDisabled,"onUpdate:modelValue":h[1]||(h[1]=w=>t(b).bookingOpensDisabled=w),label:t(o).event_booking_opens_now},null,8,["modelValue","label"]),t(b).bookingOpensDisabled?D("",!0):(c(),y(ee,{key:0},[A(S,{label:`${t(o).date}:`,prop:"bookingOpensDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(Yt,{modelValue:t(b).bookingOpensDate,"onUpdate:modelValue":h[2]||(h[2]=w=>t(b).bookingOpensDate=w),format:t(jt)(),lang:t(r),"disabled-date":d},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),A(S,{label:`${t(o).time}:`,prop:"bookingOpensTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(La,{modelValue:t(b).bookingOpensTime,"onUpdate:modelValue":h[3]||(h[3]=w=>t(b).bookingOpensTime=w),placeholder:t(o).select_time,step:t(Dt)(t(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1},null,8,["modelValue","placeholder","step"])]),_:1},8,["label","rules","class"])],64)),t(O)?(c(),U(mt,{key:1,modelValue:t(b).bookingOpensRec,"onUpdate:modelValue":h[4]||(h[4]=w=>t(b).bookingOpensRec=w)},{default:x(()=>[ce(k(t(o).apply_to_all)+" ",1),A(E,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(o).event_booking_closes_apply},null,8,Sb)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):D("",!0)]),m("div",Ab,[A(mt,{modelValue:t(b).bookingClosesDisabled,"onUpdate:modelValue":h[5]||(h[5]=w=>t(b).bookingClosesDisabled=w),label:t(o).event_booking_closes_after},null,8,["modelValue","label"]),t(b).bookingClosesDisabled?D("",!0):(c(),y(ee,{key:0},[A(S,{label:`${t(o).date}:`,prop:"bookingClosesDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(Yt,{modelValue:t(b).bookingClosesDate,"onUpdate:modelValue":h[6]||(h[6]=w=>t(b).bookingClosesDate=w),format:t(jt)(),lang:t(r),"disabled-date":d},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),A(S,{label:`${t(o).time}:`,prop:"bookingClosesTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[A(La,{modelValue:t(b).bookingClosesTime,"onUpdate:modelValue":h[7]||(h[7]=w=>t(b).bookingClosesTime=w),step:t(Dt)(t(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1,placeholder:t(o).select_time},null,8,["modelValue","step","placeholder"])]),_:1},8,["label","rules","class"])],64)),t(O)?(c(),U(mt,{key:1,modelValue:t(b).bookingClosesRec,"onUpdate:modelValue":h[8]||(h[8]=w=>t(b).bookingClosesRec=w)},{default:x(()=>[ce(k(t(o).apply_to_all)+" ",1),A(E,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(o).event_booking_closes_apply},null,8,Ib)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):D("",!0)])]),_:1},8,["model","style"])}}};const $b={class:"am-capei-recurr__header"},Nb={class:"am-capei-recurr__header-text"},Db={props:{pageWidth:{type:Number,default:0},recurringUntil:{type:Object,default:null}},setup(n,{expose:a}){const e=n;let s=v(()=>st(e.pageWidth));const l=Ne();let i=R("amLabels"),o=R("localLanguage"),r=M([{label:i.value.day,value:"daily"},{label:i.value.week,value:"weekly"},{label:i.value.month,value:"monthly"},{label:i.value.year,value:"yearly"}]),u=M([{label:i.value.recurring_date_first,value:"first"},{label:i.value.recurring_date_second,value:"second"},{label:i.value.recurring_date_third,value:"third"},{label:i.value.recurring_date_fourth,value:"fourth"},{label:i.value.recurring_date_fifth,value:"fifth"},{label:i.value.recurring_date_last,value:"last"}]),d=[{label:i.value.weekday_monday,value:"monday"},{label:i.value.weekday_tuesday,value:"tuesday"},{label:i.value.weekday_wednesday,value:"wednesday"},{label:i.value.weekday_thursday,value:"thursday"},{label:i.value.weekday_friday,value:"friday"},{label:i.value.weekday_saturday,value:"saturday"},{label:i.value.weekday_sunday,value:"sunday"}],f=M(null),_=M({enabled:v({get:()=>l.getters["event/getRecurringEnabled"],set:L=>{l.commit("event/setRecurringEnabled",L)}}),cycle:v({get:()=>l.getters["event/getRecurringCycle"],set:L=>{l.commit("event/setRecurringCycle",L)}}),cycleInterval:v({get:()=>l.getters["event/getRecurringCycleInterval"],set:L=>{l.commit("event/setRecurringCycleInterval",L)}}),monthDate:v({get:()=>l.getters["event/getRecurringMonthDate"],set:L=>{l.commit("event/setRecurringMonthDate",L)}}),monthlyOnDay:v({get:()=>l.getters["event/getRecurringMonthlyOnDay"],set:L=>{l.commit("event/setRecurringMonthlyOnDay",L)}}),monthlyOnRepeat:v({get:()=>l.getters["event/getRecurringMonthlyOnRepeat"],set:L=>{l.commit("event/setRecurringMonthlyOnRepeat",L)}}),monthlyRepeat:v({get:()=>l.getters["event/getRecurringMonthlyRepeat"],set:L=>{l.commit("event/setRecurringMonthlyRepeat",L)}}),order:v({get:()=>l.getters["event/getRecurringOrder"],set:L=>{l.commit("event/setRecurringOrder",L)}}),until:v({get:()=>l.getters["event/getRecurringUntil"],set:L=>{l.commit("event/setRecurringUntil",L)}})}),g=v(()=>({cycle:[{required:!0,message:i.value.select_cycle_warning,trigger:["submit","change"]}],until:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],monthDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}]})),C=v(()=>l.getters["event/getPeriods"]),O=v(()=>e.recurringUntil!==null?e.recurringUntil:C.value.length?Ke(C.value[0].startDate,"YYYY-MM-DD"):Ke());function I(L){return Ke(L)<=O.value}a({recurringFormRef:f});let b=R("amColors"),P=v(()=>({"--am-c-capei-recurr-text":b.value.colorMainText,"--am-c-capei-recurr-text-op03":H(b.value.colorMainText,.03),"--am-c-capei-recurr-inp-bgr-op03":H(b.value.colorInpBgr,.03),"--am-c-capei-recurr-bgr-op03":H(b.value.colorMainText,.03)}));return(L,$)=>{const h=yt,S=et;return c(),y("div",{class:"am-capei-recurr",style:Ce(t(P))},[m("div",$b,[m("div",Nb,k(t(i).event_recurring_check),1),A(lt,{modelValue:t(_).enabled,"onUpdate:modelValue":$[0]||($[0]=E=>t(_).enabled=E),disabled:!t(C).length||!t(C)[0].startDate||!t(C)[0].endDate,"aria-label":t(i).event_recurring_check},null,8,["modelValue","disabled","aria-label"])]),t(_).enabled&&t(C).length&&t(C)[0].startDate&&t(C)[0].endDate?(c(),U(S,{key:0,ref_key:"recurringFormRef",ref:f,rules:t(g),model:t(_),"label-position":"top",class:"am-capei-recurr__form"},{default:x(()=>[A(h,{label:`${t(i).repeat_every}`,class:q(["am-capei-recurr__form-item am-ws-150",t(s)])},{default:x(()=>[A(ht,{modelValue:t(_).cycleInterval,"onUpdate:modelValue":$[1]||($[1]=E=>t(_).cycleInterval=E),min:1,disabled:t(e).recurringUntil!==null},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),A(h,{prop:"cycle",class:q(["am-capei-recurr__form-item am-inline-ws-150 am-align-end",t(s)])},{default:x(()=>[A(He,{modelValue:t(_).cycle,"onUpdate:modelValue":$[2]||($[2]=E=>t(_).cycle=E),clearable:"",placeholder:t(i).select_repeat_period,disabled:t(e).recurringUntil!==null},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),(E,T)=>(c(),U(qe,{key:T,value:E.value,label:E.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["class"]),t(_).cycle==="monthly"?(c(),U(Vl,{key:0,modelValue:t(_).monthlyRepeat,"onUpdate:modelValue":$[6]||($[6]=E=>t(_).monthlyRepeat=E),class:"am-w-100",disabled:t(e).recurringUntil!==null},{default:x(()=>[A(h,{class:"am-capei-recurr__form-item"},{default:x(()=>[A(Pa,{value:"each"},{default:x(()=>[ce(k(t(i).recurrence_each),1)]),_:1})]),_:1}),A(h,{prop:"monthDate",class:"am-capei-recurr__form-item"},{default:x(()=>[A(Yt,{modelValue:t(_).monthDate,"onUpdate:modelValue":$[3]||($[3]=E=>t(_).monthDate=E),disabled:t(_).monthlyRepeat==="on"||t(e).recurringUntil!==null,format:t(jt)(),lang:t(o),placeholder:t(i).select_date},null,8,["modelValue","disabled","format","lang","placeholder"])]),_:1}),A(h,{prop:"on",class:"am-capei-recurr__form-item"},{default:x(()=>[A(Pa,{value:"on"},{default:x(()=>[ce(k(t(i).recurrence_on),1)]),_:1})]),_:1}),A(h,{class:q(["am-capei-recurr__form-item am-w-50",t(s)])},{default:x(()=>[A(He,{modelValue:t(_).monthlyOnRepeat,"onUpdate:modelValue":$[4]||($[4]=E=>t(_).monthlyOnRepeat=E),disabled:t(_).monthlyRepeat==="each"||t(e).recurringUntil!==null,placeholder:t(i).select_repeat_period},{default:x(()=>[(c(!0),y(ee,null,fe(t(u),(E,T)=>(c(),U(qe,{key:T,value:E.value,label:E.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"]),A(h,{class:q(["am-capei-recurr__form-item am-w-50",t(s)])},{default:x(()=>[A(He,{modelValue:t(_).monthlyOnDay,"onUpdate:modelValue":$[5]||($[5]=E=>t(_).monthlyOnDay=E),disabled:t(_).monthlyRepeat==="each",placeholder:t(i).select_repeat_period},{default:x(()=>[(c(!0),y(ee,null,fe(t(d),(E,T)=>(c(),U(qe,{key:T,value:E.value,label:E.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"])]),_:1},8,["modelValue","disabled"])):D("",!0),A(h,{label:t(i).event_recurring_until,prop:"until",class:"am-capei-recurr__form-item"},{default:x(()=>[A(Yt,{modelValue:t(_).until,"onUpdate:modelValue":$[7]||($[7]=E=>t(_).until=E),format:t(jt)(),lang:t(o),"disabled-date":I,placeholder:t(i).select_date},null,8,["modelValue","format","lang","placeholder"])]),_:1},8,["label"])]),_:1},8,["rules","model"])):D("",!0)],4)}}};const Ob={class:"am-capei-price__heading"},Fb={key:0,class:"am-capei-price__segment"},Mb={key:0,class:"am-capei-price__block"},Vb={class:"am-capei-price__block-header"},Bb={class:"am-capei-price__block-header__text"},Rb={key:1,class:"am-capei-price__segment"},qb={key:1,class:"am-capei-price__block"},Ub={class:"am-capei-price__block-header"},zb={class:"am-capei-price__block-header__text"},jb={key:0,class:"am-capei-price__block-heading am-pl-32 am-pr-44"},Yb={class:"am-capei-price__block-heading__item am-custom-pricing am-w-40"},Wb={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},Hb={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},Zb={key:1,class:"am-separator am-order-6"},Gb=m("div",{class:"am-separator"},null,-1),Jb={class:"am-capei-price__part"},Xb=m("div",{class:"am-separator"},null,-1),Qb={class:"am-capei-price__block-header"},Kb={class:"am-capei-price__block-header__text"},e1={key:1,class:"am-capei-price__block-segment"},t1={key:0,class:"am-capei-price__block-heading"},a1={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},s1={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},l1=m("div",{class:"am-separator"},null,-1),n1={key:2,class:"am-capei-price__block"},i1={class:"am-capei-price__block-header"},o1={class:"am-capei-price__block-header__text"},r1={key:0,class:"am-capei-price__part"},c1={key:3,class:"am-capei-price__block"},u1={class:"am-capei-price__block-header"},d1={class:"am-capei-price__block-header__text"},m1={key:0,class:"am-capei-price__part"},p1={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:a}){const e=n;let s=v(()=>st(e.pageWidth)),l=Ne(),i=R("amLabels"),o=R("localLanguage"),r=R("licence"),u={components:{IconComponent:We},template:'<IconComponent icon="plus"/>'};function d(T){let w=ye(T),B=!1;if(h.value.customTicketsRanges.forEach(G=>{!B&&G.range[0]&&G.range[1]&&(B=ye(G.range[0])<=w&&ye(G.range[1])>=w)}),B)return!0;let z=l.getters["event/getBookingOpensDisabled"]?ye():ye(l.getters["event/getBookingOpensDate"]),N=l.getters["event/getBookingClosesDisabled"]?l.getters["event/getPeriods"][0].startDate?ye(l.getters["event/getPeriods"][0].startDate,"YYYY-MM-DD"):ye():ye(l.getters["event/getBookingClosesDate"]);return w<z||w>N}let f=v(()=>l.getters["event/getEvent"]),_=v(()=>h.value.customPricing?h.value.customTickets.reduce((T,w)=>T+w.spots,0)>1:h.value.maxCapacity>1),g=v(()=>h.value.customPricing?h.value.customTickets.reduce((T,w)=>T+w.spots,0):0),C=v(()=>h.value.customPricing&&h.value.maxCustomCapacityEnabled?h.value.maxCustomCapacity:h.value.customPricing?g.value:h.value.maxCapacity);function O(){h.value.customPricing&&h.value.customTickets.length===0&&b()}function I(T){h.value.customTickets.splice(T,1)}function b(){h.value.customTickets.push({enabled:!0,name:"",spots:1,waitingListSpots:0,price:0}),h.value.customTicketsRanges.forEach(T=>{T.tickets.push(new Object({price:0}))})}function P(T){h.value.customTicketsRanges.splice(T,1)}function L(){h.value.customTicketsRanges.push({range:["",""],tickets:h.value.customTickets.map(T=>new Object({price:T.price}))})}const $=M(null);let h=M({price:v({get:()=>l.getters["event/getPrice"],set:T=>{l.commit("event/setPrice",T)}}),maxCapacity:v({get:()=>l.getters["event/getMaxCapacity"],set:T=>{l.commit("event/setMaxCapacity",T)}}),bringingAnyone:v({get:()=>l.getters["event/getBringingAnyone"],set:T=>{l.commit("event/setBringingAnyone",T)}}),aggregatedPrice:v({get:()=>l.getters["event/getAggregatedPrice"],set:T=>{l.commit("event/setAggregatedPrice",T)}}),bookMultipleTimes:v({get:()=>l.getters["event/getBookMultipleTimes"],set:T=>{l.commit("event/setBookMultipleTimes",T)}}),depositEnabled:v({get:()=>l.getters["event/getDepositEnabled"],set:T=>{l.commit("event/setDepositEnabled",T)}}),deposit:v({get:()=>l.getters["event/getDeposit"],set:T=>{l.commit("event/setDeposit",T)}}),depositPayment:v({get:()=>l.getters["event/getDepositPayment"],set:T=>{l.commit("event/setDepositPayment",T)}}),depositPerPerson:v({get:()=>l.getters["event/getDepositPerPerson"],set:T=>{l.commit("event/setDepositPerPerson",T)}}),fullPayment:v({get:()=>l.getters["event/getFullPayment"],set:T=>{l.commit("event/setFullPayment",T)}}),customPricing:v({get:()=>l.getters["event/getCustomPricing"],set:T=>{l.commit("event/setCustomPricing",T)}}),customTickets:v({get:()=>l.getters["event/getCustomTickets"],set:T=>{l.commit("event/setCustomTickets",T)}}),customTicketsRangesEnabled:v({get:()=>l.getters["event/getCustomTicketsRangesEnabled"],set:T=>{l.commit("event/setCustomTicketsRangesEnabled",T)}}),customTicketsRanges:v({get:()=>l.getters["event/getCustomTicketsRanges"],set:T=>{l.commit("event/setCustomTicketsRanges",T)}}),maxCustomCapacityEnabled:v({get:()=>l.getters["event/getMaxCustomCapacityEnabled"],set:T=>{l.commit("event/setMaxCustomCapacityEnabled",T)}}),maxCustomCapacity:v({get:()=>l.getters["event/getMaxCustomCapacity"],set:T=>{l.commit("event/setMaxCustomCapacity",T)}}),closeAfterMinEnabled:v({get:()=>l.getters["event/getCloseAfterMinEnabled"],set:T=>{l.commit("event/setCloseAfterMinEnabled",T)}}),closeAfterMin:v({get:()=>l.getters["event/getCloseAfterMin"],set:T=>{l.commit("event/setCloseAfterMin",T)}}),closeAfterMinBookings:v({get:()=>l.getters["event/getCloseAfterMinBookings"],set:T=>{l.commit("event/setCloseAfterMinBookings",T)}}),maxExtraPeopleEnabled:v({get:()=>l.getters["event/getMaxExtraPeopleEnabled"],set:T=>{l.commit("event/setMaxExtraPeopleEnabled",T)}}),maxExtraPeople:v({get:()=>l.getters["event/getMaxExtraPeople"],set:T=>{l.commit("event/setMaxExtraPeople",T)}})});a({pricingFormRef:$});let S=R("amColors"),E=v(()=>({"--am-c-capei-price-text":S.value.colorMainText,"--am-c-capei-price-text-op03":H(S.value.colorMainText,.03),"--am-c-capei-price-inp-bgr-op03":H(S.value.colorInpBgr,.03)}));return(T,w)=>{const B=yt,z=et;return c(),U(z,{ref_key:"pricingFormRef",ref:$,model:t(h),style:Ce(t(E)),class:"am-capei-price"},{default:x(()=>[m("div",Ob,[A(B,{label:`${t(i).price}:`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[A(it,{modelValue:t(h).price,"onUpdate:modelValue":w[0]||(w[0]=N=>t(h).price=N),disabled:t(h).customPricing,"is-money":!0},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),A(B,{label:`${t(i).event_max_capacity}:`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[A(ht,{modelValue:t(h).maxCapacity,"onUpdate:modelValue":w[1]||(w[1]=N=>t(h).maxCapacity=N),disabled:t(h).customPricing,min:1},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),t(_)?(c(),y("div",Fb,[A(mt,{modelValue:t(h).bringingAnyone,"onUpdate:modelValue":w[2]||(w[2]=N=>t(h).bringingAnyone=N),label:t(i).event_bringing_anyone},null,8,["modelValue","label"]),t(h).bringingAnyone?(c(),U(mt,{key:0,modelValue:t(h).aggregatedPrice,"onUpdate:modelValue":w[3]||(w[3]=N=>t(h).aggregatedPrice=N),label:t(i).event_aggregated_price},null,8,["modelValue","label"])):D("",!0),A(mt,{modelValue:t(h).bookMultipleTimes,"onUpdate:modelValue":w[4]||(w[4]=N=>t(h).bookMultipleTimes=N),label:t(i).event_book_more_than_once},null,8,["modelValue","label"])])):D("",!0)]),t(r).isStarter?D("",!0):(c(),y("div",Mb,[m("div",Vb,[m("div",Bb,k(t(i).deposit_enabled),1),A(lt,{modelValue:t(h).depositEnabled,"onUpdate:modelValue":w[5]||(w[5]=N=>t(h).depositEnabled=N),"aria-label":t(i).deposit_enabled},null,8,["modelValue","aria-label"])]),t(h).depositEnabled?(c(),y(ee,{key:0},[A(B,{label:`${t(i).deposit_payment}:`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[A(He,{modelValue:t(h).depositPayment,"onUpdate:modelValue":w[6]||(w[6]=N=>t(h).depositPayment=N)},{default:x(()=>[A(qe,{value:"percentage",label:t(i).amount_percentage},null,8,["label"]),A(qe,{value:"fixed",label:t(i).amount_fixed},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label","class"]),t(h).depositPayment==="fixed"?(c(),U(B,{key:0,label:`${t(i).amount} (${t(lc)()}):`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[A(it,{modelValue:t(h).deposit,"onUpdate:modelValue":w[7]||(w[7]=N=>t(h).deposit=N),"is-money":!0},null,8,["modelValue"])]),_:1},8,["label","class"])):D("",!0),t(h).depositPayment==="percentage"?(c(),U(B,{key:1,label:`${t(i).amount} (%):`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[A(ht,{modelValue:t(h).deposit,"onUpdate:modelValue":w[8]||(w[8]=N=>t(h).deposit=N),min:1,max:100},null,8,["modelValue"])]),_:1},8,["label","class"])):D("",!0)],64)):D("",!0),t(h).depositEnabled?(c(),y("div",Rb,[A(mt,{modelValue:t(h).depositPerPerson,"onUpdate:modelValue":w[9]||(w[9]=N=>t(h).depositPerPerson=N),label:t(i).deposit_per_person},null,8,["modelValue","label"]),A(mt,{modelValue:t(h).fullPayment,"onUpdate:modelValue":w[10]||(w[10]=N=>t(h).fullPayment=N),label:t(i).allow_total_event_amount},null,8,["modelValue","label"])])):D("",!0)])),t(r).isStarter?D("",!0):(c(),y("div",qb,[m("div",Ub,[m("div",zb,k(t(i).custom_pricing_enabled),1),A(lt,{modelValue:t(h).customPricing,"onUpdate:modelValue":w[11]||(w[11]=N=>t(h).customPricing=N),disabled:t(f).bookings&&t(f).bookings.length>0,"aria-label":t(i).custom_pricing_enabled,onChange:O},null,8,["modelValue","disabled","aria-label"])]),t(h).customPricing?(c(),y(ee,{key:0},[e.pageWidth>545?(c(),y("div",jb,[m("div",Yb,k(t(i).name)+": ",1),m("div",Wb,k(t(i).price)+": ",1),m("div",Hb,k(t(i).spots)+": ",1)])):D("",!0),(c(!0),y(ee,null,fe(t(h).customTickets,(N,G)=>(c(),y("div",{key:G,class:"am-capei-price__block-segment am-custom-76"},[m("div",{class:q(["am-capei-price__block-inner am-ws-16",{"am-mt-22":e.pageWidth<546}])},[A(B,null,{default:x(()=>[A(mt,{modelValue:N.enabled,"onUpdate:modelValue":se=>N.enabled=se},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-we-40":e.pageWidth>545},{"am-we-100":e.pageWidth<546}]])},[A(B,{label:e.pageWidth<546?`${t(i).name}:`:""},{default:x(()=>[A(it,{modelValue:N.name,"onUpdate:modelValue":se=>N.name=se,disabled:!N.enabled,"aria-label":t(i).name},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-we-30":e.pageWidth>545},{"am-w-50 am-order-2":e.pageWidth<546},{"am-w-100":e.pageWidth<401}]])},[A(B,{label:e.pageWidth<546?t(i).price:""},{default:x(()=>[A(it,{modelValue:N.price,"onUpdate:modelValue":se=>N.price=se,disabled:!N.enabled,"is-money":!0,"aria-label":t(i).price},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-we-30":e.pageWidth>545},{"am-w-50 am-order-3":e.pageWidth<546},{"am-w-100":e.pageWidth<401}]])},[A(B,{label:e.pageWidth<546?`${t(i).spots}:`:""},{default:x(()=>[A(ht,{modelValue:N.spots,"onUpdate:modelValue":se=>N.spots=se,min:1,disabled:!N.enabled||t(h).maxCustomCapacityEnabled,"aria-label":t(i).spots},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),!N.booked&&t(h).customTickets.length>1?(c(),y("div",{key:0,class:q(["am-capei-price__block-delete",{"am-order-1 am-mt-22":e.pageWidth<546}])},[A(Ee,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:We},template:"<IconComponent icon='bucket'/>"},onClick:se=>I(G)},null,8,["icon","onClick"])],2)):D("",!0),e.pageWidth<546?(c(),y("div",Zb)):D("",!0)]))),128)),A(Ee,{icon:t(u),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:b},{default:x(()=>[ce(k(t(i).add_ticket_category),1)]),_:1},8,["icon"]),Gb,m("div",Jb,[m("div",{class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},[A(mt,{modelValue:t(h).maxCustomCapacityEnabled,"onUpdate:modelValue":w[12]||(w[12]=N=>t(h).maxCustomCapacityEnabled=N),label:`${t(i).event_max_capacity}:`},null,8,["modelValue","label"])],2),m("div",{class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},[A(ht,{modelValue:t(h).maxCustomCapacity,"onUpdate:modelValue":w[13]||(w[13]=N=>t(h).maxCustomCapacity=N),min:1,disabled:!t(h).maxCustomCapacityEnabled},null,8,["modelValue","disabled"])],2)]),Xb,m("div",Qb,[m("div",Kb,k(t(i).pricing_by_date_enabled),1),A(lt,{modelValue:t(h).customTicketsRangesEnabled,"onUpdate:modelValue":w[14]||(w[14]=N=>t(h).customTicketsRangesEnabled=N),"aria-label":t(i).pricing_by_date_enabled},null,8,["modelValue","aria-label"])]),t(h).customTicketsRangesEnabled?(c(),y("div",e1,[(c(!0),y(ee,null,fe(t(h).customTicketsRanges,(N,G)=>(c(),y(ee,{key:G},[A(B,{label:`${t(i).event_date_range}:`,class:"am-capei-price__date-range"},{default:x(()=>[A(Yt,{modelValue:N.range,"onUpdate:modelValue":se=>N.range=se,type:"daterange",format:t(jt)(),placeholder:"Pick a day",lang:t(o),"disabled-date":d,"start-placeholder":t(i).start_date,"end-placeholder":t(i).end_date},null,8,["modelValue","onUpdate:modelValue","format","lang","start-placeholder","end-placeholder"]),A(Ee,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:We},template:"<IconComponent icon='bucket'/>"},"aria-label":t(i).delete,onClick:se=>P(G)},null,8,["icon","aria-label","onClick"])]),_:2},1032,["label"]),e.pageWidth>545?(c(),y("div",t1,[m("div",a1,k(t(i).name)+": ",1),m("div",s1,k(t(i).price)+": ",1)])):D("",!0),(c(!0),y(ee,null,fe(t(h).customTickets,(se,j)=>(c(),y(ee,{key:j},[m("div",{class:q(["am-capei-price__block-inner",[{"am-w-50":e.pageWidth>545},{"am-w-100":e.pageWidth<546}]])},[A(B,{label:e.pageWidth<546?`${t(i).name}:`:""},{default:x(()=>[A(it,{modelValue:se.name,"onUpdate:modelValue":ne=>se.name=ne,disabled:!0,"aria-label":t(i).name},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),_:2},1032,["label"])],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-w-50":e.pageWidth>545},{"am-w-100":e.pageWidth<546}]])},[A(B,{label:e.pageWidth<546?`${t(i).price}:`:""},{default:x(()=>[A(it,{modelValue:N.tickets[j].price,"onUpdate:modelValue":ne=>N.tickets[j].price=ne,"is-money":!0,"aria-label":t(i).price},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),_:2},1032,["label"])],2)],64))),128)),l1],64))),128)),A(Ee,{icon:t(u),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:L},{default:x(()=>[ce(k(t(i).event_add_date_range),1)]),_:1},8,["icon"])])):D("",!0)],64)):D("",!0)])),t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1?(c(),y("div",n1,[m("div",i1,[m("div",o1,k(t(i).event_close_after_min),1),A(lt,{modelValue:t(h).closeAfterMinEnabled,"onUpdate:modelValue":w[15]||(w[15]=N=>t(h).closeAfterMinEnabled=N),"aria-label":t(i).event_close_after_min},null,8,["modelValue","aria-label"])]),t(h).closeAfterMinEnabled&&(t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1)?(c(),y("div",r1,[A(Vl,{modelValue:t(h).closeAfterMinBookings,"onUpdate:modelValue":w[16]||(w[16]=N=>t(h).closeAfterMinBookings=N),class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},{default:x(()=>[A(Pa,{value:!1},{default:x(()=>[ce(k(t(i).event_close_min_total),1)]),_:1}),A(Pa,{value:!0},{default:x(()=>[ce(k(t(i).event_close_min_bookings),1)]),_:1})]),_:1},8,["modelValue","class"]),A(B,{class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},{default:x(()=>[A(ht,{modelValue:t(h).closeAfterMin,"onUpdate:modelValue":w[17]||(w[17]=N=>t(h).closeAfterMin=N),min:1,max:t(C)},null,8,["modelValue","max"])]),_:1},8,["class"])])):D("",!0)])):D("",!0),t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1?(c(),y("div",c1,[m("div",u1,[m("div",d1,k(t(i).limit_extra_people),1),A(lt,{modelValue:t(h).maxExtraPeopleEnabled,"onUpdate:modelValue":w[18]||(w[18]=N=>t(h).maxExtraPeopleEnabled=N),"aria-label":t(i).limit_extra_people},null,8,["modelValue","aria-label"])]),t(h).maxExtraPeopleEnabled&&(t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1)?(c(),y("div",m1,[A(B,{label:`${t(i).limit_extra_people_set}:`,class:"am-capei-price__part-item am-w-100"},{default:x(()=>[A(ht,{modelValue:t(h).maxExtraPeople,"onUpdate:modelValue":w[19]||(w[19]=N=>t(h).maxExtraPeople=N),min:0,max:t(C)-1},null,8,["modelValue","max"])]),_:1},8,["label"])])):D("",!0)])):D("",!0)]),_:1},8,["model","style"])}}};const g1={class:"am-capei-custef__heading"},f1={class:"am-capei-custef__colors"},h1=["onClick"],v1={key:0,class:"am-icon-check"},_1={setup(n){let a=Ne(),e=R("amLabels");const s=M(null);let l=M(1),i=M(["#1788FB","#4BBEC6","#FBC22D","#FA3C52","#D696B8","#689BCA","#26CC2B","#FD7E35","#E38587","#774DFB"]),o=M({color:v({get:()=>a.getters["event/getColor"],set:r=>{a.commit("event/setColor",r)}}),show:v({get:()=>a.getters["event/getShow"],set:r=>{a.commit("event/setShow",r)}})});return Je(()=>{let r=a.getters["event/getColor"];i.value.filter(d=>d===r).length>0?l.value=1:l.value=2}),(r,u)=>{const d=yt,f=nc,_=et;return c(),U(_,{ref_key:"customizeFormRef",ref:s,model:t(o),class:"am-capei-custef"},{default:x(()=>[m("div",g1,k(t(e).event_colors),1),A(Vl,{modelValue:t(l),"onUpdate:modelValue":u[2]||(u[2]=g=>we(l)?l.value=g:l=g)},{default:x(()=>[A(d,{class:"am-capei-custef__item"},{default:x(()=>[A(Pa,{value:1},{default:x(()=>[ce(k(t(e).event_colors_preset)+": ",1)]),_:1}),m("div",f1,[(c(!0),y(ee,null,fe(t(i),g=>(c(),y("div",{key:g,class:q(["am-capei-custef__colors-item",{"am-disabled":t(l)===2}]),onClick:C=>t(a).commit("event/setColor",g)},[m("div",{class:"am-capei-custef__colors-item__inner",style:Ce({backgroundColor:g})},[g===t(o).color?(c(),y("span",v1)):D("",!0)],4)],10,h1))),128))])]),_:1}),A(d,{class:"am-capei-custef__item"},{default:x(()=>[A(Pa,{value:2},{default:x(()=>[ce(k(t(e).event_colors_custom)+": ",1)]),_:1}),A(f,{modelValue:t(o).color,"onUpdate:modelValue":u[0]||(u[0]=g=>t(o).color=g),disabled:t(l)===1,"aria-label":t(e).event_colors_custom},null,8,["modelValue","disabled","aria-label"])]),_:1}),A(d,{class:"am-capei-custef__item"},{default:x(()=>[A(mt,{modelValue:t(o).show,"onUpdate:modelValue":u[1]||(u[1]=g=>t(o).show=g),label:t(e).event_show_on_site},null,8,["modelValue","label"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])}}};const y1={class:"am-capei-waiting__header"},b1={class:"am-capei-waiting__header-text"},k1={class:"am-capei-waiting__header"},C1={class:"am-capei-waiting__header-text"},x1={props:{pageWidth:{type:Number,default:0},waitingListUntil:{type:Object,default:null}},setup(n,{expose:a}){const e=n;let s=v(()=>st(e.pageWidth));const l=Ne();let i=R("amLabels"),o=M(null),r=M({enabled:v({get:()=>l.getters["event/getWaitingListEnabled"],set:C=>{l.commit("event/setWaitingListEnabled",C)}}),maxCapacity:v({get:()=>l.getters["event/getWaitingListMaxCapacity"],set:C=>{l.commit("event/setWaitingListMaxCapacity",C)}}),maxExtraPeopleEnabled:v({get:()=>l.getters["event/getWaitingListMaxExtraPeopleEnabled"],set:C=>{l.commit("event/setWaitingListMaxExtraPeopleEnabled",C)}}),maxExtraPeople:v({get:()=>l.getters["event/getWaitingListMaxExtraPeople"],set:C=>{l.commit("event/setWaitingListMaxExtraPeople",C)}})}),u=v(()=>l.getters["event/getCustomTickets"]),d=v(()=>l.getters["event/getCustomPricing"]),f=v(()=>l.getters["event/getMaxCustomCapacityEnabled"]);a({waitingListFormRef:o});let _=R("amColors"),g=v(()=>({"--am-c-capei-waiting-text":_.value.colorMainText,"--am-c-capei-waiting-text-op03":H(_.value.colorMainText,.03),"--am-c-capei-waiting-inp-bgr-op03":H(_.value.colorInpBgr,.03),"--am-c-capei-waiting-bgr-op05":H(_.value.colorPrimary,.05)}));return(C,O)=>{const I=yt,b=et;return c(),y("div",{class:"am-capei-waiting",style:Ce(t(g))},[m("div",y1,[m("div",b1,k(t(i).events_show_waiting_list_booking_full),1),A(lt,{modelValue:t(r).enabled,"onUpdate:modelValue":O[0]||(O[0]=P=>t(r).enabled=P),"aria-label":t(i).events_show_waiting_list_booking_full},null,8,["modelValue","aria-label"])]),t(r).enabled?(c(),U(b,{key:0,ref_key:"waitingListFormRef",ref:o,model:t(r),"label-position":"top"},{default:x(()=>[!t(d)||t(f)?(c(),U(I,{key:0,label:`${t(i).maximum_capacity}`,class:q(["am-capei-waiting__item",t(s)])},{default:x(()=>[A(ht,{modelValue:t(r).maxCapacity,"onUpdate:modelValue":O[1]||(O[1]=P=>t(r).maxCapacity=P),min:1},null,8,["modelValue"])]),_:1},8,["label","class"])):D("",!0),t(d)?(c(!0),y(ee,{key:1},fe(t(u),(P,L)=>(c(),U(I,{key:L,label:P.name,class:q(["am-capei-waiting__item",t(s)])},{default:x(()=>[A(ht,{modelValue:P.waitingListSpots,"onUpdate:modelValue":$=>P.waitingListSpots=$,min:1,disabled:t(f)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128)):D("",!0),m("div",k1,[m("div",C1,k(t(i).limit_extra_people),1),A(lt,{modelValue:t(r).maxExtraPeopleEnabled,"onUpdate:modelValue":O[2]||(O[2]=P=>t(r).maxExtraPeopleEnabled=P),"aria-label":t(i).limit_extra_people},null,8,["modelValue","aria-label"])]),t(r).maxExtraPeopleEnabled?(c(),U(I,{key:2,class:q(t(s))},{default:x(()=>[A(ht,{modelValue:t(r).maxExtraPeople,"onUpdate:modelValue":O[3]||(O[3]=P=>t(r).maxExtraPeople=P),min:0,disabled:!t(r).maxExtraPeopleEnabled},null,8,["modelValue","disabled"])]),_:1},8,["class"])):D("",!0)]),_:1},8,["model"])):D("",!0)],4)}}};const w1={class:"am-capei-sef__header"},T1=m("span",{class:"am-icon-options"},null,-1),E1={class:"am-capei-sef__header-text"},L1={class:"am-capei-sef__content"},S1=["innerHTML"],A1=["innerHTML"],I1={class:"am-capei-sef__header"},P1=m("span",{class:"am-icon-payments"},null,-1),$1={class:"am-capei-sef__header-text"},N1={class:"am-capei-sef__content"},D1={class:"am-capei-sef__segment"},O1={key:0,class:"am-capei-sef__heading"},F1={class:"am-capei-sef__heading-text"},M1=["innerHTML"],V1=["innerHTML"],B1={key:0,class:"am-capei-sef__heading"},R1={class:"am-capei-sef__heading-text"},q1={class:"am-capei-sef__segment"},U1={key:0,class:"am-capei-sef__heading"},z1={class:"am-capei-sef__heading-text"},j1={key:1,class:"am-capei-sef__heading"},Y1=["src"],W1={key:2,class:"am-capei-sef__heading"},H1=["src"],Z1={key:3,class:"am-capei-sef__heading"},G1=["src"],J1={key:4,class:"am-capei-sef__heading"},X1=["src"],Q1={key:5,class:"am-capei-sef__heading"},K1=["src"],e0={class:"am-capei-sef__header"},t0=m("span",{class:"am-icon-options"},null,-1),a0={class:"am-capei-sef__header-text"},s0={key:0,class:"am-capei-sef__heading"},l0={class:"am-capei-sef__heading-text"},n0={key:1,class:"am-capei-sef__heading"},i0={class:"am-capei-sef__heading-text"},o0={key:2,class:"am-capei-sef__heading"},r0={class:"am-capei-sef__heading-text"},c0={setup(n){let a=Ne(),e=R("licence"),s=R("amLabels");const l=R("settings"),i=R("baseUrls");let o=M([{label:s.value.disabled,value:0},{label:s.value.min10,value:600},{label:s.value.min12,value:720},{label:s.value.min15,value:900},{label:s.value.min30,value:1800},{label:s.value.min45,value:2700},{label:s.value.h1,value:3600},{label:s.value.h1min30,value:5400},{label:s.value.h2,value:7200},{label:s.value.h3,value:10800},{label:s.value.h4,value:14400},{label:s.value.h6,value:21600},{label:s.value.h8,value:28800},{label:s.value.h9,value:32400},{label:s.value.h10,value:36e3},{label:s.value.h11,value:39600},{label:s.value.h12,value:43200},{label:s.value.day1,value:86400},{label:s.value.days2,value:172800},{label:s.value.days3,value:259200},{label:s.value.days4,value:345600},{label:s.value.days5,value:432e3},{label:s.value.days6,value:518400},{label:s.value.week1,value:604800},{label:s.value.weeks2,value:1209600},{label:s.value.weeks3,value:1814400},{label:s.value.weeks4,value:2419200},{label:s.value.months3,value:7884e3},{label:s.value.months6,value:15768e3}]),r=M([]),u=M(!1),d=M(0),f=M(null),_=v(()=>{if(r.value.length){let h=r.value.find(S=>S.id===l.payments.wc.productId);return typeof h<"u"?h.name:s.value.select}return""});function g(){l.payments.wc.enabled&&C({id:P.value.paymentsWcProductId},h=>{r.value=h.length?h:[]})}function C(h,S){clearTimeout(f.value),u.value=!0,d.value++,f.value=setTimeout(()=>{let E=d.value;De.get("/payment/wc/products",{params:h}).then(T=>{E>=d.value&&S(T.data.data.products.sort((w,B)=>w.name.toLowerCase()>B.name.toLowerCase()?1:-1))}).finally(()=>{u.value=!1})},500)}function O(h){h&&C({name:h},S=>{r.value=S})}let I=M("");const b=M(null);let P=M({generalMinimumTimeRequirementPriorToCanceling:v({get:()=>a.getters["event/getSettingsGeneralMinimumTimeRequirementPriorToCanceling"],set:h=>{a.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",h)}}),generalRedirectUrlAfterAppointment:v({get:()=>a.getters["event/getSettingsGeneralRedirectUrlAfterAppointment"],set:h=>{a.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",h)}}),paymentsPaymentLinksEnabled:v({get:()=>a.getters["event/getSettingsPaymentsPaymentLinksEnabled"],set:h=>{a.commit("event/setSettingsPaymentsPaymentLinksEnabled",h)}}),paymentsPaymentLinksRedirectUrl:v({get:()=>a.getters["event/getSettingsPaymentsPaymentLinksRedirectUrl"],set:h=>{a.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",h)}}),paymentsOnSite:v({get:()=>a.getters["event/getSettingsPaymentsOnSite"],set:h=>{a.commit("event/setSettingsPaymentsOnSite",h)}}),paymentsWcEnabled:v({get:()=>a.getters["event/getSettingsPaymentsWcEnabled"],set:h=>{a.commit("event/setSettingsPaymentsWcEnabled",h)}}),paymentsWcProductId:v({get:()=>a.getters["event/getSettingsPaymentsWcProductId"],set:h=>{a.commit("event/setSettingsPaymentsWcProductId",h)}}),paymentsStripeEnabled:v({get:()=>a.getters["event/getSettingsPaymentsStripeEnabled"],set:h=>{a.commit("event/setSettingsPaymentsStripeEnabled",h)}}),paymentsPayPalEnabled:v({get:()=>a.getters["event/getSettingsPaymentsPayPalEnabled"],set:h=>{a.commit("event/setSettingsPaymentsPayPalEnabled",h)}}),paymentsMollieEnabled:v({get:()=>a.getters["event/getSettingsPaymentsMollieEnabled"],set:h=>{a.commit("event/setSettingsPaymentsMollieEnabled",h)}}),paymentsRazorpayEnabled:v({get:()=>a.getters["event/getSettingsPaymentsRazorpayEnabled"],set:h=>{a.commit("event/setSettingsPaymentsRazorpayEnabled",h)}}),paymentsSquareEnabled:v({get:()=>a.getters["event/getSettingsPaymentsSquareEnabled"],set:h=>{a.commit("event/setSettingsPaymentsSquareEnabled",h)}}),integrationsGoogleMeetEnabled:v({get:()=>a.getters["event/getSettingsIntegrationsGoogleMeetEnabled"],set:h=>{a.commit("event/setSettingsIntegrationsGoogleMeetEnabled",h)}}),integrationsMicrosoftTeamsEnabled:v({get:()=>a.getters["event/getSettingsIntegrationsMicrosoftTeamsEnabled"],set:h=>{a.commit("event/setSettingsIntegrationsMicrosoftTeamsEnabled",h)}}),integrationsLessonSpaceEnabled:v({get:()=>a.getters["event/getSettingsIntegrationsLessonSpaceEnabled"],set:h=>{a.commit("event/setSettingsIntegrationsLessonSpaceEnabled",h)}})});Je(()=>{P.value.generalMinimumTimeRequirementPriorToCanceling===l.general.minimumTimeRequirementPriorToCanceling&&a.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",""),P.value.generalRedirectUrlAfterAppointment===l.general.redirectUrlAfterAppointment&&a.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",""),P.value.paymentsPaymentLinksRedirectUrl===l.payments.paymentLinks.redirectUrl&&a.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",""),g()});let L=R("amColors"),$=v(()=>({"--am-c-capei-sef-primary":L.value.colorPrimary,"--am-c-capei-sef-text":L.value.colorMainText,"--am-c-capei-sef-text-op03":H(L.value.colorMainText,.03),"--am-c-capei-sef-bgr":L.value.colorMainBgr}));return(h,S)=>{const E=Ml,T=yt,w=bs,B=ks,z=et;return c(),U(z,{ref_key:"settingsFormRef",ref:b,model:t(P),class:"am-capei-sef",style:Ce(t($))},{default:x(()=>[A(B,{modelValue:t(I),"onUpdate:modelValue":S[15]||(S[15]=N=>we(I)?I.value=N:I=N),accordion:"",class:"am-capei-sef__collapse"},{default:x(()=>[A(w,{name:"general",class:"am-capei-sef__collapse-item"},{title:x(()=>[m("div",w1,[T1,m("div",E1,k(t(s).general),1)])]),default:x(()=>[m("div",L1,[A(T,null,{label:x(()=>[ce(k(t(s).minimum_time_before_canceling)+" ",1),A(E,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).minimum_time_before_canceling_tooltip},null,8,S1)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:x(()=>[A(He,{modelValue:t(P).generalMinimumTimeRequirementPriorToCanceling,"onUpdate:modelValue":S[0]||(S[0]=N=>t(P).generalMinimumTimeRequirementPriorToCanceling=N),placeholder:t(o).find(N=>N.value===t(l).general.minimumTimeRequirementPriorToCanceling).label,clearable:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(o),(N,G)=>(c(),U(qe,{key:G,value:N.value,label:N.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),A(T,null,{label:x(()=>[ce(k(t(s).redirect_url_after_appointment)+" ",1),A(E,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).redirect_url_after_appointment_tooltip},null,8,A1)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:x(()=>[A(it,{modelValue:t(P).generalRedirectUrlAfterAppointment,"onUpdate:modelValue":S[1]||(S[1]=N=>t(P).generalRedirectUrlAfterAppointment=N),placeholder:t(l).general.redirectUrlAfterAppointment},null,8,["modelValue","placeholder"])]),_:1})])]),_:1}),A(w,{name:"payment",class:"am-capei-sef__collapse-item"},{title:x(()=>[m("div",I1,[P1,m("div",$1,k(t(s).payments),1)])]),default:x(()=>[m("div",N1,[m("div",D1,[t(e).isStarter?D("",!0):(c(),y("div",O1,[m("div",F1,[ce(k(t(s).payment_links_enable)+" ",1),A(E,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).payment_links_enable_tooltip},null,8,M1)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),A(lt,{modelValue:t(P).paymentsPaymentLinksEnabled,"onUpdate:modelValue":S[2]||(S[2]=N=>t(P).paymentsPaymentLinksEnabled=N)},null,8,["modelValue"])])),t(P).paymentsPaymentLinksEnabled&&!t(e).isStarter?(c(),U(T,{key:1,label:t(s).redirect_url_after_appointment},{label:x(()=>[ce(k(t(s).redirect_url_after_appointment)+" ",1),A(E,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(e).isPro||t(e).isDeveloper?t(s).redirect_url_after_app_or_package_tt:t(s).redirect_url_after_appointment_tooltip},null,8,V1)]),default:x(()=>[A(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:x(()=>[A(it,{modelValue:t(P).paymentsPaymentLinksRedirectUrl,"onUpdate:modelValue":S[3]||(S[3]=N=>t(P).paymentsPaymentLinksRedirectUrl=N),placeholder:t(l).payments.paymentLinks.redirectUrl},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0)]),t(l).payments.onSite?(c(),y("div",B1,[m("div",R1,k(t(s).on_site),1),A(lt,{modelValue:t(P).paymentsOnSite,"onUpdate:modelValue":S[4]||(S[4]=N=>t(P).paymentsOnSite=N)},null,8,["modelValue"])])):D("",!0),m("div",q1,[t(l).payments.wc.enabled?(c(),y("div",U1,[m("div",z1,k(t(s).wc_service),1),A(lt,{modelValue:t(P).paymentsWcEnabled,"onUpdate:modelValue":S[5]||(S[5]=N=>t(P).paymentsWcEnabled=N)},null,8,["modelValue"])])):D("",!0),t(P).paymentsWcEnabled?(c(),U(T,{key:1},{default:x(()=>[A(He,{modelValue:t(P).paymentsWcProductId,"onUpdate:modelValue":S[6]||(S[6]=N=>t(P).paymentsWcProductId=N),clearable:"",filterable:"",remote:"",placeholder:t(_),loading:t(u),"remote-method":O},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),(N,G)=>(c(),U(qe,{key:G,value:N.id,label:N.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","loading"])]),_:1})):D("",!0)]),t(l).payments.payPal.enabled?(c(),y("div",j1,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/paypal-light.svg",alt:"PayPal"},null,8,Y1),A(lt,{modelValue:t(P).paymentsPayPalEnabled,"onUpdate:modelValue":S[7]||(S[7]=N=>t(P).paymentsPayPalEnabled=N)},null,8,["modelValue"])])):D("",!0),t(l).payments.stripe.enabled?(c(),y("div",W1,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/stripe.svg",alt:"Stripe"},null,8,H1),A(lt,{modelValue:t(P).paymentsStripeEnabled,"onUpdate:modelValue":S[8]||(S[8]=N=>t(P).paymentsStripeEnabled=N)},null,8,["modelValue"])])):D("",!0),t(l).payments.mollie.enabled?(c(),y("div",Z1,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/mollie.svg",alt:"Mollie"},null,8,G1),A(lt,{modelValue:t(P).paymentsMollieEnabled,"onUpdate:modelValue":S[9]||(S[9]=N=>t(P).paymentsMollieEnabled=N)},null,8,["modelValue"])])):D("",!0),t(l).payments.square.enabled?(c(),y("div",J1,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/square.svg",alt:"Square"},null,8,X1),A(lt,{modelValue:t(P).paymentsSquareEnabled,"onUpdate:modelValue":S[10]||(S[10]=N=>t(P).paymentsSquareEnabled=N)},null,8,["modelValue"])])):D("",!0),t(l).payments.razorpay.enabled?(c(),y("div",Q1,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/razorpay.svg",alt:"Razorpay"},null,8,K1),A(lt,{modelValue:t(P).paymentsRazorpayEnabled,"onUpdate:modelValue":S[11]||(S[11]=N=>t(P).paymentsRazorpayEnabled=N)},null,8,["modelValue"])])):D("",!0)])]),_:1}),t(l).googleCalendar.enabled&&t(l).googleMeet.enabled||t(l).outlookCalendar.enabled&&t(l).microsoftTeams.enabled||t(l).lessonSpace.enabled?(c(),U(w,{key:0,name:"integrations",class:"am-capei-sef__collapse-item"},{title:x(()=>[m("div",e0,[t0,m("div",a0,k(t(s).integrations_settings),1)])]),default:x(()=>[t(l).googleCalendar.enabled&&t(l).googleMeet.enabled?(c(),y("div",s0,[m("div",l0,k(t(s).enable_google_meet),1),A(lt,{modelValue:t(P).integrationsGoogleMeetEnabled,"onUpdate:modelValue":S[12]||(S[12]=N=>t(P).integrationsGoogleMeetEnabled=N)},null,8,["modelValue"])])):D("",!0),t(l).outlookCalendar.enabled&&t(l).microsoftTeams.enabled?(c(),y("div",n0,[m("div",i0,k(t(s).enable_microsoft_teams),1),A(lt,{modelValue:t(P).integrationsMicrosoftTeamsEnabled,"onUpdate:modelValue":S[13]||(S[13]=N=>t(P).integrationsMicrosoftTeamsEnabled=N)},null,8,["modelValue"])])):D("",!0),t(l).lessonSpace.enabled?(c(),y("div",o0,[m("div",r0,k(t(s).lesson_space),1),A(lt,{modelValue:t(P).integrationsLessonSpaceEnabled,"onUpdate:modelValue":S[14]||(S[14]=N=>t(P).integrationsLessonSpaceEnabled=N)},null,8,["modelValue"])])):D("",!0)]),_:1})):D("",!0)]),_:1},8,["modelValue"])]),_:1},8,["model","style"])}}};const u0={class:"am-capei__footer-actions"},d0={name:"CabinetEvent"},m0=Object.assign(d0,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["close","save","duplicate"],setup(n,{emit:a}){const e=n;let s=Ne(),l=R("amLabels");const i=R("settings");let o=R("licence");const r=M("details");let u=M(null),d=M(null),f=M(null),_=M(null),g=M(null),C=M(!0),O=M(!1),I=M(!1);function b(){a("duplicate",Object.assign(JSON.parse(JSON.stringify(s.getters["event/getEvent"])),{id:null,bookings:[]}))}async function P(){let w=!0;await new Promise(B=>{u.value?.detailsFormRef.validate(z=>{z||(r.value="details",w=!1),B()})}),w&&(await new Promise(B=>{d.value?.periodsFormRef.validate(z=>{z||(r.value="periods",w=!1),B()})}),w&&(s.getters["event/getRecurringEnabled"]&&(await new Promise(B=>{f.value?.recurringFormRef.validate(z=>{z||(r.value="recurring",w=!1),B()})}),!w)||h(B=>{B?I.value=!0:$()})))}function L(w){C.value=!0,De.post("/events"+(s.getters["event/getId"]?"/"+s.getters["event/getId"]:""),Object.assign(kb(s),{applyGlobally:w}),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{yb(s),S("save")}).catch(B=>{console.log(B)}).finally(()=>{C.value=!1})}function $(){g.value?(C.value=!1,I.value=!1,O.value=!0):L(!1)}function h(w){let B=s.getters["event/getOrganizerId"]?s.getters["employee/getEmployee"]:null;if(B&&(B.googleCalendar||B.outlookCalendar)){C.value=!0;let z=s.getters["event/getProviders"].map(N=>new Object({id:N.id}));De.post("/events/calendar",{providers:s.getters["event/getProviders"].map(N=>N.id).indexOf(B.id)===-1?z.concat([{id:B.id}]):z,periods:Er(s),eventIds:[s.getters["event/getId"],s.getters["event/getParentId"]],recurring:s.getters["event/getRecurring"]},Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{w(!1)}).catch(()=>{w(!0),C.value=!1})}else w(!1)}function S(w){s.commit("event/setActive",!1),a(w)}Je(()=>{s.getters["event/getId"]&&s.getters["event/getRecurringUntil"]&&(g.value=Ke(s.getters["event/getRecurringUntil"].toISOString().split("T")[0])),s.commit("event/setActive",!0),C.value=!1});let E=R("amColors"),T=v(()=>({"--am-c-capei-text":E.value.colorMainText,"--am-c-capei-text-op10":H(E.value.colorMainText,.1),"--am-c-capei-primary":E.value.colorPrimary,"--am-c-cust-no1":E.value.colorMainText,"--am-c-cust-no1-bgr":H(E.value.colorMainText,.1),"--am-c-cust-no2":E.value.colorWarning,"--am-c-cust-no2-bgr":H(E.value.colorWarning,.1),"--am-c-cust-no3":E.value.colorError,"--am-c-cust-no3-bgr":H(E.value.colorError,.1),"--am-c-cust-link":H(E.value.colorMainText,.5),"--am-c-cust-text":E.value.colorMainText}));return(w,B)=>{const z=va,N=_a;return c(),y(ee,null,[t(C)?(c(),U(Wt,{key:1})):(c(),y("div",{key:0,class:q(["am-capei",t(e).responsiveClass]),style:Ce(t(T))},[A(N,{modelValue:r.value,"onUpdate:modelValue":B[0]||(B[0]=G=>r.value=G),class:"am-ap__tabs"},{default:x(()=>[A(z,{label:t(l).details,name:"details"},{default:x(()=>[A(wb,{ref_key:"eventDetailsRef",ref:u},null,512)]),_:1},8,["label"]),A(z,{label:t(l).periods,name:"periods"},{default:x(()=>[A(Pb,{ref_key:"eventPeriodsRef",ref:d,"page-width":t(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),t(o).isStarter?D("",!0):(c(),U(z,{key:0,label:t(l).recurring,name:"recurring"},{default:x(()=>[A(Db,{ref_key:"eventRecurringRef",ref:f,"page-width":t(e).pageWidth,"recurring-until":t(g)},null,8,["page-width","recurring-until"])]),_:1},8,["label"])),A(z,{label:t(l).pricing,name:"pricing"},{default:x(()=>[A(p1,{ref_key:"eventPricingRef",ref:_,"page-width":t(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),A(z,{label:t(l).customize,name:"customize"},{default:x(()=>[A(_1)]),_:1},8,["label"]),t(i).appointments.waitingListEvents.enabled&&!t(o).isStarter&&!t(o).isBasic?(c(),U(z,{key:1,label:t(l).waiting_list,name:"waitingList"},{default:x(()=>[A(x1,{"page-width":t(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"])):D("",!0),A(z,{label:t(l).settings,name:"settings"},{default:x(()=>[A(c0)]),_:1},8,["label"])]),_:1},8,["modelValue"]),m("div",{class:q(["am-capei__footer",[{"am-capei__footer_new":!t(s).getters["event/getId"]},t(e).responsiveClass]])},[t(s).getters["event/getId"]?(c(),U(Ee,{key:0,class:"am-capei__footer-duplicate","icon-only":!0,icon:"duplicate",type:"plain",category:"secondary",onClick:b})):D("",!0),m("div",u0,[A(Ee,{category:"secondary",size:"default",type:"plain",onClick:B[1]||(B[1]=()=>{t(a)("close")})},{default:x(()=>[ce(k(t(l).cancel),1)]),_:1}),A(Ee,{size:"default",onClick:P},{default:x(()=>[ce(k(t(l).save),1)]),_:1})])],2)],6)),A(Ua,{visibility:t(O)&&t(g)!==null,title:t(l).confirm,description:t(l).confirm_save_following,"close-btn-text":t(l).save_single,"confirm-btn-text":t(l).update_following,"customized-options":{cancelBtn:{type:"plain"},confirmBtn:{type:""}},onDecline:B[2]||(B[2]=G=>L(!1)),onConfirm:B[3]||(B[3]=G=>L(!0)),onClose:B[4]||(B[4]=G=>we(O)?O.value=!1:O=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),A(Ua,{visibility:t(I),title:t(l).confirm,description:t(l).confirm_save_conflict,"close-btn-text":t(l).cancel,"confirm-btn-text":t(l).confirm,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:B[5]||(B[5]=G=>we(I)?I.value=!1:I=!1),onConfirm:$,onClose:B[6]||(B[6]=G=>we(I)?I.value=!1:I=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],64)}}});const p0={class:"am-cap__att"},g0={class:"am-cap-customers"},f0={class:"am-cap__cust-option"},h0={class:"am-cap__cust-option__heading"},v0={key:0,class:"am-cap__cust-option__inner"},_0={key:1,class:"am-cap__cust-option__inner"},y0={key:0,class:"am-cap-cust__data-wrapper"},b0={key:0,class:"am-cap-cust__data"},k0=m("span",{class:"am-icon-phone"},null,-1),C0=["href"],x0={key:1,class:"am-cap-cust__data"},w0=m("span",{class:"am-icon-email"},null,-1),T0=["href"],E0={class:"am-cap__att-heading"},L0={props:{event:{type:Object,default:()=>{}},isNew:{type:Boolean,default:!1},pageWidth:{type:Number,required:!0}},setup(n,{expose:a}){const e=n;let s=v(()=>st(e.pageWidth)),l=Ne(),i=R("amLabels");const o=R("settings"),r=R("shortcodeData");let u=R("amCustomize"),d=v(()=>r.value.cabinetType==="employee"?u.value.events.options.customerPhone.visibility:!0),f=v(()=>r.value.cabinetType==="employee"?u.value.events.options.customerEmail.visibility:!0),_=M(null),g=M({customerId:v({get:()=>l.getters["attendee/getCustomerId"],set:z=>l.commit("attendee/setCustomerId",z)}),status:v({get:()=>l.getters["attendee/getStatus"],set:z=>l.commit("attendee/setStatus",z)}),persons:v({get:()=>l.getters["attendee/getPersons"],set:z=>l.commit("attendee/setPersons",z)}),tickets:v({get:()=>l.getters["attendee/getTickets"],set:z=>l.commit("attendee/setTickets",z)})}),C=M({customerId:[{required:!0,message:i.value.select_customer,trigger:["submit","change"]}]}),O=v(()=>e.event.settings?JSON.parse(e.event.settings):null),I=M(Sr().filter(z=>z.value!=="canceled"&&(!o.appointments.waitingListEvents.enabled||(O.value?"waitingList"in O.value&&!O.value.waitingList.enabled:!0)?z.value!=="waiting":!0)&&z.value!=="no-show")),b=v(()=>l.getters["customerInfo/getLoading"]),P=v(()=>l.getters["customerInfo/getCustomers"]),L=v(()=>g.value.customerId?P.value.find(z=>z.id===g.value.customerId):null);function $(z){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),h.value=!0,De.get("/users/customers/"+z,Object.assign({params:{source:"cabinet-provider"}},ze(l))).then(N=>{l.commit("customerInfo/setCustomer",Cr(l,N.data.data.user))}).catch(N=>{console.log(N)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}let h=M(!1);function S(){l.dispatch("customerInfo/resetCustomer"),h.value=!0}function E(z){l.commit("customerInfo/setCustomers",[z]),l.commit("attendee/setCustomerId",z.id)}Je(()=>{l.getters["attendee/getId"]||l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),a({detailsFormRef:_});function T(z){if(z){if(z===1)return{class:"am-no-show-1",icon:"no-show-1"};if(z===2)return{class:"am-no-show-2",icon:"no-show-2"};if(z>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}let w=R("amColors"),B=v(()=>({"--am-c-cust-no1":w.value.colorMainText,"--am-c-cust-no1-bgr":H(w.value.colorMainText,.1),"--am-c-cust-no2":w.value.colorWarning,"--am-c-cust-no2-bgr":H(w.value.colorWarning,.1),"--am-c-cust-no3":w.value.colorError,"--am-c-cust-no3-bgr":H(w.value.colorError,.1),"--am-c-cust-text":w.value.colorMainText,"--am-c-cust-link":H(w.value.colorMainText,.5)}));return(z,N)=>{const G=yt,se=et;return c(),y("div",p0,[A(se,{ref_key:"detailsFormRef",ref:_,model:t(g),rules:t(C),class:"am-cap__att-form"},{default:x(()=>[m("div",g0,[e.isNew?(c(),U(G,{key:0,prop:"customerId",class:"am-cap__att-form__item am-w-100"},{default:x(()=>[A(He,{modelValue:t(g).customerId,"onUpdate:modelValue":N[0]||(N[0]=j=>t(g).customerId=j),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-inp-text)","popper-class":"am-cap-cust__popper",placeholder:t(i).event_attendees_search,"remote-method":j=>{t(Hs)(t(l),j)},loading:t(b),onFocus:N[1]||(N[1]=j=>t(Si)(t(l)))},{default:x(()=>[(c(!0),y(ee,null,fe(t(P),j=>(c(),U(qe,{key:j.id,value:j.id,label:j.email?j.email:j.firstName+" "+j.lastName},{default:x(()=>[m("div",f0,[m("div",h0,k(j.firstName+" "+j.lastName),1),j.email&&t(f)?(c(),y("div",v0,k(j.email),1)):D("",!0),j.phone&&t(d)?(c(),y("div",_0,k(j.phone),1)):D("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})):D("",!0),!t(l).getters["attendee/getId"]&&t(o).roles.allowWriteCustomers?(c(),U(Ee,{key:1,class:q(["am-capai-cuf__heading-add",e.responsiveClass]),size:"default",disabled:!!t(g).customerId,prefix:"plus",icon:"plus","icon-only":e.pageWidth<=420,onClick:S},{default:x(()=>[ce(k(t(i).new_customer),1)]),_:1},8,["class","disabled","icon-only"])):D("",!0)]),t(L)?(c(),y("div",{key:0,class:q(["am-cap-attendee",t(s)])},[m("div",{class:q(["am-cap-cust",t(s)]),style:Ce(t(B))},[m("div",{class:q(["am-cap-cust__name",T(0).class])},[T(0).icon?(c(),y("span",{key:0,class:q(`am-icon-${T(0).icon}`)},null,2)):D("",!0),ce(" "+k(t(L).firstName+" "+t(L).lastName),1)],2),t(L).phone&&t(d)||t(L).email&&t(f)?(c(),y("div",y0,[t(L).phone&&t(d)?(c(),y("div",b0,[k0,m("a",{href:`tel:${t(L).phone}`},k(t(L).phone),9,C0)])):D("",!0),t(L).email&&t(f)?(c(),y("div",x0,[w0,m("a",{href:`mailto:${t(L).email}`},k(t(L).email),9,T0)])):D("",!0)])):D("",!0)],6),A(G,{prop:"status",class:q(["am-cap__att-form__item",t(s)])},{default:x(()=>[A(He,{modelValue:t(g).status,"onUpdate:modelValue":N[2]||(N[2]=j=>t(g).status=j),disabled:!e.isNew,placeholder:t(i).select,"prefix-icon":t(I).find(j=>j.value===t(g).status).icon,"prefix-icon-color":t(I).find(j=>j.value===t(g).status).color,"popper-class":"am-capei-att__popper"},{default:x(()=>[(c(!0),y(ee,null,fe(t(I),j=>(c(),U(qe,{key:j.value,value:j.value,label:j.label},{default:x(()=>[m("span",{class:q(`am-icon-${j.icon}`),style:Ce({color:j.color})},null,6),ce(" "+k(j.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder","prefix-icon","prefix-icon-color"])]),_:1},8,["class"]),t(o).roles.allowWriteCustomers?(c(),U(ha,{key:0,"have-delete":!1,"reference-class":t(s),onEdit:N[3]||(N[3]=j=>$(t(L).id))},null,8,["reference-class"])):D("",!0)],2)):D("",!0),t(L)?(c(),y(ee,{key:1},[e.event.customPricing?(c(),y(ee,{key:1},[m("div",E0,k(`${t(i).event_book_tickets}:`),1),(c(!0),y(ee,null,fe(t(g).tickets,(j,ne)=>(c(),U(G,{key:ne,label:e.event.customTickets.find(te=>te.id===j.eventTicketId).name,class:q(["am-cap__att-form__item",t(s)])},{default:x(()=>[A(ht,{modelValue:j.persons,"onUpdate:modelValue":te=>j.persons=te,min:0,disabled:!t(o).roles.allowWriteEvents},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128))],64)):(c(),U(G,{key:0,prop:"persons",label:`${t(i).event_book_persons}:`,class:q(["am-cap__att-form__item",t(s)])},{default:x(()=>[A(ht,{modelValue:t(g).persons,"onUpdate:modelValue":N[4]||(N[4]=j=>t(g).persons=j),min:1,disabled:!t(o).roles.allowWriteEvents},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]))],64)):D("",!0),t(L)?D("",!0):(c(),U(Ia,{key:2,heading:t(i).no_attendees_yet},null,8,["heading"]))]),_:1},8,["model","rules"]),t(h)?(c(),U(wr,{key:0,visibility:t(h),"responsive-class":e.responsiveClass,"onUpdate:visibility":N[5]||(N[5]=j=>we(h)?h.value=j:h=j),onAddedCustomer:E},null,8,["visibility","responsive-class"])):D("",!0)])}}};const S0={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n;let s=Ne();const l=R("settings");let i=R("amLabels"),o=M(null),r=M({}),u=M({}),d=M({}),f=v(()=>s.getters["attendee/getCustomFields"]);function _(O,I){let b=s.getters["attendee/getId"];(O.type!=="file"||b)&&(r.value[I]=v({get:()=>{let P=s.getters["attendee/getCustomFields"][I]?.value;return P||""},set:P=>s.commit("attendee/setCustomFields",{id:I,value:P})}))}function g(O,I){let b=s.getters["attendee/getId"];(O.type!=="file"||b)&&(d.value[I]={template:Ye[O.type],props:{id:I,itemName:I.toString(),label:O.label,options:O.options,class:`am-capei-att-cf__item am-cf-width-${O.width}`}}),(O.type==="checkbox"||O.type==="radio")&&(d.value[I].props.options=d.value[I].props.options.map(P=>({...P,value:P.label}))),O.type==="text-area"&&(d.value[I].props={...d.value[I].props,itemType:"textarea"}),O.type==="file"&&b&&(d.value[I].props={...d.value[I].props,btnLabel:i.value.upload_file_here,isUpload:!1,bookingId:b,source:"cabinet-provider"}),O.type==="datepicker"&&(d.value[I].props={...d.value[I].props,weekStartsFromDay:l.wordpress.startOfWeek})}function C(O){let I=s.getters["attendee/getId"];(O.type!=="file"||I)&&(u.value[O.id]=[{message:i.value.required_field,required:O.required,trigger:["submit","change"]}])}return Je(()=>{r.value={},d.value={};for(let O in f.value)_(f.value[O],O),g(f.value[O],O),C(f.value[O])}),a({customFieldsFormRef:o}),(O,I)=>{const b=et;return c(),U(b,{ref_key:"customFieldsFormRef",ref:o,model:t(r),rules:t(u),"label-position":"top",class:q(["am-capei-att-cf__form",e.responsiveClass])},{default:x(()=>[(c(!0),y(ee,null,fe(Object.keys(t(f)),P=>(c(),y(ee,{key:P},[P in t(r)?(c(),U(pt(t(d)[P].template),St({key:0,modelValue:t(r)[P],"onUpdate:modelValue":L=>t(r)[P]=L},t(d)[P].props),null,16,["modelValue","onUpdate:modelValue"])):D("",!0)],64))),128))]),_:1},8,["model","rules","class"])}}};const A0={class:"am-capai-pay__row-label"},I0={class:"am-capai-pay__row-value"},P0={class:"am-capai-pay__row-label"},$0={class:"am-capai-pay__row-value"},N0={class:"am-capai-pay__row-label"},D0={class:"am-capai-pay__row-value"},O0={key:0,class:"am-divider"},F0={class:"am-capai-pay__row-label"},M0={class:"am-capai-pay__row-label"},V0={class:"am-capai-pay__row-label"},B0={class:"am-capai-pay__row-label"},R0={class:"am-capai-pay__row-label"},q0={class:"am-capai-pay__row-label"},U0={class:"am-capai-pay__row-label"},z0={props:{event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},setup(n){const a=n;let e=Ne(),s=R("amLabels"),l=v(()=>e.getters["attendee/getPayments"]),i=v(()=>Object.assign(Ar(e),{deposit:l.value[0].amount,paid:l.value.reduce((u,d)=>u+d.amount,0)})),o=R("amColors"),r=v(()=>({"--am-c-pay-text-op03":H(o.value.colorMainText,.03)}));return(u,d)=>(c(),y("div",{class:q(["am-capai-pay__content",a.responsiveClass]),style:Ce(t(r))},[(c(!0),y(ee,null,fe(t(l),(f,_)=>(c(),y(ee,{key:_},[m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",A0,k(t(s).date),1),m("div",I0,k(t(nt)(f.dateTime.split(" ")[0])),1)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",P0,k(t(s).payment_method),1),m("div",$0,k(t(Tr)(f)),1)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",N0,k(t(s).status),1),m("div",D0,[m("span",{class:q(t(ds)(f.status,t(o)).icon),style:Ce({color:t(ds)(f.status,t(o)).color})},null,6),ce(" "+k(t(si)(f.status)),1)])],2)],64))),128)),a.pageWidth>480?(c(),y("div",O0)):D("",!0),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",F0,k(t(s).price),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).price)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",M0,k(t(s).discount_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).discount)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",V0,k(t(s).tax),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).tax)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",B0,k(t(s).paid_deposit),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).deposit)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",R0,k(t(s).paid_remaining_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).paid-t(i).deposit)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",q0,k(t(s).due),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).paid-(t(i).price-t(i).discount+t(i).tax))),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",U0,k(t(s).total),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},k(t(tt)(t(i).price-t(i).discount+t(i).tax)),3)],2)],6))}};const j0=m("span",{class:"am-icon-clearable"},null,-1),Y0={class:"am-capei-atti__footer"},W0={name:"CabinetEventAttendee"},Ir=Object.assign(W0,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},isNew:{type:Boolean,default:!1},event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},emits:["close","save"],setup(n,{emit:a}){const e=n;let s=Ne(),l=R("amLabels");const i=R("settings");let o=M(!1),r=v(()=>s.getters["attendee/getCustomFields"]);const u=M("details");let d=M(null),f=M(null),_=M(!1),g=M(null),C=M("");function O(){_.value=!1,C.value=""}let I=M(!1),b=M();Be("formWrapper",b);function P(){let w=Ar(s);return w.price-w.discount+w.tax}function L(){let w=!0;if(f.value?.customFieldsFormRef.validate(N=>{N||(u.value="customFields",w=!1)}),d.value?.detailsFormRef.validate(N=>{N||(u.value="details",w=!1)}),!w)return;let B=i.payments.paymentLinks&&i.payments.paymentLinks.enabled,z=e.event.settings?JSON.parse(e.event.settings):null;z&&"payments"in z&&"paymentLinks"in z.payments&&(B=z.payments.paymentLinks.enabled),B&&s.getters["attendee/getId"]&&P()>h.value?I.value=!0:$(!1)}function $(w){o.value=!0,De.post(s.getters["attendee/getId"]?"/events/bookings/"+s.getters["attendee/getId"]:"/bookings",Object.assign(Lr(s),{runInstantPostBookingActions:!0,createPaymentLinks:w}),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{a("save"),s.commit("attendee/setActive",!1)}).catch(B=>{console.log(B)}).finally(()=>{o.value=!1})}let h=M(0);function S(){s.commit("attendee/setActive",!1),a("close")}Je(()=>{s.commit("attendee/setActive",!0),s.getters["attendee/getId"]&&(h.value=P())});let E=R("amColors"),T=v(()=>({"--am-c-capai-text":E.value.colorMainText,"--am-c-capai-text-op10":H(E.value.colorMainText,.1),"--am-c-capai-primary":E.value.colorPrimary,"--am-c-cust-no1":E.value.colorMainText,"--am-c-cust-no1-bgr":H(E.value.colorMainText,.1),"--am-c-cust-no2":E.value.colorWarning,"--am-c-cust-no2-bgr":H(E.value.colorWarning,.1),"--am-c-cust-no3":E.value.colorError,"--am-c-cust-no3-bgr":H(E.value.colorError,.1),"--am-c-cust-link":H(E.value.colorMainText,.5),"--am-c-cust-text":E.value.colorMainText}));return(w,B)=>{const z=va,N=_a;return t(o)?(c(),U(Wt,{key:1})):(c(),y("div",{key:0,class:q(["am-capei-atti",[{"am-no-border":!0},t(e).responsiveClass]]),style:Ce(t(T))},[t(_)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:O,onTriggerClose:O},{title:x(()=>[j0,ce(" "+k(t(C)),1)]),_:1},512)):D("",!0),A(N,{modelValue:u.value,"onUpdate:modelValue":B[0]||(B[0]=G=>u.value=G)},{default:x(()=>[A(z,{label:t(l).details,name:"details"},{default:x(()=>[A(t(L0),{ref_key:"attendeeDetailsRef",ref:d,event:t(e).event,"is-new":t(e).isNew,"page-width":t(e).pageWidth},null,8,["event","is-new","page-width"])]),_:1},8,["label"]),Object.keys(t(r)).length?(c(),U(z,{key:0,label:t(l).custom_fields,name:"customFields"},{default:x(()=>[A(t(S0),{ref_key:"attendeeCustomFieldsRef",ref:f,event:t(e).event},null,8,["event"])]),_:1},8,["label"])):D("",!0),t(s).getters["attendee/getId"]?(c(),U(z,{key:1,label:t(l).payment,name:"payment"},{default:x(()=>[A(t(z0),{event:t(e).event,"page-width":t(e).pageWidth},null,8,["event","page-width"])]),_:1},8,["label"])):D("",!0)]),_:1},8,["modelValue"]),m("div",Y0,[A(Ee,{category:"secondary",size:"default",type:"plain",onClick:S},{default:x(()=>[ce(k(t(i).roles.allowWriteEvents?t(l).cancel:t(l).close),1)]),_:1}),t(i).roles.allowWriteEvents?(c(),U(Ee,{key:0,size:"default",onClick:L},{default:x(()=>[ce(k(t(l).save),1)]),_:1})):D("",!0)]),A(Ua,{visibility:t(I),title:t(l).confirm,description:t(l).price_changed_message,"close-btn-text":t(l).no,"confirm-btn-text":t(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:B[1]||(B[1]=G=>$(!1)),onConfirm:B[2]||(B[2]=G=>$(!0)),onClose:B[3]||(B[3]=G=>we(I)?I.value=!1:I=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],6))}}});const H0=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),Z0={key:1,class:"am-capei-att__top"},G0={class:"am-capei-att__top-heading"},J0={class:"am-capei-att__top-text"},X0={key:0,class:"am-capei-att__top-places"},Q0={class:"am-cap__cust-option"},K0={class:"am-cap__cust-option__heading"},ek={key:0,class:"am-cap__cust-option__inner"},tk={key:1,class:"am-cap__cust-option__inner"},ak={key:0,class:"am-capei-att__card-wrapper"},sk={key:0,class:"am-capei-customer__data-wrapper"},lk={key:0,class:"am-capei-customer__data"},nk=m("span",{class:"am-icon-phone"},null,-1),ik=["href"],ok={key:1,class:"am-capei-customer__data"},rk=m("span",{class:"am-icon-email"},null,-1),ck=["href"],uk={key:0,class:"am-capei-att__card-tickets"},dk={class:"am-capei-att__card-label"},mk={class:"am-capei-att__card-tickets__inner"},pk={key:1,class:"am-capei-att__card-persons"},gk={class:"am-capei-att__card-label"},fk={class:"am-capei-att__card-person"},hk={key:0,class:"am-capei-att__card-wrapper"},vk={key:0,class:"am-capei-customer__data-wrapper"},_k={key:0,class:"am-capei-customer__data"},yk=m("span",{class:"am-icon-phone"},null,-1),bk=["href"],kk={key:1,class:"am-capei-customer__data"},Ck=m("span",{class:"am-icon-email"},null,-1),xk=["href"],wk={key:0,class:"am-capei-att__card-tickets"},Tk={class:"am-capei-att__card-label"},Ek={class:"am-capei-att__card-tickets__inner"},Lk={key:1,class:"am-capei-att__card-persons"},Sk={class:"am-capei-att__card-label"},Ak={class:"am-capei-att__card-person"},Ik={name:"CabinetEventAttendees"},Pk=Object.assign(Ik,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},event:{type:Object,default:()=>{}}},emits:["close","openAttendee"],setup(n,{emit:a}){const e=n;let s=Ne(),l=R("amLabels");const i=R("settings"),o=R("shortcodeData");let r=R("amCustomize"),u=v(()=>o.value.cabinetType==="employee"?r.value.events.options.customerPhone.visibility:!0),d=v(()=>o.value.cabinetType==="employee"?r.value.events.options.customerEmail.visibility:!0),f=M(null),_=M(!1),g=M("success"),C=M("");function O(){_.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let I=M(!1),b=M(!1),P=M(!1),L=M([]),$=M(0),h=M(1),S=M(!1),E=M([]),T=M(0),w=M(1),B=v(()=>e.event.settings?JSON.parse(e.event.settings):null);const{noShowData:z}=R("noShowData");let N=M(!1),G=M(null),se=M(!1);function j(){G.value=null,N.value=!1}function ne(Oe,Re){G.value=Oe,se.value=Re,N.value=!0}let te=M(null);function oe(){s.commit("attendee/setActive",!1),_.value=!0,C.value=l.value.event_attendee_saved,te.value&&f.value&&setTimeout(function(){dt(te.value,f.value.$el,0,300)},500),F(Ae.value==="approved"?["approved","canceled"]:["waiting"]),ie()}function ie(){I.value=!1,b.value=!1,a("openAttendee",!1)}function K(){s.commit("attendee/setAttendee",fs(s,s.getters["attendee/getDefaultAttendee"],e.event)),I.value=!0,a("openAttendee",!0)}function me(Oe){let Re=s.getters["customerInfo/getCustomers"],be=s.getters["customerInfo/getCustomersIds"];Re.filter(Ue=>Ue.id===Oe.customer.id).length===0&&(Re.push(Oe.customer),s.commit("customerInfo/setCustomers",Re)),be.indexOf(Oe.customer.id)===-1&&(be.push(Oe.customer.id),s.commit("customerInfo/setCustomersIds",be)),s.commit("attendee/setAttendee",fs(s,Oe,e.event)),b.value=!0,I.value=!0,a("openAttendee",!0)}const Ae=M("approved");function Ve(){switch(Ae.value){case"approved":h.value=1;break;case"waiting":w.value=1;break}F(Ae.value==="approved"?["approved","canceled"]:["waiting"])}let Q=M(null),ve=v(()=>s.getters["customerInfo/getLoading"]),X=v(()=>s.getters["customerInfo/getCustomers"]);function F(Oe,Re=1){Oe[0]==="approved"?P.value=!0:S.value=!0,De.get("/bookings/events",Object.assign(ze(s),{params:Js({source:"cabinet-provider",statuses:Oe,page:Re,limit:parseInt(i.general.itemsPerPageBackEnd),events:[e.event.id],customers:Q.value?[Q.value]:[]})})).then(be=>{Oe[0]==="approved"?(ae.value=be.data.data.attendeeCount,xe.value=be.data.data.maxCapacity,L.value=be.data.data.bookings.filter(Ue=>Ue.status==="approved"||Ue.status==="canceled").reduce((Ue,J)=>(Ue.push(fs(s,vo(J,s.getters["attendee/getAttendee"]),e.event)),Ue),[]),$.value=be.data.data.filteredCount):(ae.value=be.data.data.waitingCount,xe.value=be.data.data.waitingCapacity,E.value=be.data.data.bookings.filter(Ue=>Ue.status==="waiting").reduce((Ue,J)=>(Ue.push(vo(J)),Ue),[]),T.value=be.data.data.filteredCount)}).catch(be=>{console.log(be)}).finally(()=>{P.value=!1,S.value=!1})}function Z(Oe,Re){De.post("/events/bookings/"+Oe,{status:Re,bookings:[{status:Re}]},Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(be=>{console.log(be)}).finally(()=>{})}function W(Oe){let Re=Ae.value==="approved"?["approved","canceled"]:["waiting"];Re[0]==="approved"?h.value=Oe:w.value=Oe,F(Re,Oe)}function le(){N.value=!1,se.value?S.value=!0:P.value=!0,De.post("/events/bookings/delete/"+G.value.id,Lr(s),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{W(h.value)}).catch(()=>{S.value=!1,P.value=!1})}let de=M(Sr().filter(Oe=>(!i.appointments.waitingListEvents.enabled||(B.value?"waitingList"in B.value&&!B.value.waitingList.enabled:!0)?Oe.value!=="waiting":!0)&&(i.roles.enableNoShowTag?!0:Oe.value!=="no-show"))),ae=M(0),xe=M(0),_e=v(()=>`${ae.value}/${xe.value}`),pe=v(()=>ae.value===1?l.value.attendee:l.value.attendees);Je(()=>{F(["approved","canceled"]),s.commit("customerInfo/setCustomers",s.getters["auth/getPreloadedCustomers"])});let Te=R("amColors"),$e=v(()=>({"--am-c-capei-att-primary":Te.value.colorPrimary,"--am-c-capei-att-text":Te.value.colorMainText,"--am-c-capei-att-text-op90":H(Te.value.colorMainText,.9),"--am-c-capei-att-text-op10":H(Te.value.colorMainText,.1)}));return(Oe,Re)=>{const be=va,Ue=_a;return c(),y("div",{ref_key:"attendeesContainer",ref:te,class:"am-capei-att",style:Ce(t($e))},[t(_)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:f,type:t(g),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:O,onTriggerClose:O},{title:x(()=>[H0,ce(" "+k(t(C)),1)]),_:1},8,["type"])):D("",!0),t(I)?D("",!0):(c(),y("div",Z0,[m("div",G0,[m("div",J0,k(t(e).event.name),1),t(xe)?(c(),y("div",X0,k(t(_e))+" "+k(t(pe)),1)):D("",!0)]),A(Ee,{category:"secondary",type:"plain",size:"small",class:"am-capei-att__back",onClick:Re[0]||(Re[0]=J=>t(a)("close"))},{default:x(()=>[ce(k(t(l).back),1)]),_:1})])),t(I)?D("",!0):(c(),y("div",{key:2,class:q(["am-capei-att__header",t(e).responsiveClass])},[A(He,{modelValue:t(Q),"onUpdate:modelValue":Re[1]||(Re[1]=J=>we(Q)?Q.value=J:Q=J),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-capei-att-text)","popper-class":"am-cap-cust__popper",placeholder:t(l).event_attendees_search,"remote-method":J=>{t(Hs)(t(s),J)},loading:t(ve),onFocus:Re[2]||(Re[2]=J=>t(Si)(t(s))),onChange:Re[3]||(Re[3]=J=>F(Ae.value==="approved"?["approved","canceled"]:["waiting"],1))},{default:x(()=>[(c(!0),y(ee,null,fe(t(X),J=>(c(),U(qe,{key:J.id,value:J.id,label:`${J.firstName} ${J.lastName}`},{default:x(()=>[m("div",Q0,[m("div",K0,k(J.firstName+" "+J.lastName),1),t(d)?(c(),y("div",ek,k(J.email),1)):D("",!0),t(u)?(c(),y("div",tk,k(J.phone),1)):D("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"]),t(i).roles.allowWriteEvents?(c(),U(Ee,{key:0,prefix:"plus",icon:"plus","icon-only":t(e).pageWidth<540,onClick:K},{default:x(()=>[ce(k(t(l).event_add_attendee),1)]),_:1},8,["icon-only"])):D("",!0)],2)),t(I)?D("",!0):(c(),U(Ue,{key:3,modelValue:Ae.value,"onUpdate:modelValue":Re[4]||(Re[4]=J=>Ae.value=J),onTabClick:Ve},{default:x(()=>[A(be,{label:t(l).attendees,name:"approved"},{default:x(()=>[t(P)?(c(),U(Wt,{key:1})):(c(),y("div",ak,[t(L).length?(c(),y(ee,{key:0},[(c(!0),y(ee,null,fe(t(L),(J,he)=>(c(),y("div",{key:he,class:q(["am-capei-att__card",t(e).responsiveClass])},[m("div",{class:q(["am-capei-att__card-inner",t(e).responsiveClass])},[m("div",{class:q(["am-capei-att__info",t(e).responsiveClass])},[m("div",{class:q(["am-capei-customer__name",t(z)(0).class])},[t(z)(0).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(z)(0).icon}`)},null,2)):D("",!0),ce(" "+k(J.customer.firstName+" "+J.customer.lastName),1)],2),J.customer.phone&&t(u)||J.customer.email&&t(d)?(c(),y("div",sk,[J.customer.phone&&t(u)?(c(),y("div",lk,[nk,m("a",{href:`tel:${J.customer.phone}`},k(J.customer.phone),9,ik)])):D("",!0),J.customer.email&&t(d)?(c(),y("div",ok,[rk,m("a",{href:`mailto:${J.customer.email}`},k(J.customer.email),9,ck)])):D("",!0)])):D("",!0)],2),A(He,{modelValue:J.status,"onUpdate:modelValue":ge=>J.status=ge,placeholder:t(l).select,disabled:!t(i).roles.allowWriteEvents,"prefix-icon":t(de).find(ge=>ge.value===J.status).icon,"prefix-icon-color":t(de).find(ge=>ge.value===J.status).color,"popper-class":"am-capei-att__popper","parent-class":t(e).responsiveClass,onChange:ge=>{Z(J.id,ge)}},{default:x(()=>[(c(!0),y(ee,null,fe(t(de),ge=>(c(),U(qe,{key:ge.value,value:ge.value,label:ge.label},{default:x(()=>[m("span",{class:q(`am-icon-${ge.icon}`),style:Ce({color:ge.color})},null,6),ce(" "+k(ge.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","parent-class","onChange"])],2),J.ticketsData.length?(c(),y("div",uk,[m("div",dk,k(t(l).event_book_tickets)+": ",1),m("div",mk,[(c(!0),y(ee,null,fe(J.ticketsData,(ge,Fe)=>(c(),y("div",{key:Fe,class:"am-capei-att__card-ticket"},k(ge.persons)+" x "+k(t(e).event.customTickets.find(ke=>ke.id===ge.eventTicketId).name),1))),128))])])):(c(),y("div",pk,[m("div",gk,k(t(l).event_book_persons)+": ",1),m("div",fk,k(J.persons),1)])),t(i).roles.allowWriteEvents?(c(),U(ha,{key:2,index:he,"reference-class":t(e).responsiveClass,onEdit:ge=>me(J),onRemove:ge=>ne(J,!1)},null,8,["index","reference-class","onEdit","onRemove"])):D("",!0)],2))),128)),t($)>t(i).general.itemsPerPageBackEnd?(c(),U(Sl,{key:0,"page-size":t(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t($),"current-page":t(h),onCurrentChange:W},null,8,["page-size","total","current-page"])):D("",!0)],64)):(c(),U(Ia,{key:1,heading:t(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"]),t(i).appointments.waitingListEvents.enabled&&t(B)!==null&&"waitingList"in t(B)&&t(B).waitingList.enabled?(c(),U(be,{key:0,label:t(l).waiting_list,name:"waiting"},{default:x(()=>[t(S)?(c(),U(Wt,{key:1})):(c(),y("div",hk,[t(E).length?(c(),y(ee,{key:0},[(c(!0),y(ee,null,fe(t(E),(J,he)=>(c(),y("div",{key:he,class:"am-capei-att__card"},[m("div",{class:q(["am-capei-att__card-inner",t(e).responsiveClass])},[m("div",{class:q(["am-capei-att__info",t(e).responsiveClass])},[m("div",{class:q(["am-capei-customer__name",t(z)(0).class])},[t(z)(0).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(z)(0).icon}`)},null,2)):D("",!0),ce(" "+k(J.customer.firstName+" "+J.customer.lastName),1)],2),J.customer.phone&&t(u)||J.customer.email&&t(d)?(c(),y("div",vk,[J.customer.phone&&t(u)?(c(),y("div",_k,[yk,m("a",{href:`tel:${J.customer.phone}`},k(J.customer.phone),9,bk)])):D("",!0),J.customer.email&&t(d)?(c(),y("div",kk,[Ck,m("a",{href:`mailto:${J.customer.email}`},k(J.customer.email),9,xk)])):D("",!0)])):D("",!0)],2),A(He,{modelValue:J.status,"onUpdate:modelValue":ge=>J.status=ge,placeholder:t(l).select,disabled:!t(i).roles.allowWriteEvents,"prefix-icon":t(de).find(ge=>ge.value===J.status).icon,"prefix-icon-color":t(de).find(ge=>ge.value===J.status).color,"popper-class":"am-capei-att__popper",onChange:ge=>{Z(J.id,ge)}},{default:x(()=>[(c(!0),y(ee,null,fe(t(de),ge=>(c(),U(qe,{key:ge.value,value:ge.value,label:ge.label},{default:x(()=>[m("span",{class:q(`am-icon-${ge.icon}`),style:Ce({color:ge.color})},null,6),ce(" "+k(ge.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","onChange"])],2),Object.keys(J.ticketsData).length?(c(),y("div",wk,[m("div",Tk,k(t(l).event_book_tickets)+": ",1),m("div",Ek,[(c(!0),y(ee,null,fe(J.ticketsData,(ge,Fe)=>(c(),y("div",{key:Fe,class:"am-capei-att__card-ticket"},k(ge.persons)+" x "+k(t(e).event.customTickets.find(ke=>ke.id===ge.eventTicketId).name),1))),128))])])):(c(),y("div",Lk,[m("div",Sk,k(t(l).event_book_persons)+": ",1),m("div",Ak,k(J.persons),1)])),t(i).roles.allowWriteEvents?(c(),U(ha,{key:2,index:he,"reference-class":t(e).responsiveClass,onEdit:ge=>me(J),onRemove:ge=>ne(J,!0)},null,8,["index","reference-class","onEdit","onRemove"])):D("",!0)]))),128)),t(T)>t(i).general.itemsPerPageBackEnd?(c(),U(Sl,{key:0,"page-size":t(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(T),"current-page":t(w),onCurrentChange:W},null,8,["page-size","total","current-page"])):D("",!0)],64)):(c(),U(Ia,{key:1,heading:t(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"])):D("",!0)]),_:1},8,["modelValue"])),A(Ua,{visibility:t(N),title:t(l).confirm,description:t(l).event_attendee_remove,"close-btn-text":t(l).no,"confirm-btn-text":t(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:j,onConfirm:le,onClose:j},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),t(I)?(c(),U(Ir,{key:4,visibility:t(I),title:t(b)?t(l).event_edit_attendee:t(l).event_add_attendee,event:t(e).event,"page-width":t(e).pageWidth,"is-new":!t(b),onSave:oe,onClose:ie},null,8,["visibility","title","event","page-width","is-new"])):D("",!0)],4)}}});const $k=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),Nk={key:2,class:"am-cap__actions"},Dk={name:"CabinetEvents",key:"events"},Ok=Object.assign(Dk,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const a=n;let e=Ne(),s=M(null),{width:l}=ja(s),i=v(()=>st(l.value)),o={components:{IconComponent:We},template:'<IconComponent icon="plus"/>'};const r=R("settings");let u=R("originKey"),d=R("amCustomize");const f=R("shortcodeData"),_=R("labels"),g=R("localLanguage");let C=v(()=>r.general.usedLanguages.includes(g.value)),O=v(()=>{let J=Qe({..._}),he=d.value.events.translations;return he&&Object.keys(he).forEach(ge=>{he[ge][g.value]&&C.value?J[ge]=he[ge][g.value]:he[ge].default&&(J[ge]=he[ge].default)}),J});Be("amLabels",O);let I=M(null),b=M(!1),P=M("success"),L=M("");function $(){b.value=!1,e.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}function h(J){let he=Qe({..._}),ge=d.value[J].translations;return ge&&Object.keys(ge).forEach(Fe=>{ge[Fe][g.value]&&C.value?he[Fe]=ge[Fe][g.value]:ge[Fe].default&&(he[Fe]=ge[Fe].default)}),he}function S(J){return d.value[J].options}let E=v(()=>e.getters["entities/getReady"]),T=R("cabinetType");e.commit("cabinetFilters/setDates",ui(T.value));let w=v(()=>e.getters["cabinet/getEventsLoading"]),B=M(!1),z=M(null),N=M(null),G=M(0),se=M(1);function j(J){se.value=J,ne(J)}function ne(J=1){z.value=null,e.commit("cabinet/setEventsLoading",!0);let he=e.getters["cabinet/getTimeZone"],ge=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getEventsFilters"]));ge.dates=ge.dates.map(ke=>ye(ke).format("YYYY-MM-DD")),ge.timeZone=he,ge.source="cabinet-"+T.value,ge.id=ge.events,ge.group=!0,ge.page=J,ge.limit=r.general.itemsPerPageBackEnd,ge.customers&&(ge.customerId=ge.customers),e.commit("auth/setLoadingEventsCounter",e.getters["auth/getLoadingEventsCounter"]+1);let Fe=e.getters["auth/getLoadingEventsCounter"];De.get("/events",Object.assign(ze(e),{params:Js(ge)})).then(ke=>{Fe===e.getters["auth/getLoadingEventsCounter"]&&(e.dispatch("cabinetFilters/injectEventsOptions",ke.data.data.events),e.commit("auth/setPreloadedEvents",ke.data.data.events),G.value=ke.data.data.count,e.commit("eventEntities/setEvents",ke.data.data.events),N.value=xc(ke.data.data.events,e.getters["cabinet/getTimeZone"],e))}).catch(ke=>{ke?.response?.data?.data?.reauthorize!==void 0&&ke.response.data.data.reauthorize&&e.dispatch("auth/logout"),console.log(ke)}).finally(()=>{Fe===e.getters["auth/getLoadingEventsCounter"]&&e.commit("cabinet/setEventsLoading",!1)})}function te(J){e.commit("cabinet/setEventsLoading",!0),De.get("/events/"+J.id,Object.assign({params:{source:"cabinet-"+T.value,timeZone:e.getters["cabinet/getTimeZone"]}},ze(e))).then(he=>{e.commit("event/setEvent",bb(e,he.data.data.event)),oe.value=!0}).catch(he=>{console.log(he)}).finally(()=>{e.commit("cabinet/setEventsLoading",!1)})}let oe=M(!1),ie=M(!1),K=M(!1),me=M(!1),Ae=M(!1),Ve=M(null);function Q(J){e.commit("cabinet/setEventsLoading",!0),oe.value=!1,setTimeout(()=>{e.commit("event/setEvent",J),oe.value=!0,e.commit("cabinet/setEventsLoading",!1)},500)}function ve(){b.value=!0,L.value=O.value.event_saved,s.value&&I.value&&setTimeout(function(){dt(s.value,I.value.$el,0,300)},500),ne(),_e()}function X(){pe(),oe.value=!0}function F(J){Ve.value=J,xe(fs(e,e.getters["attendee/getDefaultAttendee"],J)),K.value=!0}function Z(){ne(se.value),W()}function W(){K.value=!1,me.value=!1}function le(J){Ve.value=J,ie.value=!0}function de(){Ve.value=null,ne(se.value),xe(fs(e,e.getters["attendee/getDefaultAttendee"])),ie.value=!1,Ae.value=!1}function ae(J){Ae.value=J}function xe(J={}){e.commit("attendee/setAttendee",J)}function _e(){oe.value=!1,pe()}function pe(){e.commit("event/setEvent",{bookings:[],settings:ys(r,e.getters["event/getSettings"],{},{})})}let Te=M(!1);function $e(){Te.value=!0,De.post("/bookings/cancel/"+z.value.id,{type:"event",source:"cabinet-"+T.value},Object.assign(ze(e),{params:{source:"cabinet-"+T.value}})).then(()=>{z.value=null,ne(),b.value=!0,L.value=O.value.event_canceled,s.value&&I.value&&setTimeout(function(){dt(s.value,I.value.$el,0,300)},500)}).catch(J=>{!("data"in J.response.data)&&"message"in J.response.data&&(b.value=!0,L.value=J.response.data.message,s.value&&I.value&&setTimeout(function(){dt(s.value,I.value.$el,0,300)},500))}).finally(()=>{Te.value=!1})}rt(()=>a.loadBookingsCounter,()=>{ne()}),Je(()=>{ne()});function Oe(J){let he=[],ge=e.getters["entities/getEmployees"];if(J.organizerId&&ge.find(Fe=>Fe.id===J.organizerId)){let Fe={...ge.find(ke=>ke.id===J.organizerId),rank:"organizer"};if(!J.providers.length)return Fe;he.push(Fe)}return J.providers.length&&J.providers.forEach(Fe=>{Fe.id!==J.organizerId&&ge.find(ke=>ke.id===Fe.id)&&he.push(ge.find(ke=>ke.id===Fe.id))}),he}function Re(J){if(J){if(J===1)return{class:"am-no-show-1",icon:"no-show-1"};if(J===2)return{class:"am-no-show-2",icon:"no-show-2"};if(J>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Be("noShowData",{noShowData:Re});let be=R("amColors"),Ue=v(()=>({"--am-c-cape-bgr":be.value.colorMainBgr,"--am-c-cape-text":be.value.colorMainText,"--am-c-cape-text-op70":H(be.value.colorMainText,.7),"--am-c-cape-text-op25":H(be.value.colorMainText,.25),"--am-c-cape-primary":be.value.colorPrimary,"--am-c-cust-no1":be.value.colorMainText,"--am-c-cust-no1-bgr":H(be.value.colorMainText,.1),"--am-c-cust-no2":be.value.colorWarning,"--am-c-cust-no2-bgr":H(be.value.colorWarning,.1),"--am-c-cust-no3":be.value.colorError,"--am-c-cust-no3-bgr":H(be.value.colorError,.1),"--am-c-cust-text":be.value.colorMainText,"--am-c-cust-link":H(be.value.colorMainText,.5)}));return(J,he)=>(c(),y("div",{ref_key:"pageContainer",ref:s,class:q(["am-cap am-cape-main",{"am-capei-main":t(oe)||t(K)||t(Ae)}]),style:Ce(t(Ue))},[m("div",{class:q(["am-cape-main__inner",t(i)])},[t(b)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:I,type:t(P),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:$,onTriggerClose:$},{title:x(()=>[$k,ce(" "+k(t(L)),1)]),_:1},8,["type"])):D("",!0),!t(K)&&!t(oe)&&!t(ie)&&t(E)?(c(),U(Ai,{key:1,"step-key":"events",empty:t(B),"responsive-class":t(i),onChangeFilters:ne},null,8,["empty","responsive-class"])):D("",!0),t(f).cabinetType==="employee"&&t(r).roles.allowWriteEvents&&!t(K)&&!t(oe)&&!t(ie)&&t(E)?(c(),y("div",Nk,[A(Ee,{icon:t(o),prefix:"plus",size:"small",category:"primary",type:t(d).events.options.newEvtBtn.buttonType,onClick:X},{default:x(()=>[m("span",null,k(t(O).new_event),1)]),_:1},8,["icon","type"])])):D("",!0),!t(w)&&t(E)?(c(),y(ee,{key:3},[!t(K)&&!t(oe)&&!t(ie)&&t(N)&&Object.keys(t(N)).length>0?(c(),y("div",{key:0,class:q(["am-cape__wrapper",[{"am-no-border":t(N)&&Object.keys(t(N)).length===1},t(i)]])},[(c(!0),y(ee,null,fe(t(N),(ge,Fe)=>(c(),y("div",{key:Fe,class:"am-cape"},[m("div",{class:q(["am-cape__date",[{"am-today":t(nt)(Fe)===t(nt)(t(ye)().format("YYYY-MM-DD"))},{"am-no-flag":t(N)&&Object.keys(t(N)).length===1},t(i)]])},k(t(nt)(Fe)),3),(c(!0),y(ee,null,fe(ge.events,(ke,ba)=>(c(),U(yr,{key:ba,start:t(vs)(ke.periods[0].periodStart.split(" ")[1].slice(0,5)),name:ke.name,employee:Oe(ke),customers:ke.bookings.filter(wt=>wt.status!=="rejected"&&wt.status!=="canceled").map(wt=>wt.customer),price:t(Io)(ke),duration:null,periods:(J.periods=t(wc)(ke.periods))?J.periods:[],extras:[],tickets:t(Tc)(ke),"custom-fields":t(hr)(ke.bookings,t(f).cabinetType),location:t(Ec)(t(e),ke),"google-meet-link":ke.periods.length===1&&ke.periods[0].googleMeetUrl?ke.periods[0].googleMeetUrl:"","microsoft-teams-link":ke.periods.length===1&&ke.periods[0].microsoftTeamsUrl?ke.periods[0].microsoftTeamsUrl:"","zoom-link":ke.periods.length===1&&ke.periods[0].zoomMeeting?ke.periods[0].zoomMeeting.joinUrl:"","lesson-space-link":ke.periods.length===1&&ke.periods[0].lessonSpace?ke.periods[0].lessonSpace:"",bookable:ke,reservation:ke,booking:ke.bookings[0],"responsive-class":t(i),"parent-width":t(l),"customized-options":S("events"),onEditEvent:te,onAddEventAttendee:F,onListEventAttendees:le,onCancelBooking:he[0]||(he[0]=wt=>{we(z)?z.value=wt:z=wt})},null,8,["start","name","employee","customers","price","periods","tickets","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","responsive-class","parent-width","customized-options"]))),128))]))),128))],2)):D("",!0),!t(K)&&!t(oe)&&!t(ie)&&(t(N)===null||Object.keys(t(N)).length===0)?(c(),U(Ia,{key:1,heading:t(O).no_evt_found,text:t(O).have_no_evt},null,8,["heading","text"])):D("",!0),!t(K)&&!t(oe)&&!t(ie)&&t(N)&&Object.keys(t(N)).length>0&&t(G)>t(r).general.itemsPerPageBackEnd?(c(),U(Sl,{key:2,"page-size":t(r).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(G),"current-page":t(se),onCurrentChange:j},null,8,["page-size","total","current-page"])):D("",!0),t(oe)?(c(),U(m0,{key:3,"page-width":t(l),"responsive-class":t(i),onClose:_e,onSave:ve,onDuplicate:Q},null,8,["page-width","responsive-class"])):D("",!0),!t(K)&&t(ie)?(c(),U(Pk,{key:4,event:t(Ve),"page-width":t(l),"responsive-class":t(i),onClose:de,onOpenAttendee:ae},null,8,["event","page-width","responsive-class"])):D("",!0),t(K)?(c(),U(Ir,{key:5,visibility:t(K),title:t(me)?t(O).event_edit_attendee:t(O).event_add_attendee,event:t(Ve),"page-width":t(l),"is-new":!t(me),onSave:Z,onClose:W},null,8,["visibility","title","event","page-width","is-new"])):D("",!0),t(u)==="capc"?(c(),U(Ua,{key:6,visibility:t(z)!==null,title:h("cancelEvent").cancel_event,description:h("cancelEvent").confirm_cancel_event,"close-btn-text":h("cancelEvent").close,"confirm-btn-text":h("cancelEvent").confirm,"customized-options":S("cancelEvent"),loading:t(Te),onClose:he[1]||(he[1]=ge=>we(z)?z.value=null:z=null),onDecline:he[2]||(he[2]=ge=>we(z)?z.value=null:z=null),onConfirm:$e},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):D("",!0)],64)):(c(),U(Ii,{key:4}))],2)],6))}});const Fk={class:"am-sc__top-left"},Mk={class:"am-sc__name"},Vk={key:0,class:"am-sc__date"},Bk={key:1,class:"am-sc__date"},Rk=["onClick"],qk={class:"am-sc__capacity"},Uk=m("div",{class:"am-sc__btn"},[m("span",{class:"am-icon-arrow-right"})],-1),zk={key:0,class:"am-sc__bottom"},jk={class:"am-sc__expiration"},Yk=m("span",{class:"am-icon-triangle-info"},null,-1),Wk={name:"CabinetPackagesList"},Hk=Object.assign(Wk,{props:{packages:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""}},emits:["click"],setup(n,{emit:a}){const e=n;function s(b){return ye(b,"YYYY-MM-DD").diff(ye(),"days")}function l(b){a("click",b)}function i(b,P,L){let $=0;return Object.keys(b).forEach(h=>{(P===null||parseInt(P)===parseInt(h))&&($+=b[h].purchaseData[L])}),$}function o(b){return b===1?C.value.appointment_booked:C.value.appointments_booked}function r(b){let P=b.packageData.sharedCapacity?b.packageData.sharedCount:i(b.services,null,"count"),L=b.packageData.sharedCapacity?b.packageData.sharedTotal:i(b.services,null,"total");return`${L-P}/${L} ${o(L-P)}`}const u=R("settings");let d=R("amCustomize");const f=R("labels"),_=R("localLanguage");let g=v(()=>u.general.usedLanguages.includes(_.value)),C=v(()=>{let b=Qe({...f}),P=d.value.packagesList.translations;return P&&Object.keys(P).forEach(L=>{P[L][_.value]&&g.value?b[L]=P[L][_.value]:P[L].default&&(b[L]=P[L].default)}),b}),O=R("amColors"),I=v(()=>({"--am-c-sc-bgr":O.value.colorMainBgr,"--am-c-sc-bgr-op15":H(O.value.colorMainText,.15),"--am-c-sc-text":O.value.colorMainText,"--am-c-sc-text-op80":H(O.value.colorMainText,.8),"--am-c-sc-text-op60":H(O.value.colorMainText,.6),"--am-c-sc-warning-op50":H(O.value.colorWarning,.5)}));return(b,P)=>t(e).packages.length?(c(!0),y(ee,{key:0},fe(t(e).packages,L=>(c(),y("div",{key:L[0],style:Ce(t(I)),class:q(["am-sc",{"am-sc__canceled":L[1].packageData.status==="canceled"}])},[m("div",{class:q(["am-sc__top",n.responsiveClass])},[m("div",Fk,[m("div",Mk,k(L[1].packageData.name),1),L[1].packageData.end?(c(),y("div",Vk,k(t(C).package_book_expire)+" "+k(t(nt)(L[1].packageData.end.split(" ")[0])),1)):(c(),y("div",Bk,k(`${t(C).package_book_expiration} ${t(C).package_book_unlimited}`),1))]),m("div",{class:q(["am-sc__top-right",n.responsiveClass]),onClick:$=>l(L[0])},[m("div",qk,k(r(L[1])),1),Uk],10,Rk)],2),L[1].packageData.end&&L[1].packageData.status!=="canceled"?(c(),y(ee,{key:0},[s(L[1].packageData.end.split(" ")[0])>0?(c(),y("div",zk,[m("span",jk,[Yk,ce(" "+k(`${t(C).package_deal_expire_in} ${s(L[1].packageData.end.split(" ")[0])} ${t(C).expires_days}, ${t(C).appointments_deal_expire}`),1)])])):D("",!0)],64)):D("",!0)],6))),128)):(c(),U(Ia,{key:1,heading:t(C).no_pack_found,text:t(C).have_no_pack},null,8,["heading","text"]))}});const Zk=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),Gk={class:"am-cappa__back"},Jk={class:"am-cappa__heading-left"},Xk={key:0,class:"am-cappa__img-name"},Qk={class:"am-cappa__info"},Kk={class:"am-cappa__name"},eC={key:0,class:"am-cappa__date"},tC={key:1,class:"am-cappa__date"},aC={key:2,class:"am-cappa__capacity"},sC={class:"am-cappa__service-heading"},lC={class:"am-cappa__service-right"},nC={key:0,class:"am-cappa__service-img__name"},iC={class:"am-cappa__service-info"},oC={class:"am-cappa__service-name"},rC={key:0,class:"am-cappa__service-capacity"},cC={name:"CabinetPackageAppointmentsList",key:"packagesList"},uC=Object.assign(cC,{props:{data:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["goBack","booked","canceled","cancelError"],setup(n,{emit:a}){const e=n;let s=Ne(),l=v(()=>s.getters.getSettings),i={components:{IconComponent:We},template:'<IconComponent icon="arrow-left"></IconComponent>'},{selectedPackageCustomerId:o}=R("packageSelection"),r=v(()=>s.getters["entities/getPackage"](e.data.packageData.id)),u=v(()=>r.value.bookable.filter(F=>e.data.services[F.service.id]).map(F=>F.service.id.toString())),d=v(()=>r.value.bookable.find(F=>parseInt(F.service.id)===parseInt(b.value))),f=M(null),_=M(null),g=v(()=>{let F=s.getters["entities/getEntitiesRelations"],Z=s.getters["entities/getUnfilteredEmployees"],W=[];if(d.value){if(_.value)Object.keys(F).forEach(de=>{P.value&&P.value.serviceId in F[de]&&F[de][parseInt(P.value.serviceId)].indexOf(_.value)!==-1&&W.push(parseInt(de))});else{let de=[];if(d.value.locations.length)de=d.value.locations.map(ae=>ae.id);else for(let ae in F)d.value.service.id in F[ae]&&(de=de.concat(F[ae][d.value.service.id]));for(let ae in F)d.value.service.id in F[ae]&&de.forEach(xe=>{F[ae][d.value.service.id].indexOf(xe)!==-1&&W.push(parseInt(ae))})}let le=d.value.providers.length?d.value.providers.map(de=>de.id):Z.map(de=>de.id);return Z.filter(de=>le.indexOf(de.id)!==-1&&W.indexOf(de.id)!==-1&&(s.getters["entities/getShowHidden"]||de.status==="visible"&&de.show))}return[]}),C=v(()=>{let F=s.getters["entities/getEntitiesRelations"],Z=s.getters["entities/getUnfilteredLocations"],W=[];if(d.value){if(f.value)W=F[f.value][d.value.service.id];else{let de=[];if(d.value.providers.length)de=d.value.providers.map(ae=>ae.id);else for(let ae in F)d.value.service.id in F[ae]&&de.push(parseInt(ae));for(let ae in F)d.value.service.id in F[ae]&&de.indexOf(parseInt(ae))!==-1&&(W=W.concat(F[ae][d.value.service.id]))}let le=d.value.locations.length?d.value.locations.map(de=>de.id):Z.map(de=>de.id);return Z.filter(de=>le.indexOf(de.id)!==-1&&W.indexOf(de.id)!==-1&&(s.getters["entities/getShowHidden"]||de.status==="visible"))}return[]}),O=v(()=>{let F=[];return Object.keys(e.data.services).forEach(Z=>{Object.keys(e.data.services[Z].appointments).forEach(W=>{e.data.services[Z].appointments[W].appointments.forEach(le=>{F.push(le)})})}),{type:"package",package:r.value,booking:null,bookable:r.value,paymentId:e.data.packageData.payments.length?e.data.packageData.payments[0].id:null,customer:s.getters["auth/getProfile"],packageCustomerId:parseInt(o.value),packageReservations:F,payments:e.data.packageData.payments,price:e.data.packageData.price,tax:e.data.packageData.tax,coupon:e.data.packageData.coupon,discount:e.data.packageData.discount,end:e.data.packageData.end}}),I=M(!1),b=M(null),P=M(null),L=M(null);Je(()=>{b.value=u.value[0]});function $(F,Z,W){let le=0;return Object.keys(F).forEach(de=>{(Z===null||parseInt(Z)===parseInt(de))&&(le+=F[de].purchaseData[W])}),le}function h(F){return F===1?oe.value.appointment_booked:oe.value.appointments_booked}function S(F,Z=null){let W=F.packageData.sharedCapacity?F.packageData.sharedCount:$(F.services,Z,"count"),le=F.packageData.sharedCapacity?F.packageData.sharedTotal:$(F.services,Z,"total");return`${le-W}/${le} ${h(le-W)}`}function E(F){b.value=F.paneName}function T(){let F=s.getters["auth/getProfile"],Z=s.getters["cabinet/getTimeZone"]?s.getters["cabinet/getTimeZone"]:"UTC",W={serviceId:parseInt(b.value),group:1,timeZone:s.getters["cabinet/getTimeZone"],structured:!0,page:"cabinet"},le=r.value.bookable.find(de=>parseInt(de.service.id)===parseInt(b.value)).providers.map(de=>de.id);le.length&&(W.providerIds=le),W.locationId=null,L.value=W,P.value={type:"appointment",bookings:[{packageCustomerService:{id:e.data.services[b.value].purchaseData.packageCustomerServiceId},customer:{id:F.id,firstName:F.firstName,lastName:F.lastName,email:F.email,phone:F.phone,countryPhoneIso:F.countryPhoneIso,externalId:F.externalId},customerId:F.id,customFields:null,persons:1,extras:[],deposit:0}],serviceId:b.value,locationId:e.data.services[b.value].purchaseData.locitionId,providerId:e.data.services[b.value].purchaseData.employeeId,isGroup:!0,notifyParticipants:l.value.notifications.notifyCustomers?1:0,payment:null,recurring:[],package:[],timeZone:Z===""?Intl.DateTimeFormat().resolvedOptions().timeZone:Z,utc:Z==="",locale:window.localeLanguage[0]}}function w(F){P.value=null,a("booked",F)}let B=M(!1);function z(){B.value=!0,De.post("/packages/customers/"+parseInt(o.value),{status:"canceled"},ze(s)).then(()=>{I.value=!1,a("canceled",{message:oe.value.package_purchase_canceled})}).catch(F=>{F.response&&a("cancelError",F.response.data)}).finally(()=>{B.value=!1})}function N(F){a("booked",F)}function G(){a("goBack")}let se=R("amCustomize");const j=R("labels"),ne=R("localLanguage");let te=v(()=>l.value.general.usedLanguages.includes(ne.value)),oe=v(()=>{let F=Qe({...j}),Z=se.value.packageAppointmentsList.translations;return Z&&Object.keys(Z).forEach(W=>{Z[W][ne.value]&&te.value?F[W]=Z[W][ne.value]:Z[W].default&&(F[W]=Z[W].default)}),F});Be("amLabels",oe);let ie=v(()=>s.getters["cabinet/getPaymentLinkError"].package),K=M("error"),me=M(oe.value.payment_link_error);function Ae(){ie.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"package"})}function Ve(F){let Z=Qe({...j}),W=se.value[F].translations;return W&&Object.keys(W).forEach(le=>{W[le][ne.value]&&te.value?Z[le]=W[le][ne.value]:W[le].default&&(Z[le]=W[le].default)}),Z}function Q(F){return se.value[F].options}let ve=R("amColors"),X=v(()=>({"--am-c-cappa-text":ve.value.colorMainText,"--am-c-cappa-bgr":ve.value.colorMainBgr,"--am-c-cappa-text-op80":H(ve.value.colorMainText,.8),"--am-c-cappa-text-op70":H(ve.value.colorMainText,.7),"--am-c-cappa-text-op20":H(ve.value.colorMainText,.2),"--am-c-cappa-primary":ve.value.colorPrimary}));return(F,Z)=>{const W=va,le=_a;return c(),y("div",{class:"am-cappa",style:Ce(t(X))},[t(ie)?(c(),U(_t,{key:0,ref:"alertContainer",type:t(K),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:Ae,onTriggerClose:Ae},{title:x(()=>[Zk,ce(" "+k(t(me)),1)]),_:1},8,["type"])):D("",!0),m("div",Gk,[A(Ee,{"custom-class":"am-cappa__back-btn",icon:t(i),type:t(se).packageAppointmentsList.options.backBtn.buttonType,size:"micro",category:"secondary","icon-only":"","aria-label":t(oe).back_btn,onClick:G},null,8,["icon","type","aria-label"]),m("span",null,k(t(oe).back_btn),1)]),m("div",{class:q(["am-cappa__heading",n.responsiveClass])},[m("div",Jk,[m("div",{class:"am-cappa__img",style:Ce(t(e).data.packageData.pictureThumbPath?{backgroundImage:`url(${t(e).data.packageData.pictureThumbPath})`}:{})},[t(e).data.packageData.pictureThumbPath?D("",!0):(c(),y("span",Xk,k(t(Mi)(t(e).data.packageData.name)),1)),m("span",{class:"am-cappa__img-color",style:Ce({backgroundColor:t(e).data.packageData.color})},null,4)],4),m("div",Qk,[m("div",Kk,k(t(e).data.packageData.name),1),t(e).data.packageData.end?(c(),y("div",eC,k(t(oe).package_book_expire)+" "+k(t(nt)(t(e).data.packageData.end.split(" ")[0])),1)):(c(),y("div",tC,k(`${t(oe).package_book_expiration} ${t(oe).package_book_unlimited}`),1)),Object.keys(t(e).data.services).length>1?(c(),y("div",aC,k(S(t(e).data)),1)):D("",!0)])]),m("div",{class:q(["am-cappa__heading-right",n.responsiveClass])},[t(l).roles.allowCustomerCancelPackages&&t(e).data.packageData.status!=="canceled"?(c(),U(Ee,{key:0,category:"danger",size:"small",class:q(["am-cappa__actions",n.responsiveClass]),type:t(se).packageAppointmentsList.options.cancelBtn.buttonType,onClick:Z[0]||(Z[0]=()=>{we(I)?I.value=!0:I=!0})},{default:x(()=>[ce(k(t(oe).cancel),1)]),_:1},8,["class","type"])):D("",!0),t(e).data.packageData.status==="approved"&&t(e).data.packageData.price>0?(c(),U(vr,{key:1,"btn-size":"small",class:q(`am-cappa__actions ${n.responsiveClass}`),type:t(se).packageAppointmentsList.options.payBtn.buttonType,reservation:t(O),bookable:t(r)},null,8,["class","type","reservation","bookable"])):D("",!0)],2)],2),A(le,{modelValue:t(b),"onUpdate:modelValue":Z[1]||(Z[1]=de=>we(b)?b.value=de:b=de),class:"am-cappa__service",onTabClick:E},{default:x(()=>[(c(!0),y(ee,null,fe(t(u),de=>(c(),U(W,{key:de,name:de},{label:x(()=>[m("div",sC,k(t(e).data.services[de].purchaseData.name),1)]),default:x(()=>[t(b)===de?(c(),y(ee,{key:0},[m("div",{class:q(["am-cappa__service-top",n.responsiveClass])},[m("div",lC,[m("div",{class:"am-cappa__service-img",style:Ce(t(e).data.services[t(b)].purchaseData.pictureThumbPath?{backgroundImage:`url(${t(e).data.services[t(b)].purchaseData.pictureThumbPath})`}:{})},[t(e).data.services[t(b)].purchaseData.pictureThumbPath?D("",!0):(c(),y("span",nC,k(t(Mi)(t(e).data.services[t(b)].purchaseData.name)),1)),m("span",{class:"am-cappa__service-img__color",style:Ce({backgroundColor:t(e).data.services[t(b)].purchaseData.color})},null,4)],4),m("div",iC,[m("div",oC,k(t(e).data.services[t(b)].purchaseData.name),1),t(e).data.packageData.sharedCapacity?D("",!0):(c(),y("div",rC,k(S(t(e).data,t(b))),1))])]),t(e).data.packageData.status!=="canceled"?(c(),U(Ee,{key:0,class:q(["am-cappa__service-book",n.responsiveClass]),size:"small",type:t(se).packageAppointmentsList.options.bookBtn.buttonType,disabled:$(t(e).data.services,t(b),"count")===0,onClick:T},{default:x(()=>[ce(k(t(oe).book_now),1)]),_:1},8,["class","type","disabled"])):D("",!0)],2),A(kr,{"grouped-appointments":t(e).data.services[t(b)].appointments,"page-width":n.pageWidth,"responsive-class":n.responsiveClass,"is-package-booking":!0,"step-key":"packageAppointmentsList",onCanceled:N,onBooked:N},null,8,["grouped-appointments","page-width","responsive-class"])],64)):D("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),A(Ua,{loading:t(B),visibility:t(I),title:Ve("cancelPackage").cancel_package,description:Ve("cancelPackage").confirm_cancel_package,"close-btn-text":Ve("cancelPackage").close,"confirm-btn-text":Ve("cancelPackage").confirm,"customized-options":Q("cancelPackage"),onClose:Z[2]||(Z[2]=()=>{we(I)?I.value=!1:I=!1}),onDecline:Z[3]||(Z[3]=()=>{we(I)?I.value=!1:I=!1}),onConfirm:z},null,8,["loading","visibility","title","description","close-btn-text","confirm-btn-text","customized-options"]),A(br,{visibility:t(P)!==null&&!t(P).id,appointment:t(P),employees:t(g),locations:t(C),"slots-params":t(L),labels:Ve("bookAppointment"),"customized-options":Q("bookAppointment"),onClose:Z[4]||(Z[4]=de=>we(P)?P.value=null:P=null),onSuccess:w,onError:Z[5]||(Z[5]=()=>{}),onEmployeeSelection:Z[6]||(Z[6]=de=>we(f)?f.value=de:f=de),onLocationSelection:Z[7]||(Z[7]=de=>we(_)?_.value=de:_=de)},null,8,["visibility","appointment","employees","locations","slots-params","labels","customized-options"])],4)}}});const dC=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),mC={name:"CabinetPackages",key:"packages"},pC=Object.assign(mC,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const a=n;let e=Ne(),s=M(null),l=M(0),i=R("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}rt(i,G=>{G?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{ii(()=>{l.value=s.value.offsetWidth})});let u=v(()=>st(l.value)),d=M(null),f=M(!1),_=M("success"),g=M("");function C(){f.value=!1,g.value=""}let O=R("cabinetType");e.commit("cabinetFilters/setDates",ui(O.value));let I=v(()=>e.getters["cabinet/getPackageLoading"]),b=M([]),P=M(null);function L(){let G=e.getters["cabinetFilters/getPackages"],se=e.getters["cabinetFilters/getServices"],j=e.getters["cabinetFilters/getProviders"],ne=e.getters["cabinetFilters/getLocations"];b.value=T.value.filter(te=>{let oe=e.getters["entities/getPackageEntities"](te[1].packageData.id);return(se.length===0||se.filter(ie=>oe.services.includes(ie)).length>0)&&(j.length===0||j.filter(ie=>oe.providers.includes(ie)).length>0)&&(ne.length===0||ne.filter(ie=>oe.locations.includes(ie)).length>0)&&(G.length===0||G.filter(ie=>oe.packages.includes(ie)).length>0)})}function $(G,se,j){let ne=0;return Object.keys(G).forEach(te=>{(se===null||parseInt(se)===parseInt(te))&&(ne+=G[te].purchaseData[j])}),ne}function h(G){let se=$(G.services,null,"count"),j=$(G.services,null,"total");return j-se===j}function S(G){e.commit("cabinet/setPackageLoading",!0);let se=e.getters["cabinet/getTimeZone"],j=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getPackagesFilters"]));j.timeZone=se,j.source="cabinet-"+O.value,j.activePackages=0,De.get("/appointments",Js(Object.assign(ze(e),{params:j}))).then(ne=>{let te={};ne.data.data.availablePackageBookings.forEach(Q=>{Q.packages.forEach(ve=>{ve.services.forEach(X=>{X.bookings.forEach(F=>{let Z=e.getters["entities/getPackage"](ve.packageId);if(Z&&(F.packageCustomerId in te||(te[F.packageCustomerId]={packageData:{id:Z.id,name:Z.name,start:F.start,end:F.end,price:F.price,tax:F.tax,coupon:F.coupon,status:F.status,type:"package",payments:F.payments,sharedCapacity:F.sharedCapacity,sharedTotal:F.total,sharedCount:F.count,discount:0,color:Z.color,pictureFullPath:Z.pictureFullPath,pictureThumbPath:Z.pictureThumbPath},services:{}}),!(X.serviceId in te[F.packageCustomerId].services))){let W=e.getters["entities/getService"](X.serviceId);te[F.packageCustomerId].services[X.serviceId]={appointments:{},purchaseData:{packageCustomerServiceId:F.id,total:F.total,count:F.count,employeeId:F.employeeId,locationId:F.locationId,name:W.name,color:W.color,pictureThumbPath:W.pictureThumbPath}}}})})})});let oe=fr(ne.data.data.appointments,se,O.value==="provider");Object.keys(oe).forEach(Q=>{oe[Q].appointments.forEach(ve=>{ve.bookings.forEach(X=>{let F=X.packageCustomerService.packageCustomer.id;F in te&&(Q in te[F].services[ve.serviceId].appointments||(te[F].services[ve.serviceId].appointments[Q]={date:Q,appointments:[]}),te[F].services[ve.serviceId].appointments[Q].appointments.push(ve))})})});let ie=Object.entries(te).filter(Q=>Q[1].packageData.status==="canceled"),K=Object.entries(te).filter(Q=>Q[1].packageData.status!=="canceled"&&h(Q[1])),me=Object.entries(te).filter(Q=>Q[1].packageData.status!=="canceled"&&!h(Q[1])&&Q[1].packageData.end===null),Ae=Object.entries(te).filter(Q=>Q[1].packageData.status!=="canceled"&&!h(Q[1])&&Q[1].packageData.end!==null).sort((Q,ve)=>ye(Q[1].packageData.end,"YYYY-MM-DD HH:mm:ss").diff(ye(ve[1].packageData.end,"YYYY-MM-DD HH:mm:ss"),"minutes"));if(b.value=[...Ae,...me,...K,...ie],T.value=[...Ae,...me,...K,...ie],!(j.packages.length||j.services.length||j.providers.length||j.locations.length)){let Q=[],ve=[],X=[],F=[];b.value.forEach(Z=>{let W=e.getters["entities/getPackageEntities"](Z[1].packageData.id);Q=Q.concat(W.services),ve=ve.concat(W.providers),X=X.concat(W.locations),F=F.concat(W.packages)}),e.dispatch("cabinetFilters/injectServiceOptions",Q.filter((Z,W,le)=>le.indexOf(Z)===W)),e.dispatch("cabinetFilters/injectProviderOptions",ve.filter((Z,W,le)=>le.indexOf(Z)===W)),e.dispatch("cabinetFilters/injectLocationOptions",X.filter((Z,W,le)=>le.indexOf(Z)===W)),e.dispatch("cabinetFilters/injectPackagesOptions",F.filter((Z,W,le)=>le.indexOf(Z)===W))}}).catch(ne=>{console.log(ne)}).finally(()=>{e.commit("cabinet/setPackageLoading",!1),G&&"message"in G&&(f.value=!0,g.value=G.message,s.value&&d.value&&setTimeout(function(){dt(s.value,d.value.$el,0,300)},500))})}function E(G){f.value=!0,g.value=G.message,_.value="error",s.value&&d.value&&setTimeout(function(){dt(s.value,d.value.$el,0,300)},500)}Be("packageSelection",{selectedPackageCustomerId:P});let T=M([]);rt(()=>a.loadBookingsCounter,()=>{S()}),Je(()=>{S()});let w=v(()=>({list:{template:Ge(Hk),props:{packages:b.value,responsiveClass:u.value},handlers:{click:z}},item:{template:Ge(uC),props:{data:P.value?b.value.find(G=>G[0]===P.value)[1]:{},responsiveClass:u.value,pageWidth:l.value},handlers:{goBack:N,booked:S,canceled:S,cancelError:E}}})),B=M("list");function z(G){P.value=G,B.value="item"}function N(){P.value=null,B.value="list"}return(G,se)=>(c(),y("div",{ref_key:"pageContainer",ref:s,class:"am-cap"},[t(f)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:d,type:t(_),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:C,onTriggerClose:C},{title:x(()=>[dC,ce(" "+k(t(g)),1)]),_:1},8,["type"])):D("",!0),zt(A(Ai,{"step-key":"packages","responsive-class":t(u),onChangeFilters:L},null,8,["responsive-class"]),[[To,t(B)==="list"]]),t(I)?(c(),U(Ii,{key:2})):(c(),U(pt(t(w)[t(B)].template),St({key:1},t(w)[t(B)].props,ri(t(w)[t(B)].handlers)),null,16))],512))}});const gC=m("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),fC=m("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),hC=["href"],vC={class:"am-fs-sb__page-wrapper am-fs-sb__page-wrapper__cabinet"},_C=["onClick"],yC={class:"am-fs-sb__page-icon"},bC={key:1,class:"am-fs-sb__page-divider"},kC={class:"am-fs-sb__page-inner"},CC=m("div",{class:"am-fs-sb__page-icon"},[m("span",{class:"am-icon-dashboard"})],-1),xC=m("div",{class:"am-fs-sb__page-divider"},null,-1),wC={class:"am-fs-sb__page-inner"},TC=m("div",{class:"am-fs-sb__page-icon"},[m("span",{class:"am-icon-logout"})],-1),EC={class:"am-caph"},LC={class:"am-caph__text"},SC=m("span",{class:"am-icon-menu"},null,-1),AC=[SC],IC={name:"CustomerPanel"},PC=Object.assign(IC,{setup(n){const a=Dl().cookies,e=Ne();let s=v(()=>e.getters.getIsRtl);const l=R("shortcodeData");let i=v(()=>e.getters["auth/getAuthenticated"]);rt(i,ae=>{ae&&(e.commit("auth/setNewPassword",""),e.commit("auth/setConfirmPassword",""))});let o=M(l.value.cabinetType==="employee"?"provider":"customer");Be("cabinetType",o);let r=R("licence"),u=v(()=>o.value==="provider"?"cape":"capc");Be("originKey",u);let d=M(null),{width:f}=ja(d);Be("containerWidth",f);const _=R("settings");let g=M(l.value.appointments||!l.value.events?"appointments":"events");const C=v(()=>_.customizedData&&u.value in _.customizedData?_.customizedData[u.value]:Ll[u.value]);Be("amCustomize",C);const O=M(_.customizedData?_.customizedData.fonts:Ll.fonts);Be("amFonts",O);const I=R("labels");Be("amLabels",I);const b=R("localLanguage");let P=v(()=>_.general.usedLanguages.includes(b.value)),L=v(()=>{let ae=Qe({...I});return _.customizedData&&Object.keys(C.value).forEach(xe=>{if(xe!=="colors"&&C.value[xe].translations){let _e=C.value[xe].translations;Object.keys(_e).forEach(pe=>{_e[pe][b.value]&&P.value?ae[pe]=_e[pe][b.value]:_e[pe].default&&(ae[pe]=_e[pe].default)})}}),ae});function $(){let ae=document.head||document.getElementsByTagName("head")[0];ae.querySelector("#amCustomFont")&&ae.querySelector("#amCustomFont").remove();let xe="@font-face {font-family: 'comic'; src: url(http://localhost/amelia-test/wp-content/uploads/amelia/fonts/comic.woff);}",_e=document.createElement("style");ae.appendChild(_e),_e.setAttribute("type","text/css"),_e.setAttribute("id","amCustomFont"),_e.appendChild(document.createTextNode(xe))}O.value.customFontSelected&&$();let h=v(()=>g.value==="packages"?C.value.packagesList.options:C.value[g.value].options),S=v(()=>{let ae=g.value;return o.value==="customer"?ae!=="profile"?h.value.timeZone.visibility:!0:ae==="appointments"||ae==="events"?h.value.timeZone.visibility:!0}),E=M(!1),T=M(!1);Be("sidebarCollapsed",ic(T));let w=M("");rt(T,ae=>{ae?setTimeout(()=>{w.value="am-collapsed"},1e3):w.value=""});let B=M(null),z=M(0),N=v(()=>f.value>480);Je(()=>{B.value&&setTimeout(()=>{z.value=B.value.offsetHeight},200),setTimeout(()=>{T.value=f.value<=600?!0:C.value.sidebar.options.toggle.visibility},1300)});const G=()=>{f.value<=600?T.value=!0:T.value=C.value.sidebar.options.toggle.visibility};window.addEventListener("resize",G),rt(f,ae=>{E.value=ae>481?!1:E.value});const se=v(()=>e.getters["entities/getReady"]);rt(se,ae=>{if(ae){if(l.value.cabinetType==="employee"&&e.getters["employee/getId"]){let xe=e.getters["employee/getEmployee"];e.commit("employee/setServiceList",bo(e,xe.serviceList)),e.commit("entities/setEmployees",[e.getters["entities/getEmployee"](e.getters["employee/getId"])])}e.dispatch("cabinetFilters/injectServiceOptions",e.getters["entities/getServices"].map(xe=>xe.id)),e.dispatch("cabinetFilters/injectProviderOptions",o.value==="customer"?e.getters["entities/getEmployees"].map(xe=>xe.id):[]),e.dispatch("cabinetFilters/injectLocationOptions",e.getters["entities/getLocations"].map(xe=>xe.id))}});const j=R("baseUrls");let ne=["employees","categories","locations","packages","entitiesRelations","customFields"];l.value.cabinetType==="employee"&&(ne=ne.concat(["taxes","spaces","tags","settings"])),e.dispatch("entities/getEntities",{types:ne,licence:"basic",loadEntities:!0,showHidden:!0,isPanel:!0});let te=v(()=>e.getters.getReady),oe=M({profile:Ge(l.value.cabinetType==="employee"?Ff:Hu)});(l.value.appointments||!l.value.events)&&(oe.value.appointments=Ge(_b)),(l.value.events||!l.value.appointments)&&(oe.value.events=Ge(Ok)),(l.value.appointments||!l.value.events)&&(r.isPro||r.isDeveloper)&&(oe.value.packages=Ge(pC));const ie=M([{key:"profile",icon:"user",pageLabel:L.value.my_profile,label:v(()=>u.value==="cape"?`${e.getters["auth/getProfile"].firstName} ${e.getters["auth/getProfile"].lastName}`:C.value.profile.options.lastName.visibility?`${e.getters["auth/getProfile"].firstName} ${e.getters["auth/getProfile"].lastName}`:`${e.getters["auth/getProfile"].firstName}`)}]);(l.value.appointments||!l.value.events)&&ie.value.push({key:"appointments",icon:"service",label:L.value.appointments}),(l.value.events||!l.value.appointments)&&ie.value.push({key:"events",icon:"star-outline",label:L.value.events}),l.value.cabinetType==="customer"&&(l.value.appointments||!l.value.events)&&(r.isPro||r.isDeveloper)&&ie.value.push({key:"packages",icon:"shipment",label:L.value.packages}),Be("sidebarSteps",ie),Je(()=>{K.value=ie.value.findIndex(ae=>ae.key===g.value)});let K=M(0);function me(ae,xe){l.value.cabinetType==="employee"&&(ae.key!=="appointments"&&(e.commit("appointment/resetAppointment",{providerId:e.getters["auth/getProfile"].id,categoryId:null,serviceId:null,locationId:null}),e.commit("customerInfo/setCustomers",[]),e.commit("customerInfo/setCustomersIds",[])),ae.key!=="events"&&(e.commit("event/setEvent",{settings:ys(_,e.getters["event/getSettings"],{},{})}),e.commit("attendee/setAttendee",fs(e,e.getters["attendee/getDefaultAttendee"])))),g.value=ae.key,K.value=xe,e.commit("cabinetFilters/setResetFilters")}function Ae(ae){l.value.cabinetType==="employee"&&l.value.profile&&ae.step.key==="profile"||(me(ae.step,ae.index),e.commit("cabinetFilters/setResetFilters"))}function Ve(){e.dispatch("auth/logout")}function Q(){E.value=!1,Ve()}let ve=M(0);function X(){ve.value++}let F=v(()=>{switch(ie.value[K.value].key){case"profile":return ie.value[K.value].pageLabel;case"appointments":return e.getters["appointment/getActive"]&&!e.getters["appointment/getId"]?L.value.new_appointment:e.getters["appointment/getActive"]&&e.getters["appointment/getId"]?L.value.edit_appointment:ie.value[K.value].label;case"events":return e.getters["attendee/getActive"]&&!e.getters["attendee/getId"]?L.value.event_add_attendee:e.getters["attendee/getActive"]&&e.getters["attendee/getId"]?L.value.event_edit_attendee:e.getters["event/getActive"]&&!e.getters["event/getId"]?L.value.new_event:e.getters["event/getActive"]&&e.getters["event/getId"]?L.value.edit_event:ie.value[K.value].label;default:return ie.value[K.value].label}});Be("bookingsCounterChanger",{bookingsCounterChanger:X});const Z=R("timeZone");Zs(()=>{if(!_.general.showClientTimeZone){let ae=Z.value;a.get("ameliaUserTimeZone")&&(ae=a.get("ameliaUserTimeZone")),e.commit("cabinet/setTimeZone",ae)}e.getters["cabinet/getTimeZone"]||e.commit("cabinet/setTimeZone",Us())});let W=v(()=>C.value.colors);Be("amColors",W);let le=v(()=>({"--am-c-primary":W.value.colorPrimary,"--am-c-success":W.value.colorSuccess,"--am-c-error":W.value.colorError,"--am-c-warning":W.value.colorWarning,"--am-c-main-bgr":W.value.colorMainBgr,"--am-c-main-heading-text":W.value.colorMainHeadingText,"--am-c-main-text":W.value.colorMainText,"--am-c-main-text-op10":H(W.value.colorMainText,.1),"--am-c-sb-bgr":W.value.colorSbBgr,"--am-c-sb-text":W.value.colorSbText,"--am-c-inp-bgr":W.value.colorInpBgr,"--am-c-inp-border":W.value.colorInpBorder,"--am-c-inp-text":W.value.colorInpText,"--am-c-inp-placeholder":W.value.colorInpPlaceHolder,"--am-c-drop-bgr":W.value.colorDropBgr,"--am-c-drop-text":W.value.colorDropText,"--am-c-btn-prim":W.value.colorBtnPrim,"--am-c-btn-prim-text":W.value.colorBtnPrimText,"--am-c-btn-sec":W.value.colorBtnSec,"--am-c-btn-sec-text":W.value.colorBtnSecText,"--am-c-btn-danger":W.value.colorBtnDanger,"--am-c-btn-danger-text":W.value.colorBtnDangerText,"--am-c-skeleton-op20":H(W.value.colorMainText,.2),"--am-c-skeleton-op60":H(W.value.colorMainText,.6),"--am-c-skeleton-sb-op20":H(W.value.colorSbText,.2),"--am-c-skeleton-sb-op60":H(W.value.colorSbText,.6),"--am-c-scroll-op30":H(W.value.colorPrimary,.3),"--am-c-scroll-op10":H(W.value.colorPrimary,.1),"--am-font-family":O.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px","--am-mw-main":N.value?T.value?"858px":"1024px":"520px","--am-brad-main":N.value?"0 0.5rem 0.5rem 0":"0.5rem"})),de=v(()=>({"--am-c-msd-bgr":W.value.colorSbBgr,"--am-c-msd-text":W.value.colorSbText,"--am-c-msd-text-op05":H(W.value.colorSbText,.05),"--am-c-msd-text-op10":H(W.value.colorSbText,.1),"--am-c-msd-text-op60":H(W.value.colorSbText,.6)}));return(ae,xe)=>(c(),y(ee,null,[O.value.customFontSelected?D("",!0):(c(),y(ee,{key:0},[gC,fC,m("link",{rel:"stylesheet",type:"text/css",href:`${t(j).wpAmeliaPluginURL}v3/src/assets/scss/common/fonts/font.css`,media:"all"},null,8,hC)],64)),m("div",{id:"amelia-container",ref_key:"ameliaContainer",ref:d,class:q(["am-cap__wrapper",[{"am-collapsed":t(T)},{"am-auth":!t(i)}]]),style:Ce(t(le))},[t(i)?D("",!0):(c(),U(Fu,{key:0})),t(i)?(c(),y(ee,{key:1},[t(N)?(c(),U(oc,{key:0,class:q(["am-fs-sb",[{"am-collapsed":t(T)},{"am-rtl":t(s)}]]),style:Ce({width:t(T)?"72px":"240px",paddingBottom:`${t(z)+16}px`})},{"step-list":x(()=>[m("div",vC,[(c(!0),y(ee,null,fe(ie.value,(_e,pe)=>(c(),y(ee,{key:_e.key},[_e.key!=="packages"||t(e).getters["entities/getPackages"].length?(c(),y("div",{key:0,class:q(["am-fs-sb__page",{selected:t(g)===_e.key}]),style:Ce({"pointer-events":t(l).cabinetType==="employee"&&t(l).profile&&_e.key==="profile"?"none":""}),onClick:()=>{t(l).cabinetType==="employee"&&t(l).profile&&_e.key==="profile"||me(_e,pe)}},[m("div",{class:q(["am-fs-sb__page-inner",{"am-collapsed":t(T)}])},[m("div",yC,[m("span",{class:q(`am-icon-${_e.icon}`)},null,2)]),A(ga,{name:"fade"},{default:x(()=>[t(T)?D("",!0):(c(),y("p",{key:0,class:q(["am-fs-sb__page-heading",[t(w),{"am-rtl":t(s)}]])},k(_e.label),3))]),_:2},1024),A(ga,{name:"fade"},{default:x(()=>[t(T)?D("",!0):(c(),y("div",{key:0,class:q(["am-fs-sb__page-indicator",[t(w),{"am-rtl":t(s)}]])},[m("span",{class:q(t(s)?"am-icon-arrow-big-left":"am-icon-arrow-big-right")},null,2)],2))]),_:1})],2)],14,_C)):D("",!0),pe===0&&ie.value[0].key==="profile"?(c(),y("div",bC)):D("",!0)],64))),128))])]),"support-info":x(()=>[m("div",{ref_key:"sidebarFooterRef",ref:B,class:"am-fs-sb__footer"},[m("div",{class:"am-fs-sb__page",onClick:xe[0]||(xe[0]=_e=>we(T)?T.value=!t(T):T=!t(T))},[m("div",kC,[CC,A(ga,{name:"fade"},{default:x(()=>[t(T)?D("",!0):(c(),y("p",{key:0,class:q(["am-fs-sb__page-heading",t(w)])},k(t(L).toggle_sidebar),3))]),_:1})])]),xC,m("div",{class:"am-fs-sb__page",onClick:Ve},[m("div",wC,[TC,A(ga,{name:"fade"},{default:x(()=>[t(T)?D("",!0):(c(),y("p",{key:0,class:q(["am-fs-sb__page-heading",t(w)])},k(t(L).log_out),3))]),_:1})])])],512)]),_:1},8,["class","style"])):D("",!0),A(rc,{"max-width":786,"old-responsive":!1},{header:x(()=>[A(gc,{ready:t(te)},{default:x(()=>[m("div",EC,[m("div",LC,k(t(F)),1),t(N)?D("",!0):(c(),y("div",{key:0,class:"am-caph__menu",onClick:xe[1]||(xe[1]=()=>we(E)?E.value=!t(E):E=!t(E))},AC)),t(se)&&t(N)&&t(S)?(c(),U(zn,{key:1})):D("",!0),A(Mc,{"menu-items":ie.value,monitor:t(g),visibility:t(E),"custom-css":t(de),"customized-labels":t(L),position:"right",width:240,"onUpdate:visibility":xe[2]||(xe[2]=_e=>we(E)?E.value=_e:E=_e),onClick:Ae,onLogout:Q},null,8,["menu-items","monitor","visibility","custom-css","customized-labels"])])]),_:1},8,["ready"])]),step:x(()=>[(c(),U(pt(t(oe)[t(g)]),{class:"am-fs__main-content","load-bookings-counter":t(ve)},null,8,["load-bookings-counter"]))]),_:1})],64)):D("",!0)],6)],64))}});var RC=Object.freeze(Object.defineProperty({__proto__:null,default:PC},Symbol.toStringTag,{value:"Module"}));export{RC as C,lt as _,yc as a,Yt as b,wc as c,gc as d,Mc as e,OC as f,DC as g,Vt as h,na as i,dc as j,Io as u};
