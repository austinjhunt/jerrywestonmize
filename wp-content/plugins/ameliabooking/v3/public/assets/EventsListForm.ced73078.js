var wt=Object.defineProperty,Bt=Object.defineProperties;var Tt=Object.getOwnPropertyDescriptors;var at=Object.getOwnPropertySymbols;var Dt=Object.prototype.hasOwnProperty,It=Object.prototype.propertyIsEnumerable;var ot=(I,a,t)=>a in I?wt(I,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):I[a]=t,_e=(I,a)=>{for(var t in a||(a={}))Dt.call(a,t)&&ot(I,t,a[t]);if(at)for(var t of at(a))It.call(a,t)&&ot(I,t,a[t]);return I},Fe=(I,a)=>Bt(I,Tt(a));import{j as p,k as o,aZ as he,z as ne,l as L,o as n,c as m,a as l,b as e,n as R,t as v,g as w,bJ as Lt,bK as Ot,bL as Ae,m as oe,f as de,F as N,h as z,w as U,_ as je,p as F,s as fe,r as me,au as Ye,av as He,u as re,aY as nt,y as $e,d as st,A as Ie,D as Me,a8 as ye,ah as _t,ai as lt,aK as Ft,a5 as Ue,e as H,al as it,an as Ke,bN as zt,bz as vt,aR as Re,a2 as Se,b3 as Mt,b4 as Rt,aV as Vt,cg as be,ch as gt,ci as We,cj as Be,ck as Te,bj as Ge,b0 as ft,aq as Ee,ar as we,a1 as yt,q as Ve,b2 as bt,a_ as ht,aS as rt,ac as Le,bf as et,C as qe,cl as At,bE as jt,cm as Wt,bG as Nt,cn as Ut,aD as qt,co as Yt,cp as Ht,cq as Gt,aU as Jt,B as ue,ao as Zt,aj as Qt,cr as Ze,ba as Je,cs as Xt,E as ve,aI as Kt,ct as ea,v as Qe,cu as ta,cv as aa,cw as ct,ak as oa,aw as na,ax as sa}from"./stepForm.d988e24e.js";import{_ as ut}from"./catalogForm.451efe4c.js";import{u as la,a as Ne,b as ia,c as mt,s as ra,_ as ca,d as ua,e as ma,f as pt,C as pa,g as da,h as _a}from"./customizeForm.43de1a42.js";import{m as Pe,f as ze}from"./customerPanel.2ef43f63.js";const va={class:"am-ec__info"},ga={key:0,class:"am-ec__info-price"},fa={class:"am-ec__info-other"},ya={key:1,class:"am-ec__info-capacity"},ba={class:"am-ec__info-capacity__number"},ha={class:"am-ec__info-capacity__text"},ka={key:0,class:"am-tax"},xa={key:1,class:"am-ec__actions-btn"},Ca={name:"EventCard"},kt=Object.assign(Ca,{props:{event:{type:[Object,Function,Array],required:!0},labels:{type:Object,required:!0},customizedOptions:{type:Object,default:()=>({bookingBtn:{buttonType:"filled"},infoBtn:{buttonType:"plain"},imgTab:{visibility:!0},location:{visibility:!0},price:{visibility:!0},slots:{visibility:!0},status:{visibility:!0}})},tickets:{type:Array,default:()=>[]},locations:{type:Array,required:!0},borderVisibility:{type:Boolean,default:!0},btnVisibility:{type:Boolean,default:!0},autoInfoHeight:{type:Boolean,default:!1},imageVisibility:{type:Boolean,default:!0},verticalOrientation:{type:String,default:"center"},inHeader:{type:Boolean,default:!1},inDialog:{type:Boolean,default:!1},taxVisible:{type:Boolean,default:!1}},emits:["click"],setup(I,{emit:a}){const t=I,i=p("settings");let f=p("containerWidth"),_=p("dialogWidth"),C=o(()=>t.inDialog?_.value:f.value),u=o(()=>he(C.value)),h=o(()=>la(t.event)),y=o(()=>{if(t.event.customPricing){let r=0,d=t.tickets.length?t.tickets:t.event.customTickets;if(t.event.maxCustomCapacity){let c=0;d.forEach(M=>{(!("enabled"in M)||M.enabled)&&(c+=M.sold)}),r=t.event.maxCustomCapacity-c}else d.forEach(c=>{(!("enabled"in c)||c.enabled)&&(r+=c.spots-c.sold-("persons"in c?c.persons:0))});return r}return t.event.places}),O=o(()=>t.event.customPricing?Ne(t.event)?`${t.labels.from} ${ne(ia(t.event))}`:t.labels.event_free:Ne(t.event)?ne(t.event.price):t.labels.event_free);function b(r){a("click",r)}function P(r){let d=[];return r.forEach(c=>{d.push(c.periodStart.split(" ")[0]),d.push(c.periodEnd.split(" ")[0])}),!d.every(c=>c===d[0])}let s=p("amColors"),k=o(()=>C.value<=500?`0px 2px 2px -1px ${s.value.colorCardBorder}, 0px 0px 11px ${L(s.value.colorCardBorder,.3)}, inset 0px -8px 0px ${t.event.color}`:`0px 2px 2px -1px ${s.value.colorCardBorder}, 0px 0px 11px ${L(s.value.colorCardBorder,.3)}, inset 8px 0px 0px ${t.event.color}`),x=o(()=>{let r={boxShadow:k.value,"--am-c-ec-success":s.value.colorSuccess,"--am-c-ec-primary":s.value.colorPrimary,"--am-c-ec-warning":s.value.colorWarning,"--am-c-ec-bgr":t.inHeader?s.value.colorMainBgr:s.value.colorCardBgr,"--am-c-ec-text":t.inHeader?s.value.colorMainText:s.value.colorCardText,"--am-c-ec-text-op90":L(t.inHeader?s.value.colorMainText:s.value.colorCardText,.9),"--am-c-ec-text-op80":L(t.inHeader?s.value.colorMainText:s.value.colorCardText,.8),"--am-c-ec-text-op50":L(t.inHeader?s.value.colorMainText:s.value.colorCardText,.5),"--am-c-ec-error-op70":L(s.value.colorError,.7),"--am-h-ec-info":t.autoInfoHeight?"unset":"84px","--am-vo-ec":t.verticalOrientation,"--am-fs-ec-title":t.inHeader?"18px":"16px"};return t.borderVisibility||delete r.boxShadow,r});return(r,d)=>(n(),m("div",{class:R(["am-ec",[{"am-no-border":!e(t).borderVisibility},e(u)]]),style:oe(e(x))},[l("div",{class:R(["am-ec__period",e(u)])},[P(e(t).event.periods)&&(e(h)==="open"||e(h)==="upcoming")?(n(),m("p",{key:0,class:R(["am-ec__period-text",e(u)])},v(e(t).labels.event_begins),3)):w("",!0),l("p",{class:R(["am-ec__period-date",e(u)])},[l("span",{class:R(["am-ec__period-date__day",[{"am-ghost":e(h)==="canceled"||e(h)==="closed"},e(u)]])},v(e(Lt)(e(t).event.periods[0].periodStart.split(" ")[0])),3),l("span",{class:R(["am-ec__period-date__month",[{"am-ghost":e(h)==="canceled"||e(h)==="closed"},e(u)]])},v(e(Ot)(e(t).event.periods[0].periodStart.split(" ")[0])),3)],2),l("p",{class:R(["am-ec__period-time",[{"am-ghost":e(h)==="canceled"||e(h)==="closed"},e(u)]])},v(e(Ae)(e(t).event.periods[0].periodStart.split(" ")[1])),3)],2),e(t).event.gallery.length&&e(t).imageVisibility&&e(t).customizedOptions.imgTab.visibility?(n(),m("div",{key:0,class:R(["am-ec__image",e(u)]),style:oe({backgroundImage:`url(${e(t).event.gallery[0].pictureFullPath})`})},null,6)):w("",!0),l("div",va,[l("p",{class:R(["am-ec__info-name",{"am-ghost":e(h)==="canceled"||e(h)==="closed"}])},v(e(t).event.name),3),I.inHeader&&e(C)<=500&&e(t).customizedOptions.price.visibility?(n(),m("p",ga,[de(v(e(O))+" ",1),e(Ne)(e(t).event)&&e(t).taxVisible?(n(),m(N,{key:0},[e(i).payments.taxes.excluded?(n(),m(N,{key:0},[de(v(`+${e(t).labels.total_tax_colon}`),1)],64)):(n(),m(N,{key:1},[de(v(e(t).labels.incl_tax),1)],64))],64)):w("",!0)])):w("",!0),e(t).customizedOptions.location.visibility&&e(mt)(e(t).event,I.locations)?(n(),m("p",{key:1,class:R(["am-ec__info-location",{"am-ghost":e(h)==="canceled"||e(h)==="closed"}])},v(e(mt)(e(t).event,I.locations)),3)):w("",!0),l("div",fa,[e(t).customizedOptions.status.visibility?(n(),m("p",{key:0,class:R(`am-ec__info-availability ${e(h)}`)},v(e(t).labels[e(h)]),3)):w("",!0),e(t).customizedOptions.slots.visibility&&e(ra)(e(h))?(n(),m("p",ya,[l("span",ba,v(e(y)),1),l("span",ha,v(e(y)===1?` ${e(t).labels.event_slot_left}`:` ${e(t).labels.event_slots_left}`),1)])):w("",!0)])]),!I.inHeader||e(C)>500?(n(),m("div",{key:1,class:R(["am-ec__actions",[{"am-vertical-center":!e(t).customizedOptions.price.visibility},e(u)]])},[e(t).customizedOptions.price.visibility?(n(),m("div",{key:0,class:R(["am-ec__actions-price",e(u)])},[l("p",null,v(e(O)),1),e(Ne)(e(t).event)&&e(t).taxVisible?(n(),m("p",ka,[e(i).payments.taxes.excluded?(n(),m(N,{key:0},[de(v(`+${e(t).labels.total_tax_colon}`),1)],64)):(n(),m(N,{key:1},[de(v(e(t).labels.incl_tax),1)],64))])):w("",!0)],2)):w("",!0),e(t).btnVisibility?(n(),m("p",xa,[z(je,{size:e(C)>500?"small":"medium",type:e(h)!=="open"?e(t).customizedOptions.infoBtn.buttonType:e(t).customizedOptions.bookingBtn.buttonType,onClick:d[0]||(d[0]=c=>b(e(t).event.id))},{default:U(()=>[de(v(e(h)!=="open"?e(t).labels.event_learn_more:e(t).labels.event_read_more),1)]),_:1},8,["size","type"])])):w("",!0)],2)):w("",!0)],6))}});const Pa={name:"EventListSkeleton"},xt=Object.assign(Pa,{props:{displayNumber:{type:Number,required:!0}},setup(I){const a=I;let t=F(null),i=F(0);window.addEventListener("resize",f);function f(){t.value&&(i.value=t.value.offsetWidth)}fe(()=>{t.value&&(i.value=t.value.offsetWidth)});let _=o(()=>i.value<=500?"am-w100":i.value<=600?"am-w50":i.value<=768?"am-w33":"");return(C,u)=>{const h=He,y=Ye;return n(),m("div",{ref_key:"amSkeletonContainer",ref:t,class:"am-skeleton-evl__wrapper"},[z(y,{animated:"",class:"am-skeleton-evl"},{template:U(()=>[(n(!0),m(N,null,me(new Array(e(a).displayNumber),O=>(n(),m("div",{key:O,class:R(["am-skeleton-evl__item",e(_)])},[z(h,{class:"am-skeleton-evl__item-inner",variant:"text"})],2))),128))]),_:1})],512)}}});const $a=l("span",{class:"am-icon-search-close"},null,-1),Sa={name:"EmptyState"},Ea=Object.assign(Sa,{setup(I){let a=p("labels"),t=p("amColors"),i=o(()=>({"--am-c-ev-empty-text-op60":L(t.value.colorMainText,.6),"--am-c-ev-empty-text":t.value.colorMainText}));return(f,_)=>(n(),m("div",{class:"am-ev-empty",style:oe(e(i))},[$a,l("p",null,v(e(a).no_results),1)],4))}});const wa={key:0,class:"am-els__available"},Ba={key:1,class:"am-els__filters"},Ta={class:"am-els__filters-top"},Da={class:"am-els__filters-search"},Ia={class:"am-els__filters-menu__btn"},La=l("span",{class:"am-icon-filter"},null,-1),Oa={key:0},Fa={key:0,class:"am-els__wrapper"},za={key:2,class:"am-els__pagination"},Ma={class:"am-els__pagination-info"},Ra={name:"EventsList",key:"eventsList"},Va=Object.assign(Ra,{setup(I){const a=re(),t=p("settings");let i=o(()=>a.getters["shortcodeParams/getShortcodeParams"]),f=o(()=>{let q=i.value.eventId.split(",").filter(g=>g),G=nt(window.location.href),S=G&&G.ameliaEventId?G.ameliaEventId.split(","):[];return q.length===1||S.length===1});fe(()=>{let q=nt(window.location.href);q&&q.ameliaEventPopup&&A(parseInt(q.ameliaEventPopup))});let _=o(()=>a.getters.getLoading),C=p("containerWidth"),u=o(()=>he(C.value)),h=p("customizedDataForm"),y=o(()=>h.value.list.options),O=p("labels");const b=p("localLanguage");let P=o(()=>t.general.usedLanguages.includes(b.value)),s=o(()=>{let q=$e(_e({},O));if(h.value.list.translations){let G=h.value.list.translations;Object.keys(G).forEach(S=>{G[S][b.value]&&P.value?q[S]=G[S][b.value]:G[S].default&&(q[S]=G[S].default)})}return q}),k=o(()=>a.getters["eventEntities/getEvents"]),x=o(()=>k.value.length===0),r=o({get:()=>a.getters["pagination/getPage"],set:q=>{a.commit("pagination/setPage",q)}}),d=o(()=>a.getters["pagination/getCount"]),c=o(()=>a.getters["pagination/getShow"]);function M(){a.commit("setLoading",!0),a.dispatch("eventEntities/requestEvents")}let V=st({components:{IconComponent:ut},template:'<IconComponent icon="filter"/>'}),X=o(()=>a.getters["eventEntities/getFilteredLocations"](a.getters["params/getShortcodeParams"])),j=o(()=>a.getters["eventEntities/getFilteredTags"](a.getters["params/getShortcodeParams"])),D=o(()=>{let q=a.getters["params/getShortcodeParams"].tags&&a.getters["params/getShortcodeParams"].tags.length===1,G=j.value.length,S=a.getters["params/getShortcodeParams"].locations&&a.getters["params/getShortcodeParams"].locations.length===1,g=X.value.length,E=!q&&G>0,B=!S&&g>0,$={tag:"am-mw33",location:"am-mw33",date:"am-mw33"};return E||($.location="am-mw60",$.date="am-mw40"),B||($.tag="am-mw60",$.date="am-mw40"),!E&&!B&&($.date="am-mw100"),C.value<=500&&($.tag="am-mw100",$.location="am-mw100",$.date="am-mw100"),$}),T=p("popupVisible");function A(q){T.value=!0,a.commit("setLoading",!0),a.commit("eventBooking/setEventId",q),Ie(a,{},"SelectEvent","event",null,null)}let Z=o({get:()=>a.getters["params/getSearch"],set:q=>{a.commit("params/setSearch",q)}}),Y=st({components:{IconComponent:ut},template:'<IconComponent icon="search"/>'}),Q=o({get:()=>a.getters["params/getTag"],set:q=>{a.commit("params/setTag",q)}}),W=o({get:()=>a.getters["params/getLocationIdParam"],set:q=>{a.commit("params/setLocationIdParam",q)}}),pe=o(()=>a.getters["params/getDates"]),ee=F(null);Me([Z,Q,W,pe],()=>{a.commit("setLoading",!0),clearTimeout(ee.value),ee.value=setTimeout(()=>{a.commit("pagination/setPage",1),a.dispatch("eventEntities/requestEvents")},1e3)});let J=F(!1),se=p("amColors"),ke=o(()=>({"--am-c-els-text-op10":L(se.value.colorMainText,.1),"--am-c-els-text-op25":L(se.value.colorMainText,.25),"--am-c-els-text-op60":L(se.value.colorMainText,.6)}));return(q,G)=>(n(),m("div",{class:"am-els",style:oe(e(ke))},[e(y).header.visibility&&!e(f)?(n(),m("div",wa,v(`${e(d)} ${e(d)===1?e(s).event_available:e(s).events_available}`),1)):w("",!0),e(y).filters.visibility&&!e(f)?(n(),m("div",Ba,[l("div",Ta,[l("div",Da,[z(_t,{modelValue:e(Z),"onUpdate:modelValue":G[0]||(G[0]=S=>ye(Z)?Z.value=S:Z=S),placeholder:`${e(s).event_search}...`,"icon-start":e(Y)},null,8,["modelValue","placeholder","icon-start"])]),l("div",Ia,[z(je,{icon:e(V),"icon-only":e(C)<=500,"custom-class":"am-els__filters-menu__btn-inner",category:"secondary",type:e(y).filterBtn.buttonType,onClick:G[1]||(G[1]=S=>ye(J)?J.value=!e(J):J=!e(J))},{default:U(()=>[La,e(C)>500?(n(),m("span",Oa,v(e(s).event_filters),1)):w("",!0)]),_:1},8,["icon","icon-only","type"])])]),z(Ue,{name:"am-slide-fade"},{default:U(()=>[e(J)?(n(),m("div",{key:0,class:R(["am-els__filters-menu",e(u)])},[(!e(a).getters["params/getShortcodeParams"].tags||e(a).getters["params/getShortcodeParams"].tags.length!==1)&&e(j).length>0?(n(),m("div",{key:0,class:R(["am-els__filters-menu__items",[e(u),e(D).tag]])},[z(lt,{modelValue:e(Q),"onUpdate:modelValue":G[2]||(G[2]=S=>ye(Q)?Q.value=S:Q=S),filterable:"",clearable:"",placeholder:e(s).event_type},{default:U(()=>[(n(!0),m(N,null,me(e(j),(S,g)=>(n(),H(it,{key:g,value:S.name,label:S.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])],2)):w("",!0),(!e(a).getters["params/getShortcodeParams"].locations||e(a).getters["params/getShortcodeParams"].locations.length!==1)&&e(X).length>0?(n(),m("div",{key:1,class:R(["am-els__filters-menu__items",[e(u),e(D).location]])},[z(lt,{modelValue:e(W),"onUpdate:modelValue":G[3]||(G[3]=S=>ye(W)?W.value=S:W=S),filterable:"",clearable:"",placeholder:e(s).event_location},{default:U(()=>[(n(!0),m(N,null,me(e(X),S=>(n(),H(it,{key:S.id,value:S.id,label:S.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])],2)):w("",!0),l("div",{class:R(["am-els__filters-menu__items",[e(u),e(D).date]])},[z(Ft,{"existing-date":e(pe),presistant:!1,disabled:!1,onSelectedDate:G[4]||(G[4]=S=>{e(a).commit("params/setDates",S)})},null,8,["existing-date"])],2)],2)):w("",!0)]),_:1})])):w("",!0),e(x)?w("",!0):(n(),m(N,{key:2},[e(_)?(n(),H(xt,{key:1,"display-number":e(t).general.itemsPerPage},null,8,["display-number"])):(n(),m("div",Fa,[(n(!0),m(N,null,me(e(k),S=>{var g,E;return n(),H(kt,{key:S.id,event:S,labels:e(s),locations:e(X),"customized-options":e(y),"tax-visible":e(Ke)(e(a),S.id,"event")&&((E=(g=e(y).tax)==null?void 0:g.visibility)!=null?E:!0),onClick:A},null,8,["event","labels","locations","customized-options","tax-visible"])}),128))])),e(d)&&Math.ceil(e(d)/e(c))>1?(n(),m("div",za,[l("div",Ma,v(`${e(s).event_page} ${e(r)} / ${Math.ceil(e(d)/e(c))}`),1),z(ca,{"current-page":e(r),"onUpdate:current-page":G[5]||(G[5]=S=>ye(r)?r.value=S:r=S),"page-count":Math.ceil(e(d)/e(c)),total:e(d),"page-size":e(c),layout:"prev, pager, next","hide-on-single-page":!0,onCurrentChange:M},null,8,["current-page","page-count","total","page-size"])])):w("",!0)],64)),e(x)?(n(),H(Ea,{key:3})):w("",!0)],4))}});const Aa={name:"EventInfoSkeleton"};function ja(I,a,t,i,f,_){const C=He,u=Ye;return n(),H(u,{animated:"",class:"am-efi-skel"},{template:U(()=>[z(C,{class:"am-efi-skel__heading",variant:"text"}),l("div",null,[z(C,{class:"am-efi-skel__tab",variant:"text"}),z(C,{class:"am-efi-skel__tab",variant:"text"})]),z(C,{class:"am-efi-skel__text",variant:"text"})]),_:1})}var Wa=zt(Aa,[["render",ja]]);const Na={class:"am-ct__info"},Ua={class:"am-ct__info-name"},qa={class:"am-ct__info-spots"},Ya={key:0,class:"am-ct__info-spots__price"},Ha={key:1,class:"am-ct__info-spots__number"},Ga={key:2,class:"am-ct__info-spots__text"},Ja={key:0,class:"am-ct__action-price"},Za={name:"EventTicket"},Ct=Object.assign(Za,{props:{customizedLabels:{type:Object,required:!0},ticket:{type:Object},capacity:{type:Number},extraPeople:{type:Number},readOnly:{type:Boolean,default:!1},inDialog:{type:Boolean,default:!1}},setup(I){const a=I,t=re();let i=p("containerWidth"),f=p("dialogWidth"),_=o(()=>a.inDialog?f.value:i.value),C=o(()=>he(_.value)),u=o(()=>t.getters["eventEntities/getEvent"](t.getters["eventBooking/getSelectedEventId"])),h=o({get:()=>t.getters["tickets/getTicketNumber"](a.ticket.id),set:x=>{let r={id:a.ticket.id,numb:x||0};t.commit("tickets/setTicketNumber",r)}}),y=o(()=>{if(a.extraPeople){if(a.capacity)return a.extraPeople+1-(t.getters["tickets/getEventGlobalSpots"]-h.value);let x=a.extraPeople+1-(t.getters["tickets/getEventGlobalSpots"]-h.value);return x>=a.ticket.spots-a.ticket.sold?a.ticket.spots-a.ticket.sold:x}return a.capacity?a.capacity-(t.getters["tickets/getEventGlobalSpots"]-h.value):a.ticket.spots-a.ticket.sold}),O=o(()=>u.value.bringingAnyone?y.value<=0:u.value.maxCustomCapacity?t.getters["tickets/getEventGlobalSpots"]!==h.value:t.getters["tickets/getEventGlobalSpots"]!==h.value||a.ticket.spots===a.ticket.sold);function b(x,r){(a.capacity||a.extraPeople||!u.value.bringingAnyone)&&t.commit("tickets/setEventGlobalSpots",x-r)}let P=p("amFonts"),s=p("amColors"),k=o(()=>({"--am-c-font-family":P.value.fontFamily,"--am-c-ct-primary":s.value.colorPrimary,"--am-c-ct-bgr":s.value.colorMainBgr,"--am-c-ct-text":s.value.colorMainText,"--am-c-ct-text-op90":L(s.value.colorMainText,.9),"--am-c-ct-text-op80":L(s.value.colorMainText,.8),"--am-c-ct-text-op70":L(s.value.colorMainText,.7),"--am-c-ct-text-op60":L(s.value.colorMainText,.6),"--am-c-ct-text-op20":L(s.value.colorMainText,.2)}));return(x,r)=>(n(),m("div",{class:R(["am-ct",[{"am-readonly":a.readOnly},e(C)]]),style:oe(e(k))},[l("div",Na,[l("p",Ua,v(a.ticket.name),1),l("p",qa,[e(_)<=500?(n(),m("span",Ya,v(e(ne)(a.ticket.price)),1)):w("",!0),a.capacity?w("",!0):(n(),m("span",Ha,v(a.ticket.spots-a.ticket.sold-e(h)),1)),a.capacity?w("",!0):(n(),m("span",Ga,v(a.ticket.spots-a.ticket.sold-e(h)===1?` ${a.customizedLabels.event_ticket_left}`:` ${a.customizedLabels.event_tickets_left}`),1))])]),l("div",{class:R(["am-ct__action",[{"am-readonly":a.readOnly},e(C)]])},[e(_)>500?(n(),m("p",Ja,v(e(ne)(a.ticket.price)),1)):w("",!0),a.readOnly?w("",!0):(n(),H(vt,{key:1,modelValue:e(h),"onUpdate:modelValue":r[0]||(r[0]=d=>ye(h)?h.value=d:h=d),size:"small",min:0,max:e(u).bringingAnyone?e(y):1,disabled:e(O),onChange:b},null,8,["modelValue","max","disabled"]))],2)],6))}});const Qa={key:0,class:"am-elf__bringing-heading"},Xa={name:"BringingAnyone"},Ka=Object.assign(Xa,{setup(I){let a=re(),t=F({min:a.getters["persons/getMinPersons"],max:a.getters["persons/getMaxPersons"]}),i=o({get:()=>a.getters["persons/getPersons"],set:x=>{a.commit("persons/setPersons",x)}}),f=p("containerWidth"),_=o(()=>he(f.value));const C=p("settings");let u=p("customizedDataForm"),h=p("labels");const y=p("localLanguage");let O=o(()=>C.general.usedLanguages.includes(y.value)),b=o(()=>{let x=$e(_e({},h));if(u.value.bringingAnyone.translations){let r=u.value.bringingAnyone.translations;Object.keys(r).forEach(d=>{r[d][y.value]&&O.value?x[d]=r[d][y.value]:r[d].default&&(x[d]=r[d].default)})}return x}),P=p("amFonts"),s=p("amColors"),k=o(()=>({"--am-font-family":P.value.fontFamily,"--am-bringing-color-border":L(s.value.colorMainText,.25),"--am-bringing-color-text-opacity60":L(s.value.colorMainText,.6)}));return(x,r)=>(n(),m("div",{class:"am-elf__bringing",style:oe(e(k))},[l("div",{class:R(["am-elf__bringing-main",e(_)])},[(n(),m("div",Qa,v(e(b).event_bringing),1)),l("div",{class:R(["am-elf__bringing-content",e(_)])},[z(vt,{modelValue:e(i),"onUpdate:modelValue":r[0]||(r[0]=d=>ye(i)?i.value=d:i=d),min:e(t).min,max:e(t).max,class:R(e(_))},null,8,["modelValue","min","max","class"])],2)],2)],4))}});const eo={class:"am-eli__header"},to={class:"am-eli__main"},ao={key:0,class:"am-eli__timetable am-eli__main-item"},oo={class:"am-eli__timetable-title am-eli__main-title"},no={key:0},so={class:"am-eli__timetable-main__date am-eli__main-text"},lo={class:"am-eli__timetable-main__time am-eli__main-text"},io={name:"EventInfo",key:"info",label:"event_info"},ro=Object.assign(io,{props:{globalClass:{type:String,default:""},inDialog:{type:Boolean,default:!1}},setup(I){const a=I;let{nextStep:t,headerButtonPreviousReset:i,footerButtonReset:f,footerButtonClicked:_,footerBtnDisabled:C}=p("changingStepsFunctions",{nextStep:()=>{},headerButtonPreviousReset:()=>{},footerButtonReset:()=>{},footerButtonClicked:F(!1),footerBtnDisabled:F(!1)});const u=re();let h=o(()=>u.getters.getLoading);const y=p("settings");let O=p("customizedDataForm"),b=o(()=>O.value.info.options),P=p("labels");const s=p("localLanguage");let k=o(()=>y.general.usedLanguages.includes(s.value)),x=o(()=>{let E=$e(_e({},P));if(O.value.info.translations){let B=O.value.info.translations;Object.keys(B).forEach($=>{B[$][s.value]&&k.value?E[$]=B[$][s.value]:B[$].default&&(E[$]=B[$].default)})}return E}),r=o(()=>{let E=$e(_e({},P));if(O.value.bringingAnyone.translations){let B=O.value.bringingAnyone.translations;Object.keys(B).forEach($=>{B[$][s.value]&&k.value?E[$]=B[$][s.value]:B[$].default&&(E[$]=B[$].default)})}return E}),d=o(()=>O.value.bringingAnyone.options),c=o(()=>u.getters["eventEntities/getEvent"](u.getters["eventBooking/getSelectedEventId"])),M=o(()=>u.getters["eventEntities/getLocations"]),V=o(()=>u.getters["eventEntities/getEmployees"]),X=o(()=>{let E=[];c.value.periods.forEach(function($){let le=Pe($.periodStart.split(" ")[0],"YYYY-MM-DD"),ge=Pe($.periodEnd.split(" ")[0],"YYYY-MM-DD"),xe=Pe($.periodStart.split(" ")[1],"HH:mm:ss").format("HH:mm:ss"),ie=Pe($.periodEnd.split(" ")[1],"HH:mm:ss").format("HH:mm:ss");if(ie==="00:00:00"&&(ie="24:00:00",ge.subtract(1,"days")),le.diff(ge,"days")<0){let Oe=[];for(;le.isSameOrBefore(ge);)Oe.push(le.format("YYYY-MM-DD")),le.add(1,"days");Oe.forEach(Ce=>{E.push({id:$.id,start:Ce+" "+xe,end:Ce+" "+ie})})}else E.push({id:$.id,start:le.format("YYYY-MM-DD")+" "+xe,end:ge.format("YYYY-MM-DD")+" "+ie})});let B=[];return E.sort(($,le)=>Pe($.start,"YYYY-MM-DD HH:mm:ss")-Pe(le.start,"YYYY-MM-DD HH:mm:ss")).forEach($=>{B.push({dateOfMonth:Re($.start.split(" ")[0]),timeStart:Ae($.start.split(" ")[1]),timeEnd:Ae($.end.split(" ")[1])})}),B}),j=o(()=>{let E=[],B={};return c.value.periods.forEach($=>{E.push(Pe($.periodStart,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"),Pe($.periodEnd,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"))}),E=E.sort(),B.start=Re(E[0]),B.end=Re(E[E.length-1]),B});const D=F("first");let T=p("eventFluidStepKey");if(c.value.customPricing)T.value.indexOf("eventTickets")<0&&T.value.push("eventTickets");else{let E=T.value.indexOf("eventTickets");E>-1&&T.value.splice(E,1)}let A=o(()=>{let E=c.value.organizerId;return E&&V.value.find(B=>B.id===E)?V.value.find(B=>B.id===E):{}}),Z=o(()=>{let E=[];return c.value.providers.forEach(B=>{V.value.some($=>$.id===B.id)&&(B.badge=V.value.find($=>$.id===B.id).badge,E.push(B))}),c.value.organizerId?E.filter(B=>B.id!==c.value.organizerId):E}),Y=o(()=>c.value.maxCapacity-(c.value.maxCapacity-c.value.places));c.value.maxExtraPeople&&Y.value>c.value.maxExtraPeople?u.commit("persons/setMaxPersons",c.value.maxExtraPeople+1):u.commit("persons/setMaxPersons",Y.value);let Q=o(()=>!c.value.customPricing&&c.value.bringingAnyone&&u.getters["persons/getMinPersons"]!==u.getters["persons/getMaxPersons"]&&Y.value>1),W=F(!1);function pe(){W.value=!1}function ee(){t()}c.value.customPricing&&!u.getters["tickets/getTicketsData"].length&&(u.commit("tickets/setTickets",c.value.customTickets),c.value.maxCustomCapacity&&u.commit("tickets/setMaxCustomCapacity",c.value.maxCustomCapacity)),c.value.maxExtraPeople&&u.commit("tickets/setMaxExtraPeople",c.value.maxExtraPeople);let J=o(()=>u.getters["tickets/getTicketsData"].sort((B,$)=>B.price-$.price));C.value=!c.value.bookable||c.value.full,Se(()=>{_.value&&(f(),Q.value?W.value=!0:t())}),fe(()=>{u.commit("payment/setPaymentDepositType",c.value.depositPayment),u.commit("payment/setPaymentDepositAmount",c.value.deposit),u.commit("setLoading",!1),i()});let se=p("containerWidth"),ke=p("dialogWidth"),q=o(()=>he(a.inDialog?ke.value:se.value)),G=p("amFonts"),S=p("amColors"),g=o(()=>({"--am-font-family":G.value.fontFamily,"--am-c-eli-primary":S.value.colorPrimary,"--am-c-eli-bgr":S.value.colorMainBgr,"--am-c-eli-text":S.value.colorMainText,"--am-c-eli-text-op90":L(S.value.colorMainText,.9),"--am-c-eli-text-op80":L(S.value.colorMainText,.8),"--am-c-eli-text-op70":L(S.value.colorMainText,.7),"--am-c-eli-text-op60":L(S.value.colorMainText,.7),"--am-c-eli-text-op20":L(S.value.colorMainText,.1)}));return(E,B)=>{var ge,xe;const $=Mt,le=Rt;return n(),m(N,null,[e(h)?(n(),H(Wa,{key:1})):(n(),m("div",{key:0,class:R(["am-eli",e(a).globalClass]),style:oe(e(g))},[e(c).gallery.length&&e(b).gallery.visibility?(n(),H(ua,{key:0,gallery:e(c).gallery,class:"am-eli__image"},null,8,["gallery"])):w("",!0),l("div",eo,[z(kt,{event:e(c),labels:e(x),locations:e(M),tickets:e(J),"customized-options":e(b),"date-string-visibility":!0,"border-visibility":!1,"btn-visibility":!1,"auto-info-height":!0,"image-visibility":!1,"vertical-orientation":"start","in-header":!0,"in-dialog":!0,"tax-visible":e(Ke)(e(u),e(c).id,"event")&&((xe=(ge=e(b).tax)==null?void 0:ge.visibility)!=null?xe:!0)},null,8,["event","labels","locations","tickets","customized-options","tax-visible"])]),l("div",to,[z(le,{modelValue:D.value,"onUpdate:modelValue":B[0]||(B[0]=ie=>D.value=ie)},{default:U(()=>[z($,{label:e(x).event_info,name:"first"},{default:U(()=>[e(c).periods.length?(n(),m("div",ao,[l("p",oo,[de(v(e(x).event_timetable)+" ",1),e(j).start!==e(j).end?(n(),m("span",no,v(`: ${e(j).start} - ${e(j).end}`),1)):w("",!0)]),(n(!0),m(N,null,me(e(X),ie=>(n(),m("p",{key:ie.id,class:"am-eli__timetable-main"},[l("span",so,v(ie.dateOfMonth),1),l("span",lo,v(` - ${ie.timeStart} - ${ie.timeEnd}`),1)]))),128))])):w("",!0),e(b).eventDescription.visibility?(n(),H(ma,{key:1,class:"am-eli__main-item",title:e(x).description,description:e(c).description,limit:250,"customized-labels":e(x)},null,8,["title","description","customized-labels"])):w("",!0),e(b).eventOrganizer.visibility?(n(),H(pt,{key:2,divider:!0,employee:e(A),rank:e(x).event_organizer,"customized-labels":e(x),class:"am-eli__main-item"},null,8,["employee","rank","customized-labels"])):w("",!0),e(b).eventEmployees.visibility?(n(!0),m(N,{key:3},me(e(Z),ie=>(n(),H(pt,{key:ie.id,divider:!0,employee:ie,"customized-labels":e(x),class:"am-eli__main-item"},null,8,["employee","customized-labels"]))),128)):w("",!0)]),_:1},8,["label"]),e(J).length?(n(),H($,{key:0,label:e(x).event_tickets,name:"second"},{default:U(()=>[(n(!0),m(N,null,me(e(J),ie=>(n(),H(Ct,{key:ie.id,ticket:ie,capacity:e(c).maxCustomCapacity,"extra-people":e(c).maxExtraPeople,"customized-labels":e(x),"read-only":!0},null,8,["ticket","capacity","extra-people","customized-labels"]))),128))]),_:1},8,["label"])):w("",!0)]),_:1},8,["modelValue"])])],6)),e(Q)?(n(),H(Vt,{key:2,visibility:e(W),"custom-class":"am-eli__bringing-wrapper"},{footer:U(()=>[l("div",{class:R(["am-eli__bringing-footer",e(q)])},[z(je,{type:e(d).secBtn.buttonType,category:"secondary",disabled:!1,onClick:pe},{default:U(()=>[de(v(e(r).back_btn),1)]),_:1},8,["type"]),z(je,{type:e(d).primBtn.buttonType,disabled:!1,onClick:ee},{default:U(()=>[de(v(e(r).continue),1)]),_:1},8,["type"])],2)]),default:U(()=>[z(Ka)]),_:1},8,["visibility"])):w("",!0)],64)}}});const co={class:"am-elt__header"},uo={class:"am-elt__header-left"},mo={class:"am-elt__heading"},po={key:0,class:"am-elt__header-right"},_o={class:"am-elt__heading"},vo={name:"EventTickets",key:"tickets",label:"event_select_tickets"},go=Object.assign(vo,{props:{globalClass:{type:String,default:""},inDialog:{type:Boolean,default:!1}},setup(I){const a=I;let{nextStep:t,footerButtonClicked:i,footerBtnDisabled:f,footerButtonReset:_}=p("changingStepsFunctions",{nextStep:()=>{},footerButtonReset:()=>{},footerButtonClicked:F(!1),footerBtnDisabled:F(!1)});const C=re(),u=p("settings");let h=p("customizedDataForm"),y=p("labels");const O=p("localLanguage");let b=o(()=>u.general.usedLanguages.includes(O.value)),P=o(()=>{let j=$e(_e({},y));if(h.value.tickets.translations){let D=h.value.tickets.translations;Object.keys(D).forEach(T=>{D[T][O.value]&&b.value?j[T]=D[T][O.value]:D[T].default&&(j[T]=D[T].default)})}return j}),s=o(()=>C.getters["tickets/getTicketsData"].sort((D,T)=>D.price-T.price)),k=o(()=>C.getters["tickets/getMaxCustomCapacity"]),x=o(()=>C.getters["tickets/getMaxExtraPeople"]),r=o(()=>C.getters["tickets/getEventGlobalSpots"]),d=o(()=>{let j=0;return s.value.forEach(D=>{j+=D.sold}),j}),c=o(()=>C.getters["tickets/getTicketsSum"]);Se(()=>{i.value&&(_(),t()),f.value=c.value<1}),fe(()=>{C.commit("setLoading",!1)});let M=p("amFonts"),V=p("amColors"),X=o(()=>({"--am-c-font-family":M.value.fontFamily,"--am-c-elt-text":V.value.colorMainText,"--am-c-elt-text-op90":L(V.value.colorMainText,.9),"--am-c-elt-text-op80":L(V.value.colorMainText,.8)}));return(j,D)=>(n(),m("div",{class:R(["am-elt",e(a).globalClass]),style:oe(e(X))},[l("div",co,[l("div",uo,[l("p",mo,v(e(P).event_tickets),1),l("p",null,v(e(P).event_tickets_context),1)]),e(k)?(n(),m("div",po,[l("p",_o,v(e(P).event_ticket_types),1),l("p",null,[l("span",null,v(e(k)-e(d)-e(r)),1),de(" "+v(`${e(k)-e(d)-e(r)===1?e(P).event_ticket_left:e(P).event_tickets_left}`),1)])])):w("",!0)]),(n(!0),m(N,null,me(e(s),T=>(n(),H(Ct,{key:T.id,ticket:T,capacity:e(k)?e(k)-e(d):null,"extra-people":e(x),"customized-labels":e(P),"in-dialog":e(a).inDialog},null,8,["ticket","capacity","extra-people","customized-labels","in-dialog"]))),128))],6))}});const fo={class:"am-fs__payment_default"},yo=["id"],bo={name:"PaymentOnSite"},Xe=Object.assign(bo,{props:{instantBooking:{type:Boolean,default:!1},showRecaptcha:{type:Boolean,default:!0}},emits:["payment-error"],setup(I,{expose:a,emit:t}){const i=I,f=re(),_=o(()=>f.getters.getSettings),C=p("labels"),u=p("shortcodeData"),{nextStep:h,footerButtonReset:y,footerButtonClicked:O}=p("changingStepsFunctions",{nextStep:()=>{},footerButtonReset:()=>{},footerButtonClicked:{value:!1}});a({continueWithBooking:d}),Se(()=>{O.value&&!i.instantBooking&&(f.getters["coupon/getCouponValidated"]?d():(y(),t("payment-error",C.coupon_mandatory)))},{flush:"post"});let b=F(null),P=F(!1),s=F(null);function k(){P.value=!1,t("payment-error",C.recaptcha_error)}function x(c){if(P.value=!0,s.value=c,_.value.general.googleRecaptcha.invisible)return r(be(f,null,!1,{},s.value)),!1}function r(c){if(_.value.general.googleRecaptcha.enabled&&i.showRecaptcha&&!_.value.general.googleRecaptcha.invisible&&!P.value)return t("payment-error",C.recaptcha_error),!1;We(f,c,M=>{Ge(f,M,()=>{h()})},M=>{console.log(M),Be(f,M.response.data,()=>{_.value.general.googleRecaptcha.enabled&&i.showRecaptcha&&_.value.general.googleRecaptcha.invisible&&b.value.reset(),t("payment-error",Te())})})}function d(){y();let c=be(f,null,!1,{},s.value);f.commit("setLoading",!0),_.value.general.googleRecaptcha.enabled&&i.showRecaptcha?_.value.general.googleRecaptcha.invisible?b.value.execute():P.value?r(c):(t("payment-error",C.recaptcha_error),f.commit("setLoading",!1)):r(c)}return(c,M)=>(n(),m("div",fo,[e(_).general.googleRecaptcha.enabled&&e(i).showRecaptcha?(n(),m("div",{key:0,id:"recaptcha-"+e(u).counter,class:"am-recaptcha-holder"},[z(e(gt),{ref_key:"recaptchaRef",ref:b,size:e(_).general.googleRecaptcha.invisible?"invisible":null,"load-recaptcha-script":!0,sitekey:e(_).general.googleRecaptcha.siteKey,onVerify:x,onExpired:k},null,8,["size","sitekey"])],8,yo)):w("",!0)]))}});const ho={class:"am-fs__payment_default"},ko={name:"PaymentWc"},Pt=Object.assign(ko,{props:{instantBooking:{type:Boolean,default:!1}},emits:["payment-error"],setup(I,{expose:a,emit:t}){const i=I,f=re(),_=p("shortcodeData");let C=p("stepsArray");const{nextStep:u,footerButtonReset:h,footerButtonClicked:y}=p("changingStepsFunctions",{nextStep:()=>{},footerButtonReset:()=>{},footerButtonClicked:{value:!1}});a({continueWithBooking:b});let O=p("amLabels");Se(()=>{y.value&&!i.instantBooking&&(f.getters["coupon/getCouponValidated"]?b():(h(),t("payment-error",O.value.coupon_mandatory)))});function b(){h();let s=be(f,{shortcode:_.value,steps:C.value.map(k=>k.name)},!1,{},null);f.commit("setLoading",!0),P("/payment/wc",s,function(k){window.location=k.data.data.cartUrl})}function P(s,k,x){ft.post(s,k.data,k.options).then(x).catch(r=>{Be(f,r.response.data,()=>{t("payment-error",Te())})})}return(s,k)=>(n(),m("div",ho))}});const xo={setup(I){const a=re();let t=o(()=>a.getters["bookableType/getType"]),i=o(()=>t.value==="event"?a.getters.getLoading:a.getters["booking/getLoading"]);return(f,_)=>{const C=He,u=Ye;return Ee((n(),H(u,{animated:"",class:"am-skeleton-ci"},{template:U(()=>[(n(!0),m(N,null,me(new Array(10),h=>(n(),m("div",{key:h,class:"am-skeleton-ci__inner"},[z(C,{class:"am-skeleton-ci__label",variant:"text"}),z(C,{class:"am-skeleton-ci__input",variant:"text"})]))),128))]),_:1},512)),[[we,e(i)]])}}};const Co={key:0,class:"am-elfci__error"},Po={name:"EventCustomerInfo",key:"customerInfo",label:"event_customer_info"},$o=Object.assign(Po,{props:{globalClass:{type:String,default:""},inDialog:{type:Boolean,default:!1}},setup(I){const a=I,t=re();t.dispatch("customerInfo/requestCurrentUserData"),t.dispatch("customFields/filterEventCustomFields");let i=o(()=>t.getters.getLoading);const f=p("settings");let _=p("customizedDataForm"),C=o(()=>_.value.customerInfo.options),u=o(()=>_.value.customerInfo.order),h=p("labels");const y=p("localLanguage");let O=o(()=>f.general.usedLanguages.includes(y.value)),b=o(()=>{let g=$e(_e({},h));if(_.value.customerInfo.translations){let E=_.value.customerInfo.translations;Object.keys(E).forEach(B=>{E[B][y.value]&&O.value?g[B]=E[B][y.value]:E[B].default&&(g[B]=E[B].default)})}return g}),{nextStep:P,footerButtonClicked:s,footerButtonReset:k}=p("changingStepsFunctions",{nextStep:()=>{},footerButtonReset:()=>{},footerButtonClicked:{value:!1}}),x=o(()=>t.getters["customFields/getFilteredCustomFieldsArray"]),r=o(()=>t.getters["customFields/getCustomFields"]),d=p("eventFluidStepKey"),c=F(null),M=F(null),V=F(yt(t)===0),X=F(null),j=F(null),D=F([]),T=F([]),A=F([]),Z=F({}),Y=F(""),Q=F({firstName:o({get:()=>t.getters["customerInfo/getCustomerFirstName"],set:g=>{t.commit("customerInfo/setCustomerFirstName",g||"")}}),lastName:o({get:()=>t.getters["customerInfo/getCustomerLastName"],set:g=>{t.commit("customerInfo/setCustomerLastName",g||"")}}),email:o({get:()=>t.getters["customerInfo/getCustomerEmail"],set:g=>{t.commit("customerInfo/setCustomerEmail",g||"")}}),phone:o({get:()=>t.getters["customerInfo/getCustomerPhone"],set:g=>{t.commit("customerInfo/setCustomerPhone",g||"")}})}),W=F({firstName:{template:ze.text,props:{itemName:"firstName",label:b.value.first_name_colon,placeholder:b.value.enter_first_name,class:"am-elfci__item",disabled:o(()=>!!(t.getters["customerInfo/getCustomerFirstName"]&&t.getters["customerInfo/getLoggedUser"]))}},lastName:{template:ze.text,props:{itemName:"lastName",label:b.value.last_name_colon,placeholder:b.value.enter_last_name,class:"am-elfci__item",disabled:o(()=>!!(t.getters["customerInfo/getCustomerLastName"]&&t.getters["customerInfo/getLoggedUser"]))}},email:{template:ze.text,props:{itemName:"email",label:b.value.email_colon,placeholder:b.value.enter_email,class:"am-elfci__item",disabled:o(()=>!!(t.getters["customerInfo/getCustomerEmail"]&&t.getters["customerInfo/getLoggedUser"]))}},phone:{countryPhoneIso:o({get:()=>t.getters["customerInfo/getCustomerCountryPhoneIso"],set:g=>{t.commit("customerInfo/setCustomerCountryPhoneIso",g?g.toLowerCase():"")}}),template:ze.phone,props:{itemName:"phone",label:b.value.phone_colon,placeholder:b.value.enter_phone,defaultCode:f.general.phoneDefaultCountryCode==="auto"?"":f.general.phoneDefaultCountryCode.toLowerCase(),phoneError:!1,whatsAppLabel:b.value.whatsapp_opt_in_text,isWhatsApp:f.notifications.whatsAppEnabled&&f.notifications.whatsAppAccessToken&&f.notifications.whatsAppBusinessID&&f.notifications.whatsAppPhoneID,class:"am-elfci__item",disabled:o(()=>!!(t.getters["customerInfo/getCustomerPhone"]&&t.getters["customerInfo/getLoggedUser"]))}}}),pe=F({firstName:[{required:!0,message:b.value.enter_first_name_warning,trigger:"submit"}],lastName:[{required:C.value.lastName.required,message:b.value.enter_last_name_warning,trigger:"submit"}],email:[{required:C.value.email.required,type:"email",message:b.value.enter_valid_email_warning,trigger:"submit"}],phone:[{required:C.value.phone.required,message:b.value.enter_phone_warning,trigger:"submit"}]});Object.keys(r.value).forEach(g=>{Q.value[g]=o({get:()=>t.getters["customFields/getCustomFieldValue"](g),set:E=>{let B={key:g,value:E};t.commit("customFields/setCustomFieldValue",B)}}),pe.value[g]=[{message:b.value.required_field,required:r.value[g].required,trigger:"submit"}],W.value[g]={template:ze[r.value[g].type],props:{id:r.value[g].id,itemName:g,label:r.value[g].label,options:r.value[g].options,class:`am-elfci__item am-cf-width-${r.value[g].width}`}},r.value[g].type==="text-area"&&(W.value[g].props=Fe(_e({},W.value[g].props),{itemType:"textarea"})),r.value[g].type==="file"&&(W.value[g].props=Fe(_e({},W.value[g].props),{btnLabel:b.value.upload_file_here})),r.value[g].type==="datepicker"&&(W.value[g].props=Fe(_e({},W.value[g].props),{weekStartsFromDay:f.wordpress.startOfWeek}))}),fe(()=>{if(V.value&&d.value.indexOf("eventPayment")!==-1){let g=d.value.indexOf("eventPayment");g>0&&d.value.splice(g,1)}!V.value&&d.value.indexOf("eventPayment")<0&&d.value.push("eventPayment"),Ve(()=>{setTimeout(()=>{D.value.forEach(g=>{g.formFieldRef&&A.value.push(g.formFieldRef)}),T.value.forEach(g=>{g.formFieldRef&&A.value.push(g.formFieldRef)})},500)}),Object.keys(r.value).forEach(g=>{(r.value[g].type==="text"||r.value[g].type==="text-area")&&(Z.value[g]={placeholder:""})}),Ie(t,{customFields:r,customFieldsPlaceholders:Z,couponCode:Y},"InitInfoStep","event",null,null),Y.value&&t.commit("coupon/setCode",Y.value),Object.values(Z.value).filter(g=>g.placeholder!=="").length&&Object.keys(Z.value).forEach(g=>{W.value[g].props=Fe(_e({},W.value[g].props),{placeholder:Z.value[g].placeholder})})});function ee(){k(),Q.value.firstName=Q.value.firstName.trim(),Q.value.lastName=Q.value.lastName.trim(),Q.value.email=Q.value.email.trim(),Ie(t,{rules:pe.value},"customValidation","event",null,null),j.value.validate(g=>{if(g)V.value?f.payments.wc.enabled&&!f.payments.wc.onSiteIfFree?(t.commit("payment/setPaymentGateway","wc"),M.value.continueWithBooking()):(t.commit("payment/setPaymentGateway","onSite"),c.value.continueWithBooking()):P();else{let E;A.value.some($=>{if($.shouldShowError===!0)return E=$.formItemRef,$.shouldShowError===!0});let B=A.value.find($=>$.prop==="phone");return W.value.phone.props.phoneError=!!(B&&B.shouldShowError&&B.validateMessage),et(X.value,E,0,300),!1}})}Se(()=>{s.value&&(k(),ee())});let J=o(()=>t.getters["payment/getError"]);function se(g){t.commit("payment/setError",g)}let ke=p("containerWidth"),q=p("dialogWidth"),G=o(()=>a.inDialog?q.value:ke.value),S=o(()=>he(G.value));return(g,E)=>{const B=bt;return n(),m("div",{ref_key:"infoFormWrapperRef",ref:X,class:R(["am-elfci",e(a).globalClass])},[e(i)?w("",!0):(n(),m(N,{key:0},[e(J)&&e(V)?(n(),m("div",Co,[z(ht,{type:"error",title:e(J),"show-icon":!0,closable:!1},null,8,["title"])])):w("",!0),z(B,{ref_key:"infoFormRef",ref:j,model:e(Q),rules:e(pe),"label-position":"top",class:R(["am-elfci__form",e(S)])},{default:U(()=>[(n(!0),m(N,null,me(e(u),$=>(n(),m(N,{key:$.id},[!($.id in e(C)&&"visibility"in e(C)[$.id])||e(C)[$.id].visibility?(n(),H(Le(e(W)[$.id].template),rt({key:0,ref_for:!0,ref_key:"customerCollectorRef",ref:D,modelValue:e(Q)[$.id],"onUpdate:modelValue":le=>e(Q)[$.id]=le,countryPhoneIso:e(W)[$.id].countryPhoneIso,"onUpdate:countryPhoneIso":le=>e(W)[$.id].countryPhoneIso=le},e(W)[$.id].props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"])):w("",!0)],64))),128)),(n(!0),m(N,null,me(e(x),($,le)=>(n(),H(Le(e(W)[`cf${$.id}`].template),rt({key:le,ref_for:!0,ref_key:"customFieldsCollectorRefs",ref:T,modelValue:e(Q)[`cf${$.id}`],"onUpdate:modelValue":ge=>e(Q)[`cf${$.id}`]=ge},e(W)[`cf${$.id}`].props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"])],64)),Ee(l("div",null,[e(V)&&(e(f).payments.wc.enabled?e(f).payments.wc.onSiteIfFree:!0)?(n(),H(Xe,{key:0,ref_key:"refOnSiteBooking",ref:c,"instant-booking":e(V),onPaymentError:se},null,8,["instant-booking"])):w("",!0),e(V)&&e(f).payments.wc.enabled&&!e(f).payments.wc.onSiteIfFree?(n(),H(Pt,{key:1,ref_key:"refWcBooking",ref:M,"instant-booking":e(V),onPaymentError:se},null,8,["instant-booking"])):w("",!0)],512),[[we,!e(i)]]),z(xo)],2)}}});const So=l("div",{style:{display:"inline-block"}},[l("span",{class:"am-icon-coupon-limit"})],-1),Eo={class:"am-coupon-limit-text"},wo={name:"CouponCode"},Bo=Object.assign(wo,{props:{entityId:{type:[Number,String],required:!0},bookableType:{type:String,required:!0},bookingsCount:{type:Number,required:!0}},emits:["couponApplied"],setup(I,{emit:a}){const t=I,i=re();let f=o(()=>i.getters["coupon/getCoupon"]),_=p("amLabels"),C=p("customizedDataForm"),u=F(null),h=F({coupon:o({get:()=>i.getters["coupon/getCoupon"].code,set:c=>{i.commit("coupon/setCode",c)}})}),y=o(()=>"coupon"in C.value.payment.options?C.value.payment.options.coupon.required:qe.elf.payment.options.coupon.required),O=F({coupon:[{required:y.value,trigger:"submit"}]});function b(){y.value&&(h.value.coupon?i.commit("coupon/enablePayPalActions"):i.commit("coupon/disablePayPalActions"))}fe(()=>{i.commit("coupon/setCouponRequired",y.value),f.value.code&&s()});function P(){i.getters["coupon/getError"]&&i.commit("coupon/setError",""),u.value.clearValidate()}function s(){At(i,()=>{a("couponApplied")})}let k=p("containerWidth",0),x=o(()=>k.value<340),r=p("amColors"),d=o(()=>({"--am-c-coupon-primary":r.value.colorPrimary,"--am-c-coupon-primary-op10":L(r.value.colorPrimary,.1),"--am-c-coupon-primary-op40":L(r.value.colorPrimary,.4)}));return(c,M)=>{const V=qt,X=bt,j=Yt,D=Ht;return n(),m(N,null,[z(X,{ref_key:"couponFormRef",ref:u,rules:e(O),model:e(h)},{default:U(()=>[l("div",{class:R(["am-fs__coupon",{"am-fs__coupon-mobile-s":e(x)}]),style:oe(e(d))},[z(V,{prop:"coupon",class:"am-fs__coupon-form-item"},{label:U(()=>[l("span",null,v(`${e(_).coupon}:`),1)]),default:U(()=>[z(_t,{modelValue:e(h).coupon,"onUpdate:modelValue":M[0]||(M[0]=T=>e(h).coupon=T),size:"small",class:R({"am-fs__coupon-invalid":e(f).limit===0}),"icon-start":jt,"icon-end":e(f).code&&(e(f).discount||e(f).deduction)?e(f).limit===0?Wt:Nt:"",onInput:P,onChange:b,onKeydown:M[1]||(M[1]=Ut(T=>{T.preventDefault()},["enter"]))},null,8,["modelValue","class","icon-end"])]),_:1}),z(je,{size:"small",onClick:s},{default:U(()=>[de(v(e(_).add_coupon_btn),1)]),_:1})],6)]),_:1},8,["rules","model"]),e(t).bookableType!=="event"?(n(),H(D,{key:0,class:"am-coupon-limit",style:oe(e(d))},{default:U(()=>[z(j,{sm:2,xs:4},{default:U(()=>[So]),_:1}),z(j,{class:"am-coupon-limit-col",sm:22,xs:20},{default:U(()=>[l("div",Eo,[l("strong",null,v(e(_).coupons_used),1),l("p",null,v(`${e(_).coupons_used_description} ${e(f).limit}`),1)])]),_:1})]),_:1},8,["style"])):w("",!0)],64)}}});const To={class:"am-pei__inner"},Do={class:"am-pei__segment-info"},Io={class:"am-pei__segment-sub"},Lo={class:"am-amount"},Oo={class:"am-pei__segment-open"},Fo={key:0,class:"am-pei__segment-open__text"},zo={class:"am-amount"},Mo={class:"am-pei__segment-sub"},Ro={class:"am-amount"},Vo={key:1,class:"am-pei__segment-wrapper"},Ao={class:"am-pei__segment"},jo={class:"am-pei__segment-info"},Wo={class:"am-pei__segment-open"},No={class:"am-pei__segment-sub"},Uo={key:0},qo={class:"am-amount"},Yo={class:"am-pei__info"},Ho={key:1,class:"am-pei__info-subtotal"},Go={class:"am-amount"},Jo={class:"am-amount"},Zo={key:0,class:"am-pei__info-tax"},Qo={class:"am-amount"},Xo={class:"am-amount"},Ko={class:"am-pei__info-deposit"},en={class:"am-amount"},tn={class:"am-pei__info-remaining"},an={class:"am-amount"},on={name:"EventPaymentInfo"},nn=Object.assign(on,{props:{taxVisibility:{type:Boolean,default:!1}},emits:["setOnSitePayment"],setup(I,{emit:a}){const t=I,i=re(),f=p("settings");let _=p("amLabels"),C=o(()=>i.getters["bookableType/getType"]),u=o(()=>i.getters["eventEntities/getEvent"](i.getters["eventBooking/getSelectedEventId"])),h=o(()=>i.getters["tickets/getTicketsData"]),y=o(()=>i.getters["persons/getPersons"]);function O(A){return A>1?_.summary_persons:_.summary_person}function b(A){return u.value.aggregatedPrice?`(${ne(A.price)}) x ${A.persons} ${O(A.persons)}`:`(${A.persons} ${O(A.persons)})`}let P=o(()=>{let A=0;return u.value.customPricing?(h.value.forEach(Z=>{A+=Z.persons}),A):y.value}),s=o(()=>{let A=0;u.value.customPricing?h.value.forEach(Y=>{Y.persons&&(A+=u.value.aggregatedPrice?Y.price*Y.persons:Y.price)}):A=u.value.aggregatedPrice?u.value.price*y.value:u.value.price;let Z=Gt(i,i.getters["eventBooking/getSelectedEventId"],"event");return Jt(u.value,i.getters["coupon/getCoupon"],Z&&f.payments.taxes.enabled?Object.assign({},Z,{excluded:f.payments.taxes.excluded}):null,A,!0)}),k=o(()=>i.getters["payment/getPaymentDeposit"]),x=p("hasDeposit"),r=o(()=>(!f.payments.coupons||s.value.discount===0)&&(!f.payments.taxes.enabled||s.value.tax===0));ue("discount",s.value.discount);let d=o(()=>i.getters["payment/getPaymentGateway"]);function c(){a("setOnSitePayment",s.value.price+s.value.tax-s.value.discount<=0)}let M=F(!0);function V(A){A.style.opacity=0,setTimeout(()=>{A.style.opacity=1,A.style.height="var(--am-h__part-sub)"},200)}function X(A){A.style.opacity=0,A.style.setProperty("--am-h__part-sub",`${A.offsetHeight}px`),setTimeout(()=>{A.style.height="0px"},100)}let j=p("amFonts"),D=p("amColors"),T=o(()=>({"--am-font-family":j.value.fontFamily,"--am-c-pay-text":D.value.colorMainText,"--am-c-pay-text-op70":L(D.value.colorMainText,.7),"--am-c-pay-text-op60":L(D.value.colorMainText,.6),"--am-c-pay-text-op30":L(D.value.colorMainText,.3),"--am-c-pay-text-op20":L(D.value.colorMainText,.2),"--am-c-pay-border":L(D.value.colorInpBorder),"--am-c-pay-success":D.value.colorSuccess,"--am-c-pay-primary":D.value.colorPrimary}));return(A,Z)=>(n(),m("div",{class:"am-pei",style:oe(e(T))},[l("div",To,[e(h).length?(n(),H(e(Qt),{key:0,class:"am-pei__segment"},{default:U(()=>[z(e(Zt),{side:!0,onCollapseOpen:Z[0]||(Z[0]=Y=>ye(M)?M.value=!1:M=!1),onCollapseClose:Z[1]||(Z[1]=Y=>ye(M)?M.value=!0:M=!0)},{heading:U(()=>[l("div",Do,[l("span",null,v(e(_).summary_event),1)])]),"icon-below":U(()=>[z(Ue,{duration:{enter:500,leave:500},onEnter:V,onLeave:X},{default:U(()=>[Ee(l("div",Io,[l("p",null,v(`${e(u).name} x ${e(P)} ${O(e(P))}`),1),l("p",Lo,v(e(ne)(e(s).price)),1)],512),[[we,e(M)]])]),_:1})]),default:U(()=>[l("div",Oo,[(n(!0),m(N,null,me(e(h),Y=>(n(),m(N,{key:Y.id},[Y.persons?(n(),m("div",Fo,[l("span",null,v(Y.name)+" "+v(b(Y)),1),l("span",zo,v(e(ne)(e(u).aggregatedPrice?Y.price*Y.persons:Y.price)),1)])):w("",!0)],64))),128)),l("div",Mo,[l("p",null,v(e(u).name),1),l("p",Ro,v(e(ne)(e(s).price)),1)])])]),_:1})]),_:1})):(n(),m("div",Vo,[l("div",Ao,[l("div",jo,[l("span",null,v(e(_).summary_event),1)]),l("div",Wo,[l("div",No,[l("p",null,[de(v(`${e(u).name} (${e(u).aggregatedPrice?e(ne)(e(u).price):e(y)+" "+O(e(y))})`)+" ",1),e(u).aggregatedPrice?(n(),m("span",Uo,v(`x ${e(y)} ${O(e(y))}`),1)):w("",!0)]),l("p",qo,v(e(ne)(e(s).price)),1)])])])]))]),l("div",Yo,[e(f).payments.coupons?(n(),H(Bo,{key:0,"bookings-count":1,"entity-id":e(u).id,"bookable-type":e(C),onCouponApplied:c},null,8,["entity-id","bookable-type"])):w("",!0),e(r)?w("",!0):(n(),m("div",Ho,[l("span",null,v(e(_).subtotal)+":",1),l("span",Go,v(e(ne)(e(s).price)),1)])),z(Ue,{name:"am-fade"},{default:U(()=>[e(f).payments.coupons?Ee((n(),m("div",{key:0,class:R(["am-pei__info-discount",{"am-pei__info-discount-green":e(s).discount>0}])},[l("span",null,v(`${e(_).discount_amount_colon}:`),1),l("span",Jo,v(e(ne)(e(s).discount)),1)],2)),[[we,e(s).discount>0]]):w("",!0)]),_:1}),z(Ue,{name:"am-fade"},{default:U(()=>[e(t).taxVisibility&&e(f).payments.taxes.excluded?Ee((n(),m("div",Zo,[l("span",null,v(e(_).total_tax_colon)+": ",1),l("span",Qo,v(e(ne)(e(s).tax)),1)],512)),[[we,e(s).tax>0]]):w("",!0)]),_:1}),l("div",{class:R(["am-pei__info-total",{"am-single-row":!e(s).discount,"am-pei__info-bordered":!e(r)}])},[l("span",null,v(e(_).total_amount_colon),1),l("span",Xo,[de(v(e(ne)(e(s).price-e(s).discount+e(s).tax))+" ",1),e(t).taxVisibility&&!e(f).payments.taxes.excluded?(n(),m(N,{key:0},[de(v(e(_).incl_tax),1)],64)):w("",!0)])],2),e(x)&&e(d)!=="onSite"?(n(),m(N,{key:2},[l("div",Ko,[l("span",null,v(e(_).paying_now)+": ",1),l("span",en,v(e(ne)(e(k)?e(s).price-e(s).discount+e(s).tax:e(s).deposit)),1)]),l("div",tn,[l("span",null,v(e(_).paying_later)+": ",1),l("span",an,v(e(ne)(e(k)?0:e(s).price-e(s).discount+e(s).tax-e(s).deposit)),1)])],64)):w("",!0)])],4))}});const sn={class:"am-fs__payment-stripe__card"},ln=["id"],rn=["id"],cn=l("p",null," CVC: ",-1),un=["id"],mn={class:"am-fs__payment-stripe__policy"},pn=["src"],dn=["id"],_n={name:"PaymentStripe"},vn=Object.assign(_n,{emits:["payment-error"],setup(I,{emit:a}){const t=re(),i=p("settings"),f=p("localLanguage"),_=p("amLabels"),C=p("baseUrls"),u=p("shortcodeData"),{nextStep:h,footerButtonReset:y,footerButtonClicked:O}=p("changingStepsFunctions",{nextStep:()=>{},footerButtonReset:()=>{},footerButtonClicked:{value:!1}});let b=F(null),P=F(!1),s=F(null);function k(){P.value=!1,a("payment-error",_.recaptcha_error)}function x(ee){if(P.value=!0,s.value=ee,i.general.googleRecaptcha.invisible)return D(be(t,null,!1,{},s.value)),!1}let r=null,d=null,c=null,M=null,V=p("amColors"),X=p("amFonts");function j(){const ee={locale:f.value.replace("_","-")};r=Stripe(i.payments.stripe.testMode===!1?i.payments.stripe.livePublishableKey:i.payments.stripe.testPublishableKey,ee);let J=r.elements(),se={base:{color:V.value.colorInpText,fontSize:"15px",fontFamily:X.value.fontFamily}};d=J.create("cardNumber",{style:se}),d.mount("#am-stripe-cn-"+u.value.counter),c=J.create("cardExpiry",{style:se}),c.mount("#am-stripe-ed-"+u.value.counter),M=J.create("cardCvc",{style:se}),M.mount("#am-stripe-cvc-"+u.value.counter)}function D(){if(i.general.googleRecaptcha.enabled&&!i.general.googleRecaptcha.invisible&&!P.value)return a("payment-error",_.recaptcha_error),!1;r.createPaymentMethod("card",d,{}).then(function(ee){if(A(ee)){t.commit("setLoading",!1);return}We(t,be(t,null,!1,{paymentMethodId:ee.paymentMethod.id},s.value),function(J){if(J.data.data.requiresAction){T(J.data.data);return}t.commit("setLoading",!1),Z(J)},J=>{t.commit("setLoading",!1),Y(J)})})}function T(ee){r.handleCardAction(ee.paymentIntentClientSecret).then(function(J){A(J)||We(t,be(t,null,!1,{paymentIntentId:J.paymentIntent.id},null),Z,Y)})}function A(ee){return ee.error?(Ze(t,function(){a("payment-error",ee.error.message)}),!0):!1}function Z(ee){Ge(t,ee,function(){h()})}function Y(ee){Be(t,ee.response.data,()=>{a("payment-error",Te())})}let Q=p("paymentRef");function W(){y(),t.commit("setLoading",!0),i.general.googleRecaptcha.enabled?i.general.googleRecaptcha.invisible?b.value.execute():P.value?D():(a("payment-error",_.value.recaptcha_error),t.commit("setLoading",!1)):D()}Se(()=>{O.value&&(t.getters["coupon/getCouponValidated"]?W():(y(),et(Q.value,Q.value,20,300),a("payment-error",_.value.coupon_mandatory)))},{flush:"post"}),fe(()=>{j()});let pe=o(()=>({"--am-c-pay-text":V.value.colorMainText,"--am-c-pay-text-op60":L(V.value.colorMainText,.6)}));return(ee,J)=>(n(),m("div",{class:"am-fs__payment-stripe",style:oe(e(pe))},[l("div",sn,[l("div",null,[l("p",null,v(e(_).card_number_colon)+": ",1),l("div",{id:"am-stripe-cn-"+e(u).counter,class:"am-stripe-cn"},null,8,ln)]),l("div",null,[l("div",null,[l("p",null,v(e(_).expires_date_colon)+": ",1),l("div",{id:"am-stripe-ed-"+e(u).counter,class:"am-stripe-ed"},null,8,rn)]),l("div",null,[cn,l("div",{id:"am-stripe-cvc-"+e(u).counter,class:"am-stripe-cvc"},null,8,un)])])]),l("div",mn,[l("p",null,v(e(_).payment_protected_policy),1),l("img",{src:e(C).wpAmeliaPluginURL+"/v3/src/assets/img/icons/stripeLogo.svg",alt:"Stripe policy"},null,8,pn),l("span",null,v(e(_).stripe),1)]),e(i).general.googleRecaptcha.enabled?(n(),m("div",{key:0,id:"recaptcha-"+e(u).counter,class:"am-recaptcha-holder"},[z(e(gt),{ref_key:"recaptchaRef",ref:b,size:e(i).general.googleRecaptcha.invisible?"invisible":null,"load-recaptcha-script":!0,sitekey:e(i).general.googleRecaptcha.siteKey,onVerify:x,onExpired:k},null,8,["size","sitekey"])],8,dn)):w("",!0)],4))}});const gn={name:"PaymentPayPal"},fn=Object.assign(gn,{emits:["payment-error"],setup(I,{emit:a}){const t=re(),i=p("amLabels"),{nextStep:f}=p("changingStepsFunctions",{nextStep:()=>{}});let _=o(()=>({})),C=null;const u=p("shortcodeData");function h(){Ve(()=>{window.paypal.Button.render({style:{size:"responsive",color:"gold",shape:"rect",tagline:!1,height:40},env:Je.payments.payPal.sandboxMode?"sandbox":"production",client:{sandbox:Je.payments.payPal.testApiClientId,production:Je.payments.payPal.liveApiClientId},commit:!0,validate:function(P){t.commit("coupon/setPayPalActions",P),t.getters["coupon/getCouponValidated"]?t.commit("coupon/enablePayPalActions"):t.commit("coupon/disablePayPalActions")},onClick:function(){t.getters["coupon/getCouponValidated"]?t.commit("coupon/enablePayPalActions"):(t.commit("coupon/disablePayPalActions"),a("payment-error",i.coupon_mandatory))},payment:function(){return window.paypal.request({method:"post",url:Xt+"/payment/payPal",json:be(t,null,!0,{},null).data}).then(P=>(C=P.data.transactionReference,P.data.paymentID)).catch(P=>{y(P)})},onAuthorize:function(P,s){return s.payment.get().then(function(){t.commit("setLoading",!0),We(t,be(t,null,!1,{transactionReference:C,PaymentId:P.paymentID,PayerId:P.payerID},null),O,k=>{Be(t,k.response.data,()=>{a("payment-error",Te())})})})},onCancel:function(){t.commit("setLoading",!1)},onError:function(P){y(P)}},"#am-paypal-element-"+u.value.counter)})}function y(P){let s=P.toString(),k=JSON.parse(JSON.stringify(JSON.parse(s.substring(s.indexOf("{"),s.lastIndexOf("}")+1))));typeof k=="object"&&k.hasOwnProperty("data")?b(k):typeof k=="object"&&k.hasOwnProperty("message")?Ze(t,function(){a("payment-error",k.message)}):Ze(t,function(){a("payment-error",s)})}function O(P){Ge(t,P,function(){f()})}function b(P){Be(t,P,()=>{a("payment-error",Te())})}return fe(()=>{h()}),(P,s)=>(n(),m("div",{class:"am-fs__payment_payPal",style:oe(e(_))},null,4))}});const yn={class:"am-fs__payment_default"},bn={name:"PaymentCommon"},dt=Object.assign(bn,{emits:["payment-error"],setup(I,{emit:a}){const t=re(),i=p("shortcodeData");let f=p("stepsArray"),_=p("sidebarSteps",F([]));const{nextStep:C,footerButtonReset:u,footerButtonClicked:h}=p("changingStepsFunctions",{nextStep:()=>{},footerButtonReset:()=>{},footerButtonClicked:{value:!1}}),y=p("amLabels");Se(()=>{h.value&&(t.getters["coupon/getCouponValidated"]?b():(u(),a("payment-error",y.value.coupon_mandatory)))},{flush:"post"});function O(s,k,x){let r=be(t,null,!1,{paymentId:s,signature:k,orderId:x},null);We(t,r,d=>{Ge(t,d,()=>{C()})},d=>{Be(t,d.response.data,()=>{a("payment-error",Te())})})}function b(){u();let s=t.getters["bookableType/getType"]==="event",k=s?t.getters["payment/getPaymentGateway"]:t.getters["booking/getPaymentGateway"],x=s?{shortcode:i.value,steps:f.value.map(d=>d.name)}:{shortcode:i.value,steps:f.value.map(d=>d.key),sidebar:_.value.map(d=>Object.assign({key:d.key,data:d.stepSelectedData}))},r=be(t,k==="mollie"?x:null,!1,{},null);switch(t.commit(s?"setLoading":"booking/setLoading",!0),k){case"mollie":P("/payment/mollie",r,function(d){window.location=d.data.data.redirectUrl});break;case"razorpay":P("/payment/razorpay",r,function(d){let c=d.data.data.data;c.handler=function(V){O(V.razorpay_payment_id,V.razorpay_signature,c.order_id)},c.modal={ondismiss:function(){a("payment-abandoned")}},new Razorpay(c).open()});break}}function P(s,k,x){ft.post(s,k.data,k.options).then(x).catch(r=>{Be(t,r.response.data,()=>{a("payment-error",Te())})})}return(s,k)=>(n(),m("div",yn))}});const hn={class:"am-payments__heading"},kn={key:0,class:"am-payments__error"},xn={class:"am-payments__heading-main"},Cn={class:"am-payments__method"},Pn=["onClick"],$n=["src"],Sn={class:"am-payments__sentence"},En={key:1,class:"am-payments__pm"},wn={name:"PaymentPage"},Bn=Object.assign(wn,{props:{globalClass:{type:String,default:""},componentClass:{type:String,default:""},selectedItem:{type:Object,required:!0},inDialog:{type:Boolean,default:!1},taxVisibility:{type:Boolean,default:!1}},setup(I){const a=I,t=re();let i=o(()=>t.getters.getSettings),f=p("baseUrls");const _=p("amLabels"),C={event:ve(nn)};let u=o(()=>t.getters["payment/getError"]?t.getters["payment/getError"]:t.getters["coupon/getError"]?t.getters["coupon/getError"]:"");const{headerButtonPreviousClicked:h,footerBtnDisabledUpdater:y,footerButtonClick:O}=p("changingStepsFunctions",{headerButtonPreviousClicked:F(!1),footerBtnDisabledUpdater:()=>{},footerButtonClick:()=>{}});Me(h,()=>{t.commit("payment/setPaymentGateway","")});const b={onSite:ve(Xe),stripe:ve(vn),payPal:ve(fn),razorpay:ve(dt),mollie:ve(dt),wc:ve(Pt)};let P=o(()=>t.getters.getReady),s=o(()=>t.getters.getLoading),k=o(()=>t.getters["bookableType/getType"]),x=o(()=>(t.getters["payment/getPaymentGateway"]||t.commit("payment/setPaymentGateway",i.value.payments.defaultPaymentMethod),t.getters["payment/getPaymentGateway"])),r=o(()=>P.value?a.selectedItem.depositPayment!=="disabled":!1);ue("hasDeposit",r);let d=o(()=>P.value?a.selectedItem.fullPayment:!1),c=o({get:()=>t.getters["payment/getPaymentDeposit"],set:S=>t.commit("payment/setPaymentDeposit",S)}),M=F(!1),V=o(()=>{let S="";return x.value==="onSite"&&!M.value?S=_.payment_onsite_sentence:(x.value==="mollie"||x.value==="wc")&&(S=_.payment_wc_mollie_sentence),S}),X=F(null);function j(S){t.getters["payment/getOnSitePayment"]&&(t.commit("payment/setOnSitePayment",!1),t.commit("payment/setPaymentGateway","onSite"),M.value=!0,X.value.continueWithBooking()),t.commit("payment/setError",S)}function D(){t.commit("setLoading",!1)}let T=o(()=>{if(P.value){if(M.value)return{onSite:!0,stripe:!1,payPal:!1,wc:!1,mollie:!1,razorpay:!1};let S=a.selectedItem,g=S.settings?JSON.parse(S.settings).payments:null;if(i.value.payments.wc.enabled===!0)return t.commit("payment/setPaymentGateway","wc"),{onSite:!1,stripe:!1,payPal:!1,wc:!0,mollie:!1,razorpay:!1};let E=g?{onSite:"onSite"in g?g.onSite&&i.value.payments.onSite:i.value.payments.onSite,stripe:"stripe"in g?g.stripe.enabled&&i.value.payments.stripe.enabled:i.value.payments.stripe.enabled,payPal:"payPal"in g?g.payPal.enabled&&i.value.payments.payPal.enabled:i.value.payments.payPal.enabled,wc:i.value.payments.wc.enabled,mollie:"mollie"in g?g.mollie.enabled&&i.value.payments.mollie.enabled:i.value.payments.mollie.enabled,razorpay:"razorpay"in g?g.razorpay.enabled&&i.value.payments.razorpay.enabled:i.value.payments.razorpay.enabled}:{onSite:i.value.payments.onSite,stripe:i.value.payments.stripe.enabled,payPal:i.value.payments.payPal.enabled,wc:i.value.payments.wc.enabled,mollie:i.value.payments.mollie.enabled,razorpay:i.value.payments.razorpay.enabled};if(!E.onSite&&!E.stripe&&!E.payPal&&!E.wc&&!E.mollie&&!E.razorpay&&(E={onSite:i.value.payments.onSite,stripe:i.value.payments.stripe.enabled,payPal:i.value.payments.payPal.enabled,wc:i.value.payments.wc.enabled,mollie:i.value.payments.mollie.enabled,razorpay:i.value.payments.razorpay.enabled}),i.value.payments.defaultPaymentMethod&&E[i.value.payments.defaultPaymentMethod])t.commit("payment/setPaymentGateway",i.value.payments.defaultPaymentMethod),y(!1);else if(Object.keys(E).filter(B=>E[B]).length===1)for(let B in E)E[B]&&(t.commit("payment/setPaymentGateway",B),y(!1));return E}return{}}),A=o(()=>{let S=[];return Object.keys(T.value).forEach(g=>{T.value[g]&&S.push(g)}),S});function Z(S){t.commit("payment/setPaymentGateway",S),y(!1)}function Y(S){(!i.value.payments.wc.enabled||i.value.payments.wc.onSiteIfFree)&&(S&&t.commit("payment/setPaymentGateway","onSite"),M.value=S)}let Q=F(null);ue("paymentRef",Q),fe(()=>{t.commit("payment/setError",""),t.commit("setLoading",!1),yt(t)===0&&(i.value.payments.wc.enabled===!0&&!i.value.payments.wc.onSiteIfFree?t.commit("payment/setPaymentGateway","wc"):t.commit("payment/setPaymentGateway","onSite"),O()),Ie(t,{},"InitiateCheckout",k.value,null,null)});let W=p("amColors");const pe=o(()=>({"--am-c-ps-price-bgr":L(W.value.colorBtnPrim,.05),"--am-c-ps-total-price":W.value.colorBtnPrim,"--am-c-ps-text-op60":L(W.value.colorMainText,.6),"--am-c-ps-text-op50":L(W.value.colorMainText,.5),"--am-c-ps-text-op25":L(W.value.colorMainText,.25),"--am-c-ps-text-op20":L(W.value.colorMainText,.2),"--am-c-ps-text-op06":L(W.value.colorMainText,.06),"--am-c-ps-primary":W.value.colorPrimary,"--am-c-ps-primary-op10":L(W.value.colorPrimary,.1),"--am-c-ps-primary-op06":L(W.value.colorPrimary,.06),"--am-w-ps-card":`${100/A.value.length}%`}));let ee=[];Object.keys(T.value).forEach(S=>{ee.push({key:S,text:J(S)})});function J(S){switch(S){case"onSite":return _.on_site;case"payPal":return _.pay_pal;case"stripe":return _.stripe;case"razorpay":return _.razorpay;case"mollie":return _.on_line;default:return""}}let se=p("containerWidth",F(0)),ke=p("dialogWidth",F(0)),q=o(()=>he(a.inDialog?ke.value:se.value)),G=o(()=>se.value<450||se.value>560&&se.value-240<450);return(S,g)=>(n(),m(N,null,[Ee(l("div",{ref_key:"paymentRef",ref:Q,class:R(["am-payments",[e(a).componentClass,e(a).globalClass]]),style:oe(e(pe))},[l("div",hn,[e(u)?(n(),m("div",kn,[z(ht,{type:"error",title:e(u),"show-icon":!0,closable:!1},null,8,["title"])])):w("",!0),l("span",xn,v(e(_).summary),1)]),(n(),H(Le(C[e(k)]),{"tax-visibility":e(a).taxVisibility,onSetOnSitePayment:Y},null,8,["tax-visibility"])),e(r)&&e(d)&&e(x)!=="onSite"?(n(),H(Kt,{key:0,modelValue:e(c),"onUpdate:modelValue":g[0]||(g[0]=E=>ye(c)?c.value=E:c=E),class:R(["am-payments__full",{"am-payments__full-checked":e(c)}]),label:e(_).full_amount_consent},null,8,["modelValue","label","class"])):w("",!0),l("div",Cn,[Ee(l("p",{class:"am-payments__method-heading"},v(e(_).payment_method),513),[[we,Object.keys(e(T)).filter(E=>e(T)[E]).length>1]]),l("div",{class:R(["am-payments__method-cards",{"am-payments__method-cards-wrap":e(G)}])},[(n(!0),m(N,null,me(e(T),(E,B)=>(n(),m(N,null,[E&&Object.keys(e(T)).filter($=>e(T)[$]).length>1?(n(),m("div",{key:B,class:R(["am-payments__method-button",[{"am-payments__method-button__selected":e(x)===B},e(q),`am-payments__method-button-${e(A).length}`]]),onClick:$=>Z(B)},[E?(n(),m("img",{key:0,src:`${e(f).wpAmeliaPluginURL}/v3/src/assets/img/icons/${B==="mollie"?"stripe":B}.svg`},null,8,$n)):w("",!0),l("div",null,[l("p",null,v(e(ee).filter($=>$.key===B)[0].text),1)])],10,Pn)):w("",!0)],64))),256))],2)]),l("div",Sn,[l("p",null,v(e(V)),1)]),z(Xe,{ref_key:"refOnSitePayment",ref:X,"instant-booking":!0,"show-recaptcha":!1,onPaymentError:j},null,512),e(x)?(n(),m("div",En,[(n(),H(Le(b[e(x)]),{onPaymentError:j,onPaymentAbandoned:D}))])):w("",!0)],6),[[we,e(P)&&!e(s)]]),z(ea)],64))}}),Tn={name:"EventPayment",key:"payment",label:"event_payment"},Dn=Object.assign(Tn,{props:{globalClass:{type:String,default:""},inDialog:{type:Boolean,default:!1}},setup(I){const a=I,t=re(),{footerButtonReset:i}=p("changingStepsFunctions",{footerButtonReset:()=>{}});i();let f=p("stepsArray"),_=p("stepIndex"),C=o(()=>t.getters.getFormKey),u=o(()=>t.getters.getSettings);const h=p("labels"),y=p("localLanguage");let O=o(()=>{let x=$e(_e({},h)),r=f.value[_.value].key;if(u.value.customizedData&&C.value in u.value.customizedData&&u.value.customizedData[C.value][r].translations){let d=u.value.customizedData[C.value][r].translations;Object.keys(d).forEach(c=>{d[c][y.value]?x[c]=d[c][y.value]:d[c].default&&(x[c]=d[c].default)})}return x});ue("amLabels",O.value);let b=o(()=>t.getters["eventEntities/getEvent"](t.getters["eventBooking/getSelectedEventId"])),P=o(()=>Ke(t,b.value.id,"event")),s=p("amColors");const k=o(()=>({"--am-c-ps-price-bgr":L(s.value.colorBtnPrim,.05),"--am-c-ps-total-price":s.value.colorBtnPrim,"--am-c-ps-text-op50":L(s.value.colorMainText,.5),"--am-c-ps-text-op25":L(s.value.colorMainText,.25),"--am-c-ps-text-op20":L(s.value.colorMainText,.2),"--am-c-ps-text-op06":L(s.value.colorMainText,.06),"--am-c-ps-primary":s.value.colorPrimary,"--am-c-ps-primary-op10":L(s.value.colorPrimary,.1),"--am-c-ps-primary-op06":L(s.value.colorPrimary,.06)}));return(x,r)=>(n(),m("div",{class:R(e(a).globalClass),style:oe(e(k))},[e(b)?(n(),H(Bn,{key:0,"selected-item":e(b),"tax-visibility":e(P),"in-dialog":!0},null,8,["selected-item","tax-visibility"])):w("",!0)],6))}});const In={class:"am-congrats__info-title"},Ln={class:"am-congrats__info-item__label"},On={class:"am-congrats__info-item__value"},Fn={class:"am-congrats__info-item__label"},zn={class:"am-congrats__info-item__value"},Mn={class:"am-congrats__info-item__label"},Rn={class:"am-congrats__info-item__value"},Vn={class:"am-congrats__info-item__label"},An={class:"am-clickable"},jn={key:2,class:"am-congrats__info-item am-fs__congrats-info-event-tickets"},Wn={class:"am-congrats__info-item__value collapsable"},Nn={name:"EventCongratsInfo"},Un=Object.assign(Nn,{props:{booked:{type:Object,required:!0},labels:{type:Object,required:!0},inDialog:{type:Boolean,default:!1}},setup(I){const a=I;let t=o(()=>a.booked?a.booked.data[0].start.split(" ")[0]:""),i=o(()=>a.booked?a.booked.data[0].start.split(" ")[1]:""),f=o(()=>a.booked?a.booked.data[a.booked.data.length-1].end.split(" ")[0]:""),_=o(()=>a.booked?a.booked.data[a.booked.data.length-1].end.split(" ")[1]:""),C=o(()=>{let k=0;return a.booked.ticketsData.forEach(x=>{k+=x.persons}),k}),u=F(a.labels.event_show_more),h=F(!1);function y(){h.value=!h.value,u.value=h.value?a.labels.event_show_less:a.labels.event_show_more}let O=p("containerWidth"),b=p("dialogWidth"),P=o(()=>a.inDialog?b.value:O.value),s=o(()=>he(P.value));return(k,x)=>(n(),m(N,null,[l("div",In,v(`${e(a).labels.event_about_list}:`),1),l("div",{class:R(["am-congrats__info-item am-fs__congrats-info-event-date-start",e(s)])},[l("span",Ln,v(e(a).labels.event_start)+": ",1),l("span",On,v(`${e(Re)(e(t))} ${e(a).labels.event_at} ${e(Ae)(e(i))}`),1)],2),l("div",{class:R(["am-congrats__info-item am-fs__congrats-info-event-date-end",e(s)])},[l("span",Fn,v(e(a).labels.event_end)+": ",1),l("span",zn,v(`${e(Re)(e(f))} ${e(a).labels.event_at} ${e(Ae)(e(_))}`),1)],2),e(a).booked.address?(n(),m("div",{key:0,class:R(["am-congrats__info-item am-fs__congrats-info-event-location",e(s)])},[l("span",Mn,v(e(a).labels.event_location)+": ",1),l("span",Rn,v(e(a).booked.address),1)],2)):w("",!0),e(a).booked.customPricing?(n(),m("div",{key:1,class:R(["am-congrats__info-item am-fs__congrats-info-event-tickets",e(s)])},[l("span",Vn,v(e(a).labels.event_tickets)+": ",1),l("span",{class:"am-congrats__info-item__value",onClick:y},[l("span",null,v(`x${e(C)} `),1),l("span",An,v(e(u)),1)])],2)):w("",!0),e(h)?(n(),m("div",jn,[l("span",Wn,[(n(!0),m(N,null,me(e(a).booked.ticketsData,(r,d)=>(n(),m("span",{key:d},v(`${r.persons} x ${r.name}(${e(ne)(r.price)})`),1))),128))])])):w("",!0),Qe(k.$slots,"payment")],64))}});const qn=l("span",{class:"am-congrats__info-item__label"}," Coupon code: ",-1),Yn={class:"am-congrats__info-item__value"},Hn={class:"am-congrats__info-item__label"},Gn={class:"am-congrats__info-item__value"},Jn={name:"PaymentCongratsInfo"},Zn=Object.assign(Jn,{props:{booked:{type:Object,required:!0},labels:{type:Object,required:!0},coupon:{type:Object,required:!0},inDialog:{type:Boolean,default:!1}},setup(I){const a=I;let t=p("containerWidth"),i=p("dialogWidth"),f=o(()=>a.inDialog?i.value:t.value),_=o(()=>he(f.value));function C(y){if(y.gateway==="onSite")return a.labels.on_site;if(y.gateway==="wc")return y.gatewayTitle;if(y.gateway)return y.gateway.charAt(0).toUpperCase()+y.gateway.slice(1)}let u=o(()=>a.booked&&a.booked.paymentAmount&&a.booked.payments[0].gateway==="onSite"?`${a.labels.congrats_total_amount}:`:`${a.labels.congrats_payment}:`),h=o(()=>{if(a.booked&&a.booked.paymentAmount&&a.booked.payments[0].gateway){let y="";return a.booked.payments[0].gatewayTitle?y=a.booked.payments[0].gatewayTitle:y=C(a.booked.payments[0]),`${ne(a.booked.paymentAmount)} - ${y}`}if(a.booked){let y="";y=a.booked.payments[0].gateway!=="onSite"?ne(a.booked.paymentAmount):ne(a.booked.price);let O="";return a.booked.payments[0].status!=="paid"&&(O=` - ${a.labels.on_site}`),`${y} ${O}`}return""});return(y,O)=>(n(),m(N,null,[e(a).coupon.code&&(e(a).coupon.discount||e(a).coupon.deduction)?(n(),m("div",{key:0,class:R(["am-congrats__info-item",e(_)])},[qn,l("span",Yn,v(e(a).coupon.code),1)],2)):w("",!0),e(a).booked.price>0||e(a).booked.price<=0&&e(a).coupon.code?(n(),m("div",{key:1,class:R(["am-congrats__info-item am-fs__congrats-info-payment",e(_)])},[l("span",Hn,v(e(u)),1),l("span",Gn,v(e(h)),1)],2)):w("",!0)],64))}});const Qn={class:"am-congrats__info-item__label"},Xn={class:"am-congrats__info-item__value"},Kn={class:"am-congrats__info-item__label"},es={class:"am-congrats__info-item__value"},ts={class:"am-congrats__info-item__label"},as={class:"am-congrats__info-item__value"},os={name:"CustomerCongratsInfo"},ns=Object.assign(os,{props:{customer:{type:Object,required:!0},labels:{type:Object,required:!0},inDialog:{type:Boolean,default:!1}},setup(I){const a=I;let t=p("containerWidth"),i=p("dialogWidth"),f=o(()=>a.inDialog?i.value:t.value),_=o(()=>he(f.value));return(C,u)=>(n(),m(N,null,[l("div",{class:R(["am-congrats__info-item am-fs__congrats-info-customer-name",e(_)])},[l("span",Qn,v(e(a).labels.your_name_colon)+": ",1),l("span",Xn,v(`${e(a).customer.firstName} ${e(a).customer.lastName}`),1)],2),e(a).customer.email?(n(),m("div",{key:0,class:R(["am-congrats__info-item am-fs__congrats-info-customer-email",e(_)])},[l("span",Kn,v(e(a).labels.email_address_colon)+": ",1),l("span",es,v(e(a).customer.email),1)],2)):w("",!0),e(a).customer.phone?(n(),m("div",{key:1,class:R(["am-congrats__info-item am-fs__congrats-info-customer-phone",e(_)])},[l("span",ts,v(e(a).labels.phone_number_colon)+": ",1),l("span",as,v(e(a).customer.phone),1)],2)):w("",!0)],64))}});const ss={class:"am-congrats__main"},ls=["src"],is={key:1,class:"am-congrats__main-heading"},rs={key:2,class:"am-congrats__main-heading"},cs={key:3},us={name:"CongratulationsPage"},ms=Object.assign(us,{props:{baseUrls:{type:Object,required:!0},labels:{type:Object,required:!0},booked:{type:Object,required:!0},customer:{type:Object,required:!0},coupon:{type:Object,required:!0},inDialog:{type:Boolean,default:!1}},setup(I){const a=I,t={event:{template:ve(Un),props:{booked:a.booked,labels:a.labels,"in-dialog":a.inDialog}}};let i=o(()=>{if(a.booked&&a.booked.data.length){if(a.booked.type==="appointment")return`${a.labels.appointment_id} #${a.booked.data[0].appointmentId}`;if(a.booked.type==="event")return`${a.labels.event_id} #${a.booked.data[0].eventId}`}return""});return(f,_)=>(n(),m("div",null,[l("div",ss,[e(a).booked.type!=="event"?(n(),m("img",{key:0,src:e(a).baseUrls.wpAmeliaPluginURL+"/v3/src/assets/img/congratulations/congratulations.svg"},null,8,ls)):w("",!0),e(a).booked.type!=="event"?(n(),m("p",is,v(e(a).labels.congratulations),1)):w("",!0),e(a).booked.type==="event"?(n(),m("p",rs,v(e(a).booked.data[0].title),1)):w("",!0),e(i)?(n(),m("span",cs,v(e(i)),1)):w("",!0),Qe(f.$slots,"positionBelowHeading")]),z(pa,null,{info:U(()=>[(n(),H(Le(t[e(a).booked.type].template),ta(aa(t[e(a).booked.type].props)),{payment:U(()=>[z(Zn,{coupon:e(a).coupon,labels:e(a).labels,booked:e(a).booked,"in-dialog":e(a).inDialog},null,8,["coupon","labels","booked","in-dialog"])]),_:1},16))]),customer:U(()=>[z(ns,{labels:e(a).labels,customer:e(a).customer,"in-dialog":e(a).inDialog},null,8,["labels","customer","in-dialog"])]),_:1}),Qe(f.$slots,"positionBottom")]))}});const ps=["href","target","onClick"],ds={name:"AddToCalendar"},_s=Object.assign(ds,{props:{labels:{type:Object,required:!0},booked:{type:Object,required:!0},ready:{type:Boolean,required:!0}},setup(I){const a=I;let t=o(()=>a.booked.type!=="event"?"sbs":"event");const i=re();let f=o(()=>i.getters.getSettings),_=o(()=>i.getters.getBaseUrls.wpAmeliaPluginAjaxURL),C=o(()=>a.ready&&a.booked?[[y(a.booked.data,"google"),{type:"outlook",label:"Outlook",links:[_.value+"/bookings/ics/"+(a.booked.data.length?a.booked.data[0].bookingId:0)+"&type="+(a.booked.type==="package"?"appointment":a.booked.type)+h(a.booked)+"&token="+a.booked.token]}],[y(a.booked.data,"yahoo"),{type:"apple",label:"Apple",links:[_.value+"/bookings/ics/"+(a.booked.data.length?a.booked.data[0].bookingId:0)+"&type="+(a.booked.type==="package"?"appointment":a.booked.type)+h(a.booked)+"&token="+a.booked.token]}]]:[]);function u(s){if(s.links.length>1){let k=!1;setTimeout(function(){s.links.forEach(function(x,r){if(r!==0)if(k)window.open(x,"_blank");else{let d=window.open(x,"_blank");try{d.addEventListener("load",function(){})}catch{k=!0,alert(a.labels.disable_popup_blocker)}}})},1e3)}return!0}function h(s){let k="";return a.booked.type!=="event"&&s.data.forEach((x,r)=>{r>0&&(k+="&recurring[]="+x.bookingId)}),k}function y(s,k){let x=[];switch(k){case"yahoo":return s.forEach(function(r){let d=r.locationId?i.getters["entities/getLocation"](r.locationId):"",c=r.cfAddress?r.cfAddress:d?d.address?d.address:d.name:"",M=(r.utcEnd.getTime()-r.utcStart.getTime())/(60*1e3);M=(M<600?"0"+Math.floor(M/60):Math.floor(M/60)+"")+(M%60<10?"0"+M%60:M%60+"");let V=new Date(r.start),X=O(new Date(V-V.getTimezoneOffset()*(60*1e3)));x.push(encodeURI(["http://calendar.yahoo.com/?v=60&view=d&type=20","&title="+(r.title||""),"&st="+X,"&dur="+(M||""),"&desc="+(r.description||""),"&in_loc="+c].join("")))}),{type:"yahoo",label:"Yahoo",links:x};case"google":return s.forEach(function(r){let d=r.locationId?i.getters["entities/getLocation"](r.locationId):"",c=r.cfAddress?r.cfAddress:d?d.address?d.address:d.name:"",M=O(new Date(r.start)),V=O(new Date(r.end));x.push(encodeURI(["https://www.google.com/calendar/render","?action=TEMPLATE","&text="+(r.title||""),"&dates="+(M||""),"/"+(V||""),"&details="+(r.description||""),"&location="+c,"&sprop=&sprop=name:"].join("")))}),{type:"google",label:"Google",links:x}}}function O(s){return s.toISOString().replace(/-|:|\.\d+/g,"")}let b=p("amColors");const P=o(()=>a.booked.type!=="event"?{"--am-c-atc-text":b.value.colorSbText,"--am-c-atc-text-op10":L(b.value.colorSbText,.1),"--am-c-atc-text-op50":L(b.value.colorSbText,.05)}:{"--am-c-atc-text":b.value.colorMainText,"--am-c-atc-text-op10":L(b.value.colorMainText,.1),"--am-c-atc-text-op50":L(b.value.colorMainText,.05)});return(s,k)=>e(f).general.addToCalendar&&I.booked&&I.booked.data.length?(n(),m("div",{key:0,class:R(`am-atc-${e(t)}`),style:oe(e(P))},[l("p",null,v(e(a).labels.add_to_calendar),1),l("div",{class:R(`am-atc-${e(t)}-cals`)},[(n(!0),m(N,null,me(e(C),(x,r)=>(n(),m("div",{key:r,class:R(`am-atc-${e(t)}-cals-cards`)},[(n(!0),m(N,null,me(x,d=>(n(),m("a",{key:d.type,href:d.links[0],target:d.type==="apple"||d.type==="outlook"?"_self":"_blank",style:oe({borderColor:"var(--am-c-atc-text-op10)"}),class:R(`am-atc-${e(t)}-cals-card`),onClick:c=>u(d)},[l("div",null,[l("span",{class:R(`am-icon-${d.type}`)},null,2)]),l("p",{style:oe({color:"var(--am-c-atc-text)"})},v(d.label),5)],14,ps))),128))],2))),128))],2)],6)):w("",!0)}});const vs={class:"am-skeleton-congratz-heading"},gs={class:"am-skeleton-congratz-booking-info"},fs={name:"LoadingSkeleton"},ys=Object.assign(fs,{setup(I){return(a,t)=>{const i=He,f=Ye;return n(),H(f,{animated:"",class:"am-skeleton-congratz"},{template:U(()=>[l("div",vs,[z(i,{variant:"circle"}),z(i,{variant:"h3"}),z(i,{variant:"text"})]),l("div",gs,[(n(!0),m(N,null,me(new Array(10),(_,C)=>(n(),m("div",{key:_,class:R({"am-customer-info":C===6})},[z(i,{variant:"text",style:oe({width:`${e(ct)(14,36)}%`})},null,8,["style"]),z(i,{variant:"text",style:oe({width:`${e(ct)(14,36)}%`})},null,8,["style"])],2))),128))])]),_:1})}}}),bs={name:"CongratulationsStep",label:"event_congrats",key:"congrats"},hs=Object.assign(bs,{props:{globalClass:{type:String,default:""},inDialog:{type:Boolean,default:!1}},setup(I){const a=I,t=re(),i=o(()=>t.getters.getSettings),f=o(()=>t.getters.getBaseUrls);let _=o(()=>t.getters.getReady),C=o(()=>t.getters.getLoading),u=o(()=>t.getters["eventBooking/getBooked"]),h=o(()=>t.getters["coupon/getCoupon"]),y=o(()=>({firstName:t.getters["customerInfo/getCustomerFirstName"],lastName:t.getters["customerInfo/getCustomerLastName"],email:t.getters["customerInfo/getCustomerEmail"],phone:t.getters["customerInfo/getCustomerPhone"]}));const{footerButtonClicked:O}=p("changingStepsFunctions",{footerButtonClicked:{value:!1}});function b(){u.value.redirectAfterBookingUrl?window.location.href=u.value.redirectAfterBookingUrl:window.location.reload()}Se(()=>{O.value&&b()}),fe(()=>{t.commit("setLoading",!1)});let P=p("stepsArray"),s=p("stepIndex"),k=o(()=>t.getters.getFormKey);const x=p("labels"),r=p("localLanguage");let d=o(()=>{let V=$e(_e({},x)),X=P.value[s.value].key;if(i.value.customizedData&&k.value in i.value.customizedData&&i.value.customizedData[k.value][X].translations){let j=i.value.customizedData[k.value][X].translations;Object.keys(j).forEach(D=>{j[D][r.value]?V[D]=j[D][r.value]:j[D].default&&(V[D]=j[D].default)})}return V});ue("amLabels",d.value);let c=p("amColors");const M=o(()=>u.value.type!=="event"?{"--am-c-atc-text-op40":L(c.value.colorMainText,.4),"--am-c-atc-heading-text-op40":L(c.value.colorSbText,.4),"--am-c-atc-text-op30":L(c.value.colorMainText,.3),"--am-c-atc-text":c.value.colorMainText,"--am-c-atc-heading-text":c.value.colorSbText,"--am-c-atc-bgr-coverage":u.value.type==="package"&&!(i.value.general.addToCalendar&&u.value&&u.value.data.length)?"50%":"80%"}:{"--am-c-atc-text-op40":L(c.value.colorMainText,.4),"--am-c-atc-heading-text-op40":L(c.value.colorMainHeadingText,.4),"--am-c-atc-text-op30":L(c.value.colorMainText,.3),"--am-c-atc-text":c.value.colorMainText,"--am-c-atc-heading-text":c.value.colorMainHeadingText});return(V,X)=>e(_)&&e(u)&&!e(C)?(n(),m("div",{key:0,style:oe(e(M)),class:R(["am-elf__main-content am-elf__congrats",e(a).globalClass])},[z(ms,{labels:e(d),"base-urls":e(f),booked:e(u),coupon:e(h),customer:e(y),"in-dialog":e(a).inDialog},{positionBottom:U(()=>[z(_s,{class:"am-congrats__main-atc",booked:e(u),labels:e(d),ready:e(_)},null,8,["booked","labels","ready"])]),_:1},8,["labels","base-urls","booked","coupon","customer","in-dialog"])],6)):(n(),H(ys,{key:1}))}});const ks=l("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),xs=l("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),Cs=["href"],Ps={key:0,class:"am-dialog-el-header"},$s={name:"EventsListFormWrapper"},Ds=Object.assign($s,{emits:["isRestored"],setup(I,{emit:a}){const t=ve(ro),i=ve(go),f=ve($o),_=ve(Dn),C=ve(hs);let u=p("isMounted");const h=F(!1);ue("popupVisible",h);const y=p("settings"),O=p("baseUrls"),b=re();b.commit("setFormKey","elf");const P=p("shortcodeData");b.commit("shortcodeParams/setShortcodeParams",P.value),b.commit("bookableType/setType","event");let s=F(null),k=F(null),x=o(()=>b.getters["eventEntities/getEvents"]);function r(ae){b.commit("eventEntities/setEvents",ae)}let d=F(0);ue("containerWidth",d);let c=F(0);ue("dialogWidth",c),window.addEventListener("resize",M);function M(){s.value&&(d.value=s.value.offsetWidth),k.value&&(c.value=k.value.offsetWidth)}let V=o(()=>b.getters.getReady),X=o(()=>b.getters.getLoading),j=o(()=>b.getters["eventBooking/getBooked"]);const D=F(0);ue("stepIndex",D);const T=F([t,f,C]);ue("stepsArray",T);let A=F([]);ue("eventFluidStepKey",A),Me(A,ae=>{if(ae.indexOf("eventTickets")>-1&&T.value.find(K=>K.name==="EventTickets")===void 0&&T.value.splice(D.value+1,0,i),ae.indexOf("eventTickets")<0&&T.value.find(K=>K.name==="EventTickets")!==void 0){let K=T.value.indexOf(i);T.value.splice(K,1)}if(ae.indexOf("eventPayment")>-1&&T.value.find(K=>K.name==="EventPayment")===void 0&&T.value.splice(D.value+1,0,_),ae.indexOf("eventPayment")<0&&T.value.find(K=>K.name==="EventPayment")!==void 0){let K=T.value.indexOf(_);T.value.splice(K,1)}},{deep:!0});let Z=F(!1);ue("bringingAnyoneVisibility",Z);let Y=F(!1),Q=F(!1),W=o(()=>j.value!==null?j.value.customerCabinetUrl.length>0:!0);function pe(){b.commit("setLoading",!0),D.value=D.value+1}function ee(){b.commit("setLoading",!0),D.value=D.value-1,q.value=!q.value}function J(){Y.value=!0;let ae=document.getElementsByClassName("am-dialog-el")[0];et(ae.children[0],ae.children[0].children[0],50,300)}function se(){Y.value=!1}function ke(ae){Q.value=ae}let q=F(!1);function G(){q.value=!0}function S(){q.value=!1}function g(){T.value[D.value].name==="CongratulationsStep"&&j.value?window.location.href=j.value.customerCabinetUrl:h.value=!1}ue("secondButton",{secondButtonClick:g}),ue("changingStepsFunctions",{nextStep:pe,previousStep:ee,footerButtonClick:J,footerButtonReset:se,footerBtnDisabledUpdater:ke,footerButtonClicked:Y,footerBtnDisabled:Q,headerButtonPreviousClick:G,headerButtonPreviousReset:S,headerButtonPreviousClicked:q}),b.dispatch("eventEntities/requestEntities",{types:["tags","employees","locations","customFields","taxes"],loadEntities:P.value.trigger||window.ameliaShortcodeData.filter(ae=>!ae.hasApiCall).length===window.ameliaShortcodeData.length?!0:P.value.hasApiCall}),fe(()=>{document.getElementById("amelia-v2-booking-"+P.value.counter).classList.add("amelia-v2-booking-"+P.value.counter+"-loaded"),Me(V,ae=>{ae&&Ie(b,{events:x,useEvents:r},"ViewContent","event",null,null)}),Ve(()=>{s.value&&(d.value=s.value.offsetWidth),k.value&&(c.value=k.value.offsetWidth)}),Ie(b,{containerWidth:d},"ContainerWidth","event",null,null),u.value=!0});function E(){T.value[D.value].name==="CongratulationsStep"&&(b.commit("setReady",!1),window.location.reload()),A.value=[],D.value=0}function B(){Ve(()=>{b.dispatch("persons/resetPersons"),b.dispatch("coupon/resetCoupon"),b.dispatch("tickets/resetCustomTickets")})}function $(){Ve(()=>{k.value&&(c.value=k.value.offsetWidth)})}Me(V,ae=>{if(ae){let K=sa(b,P.value);if(K){T.value.splice(0,T.value.length),D.value=0,K.steps.forEach(Et=>{switch(Et){case"EventInfo":T.value.push(t);break;case"EventTickets":T.value.push(i);break;case"EventCustomerInfo":T.value.push(f);break;case"EventPayment":T.value.push(_);break;case"CongratulationsStep":T.value.push(C);break}D.value++}),b.commit("setLoading",!1);let ce=-1;K.result==="success"?ce=T.value.length-1:(K.result==="error"||K.result==="canceled")&&(ce=T.value.length-2),D.value=ce,h.value=!0,a("isRestored",!0)}}});let le=o(()=>y.customizedData&&"elf"in y.customizedData?y.customizedData.elf:qe.elf);ue("customizedDataForm",le);const ge=p("labels"),xe=p("localLanguage");let ie=o(()=>y.general.usedLanguages.includes(xe.value)),Oe=o(()=>{let ae={},K=le.value[T.value[D.value].key].translations;return K&&Object.keys(K).forEach(ce=>{K[ce][xe.value]&&ie.value?ae[ce]=K[ce][xe.value]:K[ce].default&&(ae[ce]=K[ce].default)}),Object.keys(ae).length?ae:ge}),Ce=o(()=>le.value[T.value[D.value].key].options),$t=o(()=>"secBtn"in Ce.value&&"visibility"in Ce.value.secBtn?Ce.value.secBtn.visibility:!0);const De=F(y.customizedData?y.customizedData.fonts:qe.fonts);ue("amFonts",De);let te=o(()=>y.customizedData&&"elf"in y.customizedData?y.customizedData.elf.colors:qe.elf.colors);ue("amColors",te);let tt=o(()=>({"--am-c-primary":te.value.colorPrimary,"--am-c-success":te.value.colorSuccess,"--am-c-error":te.value.colorError,"--am-c-warning":te.value.colorWarning,"--am-c-main-bgr":te.value.colorMainBgr,"--am-c-main-heading-text":te.value.colorMainHeadingText,"--am-c-main-text":te.value.colorMainText,"--am-c-sb-bgr":te.value.colorSbBgr,"--am-c-sb-text":te.value.colorSbText,"--am-c-inp-bgr":te.value.colorInpBgr,"--am-c-inp-border":te.value.colorInpBorder,"--am-c-inp-text":te.value.colorInpText,"--am-c-inp-placeholder":te.value.colorInpPlaceHolder,"--am-c-drop-bgr":te.value.colorDropBgr,"--am-c-drop-text":te.value.colorDropText,"--am-c-card-bgr":te.value.colorCardBgr,"--am-c-card-text":te.value.colorCardText,"--am-c-card-border":te.value.colorCardBorder,"--am-c-btn-prim":te.value.colorBtnPrim,"--am-c-btn-prim-text":te.value.colorBtnPrimText,"--am-c-btn-sec":te.value.colorBtnSec,"--am-c-btn-sec-text":te.value.colorBtnSecText,"--am-c-skeleton-op20":L(te.value.colorMainText,.2),"--am-c-skeleton-op60":L(te.value.colorMainText,.6),"--am-font-family":De.value.fontFamily,"--am-mw-main":"792px","--am-hd-main":D.value>0?"592px":"652px","--am-c-scroll-op30":L(te.value.colorPrimary,.3),"--am-c-scroll-op10":L(te.value.colorPrimary,.1),"--am-rad-input":"6px","--am-mb-dialog":"300px"}));function St(){let ae=document.head||document.getElementsByTagName("head")[0];ae.querySelector("#amCustomFont")&&ae.querySelector("#amCustomFont").remove();let K=`@font-face {font-family: '${De.value.fontFamily}'; src: url(${De.value.fontUrl});}`,ce=document.createElement("style");ae.appendChild(ce),ce.setAttribute("type","text/css"),ce.setAttribute("id","amCustomFont"),ce.appendChild(document.createTextNode(K))}return De.value.customFontSelected&&St(),(ae,K)=>(n(),m(N,null,[De.value.customFontSelected?w("",!0):(n(),m(N,{key:0},[ks,xs,l("link",{rel:"stylesheet",type:"text/css",href:`${e(O).wpAmeliaPluginURL}v3/src/assets/scss/common/fonts/font.css`,media:"all"},null,8,Cs)],64)),l("div",{id:"amelia-container",ref_key:"ameliaContainer",ref:s,class:"am-elf",style:oe(e(tt))},[e(V)?(n(),m(N,{key:0},[z(Va),z(oa,{modelValue:h.value,"onUpdate:modelValue":K[0]||(K[0]=ce=>h.value=ce),width:"650px","append-to-body":!0,"destroy-on-close":!0,"align-center":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"modal-class":"amelia-v2-booking am-dialog-el","custom-styles":e(tt),onClose:E,onClosed:B,onOpened:$},{default:U(()=>[l("div",{id:"amelia-container",ref_key:"dialogContainer",ref:k},[D.value>0?(n(),m("div",Ps,[z(da,{ready:e(V),loading:e(X),"customized-labels":e(Oe)},null,8,["ready","loading","customized-labels"])])):w("",!0),(n(),H(Le(T.value[D.value]),{"in-dialog":!0,"global-class":"am-dialog-el__main-container"})),z(_a,{loading:e(X),"second-button-show":e(W)&&e($t)&&e(y).roles.customerCabinet.enabled&&e(y).roles.customerCabinet.pageUrl!==null,"payment-gateway":e(b).getters["payment/getPaymentGateway"],"customized-labels":e(Oe),"primary-footer-button-type":e(Ce).primBtn.buttonType,"secondary-footer-button-type":e(Ce).secBtn.buttonType},null,8,["loading","second-button-show","payment-gateway","customized-labels","primary-footer-button-type","secondary-footer-button-type"])],512)]),_:1},8,["modelValue","custom-styles"])],64)):(n(),H(xt,{key:1,"display-number":e(y).general.itemsPerPage},null,8,["display-number"]))],4),z(e(na))],64))}});export{Ds as default};
