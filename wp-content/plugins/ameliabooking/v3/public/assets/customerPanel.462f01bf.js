import{bu as Gn,bv as yu,aF as Xn,k as _,p as M,j as F,bw as bu,o as u,c as x,h as $,b as a,a8 as ye,n as R,m as be,l as W,v as Fr,a as d,w as S,f as ie,t as w,_ as ke,g as N,bx as ku,by as Cu,bz as xu,bA as wu,aX as dt,aP as ve,b7 as Nt,bB as Qn,bh as Zi,u as Ie,e as q,a5 as _a,r as pe,F as ee,a_ as Ja,bC as ul,al as Ve,bD as an,ai as We,av as dl,au as ml,bE as Ya,aC as Pe,aV as Kn,y as lt,E as Ge,Z as gn,s as Je,aS as tt,b6 as $t,ac as Ct,b5 as et,bF as $o,bG as Tu,bH as Vr,bI as Su,B as Be,C as el,D as rt,q as Gi,aY as Xa,aZ as Qa,ay as Ea,bJ as Eu,bK as Io,bL as Lu,bM as Au,ah as St,bN as Ji,aG as xt,bO as Is,bP as Os,aL as ft,aW as ht,bQ as fn,bR as $u,bo as Ka,bS as Rr,aa as qr,bT as Mt,bU as qt,aq as Yt,bV as ra,bW as hn,ar as Ur,bX as Iu,bY as Wt,bZ as Ou,aM as ot,aD as vn,b_ as Pu,b$ as sn,z as nt,c0 as pl,d as jr,ao as Nu,aj as Du,c1 as Mu,c2 as Bu,c3 as Oo,c4 as Po,b8 as gt,c5 as zr,b4 as Fu,c6 as gl,c7 as Vu,c8 as Ru,aJ as Oa,aI as fl,aO as qu,c9 as Uu,ca as ju,cb as Yr,cc as zu,cd as Yu,ce as Xi,cf as Wu,cg as Hu,ch as No,ci as Zu,a9 as Gu,ae as Ju}from"./stepForm.43f5bea5.js";import{e as Xu,n as Ye,o as Qu,m as at,p as tl}from"./eventListForm.d9ed0602.js";import{_ as He}from"./catalogForm.c6dab7cf.js";function Dt(n,e){let t=e!==""?JSON.parse(n.translations)[e]:JSON.parse(n.translations);if(Gn in t)return t[Gn];let s=Object.keys(t),l=Object.keys(t).map(o=>o.length>2?o.slice(0,2):o),i="";for(let o=0;o<l.length;o++){if(yu===s[o]&&t[s[o]]){i=t[s[o]];break}l[o]===Gn&&t[s[o]]&&(i=t[s[o]])}return i}function di(n,e){return n.translations&&JSON.parse(n.translations)[e]&&Dt(n,e)?Dt(n,e):n[e]}function Rt(n){return n.translations&&JSON.parse(n.translations).name&&Dt(n,"name")?Dt(n,"name"):n.name}function Ku(n){return n.translations&&Dt(n,"")?Dt(n,""):n.name}function ME(n){return n.translations&&Dt(n,"")?Dt(n,""):n.content}function ed(n){return n.translations&&Dt(n,"name")?Dt(n,"name"):n.label}function td(n){return n.translations&&Dt(n,"")?Dt(n,""):n.label}function oa(n){return n.translations&&JSON.parse(n.translations).description&&Dt(n,"description")?Dt(n,"description"):n.description}function BE(n){n.services&&n.services.length&&n.services.forEach(e=>{e.name=Rt(e),e.description=oa(e),e.extras.forEach(t=>{t.name=Rt(t),t.description=oa(t)})}),n.locations&&n.locations.length&&n.locations.forEach(e=>{e.name=Rt(e),e.description=oa(e)}),n.packages&&n.packages.length&&n.packages.forEach(e=>{e.name=Rt(e),e.description=oa(e),e.bookable.forEach(t=>{t.service.name=Rt(t.service),t.service.description=oa(t.service),"extras"in t.service&&t.service.extras.forEach(s=>{s.name=Rt(s),s.description=oa(s)})})}),n.categories&&n.categories.length&&n.categories.forEach(e=>{e.name=Rt(e),e.serviceList.forEach(t=>{t.name=Rt(t),t.description=oa(t),t.extras.forEach(s=>{s.name=Rt(s),s.description=oa(s)})})}),n.events&&n.events.length&&n.events.forEach(e=>{e.name=Rt(e),e.description=oa(e),e.extras.forEach(t=>{t.name=Rt(t),t.description=oa(t)})}),n.customFields&&n.customFields.length&&n.customFields.forEach(e=>{e.label=ed(e),e.options.forEach(t=>{t.label=td(t)})}),n.employees&&n.employees.length&&n.employees.forEach(e=>{e.firstName=di(e,"firstName"),e.lastName=di(e,"lastName"),e.description=di(e,"description")})}const st={props:{modelValue:{type:[Boolean,String,Number],default:!1},id:{type:String},name:{type:String},width:{type:[Number,String]},size:{type:String,default:"default",validator(n){return["large","default","small"].includes(n)}},validateEvent:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeIconClass:{type:String,default:""},inactiveIconClass:{type:String,default:""},activeIcon:{type:String,default:""},inactiveIcon:{type:String,default:""},beforeChange:{type:[Function,Boolean],default:()=>{}},borderColor:{type:String,default:""},inlinePrompt:{type:Boolean,default:!1},parentClass:{type:String,default:""},class:{type:String,default:""}},emits:["update:modelValue","change"],setup(n,{emit:e}){const t=n,{modelValue:s}=Xn(t),l=_({get:()=>s.value,set:c=>e("update:modelValue",c)}),i=M(null),o=F("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF",colorBtnWaiting:"#CCA20C",colorBtnWaitingText:"#FFFFFF",colorBtnDanger:"#B4190F",colorBtnDangerText:"#FFFFFF"})),r=_(()=>({"--am-c-switch-bgr-active":o.value.colorBtnPrim,"--am-c-switch-bgr-inactive":o.value.colorInpBorder,"--am-c-switch-action":o.value.colorBtnPrimText,"--am-c-switch-text":o.value.colorMainText}));return(c,m)=>{const g=bu;return u(),x("div",{class:R(["am-switch-wrapper",n.parentClass]),style:be(a(r))},[$(g,{id:n.id,ref_key:"amSwitch",ref:i,modelValue:a(l),"onUpdate:modelValue":m[0]||(m[0]=f=>ye(l)?l.value=f:null),class:R(["am-switch",t.class]),name:n.name,width:n.width,size:n.size,"validate-event":n.validateEvent,loading:n.loading,disabled:n.disabled,"active-color":n.activeColor,"inactive-color":n.inactiveColor,"active-text":n.activeText,"inactive-text":n.inactiveText,"active-value":n.activeValue,"inactive-value":n.inactiveValue,"active-icon-class":n.activeIconClass,"inactive-icon-class":n.inactiveIconClass,"active-icon":n.activeIcon,"inactive-icon":n.inactiveIcon,"before-change":n.beforeChange,"border-color":n.borderColor,"inline-prompt":n.inlinePrompt,onChange:m[1]||(m[1]=f=>e("change",f))},null,8,["id","modelValue","class","name","width","size","validate-event","loading","disabled","active-color","inactive-color","active-text","inactive-text","active-value","inactive-value","active-icon-class","inactive-icon-class","active-icon","inactive-icon","before-change","border-color","inline-prompt"])],6)}}};const ad={props:{ready:{type:Boolean,default:!0}},setup(n){let e=F("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),t=_(()=>({"--am-c-caph-text":e.value.colorMainText,"--am-c-caph-heading-text":e.value.colorMainHeadingText,"--am-c-caph-text-op15":W(e.value.colorMainText,.15)}));return(s,l)=>(u(),x("div",{class:"am-caph__main",style:be(a(t))},[Fr(s.$slots,"default")],4))}};const sd={key:0},nd={key:1},ld={key:2},id={name:"MainProfileFooter"},od=Object.assign(id,{props:{parentWidth:{type:Number,default:1200},display:{type:String,default:"first"},loading:{type:Boolean,default:!1},customizedLabels:{type:Object,default:()=>({})},deleteFooterType:{type:String,default:"plain"},saveFooterButton:{type:String,default:"filled"},passFooterButton:{type:String,default:"filled"}},setup(n){const e=n,t=F("labels");function s(g){return Object.keys(e.customizedLabels).length&&e.customizedLabels[g]?e.customizedLabels[g]:t[g]}const l=F("settings");let i=F("deleteProfileDialog",M(!1)),o=F("saveProfileChanges",()=>{}),r=F("changeProfilePassword",()=>{}),c=F("amColors"),m=_(()=>({"--am-c-cappf-bgr":c.value.colorMainBgr,"--am-c-cappf-text":c.value.colorMainText,"--am-c-cappf-text-op15":W(c.value.colorMainText,.15)}));return(g,f)=>(u(),x("div",{class:"am-cappf",style:be(a(m))},[d("div",{class:R(["am-cappf__options",{"am-only-one":n.display==="second"||!a(l).roles.allowCustomerDeleteProfile}])},[n.display==="first"&&a(l).roles.allowCustomerDeleteProfile?(u(),x("div",sd,[$(ke,{category:"danger",size:a(e).parentWidth<=360?"small":"default",type:a(e).deleteFooterType,class:"am-cappf__delete",disabled:n.loading,onClick:f[0]||(f[0]=v=>ye(i)?i.value=!0:i=!0)},{default:S(()=>[ie(w(s("delete_profile")),1)]),_:1},8,["size","type","disabled"])])):N("",!0),n.display==="first"?(u(),x("div",nd,[$(ke,{type:a(e).saveFooterButton,size:a(e).parentWidth<=360?"small":"default",disabled:n.loading,onClick:f[1]||(f[1]=v=>a(o)())},{default:S(()=>[ie(w(s("save_changes")),1)]),_:1},8,["type","size","disabled"])])):N("",!0),n.display==="second"?(u(),x("div",ld,[$(ke,{type:a(e).passFooterButton,size:a(e).parentWidth<=360?"small":"default",disabled:n.loading,onClick:f[2]||(f[2]=v=>a(r)())},{default:S(()=>[ie(w(s("change_password")),1)]),_:1},8,["type","size","disabled"])])):N("",!0)],2)],4))}});const rd=d("span",{class:"am-icon-calendar"},null,-1),cd={class:"am-date-picker__input-inner"},ud={class:"am-date-picker__input-start"},dd=d("span",{class:"am-date-picker__input-separator"}," - ",-1),md={class:"am-date-picker__input-end"},Ht={props:{id:{type:String},modelValue:{type:[String,Array,Object,Number]},type:{type:String,default:"date"},defaultValue:{type:[String,Array,Object,Number]},valueFormat:{type:String},value:{type:[String,Array,Object,Number]},format:{type:String},editable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},clearable:{type:Boolean,default:!1},name:{type:String,default:""},placeholder:{type:String,default:"Select Date"},popperClass:{type:String,default:""},teleported:{type:Boolean,default:!0},clearIcon:{type:[String,Object],default:ku},prefixIcon:{type:[String,Object],default:Cu},disabledDate:{type:Function,default:()=>{}},lang:{type:String,default:""},customInputDisplay:{type:Boolean,default:!1}},emits:["change","input","visible-change","remove-tag","clear","blur","focus","calendar-change","panel-change","update:modelValue"],setup(n,{emit:e}){const t=n,s=v=>{const k={};for(const T in v)k[T]=v[T].value;return k},{size:l,...i}=s(Xn(t));let{modelValue:o}=Xn(t),r=_({get:()=>o.value,set:v=>{e("update:modelValue",v)}});const c=M(null);function m(){c.value&&c.value.focus()}let g=F("amColors"),f=_(()=>({"--am-c-primary":g.value.colorPrimary,"--am-c-success":g.value.colorSuccess,"--am-c-error":g.value.colorError,"--am-c-warning":g.value.colorWarning,"--am-c-main-bgr":g.value.colorMainBgr,"--am-c-main-heading-text":g.value.colorMainHeadingText,"--am-c-main-text":g.value.colorMainText,"--am-c-sb-bgr":g.value.colorSbBgr,"--am-c-sb-text":g.value.colorSbText,"--am-c-inp-bgr":g.value.colorInpBgr,"--am-c-inp-border":g.value.colorInpBorder,"--am-c-inp-text":g.value.colorInpText,"--am-c-inp-text-op03":W(g.value.colorInpText,.03),"--am-c-inp-text-op60":W(g.value.colorInpText,.6),"--am-c-inp-placeholder":g.value.colorInpPlaceHolder,"--am-c-drop-bgr":g.value.colorDropBgr,"--am-c-drop-text":g.value.colorDropText,"--am-c-drop-text-op03":W(g.value.colorDropText,.03),"--am-c-drop-text-op10":W(g.value.colorDropText,.1),"--am-c-drop-text-op30":W(g.value.colorDropText,.3),"--am-c-drop-text-op50":W(g.value.colorDropText,.5),"--am-c-drop-text-op70":W(g.value.colorDropText,.7),"--am-c-drop-text-op80":W(g.value.colorDropText,.8),"--am-c-drop-border":g.value.colorDropBorder,"--am-c-btn-prim":g.value.colorBtnPrim,"--am-c-btn-prim-text":g.value.colorBtnPrimText,"--am-c-btn-sec":g.value.colorBtnSec,"--am-c-btn-sec-text":g.value.colorBtnSecText,"--am-c-btn-danger":g.value.colorBtnDanger,"--am-c-btn-danger-text":g.value.colorBtnDangerText,"--am-c-skeleton-op20":W(g.value.colorMainText,.2),"--am-c-skeleton-op60":W(g.value.colorMainText,.6),"--am-c-skeleton-sb-op20":W(g.value.colorSbText,.2),"--am-c-skeleton-sb-op60":W(g.value.colorSbText,.6)}));return(v,k)=>{const T=xu,y=wu;return u(),x("div",{class:R(["am-date-picker-wrapper",`am-date-picker--${a(l)}`])},[t.customInputDisplay&&t.type==="daterange"&&a(r).length?(u(),x("div",{key:0,class:R(["am-date-picker__input",`am-date-picker--${a(l)}`]),onClick:m},[rd,d("div",cd,[d("span",ud,w(a(dt)(a(ve)(a(r)[0]).format("YYYY-MM-DD"))),1),dd,d("span",md,w(a(dt)(a(ve)(a(r)[1]).format("YYYY-MM-DD"))),1)])],2)):N("",!0),$(y,{locale:a(Xu)(t.lang)},{default:S(()=>[$(T,Nt(i,{id:n.id,ref_key:"amDatePicker",ref:c,modelValue:a(r),"onUpdate:modelValue":k[0]||(k[0]=b=>ye(r)?r.value=b:r=b),type:n.type,value:n.value,"prefix-icon":n.prefixIcon,"popper-class":n.popperClass,placeholder:n.placeholder,"clear-icon":n.clearIcon,"default-value":n.defaultValue,clearable:n.clearable,"disabled-date":n.disabledDate,disabled:n.disabled,"value-format":n.valueFormat,format:n.format,editable:n.editable,class:["am-date-picker",[`am-date-picker--${a(l)}`,{"am-date-picker--disabled":n.disabled},{"am-date-picker--custom":t.type==="daterange"&&t.customInputDisplay}]],"popper-style":a(f),style:a(f),onInput:k[1]||(k[1]=b=>v.$emit("input",b)),onChange:k[2]||(k[2]=b=>v.$emit("change",b)),onBlur:k[3]||(k[3]=b=>v.$emit("blur",b)),onFocus:k[4]||(k[4]=b=>v.$emit("focus",b)),onCalendarChange:k[5]||(k[5]=b=>v.$emit("calendar-change",b)),onPanelChange:k[6]||(k[6]=b=>v.$emit("panel-change",b))}),null,16,["id","modelValue","type","value","prefix-icon","popper-class","placeholder","clear-icon","default-value","clearable","disabled-date","disabled","value-format","format","editable","popper-style","style","class"])]),_:1},8,["locale"])],2)}}};function pd(n,e,t){let s={};return n.forEach(l=>{e===""&&l.periods.forEach(g=>{g.periodStart=Qn(g.periodStart),g.periodEnd=Qn(g.periodEnd)});let o=ve(l.periods[0].periodStart,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"),r=t.getters.getSettings.general.usedLanguages.map(g=>g.length>2?g.slice(0,2):g);(t.getters.getSettings.general.usedLanguages.indexOf(t.getters.getLocalLanguage)!==-1||r.indexOf(t.getters.getLocalLanguage.split("_")[0])!==-1)&&(l.name=Rt(l),l.customTickets.forEach(g=>{g.name=Ku(g)})),l.recurring&&l.recurring.until&&(l.recurring.until=l.recurring.until.split(" ")[0]),o in s||(s[o]={date:o,events:[]});let m=l.bookings.some(g=>g.status==="waiting");if(l.full&&l.status==="approved"?l.status="full":l.upcoming&&l.status==="approved"&&(l.status="upcoming"),m&&(l.status="waiting"),t.getters["auth/getProfile"].type==="provider"){let g=JSON.parse(JSON.stringify(l));s[o].events.push(g)}else l.bookings.forEach(g=>{let f=JSON.parse(JSON.stringify(l));f.bookings=[g],s[o].events.push(f)})}),s}function Wr(n){let e=0;return n.bookings.forEach(t=>{if(["approved","pending"].includes(t.status)){let s=0;if(t.ticketsData.length>0)for(let i=0;i<t.ticketsData.length;i++)s+=t.ticketsData[i].persons*t.ticketsData[i].price;else s+=n.price;let l=Zi(n,t.coupon,t.tax?t.tax[0]:null,s,!1);e+=l.price-l.discount+l.tax}}),e>=0?e:0}function gd(n){let e=[];return n.forEach(t=>{let s=ve(t.periodStart.split(" ")[0],"YYYY-MM-DD"),l=ve(t.periodEnd.split(" ")[0],"YYYY-MM-DD"),i=t.periodStart.split(" ")[1].slice(0,5),o=t.periodEnd.split(" ")[1].slice(0,5);o==="00:00"&&(o="24:00",l.subtract(1,"days"));let r=[];for(;s.isSameOrBefore(l);)r.push(s.format("YYYY-MM-DD")),s.add(1,"days");r.forEach(c=>{e.push({date:c,startTime:i,endTime:o,periodStart:c+" "+i,periodEnd:c+" "+o,zoomLink:n.length>1&&t.zoomMeeting?t.zoomMeeting.joinUrl:"",lessonSpaceLink:n.length>1&&t.lessonSpace?t.lessonSpace:"",googleMeetLink:n.length>1&&t.googleMeetUrl?t.googleMeetUrl:"",microsoftTeamsLink:n.length>1&&t.microsoftTeamsUrl?t.microsoftTeamsUrl:""})})}),e}function fd(n){let e={};return n.bookings.forEach(t=>{["approved","pending"].includes(t.status)&&t.ticketsData&&t.ticketsData.length&&t.ticketsData.forEach(s=>{s.eventTicketId in e||(e[s.eventTicketId]={persons:0,price:s.price,name:n.customTickets.find(l=>l.id===s.eventTicketId).name}),e[s.eventTicketId].persons=e[s.eventTicketId].persons+s.persons})}),e}function hd(n,e){let t=n.getters["entities/getLocations"];if(e.locationId&&t.length){let s=t.find(l=>l.id===e.locationId);return typeof s<"u"?s:null}else if(e.customLocation)return{address:"",name:e.customLocation};return null}const vd={class:"am-msd__item-wrapper"},_d={class:"am-msd__item-inner"},yd={class:"am-msd__item-heading"},bd=d("div",{class:"am-msd__item-icon"},[d("span",{class:"am-icon-close"})],-1),kd=["onClick"],Cd={class:"am-msd__item-inner"},xd={class:"am-msd__item-icon"},wd={class:"am-msd__item-heading"},Td=d("div",{class:"am-msd__item-indicator"},[d("span",{class:"am-icon-arrow-big-right"})],-1),Sd={key:1,class:"am-msd__item-divider"},Ed={class:"am-msd__item-inner"},Ld=d("div",{class:"am-msd__item-icon"},[d("span",{class:"am-icon-logout"})],-1),Ad={class:"am-msd__item-heading"},$d={props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},monitor:{type:String,required:!0},menuItems:{type:Array,required:!0},customCss:{type:Object,default:()=>{}},width:{type:Number,default:300},position:{type:String,default:"right",validator(n){return["right","left","top","bottom"].includes(n)}}},emits:["click","update:visibility","logout"],setup(n,{emit:e}){const t=n;let s=F("labels");const l=Ie();function i(m,g){e("click",{step:m,index:g}),e("update:visibility",!1)}function o(){e("update:visibility",!1)}function r(m){return Object.keys(t.customizedLabels).length&&t.customizedLabels[m]?t.customizedLabels[m]:s[m]}let c=_(()=>({"--am-mw-msd":`${t.width}px`}));return(m,g)=>(u(),q(Ja,{visibility:n.visibility,position:n.position,"custom-class":"am-msd","close-outside":!0,"custom-css":{...n.customCss,...a(c)},"onUpdate:visibility":g[1]||(g[1]=f=>a(e)("update:visibility",!1))},{footer:S(()=>[d("div",{class:"am-msd__item",onClick:g[0]||(g[0]=()=>a(e)("logout"))},[d("div",Ed,[Ld,d("p",Ad,w(r("log_out")),1)])])]),default:S(()=>[d("div",vd,[d("div",{class:"am-msd__item",onClick:o},[d("div",_d,[$(_a,{name:"fade"},{default:S(()=>[d("p",yd,w(r("menu_title")),1)]),_:1}),$(_a,{name:"fade"},{default:S(()=>[bd]),_:1})])]),(u(!0),x(ee,null,pe(n.menuItems,(f,v)=>(u(),x(ee,{key:f.key},[f.key!=="packages"||a(l).getters["entities/getPackages"].length?(u(),x("div",{key:0,class:R(["am-msd__item",{selected:n.monitor===f.key}]),onClick:k=>i(f,v)},[d("div",Cd,[d("div",xd,[d("span",{class:R(`am-icon-${f.icon}`)},null,2)]),$(_a,{name:"fade"},{default:S(()=>[d("p",wd,w(f.label),1)]),_:2},1024),$(_a,{name:"fade"},{default:S(()=>[Td]),_:1})])],10,kd)):N("",!0),v===0?(u(),x("div",Sd)):N("",!0)],64))),128))])]),_:1},8,["visibility","position","custom-css"]))}};const Ti={props:{size:{type:String,default:"default"}},setup(n){const e=n,t=ul().cookies,s=F("settings");let l=F("cabinetType"),{bookingsCounterChanger:i}=F("bookingsCounterChanger",{bookingsCounterChanger:()=>{}});const o=Ie();let r=_({get:()=>o.getters["cabinet/getTimeZone"],set:k=>{o.commit("cabinet/setTimeZone",k||"")}}),c=_(()=>o.getters["appointment/getActive"]||o.getters["event/getActive"]||o.getters["attendee/getActive"]);const m=F("timeZone"),g=F("timeZones");function f(){let k;s.general.showClientTimeZone?k=an():k=m.value,t.set("ameliaUserTimeZone",k,s.roles[l.value+"Cabinet"].tokenValidTime),i(),o.commit("cabinet/setTimeZone",k)}function v(k){t.set("ameliaUserTimeZone",k,s.roles[l.value+"Cabinet"].tokenValidTime),i()}return(k,T)=>a(c)?N("",!0):(u(),q(We,{key:0,modelValue:a(r),"onUpdate:modelValue":T[0]||(T[0]=y=>ye(r)?r.value=y:r=y),filterable:!0,placeholder:a(an)(),clearable:!0,size:a(e).size,"custom-class":"am-ctz","prefix-icon":"globe-watch",onClear:f,onChange:v},{default:S(()=>[(u(!0),x(ee,null,pe(a(g),(y,b)=>(u(),q(Ve,{key:b,value:y,label:y},{default:S(()=>[ie(w(y),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","size"]))}};function Hr(){return"ameliaBooking"in window&&"cabinet"in window.ameliaBooking&&"disableAuthorizationHeader"in window.ameliaBooking.cabinet&&window.ameliaBooking.cabinet.disableAuthorizationHeader}function Ue(n){let e=n.getters["auth/getToken"];return e&&!Hr()?{headers:{Authorization:"Bearer "+e}}:{}}const Id={key:0,class:"el-skeleton-item-wrapper-title"},Od={name:"AuthSkeleton"},Zt=Object.assign(Od,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const e=n;return(t,s)=>{const l=dl,i=ml;return u(),q(i,{animated:"",class:R(["am-asi-el-skeleton",a(e).mainClass])},{template:S(()=>[a(e).centerFirst?(u(),x("div",Id,[$(l,{variant:"rect"})])):N("",!0),(u(!0),x(ee,null,pe(new Array(a(e).count),o=>(u(),x("div",{key:o,class:"el-skeleton-item-wrapper"},[$(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});function Pd(n,e){let t=Ya(Ya(Ya(window.location.href,"code"),"state"),"scope");Pe.post("/google/authorization/token",{authCode:n,userId:Kn(window.location.href).state,redirectUri:t}).then(()=>{history.pushState(null,null,t)}).catch(s=>{console.log(s)}).finally(()=>{e()})}function Nd(n){n.getters["auth/getGoogleLoading"]||(n.commit("auth/setGoogleLoading",!0),Pe.get("/google/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},Ue(n))).then(e=>{window.location.href=e.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(e=>{console.log(e),n.commit("auth/setGoogleLoading",!1)}))}function Dd(n){n.commit("auth/setGoogleLoading",!0),Pe.post("/google/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setGoogleId",null),n.commit("employee/setGoogleCalendarId",""),n.commit("employee/setGoogleToken",null),n.commit("auth/setGoogleCalendars",[])}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setGoogleLoading",!1)})}function Md(n,e){let t=Ya(Ya(Ya(window.location.href,"code"),"state"),"type");Pe.post("/outlook/authorization/token",{authCode:n,userId:Kn(window.location.href).state.split("amelia-outlook-calendar-auth-")[1],redirectUri:window.location.href.split("?")[0]}).then(()=>{history.pushState({},null,t)}).catch(s=>{console.log(s)}).finally(()=>{e()})}function Bd(n){n.getters["auth/getOutlookLoading"]||(n.commit("auth/setOutlookLoading",!0),Pe.get("/outlook/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},Ue(n))).then(e=>{window.location.href=e.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(e=>{console.log(e),n.commit("auth/setGoogleLoading",!1)}))}function Fd(n){n.commit("auth/setOutlookLoading",!0),Pe.post("/outlook/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setOutlookId",""),n.commit("employee/setOutlookCalendarId",""),n.commit("employee/setOutlookToken",null),n.commit("auth/setOutlookCalendars",[])}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setOutlookLoading",!1)})}function Vd(n){n.commit("auth/setZoomLoading",!0),Pe.get("/zoom/users",Object.assign(Ue(n),{params:{source:"cabinet-provider"}})).then(e=>{"data"in e.data&&"users"in e.data.data&&n.commit("auth/setZoomUsers",e.data.data?.users?e.data.data.users:[])}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setZoomLoading",!1)})}function Rd(n){n.commit("auth/setStripeLoading",!0),Pe.get("/stripe/accounts/"+n.getters["employee/getId"],Object.assign({},Ue(n))).then(e=>{e.data.data.account&&(n.commit("auth/setStripeProvider",e.data.data.account),n.getters["employee/getStripeConnect"]||n.commit("employee/setStripeConnect",{id:e.data.data.account.id,amount:null}))}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function qd(n,e){n.commit("auth/setStripeLoading",!0),Pe.post("/stripe/onboard/"+n.getters["auth/getProfile"].id,Object.assign({returnUrl:window.location.href,accountType:e},Ue(n))).then(t=>{window.location.href=t.data.data.url}).catch(t=>{n.commit("auth/setStripeLoading",!1),console.log("response"in t&&"data"in t.response&&"message"in t.response.data?t.response.data.message:t.message)})}function Ud(n){n.commit("auth/setStripeLoading",!0),Pe.post("/stripe/disconnect/"+n.getters["auth/getProfile"].id,Ue(n)).then(()=>{n.commit("auth/setStripeProvider",{id:"",email:"",type:"",completed:!1}),n.commit("employee/setStripeConnect",null)}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function jd(n){let e=n.getters["auth/getStripeProvider"];n.commit("auth/setStripeLoading",!0),e.type==="standard"?(window.open("https://dashboard.stripe.com/"+e.id,"_blank"),n.commit("auth/setStripeLoading",!1)):e.type==="express"&&Pe.post("/stripe/dashboard/"+n.getters["auth/getProfile"].id,Ue(n)).then(t=>{t.data.data.url&&window.open(t.data.data.url,"_blank")}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function zd(n){n.commit("auth/setAppleLoading",!0),Pe.get("/apple/calendar-list/"+n.getters["employee/getId"],Ue(n)).then(e=>{n.commit("auth/setAppleCalendars",e.data.data?.calendarList?e.data.data.calendarList:[]),n.getters["auth/getAppleCalendars"].map(t=>t.id).indexOf(n.getters["employee/getAppleCalendarId"])===-1&&n.commit("employee/setAppleCalendarId","")}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setAppleLoading",!1)})}const Yd={class:"am-asi__top"},Wd={class:"am-asi__header"},Hd={class:"am-asi__text"},Zd={class:"am-asi__footer"},Gd={class:"am-asi__footer-text"},Jd={name:"AuthSignIn"},Xd=Object.assign(Jd,{setup(n){let e=F("licence"),t=Ie();const s=ul().cookies,l=F("settings");let i=F("amCustomize");const o=F("labels"),r=F("localLanguage");let c=_(()=>l.general.usedLanguages.includes(r.value)),m=_(()=>{let K=lt({...o}),Q=i.value.signIn.translations;return Q&&Object.keys(Q).forEach(le=>{Q[le][r.value]&&c.value?K[le]=Q[le][r.value]:Q[le].default&&(K[le]=Q[le].default)}),K}),g={components:{IconComponent:He},template:'<IconComponent icon="email"></IconComponent>'},f={components:{IconComponent:He},template:'<IconComponent icon="password"></IconComponent>'},v=M(null),k=M({email:_({get:()=>t.getters["auth/getEmail"],set:K=>{t.commit("auth/setEmail",K||"")}}),password:_({get:()=>t.getters["auth/getPassword"],set:K=>{t.commit("auth/setPassword",K||"")}})}),T=M({email:[{required:!0,message:m.value.enter_email_or_username_warning,trigger:"submit"}],password:[{required:!0,message:m.value.enter_password_warning,trigger:"submit"}]}),y=M({email:{template:Ye.text,props:{itemName:"email",label:m.value.email_or_username,iconStart:Ge(g),placeholder:"",class:"am-asi__item"}},password:{template:Ye.text,props:{itemName:"password",itemType:"password",showPassword:!0,label:m.value.password,iconStart:Ge(f),placeholder:"",class:"am-asi__item"}}}),b=F("pageKey"),L=F("cabinetType"),E=_(()=>t.getters.getLoading),C=_(()=>t.getters["auth/getProfileDeleted"]),h=M(!1),I=M("");function O(K,Q){let le=$o("token");K?A(K,!1,!1,!1):le?A(le,!0,!1,Q):A("",!1,!0,!1)}function A(K,Q,le,H){let se={cabinetType:L.value,changePass:H};le&&(se.checkIfWpUser=!0);let ge=t.getters["auth/getPassword"],$e=t.getters["auth/getEmail"];!K&&ge&&$e&&(se.password=ge,se.email=$e),Q&&(se.token=K),Pe.post("/users/authenticate",se,K!==null&&!Hr()?{headers:{Authorization:"Bearer "+K}}:{}).then(ue=>{if("authentication_required"in ue.data.data){l.roles[L.value+"Cabinet"].loginEnabled||(b.value="sendAccessLink");return}if("token"in ue.data.data&&(s.set("ameliaToken",ue.data.data.token,l.roles[L.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",ue.data.data.user.email,l.roles[L.value+"Cabinet"].tokenValidTime,null,null,!0),t.commit("auth/setToken",ue.data.data.token)),"user"in ue.data.data&&ue.data.data.user.type==="provider"){let me={id:ue.data.data.user.id,firstName:ue.data.data.user.firstName,lastName:ue.data.data.user.lastName,email:ue.data.data.user.email,phone:ue.data.data.user.phone,countryPhoneIso:ue.data.data.user.countryPhoneIso,googleCalendar:{id:"id"in ue.data.data.user.googleCalendar?ue.data.data.user.googleCalendar.id:null,calendarId:ue.data.data.user.googleCalendar.calendarId?ue.data.data.user.googleCalendar.calendarId:"",token:"token"in ue.data.data.user.googleCalendar?ue.data.data.user.googleCalendar.token:null},outlookCalendar:{id:"id"in ue.data.data.user.outlookCalendar?ue.data.data.user.outlookCalendar.id:null,calendarId:ue.data.data.user.outlookCalendar.calendarId?ue.data.data.user.outlookCalendar.calendarId:"",token:"token"in ue.data.data.user.outlookCalendar?ue.data.data.user.outlookCalendar.token:null},appleCalendarId:ue.data.data.user.appleCalendarId?ue.data.data.user.appleCalendarId:"",stripeConnect:ue.data.data.user.stripeConnect,zoomUserId:ue.data.data.user.zoomUserId?ue.data.data.user.zoomUserId:"",locationId:ue.data.data.user.locationId,pictureFullPath:ue.data.data.user.pictureFullPath,pictureThumbPath:ue.data.data.user.pictureThumbPath,description:ue.data.data.user.description,weekDayList:ue.data.data.user.weekDayList,specialDayList:ue.data.data.user.specialDayList,dayOffList:ue.data.data.user.dayOffList,serviceList:ue.data.data.user.serviceList};me.serviceList.forEach(Y=>{Tu(Y)}),t.getters["entities/getReady"]&&(t.commit("entities/setEmployees",[JSON.parse(JSON.stringify(me))]),me.serviceList=Vr(t,me.serviceList)),t.commit("employee/setEmployee",Su(t,me)),t.commit("auth/setOutlookCalendars",ue.data.data.user.outlookCalendar?.calendarList?ue.data.data.user.outlookCalendar.calendarList:[]),t.commit("auth/setGoogleCalendars",ue.data.data.user.googleCalendar?.calendarList?ue.data.data.user.googleCalendar.calendarList:[]),l.appleCalendar&&!e.isLite&&!e.isStarter&&zd(t),l.payments.stripe.enabled&&l.payments.stripe.connect.enabled&&!e.isLite&&!e.isStarter&&!e.isBasic&&Rd(t),l.zoom.enabled&&!e.isLite&&!e.isStarter&&Vd(t)}$o("token")&&window.history.replaceState(null,null,Ya(window.location.href,"token")),t.commit("auth/setProfile",ue.data.data.user),ue.data.data.user.timeZone&&t.commit("cabinet/setTimeZone",ue.data.data.user.timeZone),"set_password"in ue.data.data&&ue.data.data.set_password||"change_password"in ue.data.data&&ue.data.data.change_password?b.value="setPassword":t.commit("auth/setAuthenticated",!0);let ae=L.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;ae>0&&ae<18144e5&&setTimeout(()=>{t.dispatch("auth/logout")},ae)}).catch(ue=>{if(!("data"in ue.response.data)&&"message"in ue.response.data){h.value=!0,I.value=ue.response.data.message;return}"invalid_credentials"in ue.response.data.data&&(h.value=!0,I.value=m.value.invalid_credentials)}).finally(()=>{t.commit("setLoading",!1)})}function D(){v.value.validate(K=>{if(K)t.commit("setLoading",!0),A(null,!1,!1,!1);else return!1})}function V(){O(s.get("ameliaToken"),"changePass"in Kn(window.location.href))}gn(()=>{t.commit("setLoading",!0)}),Je(()=>{if(t.getters["auth/getLoggedOut"])l.roles[L.value+"Cabinet"].loginEnabled||(b.value="sendAccessLink"),t.commit("setLoading",!1);else{let K=Kn(window.location.href);l.googleCalendar.enabled&&L.value==="provider"&&K&&K.code&&K.scope?Pd(K.code,V):l.outlookCalendar.enabled&&L.value==="provider"&&K&&K.code&&K.state?Md(K.code,V):V()}});let z=F("containerWidth"),B=_(()=>tt(z.value)),J=F("amFonts"),G=F("amColors"),X=_(()=>({"--am-c-primary":G.value.colorPrimary,"--am-c-success":G.value.colorSuccess,"--am-c-error":G.value.colorError,"--am-c-warning":G.value.colorWarning,"--am-c-main-bgr":G.value.colorMainBgr,"--am-c-main-heading-text":G.value.colorMainHeadingText,"--am-c-main-text":G.value.colorMainText,"--am-c-main-text-op70":W(G.value.colorMainText,.7),"--am-c-main-text-op60":W(G.value.colorMainText,.6),"--am-c-main-text-op40":W(G.value.colorMainText,.4),"--am-c-main-text-op25":W(G.value.colorMainText,.25),"--am-c-inp-bgr":G.value.colorInpBgr,"--am-c-inp-border":G.value.colorInpBorder,"--am-c-inp-text":G.value.colorInpText,"--am-c-inp-placeholder":G.value.colorInpPlaceHolder,"--am-c-btn-prim":G.value.colorBtnPrim,"--am-c-btn-prim-text":G.value.colorBtnPrimText,"--am-c-skeleton-op20":W(G.value.colorMainText,.2),"--am-c-skeleton-op60":W(G.value.colorMainText,.6),"--am-font-family":J.value.fontFamily,"--am-c-scroll-op30":W(G.value.colorPrimary,.3),"--am-c-scroll-op10":W(G.value.colorPrimary,.1)}));return(K,Q)=>{const le=et;return a(E)?(u(),q(a(Zt),{key:1,count:4,"center-first":!0,"main-class":"am-asi-sign-in am-asi"})):(u(),x("div",{key:0,class:"am-asi",style:be(a(X))},[d("div",Yd,[a(C)?(u(),q($t,{key:0,class:"am-asi__top-message am-asi__top-message-success",type:"success",title:a(m).profile_deleted,description:"","show-icon":!0,closable:!0,onClose:Q[0]||(Q[0]=H=>a(t).commit("auth/setProfileDeleted",!1))},null,8,["title"])):N("",!0),a(h)?(u(),q($t,{key:1,class:"am-asi__top-message am-asi__top-message-error",type:"error",title:a(I),description:"","show-icon":!0,closable:!0,onClose:Q[1]||(Q[1]=H=>a(t).commit("auth/setProfileDeleted",!1))},null,8,["title"])):N("",!0),d("div",Wd,w(a(m).welcome_back),1),d("div",Hd,w(a(m).enter_credentials),1)]),$(le,{ref_key:"authFormRef",ref:v,model:a(k),rules:a(T),"label-position":"top",class:R(["am-asi__form",a(B)])},{default:S(()=>[(u(!0),x(ee,null,pe(a(y),(H,se)=>(u(),q(Ct(H.template),Nt({key:se,ref_for:!0,ref:"customerCollectorRef",modelValue:a(k)[se],"onUpdate:modelValue":ge=>a(k)[se]=ge},H.props,{onEnter:D}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),$(ke,{class:"am-asi__btn",type:a(i).signIn.options.signInBtn.buttonType,onClick:D},{default:S(()=>[ie(w(a(m).sign_in),1)]),_:1},8,["type"]),d("div",Zd,[d("span",Gd,w(a(m).forgot_your_password),1),d("span",{class:"am-asi__footer-link",onClick:Q[2]||(Q[2]=H=>ye(b)?b.value="sendAccessLink":b="sendAccessLink")},w(a(m).reset_password),1)])],4))}}});const Qd={class:"am-asi__top"},Kd={class:"am-asi__header"},em={class:"am-asi__text"},tm={key:0,class:"am-asi__footer"},am={name:"AuthReset"},sm=Object.assign(am,{setup(n){let e=Ie();const t=F("settings");let s=F("amCustomize");const l=F("labels"),i=F("localLanguage");let o=_(()=>t.general.usedLanguages.includes(i.value)),r=_(()=>{let I=lt({...l}),O=s.value.accessLink.translations;return O&&Object.keys(O).forEach(A=>{O[A][i.value]&&o.value?I[A]=O[A][i.value]:O[A].default&&(I[A]=O[A].default)}),I}),c=M(null),m=M({email:_({get:()=>e.getters["auth/getEmail"],set:I=>{e.commit("auth/setEmail",I||"")}})}),g=M({email:[{required:!0,message:r.value.enter_email_warning,trigger:"submit"}]}),f=M({email:{template:Ye.text,props:{itemName:"email",itemType:"email",label:r.value.email,placeholder:"",class:"am-asi__item"}}}),v=F("pageKey"),k=F("cabinetType"),T=_(()=>e.getters.getLoading);function y(){c.value.validate(I=>{if(I)e.commit("setLoading",!0),Pe.post("/users/customers/reauthorize",{email:e.getters["auth/getEmail"],locale:window.localeLanguage[0],cabinetType:k.value}).then(()=>{v.value="sendAccessLinkProcess"}).catch(()=>{}).finally(()=>{e.commit("setLoading",!1)});else return!1})}let b=F("containerWidth"),L=_(()=>tt(b.value)),E=F("amFonts"),C=F("amColors"),h=_(()=>({"--am-c-primary":C.value.colorPrimary,"--am-c-success":C.value.colorSuccess,"--am-c-error":C.value.colorError,"--am-c-warning":C.value.colorWarning,"--am-c-main-bgr":C.value.colorMainBgr,"--am-c-main-heading-text":C.value.colorMainHeadingText,"--am-c-main-text":C.value.colorMainText,"--am-c-main-text-op70":W(C.value.colorMainText,.7),"--am-c-main-text-op60":W(C.value.colorMainText,.6),"--am-c-main-text-op40":W(C.value.colorMainText,.4),"--am-c-main-text-op25":W(C.value.colorMainText,.25),"--am-c-inp-bgr":C.value.colorInpBgr,"--am-c-inp-border":C.value.colorInpBorder,"--am-c-inp-text":C.value.colorInpText,"--am-c-inp-placeholder":C.value.colorInpPlaceHolder,"--am-c-btn-prim":C.value.colorBtnPrim,"--am-c-btn-prim-text":C.value.colorBtnPrimText,"--am-c-skeleton-op20":W(C.value.colorMainText,.2),"--am-c-skeleton-op60":W(C.value.colorMainText,.6),"--am-font-family":E.value.fontFamily,"--am-c-scroll-op30":W(C.value.colorPrimary,.3),"--am-c-scroll-op10":W(C.value.colorPrimary,.1)}));return(I,O)=>{const A=et;return a(T)?(u(),q(a(Zt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(u(),x("div",{key:0,class:"am-asi",style:be(a(h))},[d("div",Qd,[d("div",Kd,w(a(r).access_link_send),1),d("div",em,w(a(r).access_link_send_description),1)]),$(A,{ref_key:"authFormRef",ref:c,model:a(m),rules:a(g),"label-position":"top",class:R(["am-asi__form",a(L)])},{default:S(()=>[(u(!0),x(ee,null,pe(a(f),(D,V)=>(u(),q(Ct(D.template),Nt({key:V,ref_for:!0,ref:"customerCollectorRef",modelValue:a(m)[V],"onUpdate:modelValue":z=>a(m)[V]=z},D.props,{onEnter:y}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),$(ke,{class:"am-asi__btn",type:a(s).accessLink.options.sendBtn.buttonType,onClick:y},{default:S(()=>[ie(w(a(r).send),1)]),_:1},8,["type"]),a(t).roles[a(k)+"Cabinet"].loginEnabled?(u(),x("div",tm,[d("span",{class:"am-asi__footer-link",onClick:O[0]||(O[0]=D=>ye(v)?v.value="signIn":v="signIn")},w(a(r).sign_in),1)])):N("",!0)],4))}}});const nm={class:"am-asi__top"},lm={class:"am-asi__header"},im={class:"am-asi__text"},om={class:"am-asi__email"},rm={class:"am-asi__footer"},cm={class:"am-asi__footer-text"},um={name:"AuthResetProcess"},dm=Object.assign(um,{setup(n){let e=Ie();const t=F("settings");let s=F("amCustomize");const l=F("labels"),i=F("localLanguage");let o=_(()=>t.general.usedLanguages.includes(i.value)),r=_(()=>{let k=lt({...l}),T=s.value.accessLinkSuccess.translations;return T&&Object.keys(T).forEach(y=>{T[y][i.value]&&o.value?k[y]=T[y][i.value]:T[y].default&&(k[y]=T[y].default)}),k}),c=_(()=>e.getters["auth/getEmail"]),m=F("pageKey"),g=F("amFonts"),f=F("amColors"),v=_(()=>({"--am-c-primary":f.value.colorPrimary,"--am-c-success":f.value.colorSuccess,"--am-c-error":f.value.colorError,"--am-c-warning":f.value.colorWarning,"--am-c-main-bgr":f.value.colorMainBgr,"--am-c-main-heading-text":f.value.colorMainHeadingText,"--am-c-main-text":f.value.colorMainText,"--am-c-main-text-op70":W(f.value.colorMainText,.7),"--am-c-main-text-op60":W(f.value.colorMainText,.6),"--am-c-main-text-op40":W(f.value.colorMainText,.4),"--am-c-main-text-op25":W(f.value.colorMainText,.25),"--am-c-inp-bgr":f.value.colorInpBgr,"--am-c-inp-border":f.value.colorInpBorder,"--am-c-inp-text":f.value.colorInpText,"--am-c-inp-placeholder":f.value.colorInpPlaceHolder,"--am-c-btn-prim":f.value.colorBtnPrim,"--am-c-btn-prim-text":f.value.colorBtnPrimText,"--am-c-skeleton-op20":W(f.value.colorMainText,.2),"--am-c-skeleton-op60":W(f.value.colorMainText,.6),"--am-font-family":g.value.fontFamily,"--am-c-scroll-op30":W(f.value.colorPrimary,.3),"--am-c-scroll-op10":W(f.value.colorPrimary,.1)}));return(k,T)=>(u(),x("div",{class:"am-asi",style:be(a(v))},[d("div",nm,[d("div",lm,w(a(r).access_link_send_check),1),d("div",im,w(a(r).access_link_send_click),1),d("div",om,w(a(c)),1)]),d("div",rm,[d("span",cm,w(a(r).access_link_send_inbox),1),d("span",{class:"am-asi__footer-link",onClick:T[0]||(T[0]=y=>ye(m)?m.value="sendAccessLink":m="sendAccessLink")},w(a(r).access_link_send_retry),1)])],4))}});const mm={class:"am-asi__top"},pm={class:"am-asi__header"},gm={class:"am-asi__text"},fm={name:"AuthNewPass"},hm=Object.assign(fm,{setup(n){let e=Ie();const t=F("settings");let s=F("amCustomize");const l=F("labels"),i=F("localLanguage");let o=_(()=>t.general.usedLanguages.includes(i.value)),r=_(()=>{let h=lt({...l}),I=s.value.setPass.translations;return I&&Object.keys(I).forEach(O=>{I[O][i.value]&&o.value?h[O]=I[O][i.value]:I[O].default&&(h[O]=I[O].default)}),h}),c=M(null),m=M({newPassword:_({get:()=>e.getters["auth/getNewPassword"],set:h=>{e.commit("auth/setNewPassword",h||"")}}),confirmPassword:_({get:()=>e.getters["auth/getConfirmPassword"],set:h=>{e.commit("auth/setConfirmPassword",h||"")}})}),g=M({newPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"}],confirmPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"},{validator:()=>e.getters["auth/getNewPassword"]===e.getters["auth/getConfirmPassword"],message:r.value.passwords_not_match,trigger:"submit"}]}),f=M({newPassword:{template:Ye.text,props:{itemName:"newPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon,placeholder:"",minLength:3,class:"am-asi__item"}},confirmPassword:{template:Ye.text,props:{itemName:"confirmPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon_retype,placeholder:"",minLength:3,class:"am-asi__item"}}}),v=F("cabinetType"),k=_(()=>e.getters.getLoading);function T(){c.value.validate(h=>{if(h&&e.getters["auth/getNewPassword"]===e.getters["auth/getConfirmPassword"]){let I=e.getters["auth/getProfile"];e.commit("setLoading",!0),Pe.post("/users/"+v.value+"s/"+I.id,{password:e.getters["auth/getNewPassword"]},Object.assign(Ue(e),{params:{source:"cabinet-"+v.value}})).then(()=>{e.commit("auth/setAuthenticated",!0)}).catch(()=>{}).finally(()=>{e.commit("setLoading",!1)})}else return!1})}let y=F("containerWidth"),b=_(()=>tt(y.value)),L=F("amFonts"),E=F("amColors"),C=_(()=>({"--am-c-primary":E.value.colorPrimary,"--am-c-success":E.value.colorSuccess,"--am-c-error":E.value.colorError,"--am-c-warning":E.value.colorWarning,"--am-c-main-bgr":E.value.colorMainBgr,"--am-c-main-heading-text":E.value.colorMainHeadingText,"--am-c-main-text":E.value.colorMainText,"--am-c-main-text-op70":W(E.value.colorMainText,.7),"--am-c-main-text-op60":W(E.value.colorMainText,.6),"--am-c-main-text-op40":W(E.value.colorMainText,.4),"--am-c-main-text-op25":W(E.value.colorMainText,.25),"--am-c-inp-bgr":E.value.colorInpBgr,"--am-c-inp-border":E.value.colorInpBorder,"--am-c-inp-text":E.value.colorInpText,"--am-c-inp-placeholder":E.value.colorInpPlaceHolder,"--am-c-btn-prim":E.value.colorBtnPrim,"--am-c-btn-prim-text":E.value.colorBtnPrimText,"--am-c-skeleton-op20":W(E.value.colorMainText,.2),"--am-c-skeleton-op60":W(E.value.colorMainText,.6),"--am-font-family":L.value.fontFamily,"--am-c-scroll-op30":W(E.value.colorPrimary,.3),"--am-c-scroll-op10":W(E.value.colorPrimary,.1)}));return(h,I)=>{const O=et;return a(k)?(u(),q(a(Zt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(u(),x("div",{key:0,class:"am-asi",style:be(a(C))},[d("div",mm,[d("div",pm,w(a(r).new_password_set),1),d("div",gm,w(a(r).new_password_set_description),1)]),$(O,{ref_key:"authFormRef",ref:c,model:a(m),rules:a(g),"label-position":"top",class:R(["am-asi__form",a(b)])},{default:S(()=>[(u(!0),x(ee,null,pe(a(f),(A,D)=>(u(),q(Ct(A.template),Nt({key:D,ref_for:!0,ref:"customerCollectorRef",modelValue:a(m)[D],"onUpdate:modelValue":V=>a(m)[D]=V},A.props,{onEnter:T}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),$(ke,{class:"am-asi__btn",type:a(s).setPass.options.newPassBtn.buttonType,onClick:T},{default:S(()=>[ie(w(a(r).new_password_set_action),1)]),_:1},8,["type"])],4))}}});const vm={class:"am-asi__top"},_m=d("div",{class:"am-asi__img"},[d("span",{class:"am-icon-check"})],-1),ym={class:"am-asi__header"},bm={class:"am-asi__text"},km={name:"ChangePassSuccess"},Cm=Object.assign(km,{setup(n){const e=F("settings");let t=F("amCustomize");const s=F("labels"),l=F("localLanguage");let i=_(()=>e.general.usedLanguages.includes(l.value)),o=_(()=>{let f=lt({...s}),v=t.value.setPassSuccess.translations;return v&&Object.keys(v).forEach(k=>{v[k][l.value]&&i.value?f[k]=v[k][l.value]:v[k].default&&(f[k]=v[k].default)}),f}),r=F("pageKey"),c=F("amFonts"),m=F("amColors"),g=_(()=>({"--am-c-primary":m.value.colorPrimary,"--am-c-success":m.value.colorSuccess,"--am-c-error":m.value.colorError,"--am-c-warning":m.value.colorWarning,"--am-c-main-bgr":m.value.colorMainBgr,"--am-c-main-heading-text":m.value.colorMainHeadingText,"--am-c-main-text":m.value.colorMainText,"--am-c-main-text-op70":W(m.value.colorMainText,.7),"--am-c-main-text-op60":W(m.value.colorMainText,.6),"--am-c-main-text-op40":W(m.value.colorMainText,.4),"--am-c-main-text-op25":W(m.value.colorMainText,.25),"--am-c-btn-prim":m.value.colorBtnPrim,"--am-c-btn-prim-text":m.value.colorBtnPrimText,"--am-c-skeleton-op20":W(m.value.colorMainText,.2),"--am-c-skeleton-op60":W(m.value.colorMainText,.6),"--am-font-family":c.value.fontFamily,"--am-c-scroll-op30":W(m.value.colorPrimary,.3),"--am-c-scroll-op10":W(m.value.colorPrimary,.1)}));return(f,v)=>(u(),x("div",{class:"am-asi",style:be(a(g))},[d("div",vm,[_m,d("div",ym,w(a(o).new_password_changed),1),d("div",bm,w(a(o).new_password_changed_description),1)]),$(ke,{class:"am-asi__btn",type:a(t).setPassSuccess.options.signInBtn.buttonType,onClick:v[0]||(v[0]=k=>ye(r)?r.value="signIn":r="signIn")},{default:S(()=>[ie(w(a(o).sign_in),1)]),_:1},8,["type"])],4))}}),xm={name:"AuthWrapper"},wm=Object.assign(xm,{setup(n){const e=F("settings");let t=M({signIn:Ge(Xd),sendAccessLink:Ge(sm),sendAccessLinkProcess:Ge(dm),setPassword:Ge(hm),changeSuccess:Ge(Cm)}),s=F("originKey"),l=M("signIn");Be("pageKey",l);const i=M(e.customizedData?e.customizedData.fonts:el.fonts);Be("amFonts",i);let o=_(()=>e.customizedData&&s.value in e.customizedData?e.customizedData[s.value].colors:el[s.value].colors);return Be("amColors",o),(r,c)=>(u(),q(Ct(a(t)[a(l)])))}});const Tm={class:"am-csd__inner"},Sm={class:"am-csd__header"},Em={class:"am-csd__header-text"},Lm={class:"am-csd__content"},Am={class:"am-csd__footer"},$m={name:"DeleteProfile"},Im=Object.assign($m,{props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},customizedOptions:{type:Object,default:()=>({})}},emits:["close","deleteProfile"],setup(n,{emit:e}){const t=n;let s=F("containerWidth");const l=F("labels");function i(m){return Object.keys(t.customizedLabels).length&&t.customizedLabels[m]?t.customizedLabels[m]:l[m]}let o=F("amFonts"),r=F("amColors"),c=_(()=>({"--am-c-csd-text":r.value.colorMainText,"--am-c-csd-bgr":r.value.colorMainBgr,"--am-c-csd-text-op10":W(r.value.colorMainText,.1),"--am-font-family":o.value.fontFamily}));return(m,g)=>(u(),q(Ja,{visibility:a(t).visibility,"custom-class":"am-csd am-csd__cancel",style:be(a(c)),position:"center"},{footer:S(()=>[d("div",Am,[$(ke,{category:"secondary",size:a(s)<=360?"small":"default",type:a(t).customizedOptions.closeBtn.buttonType,onClick:g[1]||(g[1]=()=>{e("close")})},{default:S(()=>[ie(w(i("close")),1)]),_:1},8,["size","type"]),$(ke,{category:"danger",size:a(s)<=360?"small":"default","loading-icon":"loading",type:a(t).customizedOptions.confirmBtn.buttonType,onClick:g[2]||(g[2]=()=>{e("deleteProfile")})},{default:S(()=>[ie(w(i("delete")),1)]),_:1},8,["size","type"])])]),default:S(()=>[d("div",Tm,[d("div",Sm,[d("div",Em,w(i("delete_profile")),1),d("div",{class:"am-csd__header-btn",onClick:g[0]||(g[0]=()=>{e("close")})},[$(He,{icon:"close"})])]),d("div",Lm,[d("p",null,w(i("delete_profile_description")),1)])])]),_:1},8,["visibility","style"]))}});const Si={props:{pageWidth:{type:Number,default:768},count:{type:[Number,String],default:2},itemDirection:{type:String,default:"row",validator(n){return["row","row-reverse","column","column-reverse","initial","revert","unset"].includes(n)}}},setup(n){const e=n;let t=_(()=>tt(e.pageWidth)),s=F("amColors"),l=_(()=>({"--am-c-skeleton-op20":W(s.value.colorMainText,.2),"--am-c-skeleton-op60":W(s.value.colorMainText,.6),"--am-c-flex-direction":e.itemDirection}));return(i,o)=>{const r=dl,c=ml;return u(),q(c,{animated:"",class:"am-cps",style:be(a(l))},{template:S(()=>[(u(!0),x(ee,null,pe(new Array(a(e).count),m=>(u(),x("div",{key:m,class:R(["am-cps__item",a(t)])},[$(r,{class:"am-cps__item-label",variant:"rect"}),$(r,{class:"am-cps__item-input",variant:"rect"})],2))),128))]),_:1},8,["style"])}}};const Om={class:"am-capi__inner"},Pm=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),Nm={name:"CabinetProfile",key:"profile"},Dm=Object.assign(Nm,{setup(n){let e=Ie(),t=_(()=>e.getters.getLoading),s=M(null),l=M(0),i=F("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}rt(i,me=>{me?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{Gi(()=>{l.value=s.value.offsetWidth})});let c=_(()=>tt(l.value));const m=F("settings");let g=F("cabinetType"),f=F("amCustomize");const v=F("labels"),k=F("localLanguage");let T=_(()=>m.general.usedLanguages.includes(k.value));function y(me,Y){return Y&&Object.keys(Y).forEach(j=>{Y[j][k.value]&&T.value?me[j]=Y[j][k.value]:Y[j].default&&(me[j]=Y[j].default)}),me}let b=_(()=>{let me=lt({...v}),Y=f.value.profile.translations;return y(me,Y)});function L(me){let Y={},j=f.value[me].translations;return y(Y,j)}let E=_(()=>f.value.profile.options),C=M("first"),h=M("");function I(){le.value=!1,h.value=""}let O=M(null),A=M(!1),D=M({firstName:_({get:()=>e.getters["auth/getProfile"].firstName,set:me=>{e.commit("auth/setProfileFirstName",me||"")}}),lastName:_({get:()=>e.getters["auth/getProfile"].lastName,set:me=>{e.commit("auth/setProfileLastName",me||"")}}),email:_({get:()=>e.getters["auth/getProfile"].email,set:me=>{e.commit("auth/setProfileEmail",me||"")}}),phone:_({get:()=>e.getters["auth/getProfile"].phone,set:me=>{e.commit("auth/setProfilePhone",me||"")}}),birthday:_({get:()=>e.getters["auth/getProfile"].birthday?e.getters["auth/getProfile"].birthday:"",set:me=>{e.commit("auth/setProfileBirthday",me?ve(me).format("YYYY-MM-DD"):"")}})}),V=M({firstName:{template:Ye.text,props:{itemName:"firstName",label:b.value.first_name_colon,placeholder:b.value.enter_first_name,class:_(()=>`am-capi__item ${c.value}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:b.value.last_name_colon,placeholder:b.value.enter_last_name,class:_(()=>`am-capi__item ${c.value}`)}},email:{template:Ye.text,props:{itemName:"email",label:b.value.email_colon,placeholder:b.value.enter_email,class:_(()=>`am-capi__item ${c.value}`)}},phone:{countryPhoneIso:_({get:()=>e.getters["auth/getProfile"].countryPhoneIso?e.getters["auth/getProfile"].countryPhoneIso:"",set:me=>{e.commit("auth/setProfileCountryPhoneIso",me?me.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:b.value.phone_colon,placeholder:b.value.enter_phone,defaultCode:_(()=>e.getters["auth/getProfile"].countryPhoneIso?e.getters["auth/getProfile"].countryPhoneIso:""),phoneError:_(()=>A.value),whatsAppLabel:b.value.whatsapp_opt_in_text,isWhatsApp:m.notifications.whatsAppEnabled&&m.notifications.whatsAppAccessToken&&m.notifications.whatsAppBusinessID&&m.notifications.whatsAppPhoneID,class:_(()=>`am-capi__item ${c.value}`)}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:b.value.date_of_birth,placeholder:b.value.enter_date_of_birth,clearable:!0,readOnly:!1,class:_(()=>`am-capi__item am-capi__item-birthday ${c.value}`)}}}),z=M({firstName:[{required:!0,message:b.value.enter_first_name_warning,trigger:"submit"}],lastName:[{required:E.value.lastName.required,message:b.value.enter_last_name_warning,trigger:"submit"}],email:[{required:E.value.email.required,type:"email",message:b.value.enter_valid_email_warning,trigger:"submit"}],phone:[{required:E.value.phone.required,message:b.value.enter_phone_warning,trigger:"submit"}],birthday:[{required:E.value.birthday.required,message:b.value.enter_date_of_birth_warning,trigger:"submit"}]}),B=M(!1);Be("deleteProfileDialog",B);function J(){e.commit("auth/setProfileFirstName",D.value.firstName?D.value.firstName.trim():""),e.commit("auth/setProfileLastName",D.value.lastName?D.value.lastName.trim():""),e.commit("auth/setProfileEmail",D.value.email?D.value.email.trim():""),O.value.validate(me=>{if(me){h.value=b.value.profile_data_success;let Y=e.getters["auth/getProfile"];e.commit("setLoading",!0),Pe.post("/users/"+g.value+"s/"+Y.id,Y,Ue(e)).finally(()=>{e.commit("setLoading",!1),le.value=!0,E.value.phone.required&&D.value.phone&&(A.value=!1)})}else return E.value.phone.required&&!D.value.phone&&(A.value=!0),!1})}Be("saveProfileChanges",J);let G=M(null),X=M({newPass:_({get:()=>e.getters["auth/getNewPassword"],set:me=>{e.commit("auth/setNewPassword",me||"")}}),confirmPass:_({get:()=>e.getters["auth/getConfirmPassword"],set:me=>{e.commit("auth/setConfirmPassword",me||"")}})}),K=M({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:b.value.new_password_colon,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${c.value}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:b.value.new_password_colon_retype,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${c.value}`)}}}),Q=M({newPass:[{required:!0,message:b.value.new_password_required,trigger:"submit"},{min:4,message:b.value.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:b.value.new_password_required,trigger:"submit"},{min:4,message:b.value.new_password_length,trigger:"submit"},{validator:()=>e.getters["auth/getNewPassword"]===e.getters["auth/getConfirmPassword"],message:b.value.passwords_not_match,trigger:"submit"}]}),le=M(!1);function H(){le.value=!1}function se(){G.value.validate(me=>{if(me){let Y=e.getters["auth/getProfile"];e.commit("setLoading",!0),Pe.post("/users/customers/"+Y.id,{password:e.getters["auth/getNewPassword"]},Ue(e)).then(()=>{h.value=b.value.password_success,e.commit("auth/setNewPassword",""),e.commit("auth/setConfirmPassword","")}).catch(()=>{}).finally(()=>{e.commit("setLoading",!1),le.value=!0})}else return!1})}Be("changeProfilePassword",se);function ge(){B.value=!1,e.commit("auth/setProfileDeleted",!0),e.dispatch("auth/logout")}function $e(){e.commit("setLoading",!0);let me=e.getters["auth/getProfile"]?e.getters["auth/getProfile"].id:null;if(!me)return;let Y={email:"",firstName:b.value.customer,lastName:me,phone:"",birthday:"",gender:"",externalId:"",password:""};const j=ul().cookies;Pe.post("/users/customers/"+me,Object.assign(Ue(e),Y)).then(()=>{e.commit("auth/setProfile",{}),j.remove("ameliaUserEmail"),e.commit("setLoading",!1),ge()}).catch(te=>{e.commit("setLoading",!1),console.log(te)})}let ue=F("amColors"),ae=_(()=>({"--am-c-capi-primary":ue.value.colorPrimary,"--am-c-capi-text":ue.value.colorMainText,"--am-c-capi-text-op10":W(ue.value.colorMainText,.1)}));return(me,Y)=>{const j=et,te=Xa,de=Qa;return u(),x("div",{ref_key:"pageContainer",ref:s,class:"am-capi",style:be(a(ae))},[d("div",Om,[a(le)?(u(),q($t,{key:0,type:"success","show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:I,onTriggerClose:I},{title:S(()=>[Pm,ie(" "+w(a(h)),1)]),_:1})):N("",!0),$(de,{modelValue:a(C),"onUpdate:modelValue":Y[0]||(Y[0]=Z=>ye(C)?C.value=Z:C=Z),class:"am-capi__tabs",onTabClick:H},{default:S(()=>[$(te,{class:"am-capi__tabs-item",label:a(b).personal_info,name:"first"},{default:S(()=>[a(t)?(u(),q(Si,{key:1,count:5,"page-width":a(l)},null,8,["page-width"])):(u(),x(ee,{key:0},[a(e).getters["auth/getProfile"]?(u(),q(j,{key:0,ref_key:"infoFormRef",ref:O,model:a(D),rules:a(z),"label-position":"top",class:R(["am-capi__form",a(c)])},{default:S(()=>[(u(!0),x(ee,null,pe(a(f).profile.order,Z=>(u(),x(ee,{key:Z.id},[!a(E)[Z.id]||a(E)[Z.id].visibility?(u(),q(Ct(a(V)[Z.id].template),Nt({key:0,ref_for:!0,ref:"customerCollectorRef",modelValue:a(D)[Z.id],"onUpdate:modelValue":ce=>a(D)[Z.id]=ce,countryPhoneIso:a(V)[Z.id].countryPhoneIso,"onUpdate:countryPhoneIso":ce=>a(V)[Z.id].countryPhoneIso=ce},a(V)[Z.id].props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"])):N("",!0)],64))),128))]),_:1},8,["model","rules","class"])):N("",!0)],64))]),_:1},8,["label"]),$(te,{class:"am-capi__tabs-item",label:a(b).password_tab,name:"second"},{default:S(()=>[a(t)?(u(),q(Si,{key:1,"item-direction":"column",count:2,"page-width":a(l)},null,8,["page-width"])):(u(),q(j,{key:0,ref_key:"passFormRef",ref:G,model:a(X),rules:a(Q),"label-position":"top",class:R(["am-capi__form",a(c)])},{default:S(()=>[(u(!0),x(ee,null,pe(a(K),(Z,ce)=>(u(),q(Ct(Z.template),Nt({key:Z.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:a(X)[ce],"onUpdate:modelValue":fe=>a(X)[ce]=fe},Z.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])]),_:1},8,["modelValue"]),$(Im,{visibility:a(B),"customized-labels":L("deleteProfile"),"customized-options":a(f).deleteProfile.options,onClose:Y[1]||(Y[1]=Z=>ye(B)?B.value=!1:B=!1),onDeleteProfile:$e},null,8,["visibility","customized-labels","customized-options"]),$(od,{loading:a(t),display:a(C),"parent-width":a(l),"customized-labels":a(b),"save-footer-button":a(E).saveFooterButton.buttonType,"delete-footer-type":a(E).deleteFooterButton.buttonType,"pass-footer-button":a(E).passFooterButton.buttonType},null,8,["loading","display","parent-width","customized-labels","save-footer-button","delete-footer-type","pass-footer-button"])])],4)}}});var Mm=typeof global=="object"&&global&&global.Object===Object&&global,Zr=Mm,Bm=typeof self=="object"&&self&&self.Object===Object&&self,Fm=Zr||Bm||Function("return this")(),da=Fm,Vm=da.Symbol,Pa=Vm,Gr=Object.prototype,Rm=Gr.hasOwnProperty,qm=Gr.toString,Js=Pa?Pa.toStringTag:void 0;function Um(n){var e=Rm.call(n,Js),t=n[Js];try{n[Js]=void 0;var s=!0}catch{}var l=qm.call(n);return s&&(e?n[Js]=t:delete n[Js]),l}var jm=Object.prototype,zm=jm.toString;function Ym(n){return zm.call(n)}var Wm="[object Null]",Hm="[object Undefined]",Do=Pa?Pa.toStringTag:void 0;function Ps(n){return n==null?n===void 0?Hm:Wm:Do&&Do in Object(n)?Um(n):Ym(n)}function ya(n){return n!=null&&typeof n=="object"}var Zm=Array.isArray,Wa=Zm;function Ma(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}function Jr(n){return n}var Gm="[object AsyncFunction]",Jm="[object Function]",Xm="[object GeneratorFunction]",Qm="[object Proxy]";function Qi(n){if(!Ma(n))return!1;var e=Ps(n);return e==Jm||e==Xm||e==Gm||e==Qm}var Km=da["__core-js_shared__"],mi=Km,Mo=function(){var n=/[^.]+$/.exec(mi&&mi.keys&&mi.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function ep(n){return!!Mo&&Mo in n}var tp=Function.prototype,ap=tp.toString;function es(n){if(n!=null){try{return ap.call(n)}catch{}try{return n+""}catch{}}return""}var sp=/[\\^$.*+?()[\]{}|]/g,np=/^\[object .+?Constructor\]$/,lp=Function.prototype,ip=Object.prototype,op=lp.toString,rp=ip.hasOwnProperty,cp=RegExp("^"+op.call(rp).replace(sp,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function up(n){if(!Ma(n)||ep(n))return!1;var e=Qi(n)?cp:np;return e.test(es(n))}function dp(n,e){return n?.[e]}function ts(n,e){var t=dp(n,e);return up(t)?t:void 0}var mp=ts(da,"WeakMap"),Ei=mp,Bo=Object.create,pp=function(){function n(){}return function(e){if(!Ma(e))return{};if(Bo)return Bo(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),gp=pp;function fp(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function Xr(n,e){var t=-1,s=n.length;for(e||(e=Array(s));++t<s;)e[t]=n[t];return e}var hp=800,vp=16,_p=Date.now;function yp(n){var e=0,t=0;return function(){var s=_p(),l=vp-(s-t);if(t=s,l>0){if(++e>=hp)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function bp(n){return function(){return n}}var kp=function(){try{var n=ts(Object,"defineProperty");return n({},"",{}),n}catch{}}(),al=kp,Cp=al?function(n,e){return al(n,"toString",{configurable:!0,enumerable:!1,value:bp(e),writable:!0})}:Jr,xp=Cp,wp=yp(xp),Tp=wp;function Sp(n,e){for(var t=-1,s=n==null?0:n.length;++t<s&&e(n[t],t,n)!==!1;);return n}var Ep=9007199254740991,Lp=/^(?:0|[1-9]\d*)$/;function Qr(n,e){var t=typeof n;return e=e??Ep,!!e&&(t=="number"||t!="symbol"&&Lp.test(n))&&n>-1&&n%1==0&&n<e}function Ki(n,e,t){e=="__proto__"&&al?al(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function _n(n,e){return n===e||n!==n&&e!==e}var Ap=Object.prototype,$p=Ap.hasOwnProperty;function Kr(n,e,t){var s=n[e];(!($p.call(n,e)&&_n(s,t))||t===void 0&&!(e in n))&&Ki(n,e,t)}function yn(n,e,t,s){var l=!t;t||(t={});for(var i=-1,o=e.length;++i<o;){var r=e[i],c=s?s(t[r],n[r],r,t,n):void 0;c===void 0&&(c=n[r]),l?Ki(t,r,c):Kr(t,r,c)}return t}var Fo=Math.max;function Ip(n,e,t){return e=Fo(e===void 0?n.length-1:e,0),function(){for(var s=arguments,l=-1,i=Fo(s.length-e,0),o=Array(i);++l<i;)o[l]=s[e+l];l=-1;for(var r=Array(e+1);++l<e;)r[l]=s[l];return r[e]=t(o),fp(n,this,r)}}function Op(n,e){return Tp(Ip(n,e,Jr),n+"")}var Pp=9007199254740991;function ec(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Pp}function hl(n){return n!=null&&ec(n.length)&&!Qi(n)}function Np(n,e,t){if(!Ma(t))return!1;var s=typeof e;return(s=="number"?hl(t)&&Qr(e,t.length):s=="string"&&e in t)?_n(t[e],n):!1}function Dp(n){return Op(function(e,t){var s=-1,l=t.length,i=l>1?t[l-1]:void 0,o=l>2?t[2]:void 0;for(i=n.length>3&&typeof i=="function"?(l--,i):void 0,o&&Np(t[0],t[1],o)&&(i=l<3?void 0:i,l=1),e=Object(e);++s<l;){var r=t[s];r&&n(e,r,s,i)}return e})}var Mp=Object.prototype;function eo(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||Mp;return n===t}function Bp(n,e){for(var t=-1,s=Array(n);++t<n;)s[t]=e(t);return s}var Fp="[object Arguments]";function Vo(n){return ya(n)&&Ps(n)==Fp}var tc=Object.prototype,Vp=tc.hasOwnProperty,Rp=tc.propertyIsEnumerable,qp=Vo(function(){return arguments}())?Vo:function(n){return ya(n)&&Vp.call(n,"callee")&&!Rp.call(n,"callee")},Li=qp;function Up(){return!1}var ac=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ro=ac&&typeof module=="object"&&module&&!module.nodeType&&module,jp=Ro&&Ro.exports===ac,qo=jp?da.Buffer:void 0,zp=qo?qo.isBuffer:void 0,Yp=zp||Up,nn=Yp,Wp="[object Arguments]",Hp="[object Array]",Zp="[object Boolean]",Gp="[object Date]",Jp="[object Error]",Xp="[object Function]",Qp="[object Map]",Kp="[object Number]",eg="[object Object]",tg="[object RegExp]",ag="[object Set]",sg="[object String]",ng="[object WeakMap]",lg="[object ArrayBuffer]",ig="[object DataView]",og="[object Float32Array]",rg="[object Float64Array]",cg="[object Int8Array]",ug="[object Int16Array]",dg="[object Int32Array]",mg="[object Uint8Array]",pg="[object Uint8ClampedArray]",gg="[object Uint16Array]",fg="[object Uint32Array]",Ke={};Ke[og]=Ke[rg]=Ke[cg]=Ke[ug]=Ke[dg]=Ke[mg]=Ke[pg]=Ke[gg]=Ke[fg]=!0;Ke[Wp]=Ke[Hp]=Ke[lg]=Ke[Zp]=Ke[ig]=Ke[Gp]=Ke[Jp]=Ke[Xp]=Ke[Qp]=Ke[Kp]=Ke[eg]=Ke[tg]=Ke[ag]=Ke[sg]=Ke[ng]=!1;function hg(n){return ya(n)&&ec(n.length)&&!!Ke[Ps(n)]}function to(n){return function(e){return n(e)}}var sc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,en=sc&&typeof module=="object"&&module&&!module.nodeType&&module,vg=en&&en.exports===sc,pi=vg&&Zr.process,_g=function(){try{var n=en&&en.require&&en.require("util").types;return n||pi&&pi.binding&&pi.binding("util")}catch{}}(),Ls=_g,Uo=Ls&&Ls.isTypedArray,yg=Uo?to(Uo):hg,ao=yg,bg=Object.prototype,kg=bg.hasOwnProperty;function nc(n,e){var t=Wa(n),s=!t&&Li(n),l=!t&&!s&&nn(n),i=!t&&!s&&!l&&ao(n),o=t||s||l||i,r=o?Bp(n.length,String):[],c=r.length;for(var m in n)(e||kg.call(n,m))&&!(o&&(m=="length"||l&&(m=="offset"||m=="parent")||i&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||Qr(m,c)))&&r.push(m);return r}function lc(n,e){return function(t){return n(e(t))}}var Cg=lc(Object.keys,Object),xg=Cg,wg=Object.prototype,Tg=wg.hasOwnProperty;function Sg(n){if(!eo(n))return xg(n);var e=[];for(var t in Object(n))Tg.call(n,t)&&t!="constructor"&&e.push(t);return e}function so(n){return hl(n)?nc(n):Sg(n)}function Eg(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var Lg=Object.prototype,Ag=Lg.hasOwnProperty;function $g(n){if(!Ma(n))return Eg(n);var e=eo(n),t=[];for(var s in n)s=="constructor"&&(e||!Ag.call(n,s))||t.push(s);return t}function bn(n){return hl(n)?nc(n,!0):$g(n)}var Ig=ts(Object,"create"),ln=Ig;function Og(){this.__data__=ln?ln(null):{},this.size=0}function Pg(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var Ng="__lodash_hash_undefined__",Dg=Object.prototype,Mg=Dg.hasOwnProperty;function Bg(n){var e=this.__data__;if(ln){var t=e[n];return t===Ng?void 0:t}return Mg.call(e,n)?e[n]:void 0}var Fg=Object.prototype,Vg=Fg.hasOwnProperty;function Rg(n){var e=this.__data__;return ln?e[n]!==void 0:Vg.call(e,n)}var qg="__lodash_hash_undefined__";function Ug(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=ln&&e===void 0?qg:e,this}function Ha(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var s=n[e];this.set(s[0],s[1])}}Ha.prototype.clear=Og;Ha.prototype.delete=Pg;Ha.prototype.get=Bg;Ha.prototype.has=Rg;Ha.prototype.set=Ug;function jg(){this.__data__=[],this.size=0}function vl(n,e){for(var t=n.length;t--;)if(_n(n[t][0],e))return t;return-1}var zg=Array.prototype,Yg=zg.splice;function Wg(n){var e=this.__data__,t=vl(e,n);if(t<0)return!1;var s=e.length-1;return t==s?e.pop():Yg.call(e,t,1),--this.size,!0}function Hg(n){var e=this.__data__,t=vl(e,n);return t<0?void 0:e[t][1]}function Zg(n){return vl(this.__data__,n)>-1}function Gg(n,e){var t=this.__data__,s=vl(t,n);return s<0?(++this.size,t.push([n,e])):t[s][1]=e,this}function Ca(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var s=n[e];this.set(s[0],s[1])}}Ca.prototype.clear=jg;Ca.prototype.delete=Wg;Ca.prototype.get=Hg;Ca.prototype.has=Zg;Ca.prototype.set=Gg;var Jg=ts(da,"Map"),on=Jg;function Xg(){this.size=0,this.__data__={hash:new Ha,map:new(on||Ca),string:new Ha}}function Qg(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function _l(n,e){var t=n.__data__;return Qg(e)?t[typeof e=="string"?"string":"hash"]:t.map}function Kg(n){var e=_l(this,n).delete(n);return this.size-=e?1:0,e}function ef(n){return _l(this,n).get(n)}function tf(n){return _l(this,n).has(n)}function af(n,e){var t=_l(this,n),s=t.size;return t.set(n,e),this.size+=t.size==s?0:1,this}function as(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var s=n[e];this.set(s[0],s[1])}}as.prototype.clear=Xg;as.prototype.delete=Kg;as.prototype.get=ef;as.prototype.has=tf;as.prototype.set=af;function ic(n,e){for(var t=-1,s=e.length,l=n.length;++t<s;)n[l+t]=e[t];return n}var sf=lc(Object.getPrototypeOf,Object),no=sf,nf="[object Object]",lf=Function.prototype,of=Object.prototype,oc=lf.toString,rf=of.hasOwnProperty,cf=oc.call(Object);function uf(n){if(!ya(n)||Ps(n)!=nf)return!1;var e=no(n);if(e===null)return!0;var t=rf.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&oc.call(t)==cf}function df(){this.__data__=new Ca,this.size=0}function mf(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function pf(n){return this.__data__.get(n)}function gf(n){return this.__data__.has(n)}var ff=200;function hf(n,e){var t=this.__data__;if(t instanceof Ca){var s=t.__data__;if(!on||s.length<ff-1)return s.push([n,e]),this.size=++t.size,this;t=this.__data__=new as(s)}return t.set(n,e),this.size=t.size,this}function ca(n){var e=this.__data__=new Ca(n);this.size=e.size}ca.prototype.clear=df;ca.prototype.delete=mf;ca.prototype.get=pf;ca.prototype.has=gf;ca.prototype.set=hf;function vf(n,e){return n&&yn(e,so(e),n)}function _f(n,e){return n&&yn(e,bn(e),n)}var rc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jo=rc&&typeof module=="object"&&module&&!module.nodeType&&module,yf=jo&&jo.exports===rc,zo=yf?da.Buffer:void 0,Yo=zo?zo.allocUnsafe:void 0;function cc(n,e){if(e)return n.slice();var t=n.length,s=Yo?Yo(t):new n.constructor(t);return n.copy(s),s}function bf(n,e){for(var t=-1,s=n==null?0:n.length,l=0,i=[];++t<s;){var o=n[t];e(o,t,n)&&(i[l++]=o)}return i}function uc(){return[]}var kf=Object.prototype,Cf=kf.propertyIsEnumerable,Wo=Object.getOwnPropertySymbols,xf=Wo?function(n){return n==null?[]:(n=Object(n),bf(Wo(n),function(e){return Cf.call(n,e)}))}:uc,lo=xf;function wf(n,e){return yn(n,lo(n),e)}var Tf=Object.getOwnPropertySymbols,Sf=Tf?function(n){for(var e=[];n;)ic(e,lo(n)),n=no(n);return e}:uc,dc=Sf;function Ef(n,e){return yn(n,dc(n),e)}function mc(n,e,t){var s=e(n);return Wa(n)?s:ic(s,t(n))}function Ai(n){return mc(n,so,lo)}function Lf(n){return mc(n,bn,dc)}var Af=ts(da,"DataView"),$i=Af,$f=ts(da,"Promise"),Ii=$f,If=ts(da,"Set"),Oi=If,Ho="[object Map]",Of="[object Object]",Zo="[object Promise]",Go="[object Set]",Jo="[object WeakMap]",Xo="[object DataView]",Pf=es($i),Nf=es(on),Df=es(Ii),Mf=es(Oi),Bf=es(Ei),za=Ps;($i&&za(new $i(new ArrayBuffer(1)))!=Xo||on&&za(new on)!=Ho||Ii&&za(Ii.resolve())!=Zo||Oi&&za(new Oi)!=Go||Ei&&za(new Ei)!=Jo)&&(za=function(n){var e=Ps(n),t=e==Of?n.constructor:void 0,s=t?es(t):"";if(s)switch(s){case Pf:return Xo;case Nf:return Ho;case Df:return Zo;case Mf:return Go;case Bf:return Jo}return e});var rn=za,Ff=Object.prototype,Vf=Ff.hasOwnProperty;function Rf(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&Vf.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var qf=da.Uint8Array,sl=qf;function io(n){var e=new n.constructor(n.byteLength);return new sl(e).set(new sl(n)),e}function Uf(n,e){var t=e?io(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var jf=/\w*$/;function zf(n){var e=new n.constructor(n.source,jf.exec(n));return e.lastIndex=n.lastIndex,e}var Qo=Pa?Pa.prototype:void 0,Ko=Qo?Qo.valueOf:void 0;function Yf(n){return Ko?Object(Ko.call(n)):{}}function pc(n,e){var t=e?io(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var Wf="[object Boolean]",Hf="[object Date]",Zf="[object Map]",Gf="[object Number]",Jf="[object RegExp]",Xf="[object Set]",Qf="[object String]",Kf="[object Symbol]",eh="[object ArrayBuffer]",th="[object DataView]",ah="[object Float32Array]",sh="[object Float64Array]",nh="[object Int8Array]",lh="[object Int16Array]",ih="[object Int32Array]",oh="[object Uint8Array]",rh="[object Uint8ClampedArray]",ch="[object Uint16Array]",uh="[object Uint32Array]";function dh(n,e,t){var s=n.constructor;switch(e){case eh:return io(n);case Wf:case Hf:return new s(+n);case th:return Uf(n,t);case ah:case sh:case nh:case lh:case ih:case oh:case rh:case ch:case uh:return pc(n,t);case Zf:return new s;case Gf:case Qf:return new s(n);case Jf:return zf(n);case Xf:return new s;case Kf:return Yf(n)}}function gc(n){return typeof n.constructor=="function"&&!eo(n)?gp(no(n)):{}}var mh="[object Map]";function ph(n){return ya(n)&&rn(n)==mh}var er=Ls&&Ls.isMap,gh=er?to(er):ph,fh=gh,hh="[object Set]";function vh(n){return ya(n)&&rn(n)==hh}var tr=Ls&&Ls.isSet,_h=tr?to(tr):vh,yh=_h,bh=1,kh=2,Ch=4,fc="[object Arguments]",xh="[object Array]",wh="[object Boolean]",Th="[object Date]",Sh="[object Error]",hc="[object Function]",Eh="[object GeneratorFunction]",Lh="[object Map]",Ah="[object Number]",vc="[object Object]",$h="[object RegExp]",Ih="[object Set]",Oh="[object String]",Ph="[object Symbol]",Nh="[object WeakMap]",Dh="[object ArrayBuffer]",Mh="[object DataView]",Bh="[object Float32Array]",Fh="[object Float64Array]",Vh="[object Int8Array]",Rh="[object Int16Array]",qh="[object Int32Array]",Uh="[object Uint8Array]",jh="[object Uint8ClampedArray]",zh="[object Uint16Array]",Yh="[object Uint32Array]",Qe={};Qe[fc]=Qe[xh]=Qe[Dh]=Qe[Mh]=Qe[wh]=Qe[Th]=Qe[Bh]=Qe[Fh]=Qe[Vh]=Qe[Rh]=Qe[qh]=Qe[Lh]=Qe[Ah]=Qe[vc]=Qe[$h]=Qe[Ih]=Qe[Oh]=Qe[Ph]=Qe[Uh]=Qe[jh]=Qe[zh]=Qe[Yh]=!0;Qe[Sh]=Qe[hc]=Qe[Nh]=!1;function Jn(n,e,t,s,l,i){var o,r=e&bh,c=e&kh,m=e&Ch;if(t&&(o=l?t(n,s,l,i):t(n)),o!==void 0)return o;if(!Ma(n))return n;var g=Wa(n);if(g){if(o=Rf(n),!r)return Xr(n,o)}else{var f=rn(n),v=f==hc||f==Eh;if(nn(n))return cc(n,r);if(f==vc||f==fc||v&&!l){if(o=c||v?{}:gc(n),!r)return c?Ef(n,_f(o,n)):wf(n,vf(o,n))}else{if(!Qe[f])return l?n:{};o=dh(n,f,r)}}i||(i=new ca);var k=i.get(n);if(k)return k;i.set(n,o),yh(n)?n.forEach(function(b){o.add(Jn(b,e,t,b,n,i))}):fh(n)&&n.forEach(function(b,L){o.set(L,Jn(b,e,t,L,n,i))});var T=m?c?Lf:Ai:c?bn:so,y=g?void 0:T(n);return Sp(y||n,function(b,L){y&&(L=b,b=n[L]),Kr(o,L,Jn(b,e,t,L,n,i))}),o}var Wh=1,Hh=4;function ws(n){return Jn(n,Wh|Hh)}var Zh="__lodash_hash_undefined__";function Gh(n){return this.__data__.set(n,Zh),this}function Jh(n){return this.__data__.has(n)}function nl(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new as;++e<t;)this.add(n[e])}nl.prototype.add=nl.prototype.push=Gh;nl.prototype.has=Jh;function Xh(n,e){for(var t=-1,s=n==null?0:n.length;++t<s;)if(e(n[t],t,n))return!0;return!1}function Qh(n,e){return n.has(e)}var Kh=1,ev=2;function _c(n,e,t,s,l,i){var o=t&Kh,r=n.length,c=e.length;if(r!=c&&!(o&&c>r))return!1;var m=i.get(n),g=i.get(e);if(m&&g)return m==e&&g==n;var f=-1,v=!0,k=t&ev?new nl:void 0;for(i.set(n,e),i.set(e,n);++f<r;){var T=n[f],y=e[f];if(s)var b=o?s(y,T,f,e,n,i):s(T,y,f,n,e,i);if(b!==void 0){if(b)continue;v=!1;break}if(k){if(!Xh(e,function(L,E){if(!Qh(k,E)&&(T===L||l(T,L,t,s,i)))return k.push(E)})){v=!1;break}}else if(!(T===y||l(T,y,t,s,i))){v=!1;break}}return i.delete(n),i.delete(e),v}function tv(n){var e=-1,t=Array(n.size);return n.forEach(function(s,l){t[++e]=[l,s]}),t}function av(n){var e=-1,t=Array(n.size);return n.forEach(function(s){t[++e]=s}),t}var sv=1,nv=2,lv="[object Boolean]",iv="[object Date]",ov="[object Error]",rv="[object Map]",cv="[object Number]",uv="[object RegExp]",dv="[object Set]",mv="[object String]",pv="[object Symbol]",gv="[object ArrayBuffer]",fv="[object DataView]",ar=Pa?Pa.prototype:void 0,gi=ar?ar.valueOf:void 0;function hv(n,e,t,s,l,i,o){switch(t){case fv:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case gv:return!(n.byteLength!=e.byteLength||!i(new sl(n),new sl(e)));case lv:case iv:case cv:return _n(+n,+e);case ov:return n.name==e.name&&n.message==e.message;case uv:case mv:return n==e+"";case rv:var r=tv;case dv:var c=s&sv;if(r||(r=av),n.size!=e.size&&!c)return!1;var m=o.get(n);if(m)return m==e;s|=nv,o.set(n,e);var g=_c(r(n),r(e),s,l,i,o);return o.delete(n),g;case pv:if(gi)return gi.call(n)==gi.call(e)}return!1}var vv=1,_v=Object.prototype,yv=_v.hasOwnProperty;function bv(n,e,t,s,l,i){var o=t&vv,r=Ai(n),c=r.length,m=Ai(e),g=m.length;if(c!=g&&!o)return!1;for(var f=c;f--;){var v=r[f];if(!(o?v in e:yv.call(e,v)))return!1}var k=i.get(n),T=i.get(e);if(k&&T)return k==e&&T==n;var y=!0;i.set(n,e),i.set(e,n);for(var b=o;++f<c;){v=r[f];var L=n[v],E=e[v];if(s)var C=o?s(E,L,v,e,n,i):s(L,E,v,n,e,i);if(!(C===void 0?L===E||l(L,E,t,s,i):C)){y=!1;break}b||(b=v=="constructor")}if(y&&!b){var h=n.constructor,I=e.constructor;h!=I&&"constructor"in n&&"constructor"in e&&!(typeof h=="function"&&h instanceof h&&typeof I=="function"&&I instanceof I)&&(y=!1)}return i.delete(n),i.delete(e),y}var kv=1,sr="[object Arguments]",nr="[object Array]",qn="[object Object]",Cv=Object.prototype,lr=Cv.hasOwnProperty;function xv(n,e,t,s,l,i){var o=Wa(n),r=Wa(e),c=o?nr:rn(n),m=r?nr:rn(e);c=c==sr?qn:c,m=m==sr?qn:m;var g=c==qn,f=m==qn,v=c==m;if(v&&nn(n)){if(!nn(e))return!1;o=!0,g=!1}if(v&&!g)return i||(i=new ca),o||ao(n)?_c(n,e,t,s,l,i):hv(n,e,c,t,s,l,i);if(!(t&kv)){var k=g&&lr.call(n,"__wrapped__"),T=f&&lr.call(e,"__wrapped__");if(k||T){var y=k?n.value():n,b=T?e.value():e;return i||(i=new ca),l(y,b,t,s,i)}}return v?(i||(i=new ca),bv(n,e,t,s,l,i)):!1}function yc(n,e,t,s,l){return n===e?!0:n==null||e==null||!ya(n)&&!ya(e)?n!==n&&e!==e:xv(n,e,t,s,yc,l)}function wv(n){return function(e,t,s){for(var l=-1,i=Object(e),o=s(e),r=o.length;r--;){var c=o[n?r:++l];if(t(i[c],c,i)===!1)break}return e}}var Tv=wv(),Sv=Tv;function Pi(n,e,t){(t!==void 0&&!_n(n[e],t)||t===void 0&&!(e in n))&&Ki(n,e,t)}function Ev(n){return ya(n)&&hl(n)}function Ni(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}function Lv(n){return yn(n,bn(n))}function Av(n,e,t,s,l,i,o){var r=Ni(n,t),c=Ni(e,t),m=o.get(c);if(m){Pi(n,t,m);return}var g=i?i(r,c,t+"",n,e,o):void 0,f=g===void 0;if(f){var v=Wa(c),k=!v&&nn(c),T=!v&&!k&&ao(c);g=c,v||k||T?Wa(r)?g=r:Ev(r)?g=Xr(r):k?(f=!1,g=cc(c,!0)):T?(f=!1,g=pc(c,!0)):g=[]:uf(c)||Li(c)?(g=r,Li(r)?g=Lv(r):(!Ma(r)||Qi(r))&&(g=gc(c))):f=!1}f&&(o.set(c,g),l(g,c,s,i,o),o.delete(c)),Pi(n,t,g)}function bc(n,e,t,s,l){n!==e&&Sv(e,function(i,o){if(l||(l=new ca),Ma(i))Av(n,e,o,t,bc,s,l);else{var r=s?s(Ni(n,o),i,o+"",n,e,l):void 0;r===void 0&&(r=i),Pi(n,o,r)}},bn)}function oo(n,e){return yc(n,e)}var $v=Dp(function(n,e,t){bc(n,e,t)}),$a=$v,Se=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(Se||{});class ua{constructor(e,t,s={}){this.attrName=e,this.keyName=t;const l=Se.TYPE&Se.ATTRIBUTE;this.scope=s.scope!=null?s.scope&Se.LEVEL|l:Se.ATTRIBUTE,s.whitelist!=null&&(this.whitelist=s.whitelist)}static keys(e){return Array.from(e.attributes).map(t=>t.name)}add(e,t){return this.canAdd(e,t)?(e.setAttribute(this.keyName,t),!0):!1}canAdd(e,t){return this.whitelist==null?!0:typeof t=="string"?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""}}class Ts extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const kc=class Di{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,t=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(t){let s=null;try{s=e.parentNode}catch{return null}return this.find(s,t)}return null}create(e,t,s){const l=this.query(t);if(l==null)throw new Ts(`Unable to create ${t} blot`);const i=l,o=t instanceof Node||t.nodeType===Node.TEXT_NODE?t:i.create(s),r=new i(e,o,s);return Di.blots.set(r.domNode,r),r}find(e,t=!1){return Di.find(e,t)}query(e,t=Se.ANY){let s;return typeof e=="string"?s=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?s=this.types.text:typeof e=="number"?e&Se.LEVEL&Se.BLOCK?s=this.types.block:e&Se.LEVEL&Se.INLINE&&(s=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(l=>(s=this.classes[l],!!s)),s=s||this.tags[e.tagName]),s==null?null:"scope"in s&&t&Se.LEVEL&s.scope&&t&Se.TYPE&s.scope?s:null}register(...e){return e.map(t=>{const s="blotName"in t,l="attrName"in t;if(!s&&!l)throw new Ts("Invalid definition");if(s&&t.blotName==="abstract")throw new Ts("Cannot register abstract class");const i=s?t.blotName:l?t.attrName:void 0;return this.types[i]=t,l?typeof t.keyName=="string"&&(this.attributes[t.keyName]=t):s&&(t.className&&(this.classes[t.className]=t),t.tagName&&(Array.isArray(t.tagName)?t.tagName=t.tagName.map(o=>o.toUpperCase()):t.tagName=t.tagName.toUpperCase(),(Array.isArray(t.tagName)?t.tagName:[t.tagName]).forEach(o=>{(this.tags[o]==null||t.className==null)&&(this.tags[o]=t)}))),t})}};kc.blots=new WeakMap;let As=kc;function ir(n,e){return(n.getAttribute("class")||"").split(/\s+/).filter(t=>t.indexOf(`${e}-`)===0)}class Iv extends ua{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(t=>t.split("-").slice(0,-1).join("-"))}add(e,t){return this.canAdd(e,t)?(this.remove(e),e.classList.add(`${this.keyName}-${t}`),!0):!1}remove(e){ir(e,this.keyName).forEach(t=>{e.classList.remove(t)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const t=(ir(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""}}const aa=Iv;function fi(n){const e=n.split("-"),t=e.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("");return e[0]+t}class Ov extends ua{static keys(e){return(e.getAttribute("style")||"").split(";").map(t=>t.split(":")[0].trim())}add(e,t){return this.canAdd(e,t)?(e.style[fi(this.keyName)]=t,!0):!1}remove(e){e.style[fi(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const t=e.style[fi(this.keyName)];return this.canAdd(e,t)?t:""}}const Ba=Ov;class Pv{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,t){t?e.add(this.domNode,t)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=As.find(this.domNode);if(e==null)return;const t=ua.keys(this.domNode),s=aa.keys(this.domNode),l=Ba.keys(this.domNode);t.concat(s).concat(l).forEach(i=>{const o=e.scroll.query(i,Se.ATTRIBUTE);o instanceof ua&&(this.attributes[o.attrName]=o)})}copy(e){Object.keys(this.attributes).forEach(t=>{const s=this.attributes[t].value(this.domNode);e.format(t,s)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(t=>{this.attributes[t].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,t)=>(e[t]=this.attributes[t].value(this.domNode),e),{})}}const yl=Pv,Cc=class{constructor(e,t){this.scroll=e,this.domNode=t,As.blots.set(t,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new Ts("Blot definition missing tagName");let t,s;return Array.isArray(this.tagName)?(typeof e=="string"?(s=e.toUpperCase(),parseInt(s,10).toString()===s&&(s=parseInt(s,10))):typeof e=="number"&&(s=e),typeof s=="number"?t=document.createElement(this.tagName[s-1]):s&&this.tagName.indexOf(s)>-1?t=document.createElement(s):t=document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),As.blots.delete(this.domNode)}deleteAt(e,t){this.isolate(e,t).remove()}formatAt(e,t,s,l){const i=this.isolate(e,t);if(this.scroll.query(s,Se.BLOT)!=null&&l)i.wrap(s,l);else if(this.scroll.query(s,Se.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);i.wrap(o),o.format(s,l)}}insertAt(e,t,s){const l=s==null?this.scroll.create("text",t):this.scroll.create(t,s),i=this.split(e);this.parent.insertBefore(l,i||void 0)}isolate(e,t){const s=this.split(e);if(s==null)throw new Error("Attempt to isolate at end");return s.split(t),s}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,t){const s=typeof e=="string"?this.scroll.create(e,t):e;return this.parent!=null&&(this.parent.insertBefore(s,this.next||void 0),this.remove()),s}split(e,t){return e===0?this:this.next}update(e,t){}wrap(e,t){const s=typeof e=="string"?this.scroll.create(e,t):e;if(this.parent!=null&&this.parent.insertBefore(s,this.next||void 0),typeof s.appendChild!="function")throw new Ts(`Cannot wrap ${e}`);return s.appendChild(this),s}};Cc.blotName="abstract";let xc=Cc;const wc=class extends xc{static value(e){return!0}index(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1}position(e,t){let s=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(s+=1),[this.parent.domNode,s]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};wc.scope=Se.INLINE_BLOT;let Nv=wc;const kt=Nv;class Dv{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const t=e.slice(1);this.append(...t)}}at(e){const t=this.iterator();let s=t();for(;s&&e>0;)e-=1,s=t();return s}contains(e){const t=this.iterator();let s=t();for(;s;){if(s===e)return!0;s=t()}return!1}indexOf(e){const t=this.iterator();let s=t(),l=0;for(;s;){if(s===e)return l;l+=1,s=t()}return-1}insertBefore(e,t){e!=null&&(this.remove(e),e.next=t,t!=null?(e.prev=t.prev,t.prev!=null&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let t=0,s=this.head;for(;s!=null;){if(s===e)return t;t+=s.length(),s=s.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const t=e;return e!=null&&(e=e.next),t}}find(e,t=!1){const s=this.iterator();let l=s();for(;l;){const i=l.length();if(e<i||t&&e===i&&(l.next==null||l.next.length()!==0))return[l,e];e-=i,l=s()}return[null,0]}forEach(e){const t=this.iterator();let s=t();for(;s;)e(s),s=t()}forEachAt(e,t,s){if(t<=0)return;const[l,i]=this.find(e);let o=e-i;const r=this.iterator(l);let c=r();for(;c&&o<e+t;){const m=c.length();e>o?s(c,e-o,Math.min(t,o+m-e)):s(c,0,Math.min(m,e+t-o)),o+=m,c=r()}}map(e){return this.reduce((t,s)=>(t.push(e(s)),t),[])}reduce(e,t){const s=this.iterator();let l=s();for(;l;)t=e(t,l),l=s();return t}}function or(n,e){const t=e.find(n);if(t)return t;try{return e.create(n)}catch{const s=e.create(Se.INLINE);return Array.from(n.childNodes).forEach(l=>{s.domNode.appendChild(l)}),n.parentNode&&n.parentNode.replaceChild(s.domNode,n),s.attach(),s}}const Tc=class Sa extends xc{constructor(e,t){super(e,t),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,Sa.uiClass&&this.uiNode.classList.add(Sa.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Dv,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const t=or(e,this.scroll);this.insertBefore(t,this.children.head||void 0)}catch(t){if(t instanceof Ts)return;throw t}})}deleteAt(e,t){if(e===0&&t===this.length())return this.remove();this.children.forEachAt(e,t,(s,l,i)=>{s.deleteAt(l,i)})}descendant(e,t=0){const[s,l]=this.children.find(t);return e.blotName==null&&e(s)||e.blotName!=null&&s instanceof e?[s,l]:s instanceof Sa?s.descendant(e,l):[null,-1]}descendants(e,t=0,s=Number.MAX_VALUE){let l=[],i=s;return this.children.forEachAt(t,s,(o,r,c)=>{(e.blotName==null&&e(o)||e.blotName!=null&&o instanceof e)&&l.push(o),o instanceof Sa&&(l=l.concat(o.descendants(e,r,i))),i-=c}),l}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(t=>{e||this.statics.allowedChildren.some(s=>t instanceof s)||(t.statics.scope===Se.BLOCK_BLOT?(t.next!=null&&this.splitAfter(t),t.prev!=null&&this.splitAfter(t.prev),t.parent.unwrap(),e=!0):t instanceof Sa?t.unwrap():t.remove())})}formatAt(e,t,s,l){this.children.forEachAt(e,t,(i,o,r)=>{i.formatAt(o,r,s,l)})}insertAt(e,t,s){const[l,i]=this.children.find(e);if(l)l.insertAt(i,t,s);else{const o=s==null?this.scroll.create("text",t):this.scroll.create(t,s);this.appendChild(o)}}insertBefore(e,t){e.parent!=null&&e.parent.children.remove(e);let s=null;this.children.insertBefore(e,t||null),e.parent=this,t!=null&&(s=t.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==s)&&this.domNode.insertBefore(e.domNode,s),e.attach()}length(){return this.children.reduce((e,t)=>e+t.length(),0)}moveChildren(e,t){this.children.forEach(s=>{e.insertBefore(s,t)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove()}path(e,t=!1){const[s,l]=this.children.find(e,t),i=[[this,e]];return s instanceof Sa?i.concat(s.path(l,t)):(s!=null&&i.push([s,l]),i)}removeChild(e){this.children.remove(e)}replaceWith(e,t){const s=typeof e=="string"?this.scroll.create(e,t):e;return s instanceof Sa&&this.moveChildren(s),super.replaceWith(s)}split(e,t=!1){if(!t){if(e===0)return this;if(e===this.length())return this.next}const s=this.clone();return this.parent&&this.parent.insertBefore(s,this.next||void 0),this.children.forEachAt(e,this.length(),(l,i,o)=>{const r=l.split(i,t);r!=null&&s.appendChild(r)}),s}splitAfter(e){const t=this.clone();for(;e.next!=null;)t.appendChild(e.next);return this.parent&&this.parent.insertBefore(t,this.next||void 0),t}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,t){const s=[],l=[];e.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(s.push(...i.addedNodes),l.push(...i.removedNodes))}),l.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(i);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),s.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,o)=>i===o?0:i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let o=null;i.nextSibling!=null&&(o=this.scroll.find(i.nextSibling));const r=or(i,this.scroll);(r.next!==o||r.next==null)&&(r.parent!=null&&r.parent.removeChild(this),this.insertBefore(r,o||void 0))}),this.enforceAllowedChildren()}};Tc.uiClass="";let Mv=Tc;const ea=Mv;function Bv(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}const _s=class ys extends ea{static create(e){return super.create(e)}static formats(e,t){const s=t.query(ys.blotName);if(!(s!=null&&e.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new yl(this.domNode)}format(e,t){if(e===this.statics.blotName&&!t)this.children.forEach(s=>{s instanceof ys||(s=s.wrap(ys.blotName,!0)),this.attributes.copy(s)}),this.unwrap();else{const s=this.scroll.query(e,Se.INLINE);if(s==null)return;s instanceof ua?this.attributes.attribute(s,t):t&&(e!==this.statics.blotName||this.formats()[e]!==t)&&this.replaceWith(e,t)}}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return t!=null&&(e[this.statics.blotName]=t),e}formatAt(e,t,s,l){this.formats()[s]!=null||this.scroll.query(s,Se.ATTRIBUTE)?this.isolate(e,t).format(s,l):super.formatAt(e,t,s,l)}optimize(e){super.optimize(e);const t=this.formats();if(Object.keys(t).length===0)return this.unwrap();const s=this.next;s instanceof ys&&s.prev===this&&Bv(t,s.formats())&&(s.moveChildren(this),s.remove())}replaceWith(e,t){const s=super.replaceWith(e,t);return this.attributes.copy(s),s}update(e,t){super.update(e,t),e.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}wrap(e,t){const s=super.wrap(e,t);return s instanceof ys&&this.attributes.move(s),s}};_s.allowedChildren=[_s,kt],_s.blotName="inline",_s.scope=Se.INLINE_BLOT,_s.tagName="SPAN";let Fv=_s;const ro=Fv,bs=class Mi extends ea{static create(e){return super.create(e)}static formats(e,t){const s=t.query(Mi.blotName);if(!(s!=null&&e.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new yl(this.domNode)}format(e,t){const s=this.scroll.query(e,Se.BLOCK);s!=null&&(s instanceof ua?this.attributes.attribute(s,t):e===this.statics.blotName&&!t?this.replaceWith(Mi.blotName):t&&(e!==this.statics.blotName||this.formats()[e]!==t)&&this.replaceWith(e,t))}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return t!=null&&(e[this.statics.blotName]=t),e}formatAt(e,t,s,l){this.scroll.query(s,Se.BLOCK)!=null?this.format(s,l):super.formatAt(e,t,s,l)}insertAt(e,t,s){if(s==null||this.scroll.query(t,Se.INLINE)!=null)super.insertAt(e,t,s);else{const l=this.split(e);if(l!=null){const i=this.scroll.create(t,s);l.parent.insertBefore(i,l)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,t){const s=super.replaceWith(e,t);return this.attributes.copy(s),s}update(e,t){super.update(e,t),e.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}};bs.blotName="block",bs.scope=Se.BLOCK_BLOT,bs.tagName="P",bs.allowedChildren=[ro,bs,kt];let Vv=bs;const cn=Vv,Bi=class extends ea{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,t){super.deleteAt(e,t),this.enforceAllowedChildren()}formatAt(e,t,s,l){super.formatAt(e,t,s,l),this.enforceAllowedChildren()}insertAt(e,t,s){super.insertAt(e,t,s),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Bi.blotName="container",Bi.scope=Se.BLOCK_BLOT;let Rv=Bi;const bl=Rv;class qv extends kt{static formats(e,t){}format(e,t){super.formatAt(0,this.length(),e,t)}formatAt(e,t,s,l){e===0&&t===this.length()?this.format(s,l):super.formatAt(e,t,s,l)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Ft=qv,Uv={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},jv=100,ks=class extends ea{constructor(e,t){super(null,t),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(s=>{this.update(s)}),this.observer.observe(this.domNode,Uv),this.attach()}create(e,t){return this.registry.create(this,e,t)}find(e,t=!1){const s=this.registry.find(e,t);return s?s.scroll===this?s:t?this.find(s.scroll.domNode.parentNode,!0):null:null}query(e,t=Se.ANY){return this.registry.query(e,t)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,t){this.update(),e===0&&t===this.length()?this.children.forEach(s=>{s.remove()}):super.deleteAt(e,t)}formatAt(e,t,s,l){this.update(),super.formatAt(e,t,s,l)}insertAt(e,t,s){this.update(),super.insertAt(e,t,s)}optimize(e=[],t={}){super.optimize(t);const s=t.mutationsMap||new WeakMap;let l=Array.from(this.observer.takeRecords());for(;l.length>0;)e.push(l.pop());const i=(c,m=!0)=>{c==null||c===this||c.domNode.parentNode!=null&&(s.has(c.domNode)||s.set(c.domNode,[]),m&&i(c.parent))},o=c=>{s.has(c.domNode)&&(c instanceof ea&&c.children.forEach(o),s.delete(c.domNode),c.optimize(t))};let r=e;for(let c=0;r.length>0;c+=1){if(c>=jv)throw new Error("[Parchment] Maximum optimize iterations reached");for(r.forEach(m=>{const g=this.find(m.target,!0);g!=null&&(g.domNode===m.target&&(m.type==="childList"?(i(this.find(m.previousSibling,!1)),Array.from(m.addedNodes).forEach(f=>{const v=this.find(f,!1);i(v,!1),v instanceof ea&&v.children.forEach(k=>{i(k,!1)})})):m.type==="attributes"&&i(g.prev)),i(g))}),this.children.forEach(o),r=Array.from(this.observer.takeRecords()),l=r.slice();l.length>0;)e.push(l.pop())}}update(e,t={}){e=e||this.observer.takeRecords();const s=new WeakMap;e.map(l=>{const i=this.find(l.target,!0);return i==null?null:s.has(i.domNode)?(s.get(i.domNode).push(l),null):(s.set(i.domNode,[l]),i)}).forEach(l=>{l!=null&&l!==this&&s.has(l.domNode)&&l.update(s.get(l.domNode)||[],t)}),t.mutationsMap=s,s.has(this.domNode)&&super.update(s.get(this.domNode),t),this.optimize(e,t)}};ks.blotName="scroll",ks.defaultChild=cn,ks.allowedChildren=[cn,bl],ks.scope=Se.BLOCK_BLOT,ks.tagName="DIV";let zv=ks;const co=zv,Fi=class Sc extends kt{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,t){super(e,t),this.text=this.statics.value(this.domNode)}deleteAt(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)}index(e,t){return this.domNode===e?t:-1}insertAt(e,t,s){s==null?(this.text=this.text.slice(0,e)+t+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,t,s)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Sc&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,t=!1){return[this.domNode,e]}split(e,t=!1){if(!t){if(e===0)return this;if(e===this.length())return this.next}const s=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(s,this.next||void 0),this.text=this.statics.value(this.domNode),s}update(e,t){e.some(s=>s.type==="characterData"&&s.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Fi.blotName="text",Fi.scope=Se.INLINE_BLOT;let Yv=Fi;const ll=Yv;var Wv=Object.freeze(Object.defineProperty({__proto__:null,Attributor:ua,AttributorStore:yl,BlockBlot:cn,ClassAttributor:aa,ContainerBlot:bl,EmbedBlot:Ft,InlineBlot:ro,LeafBlot:kt,ParentBlot:ea,Registry:As,Scope:Se,ScrollBlot:co,StyleAttributor:Ba,TextBlot:ll},Symbol.toStringTag,{value:"Module"})),Pt={exports:{}},Bt=-1,Lt=1,ut=0;function un(n,e,t,s,l){if(n===e)return n?[[ut,n]]:[];if(t!=null){var i=t_(n,e,t);if(i)return i}var o=uo(n,e),r=n.substring(0,o);n=n.substring(o),e=e.substring(o),o=kl(n,e);var c=n.substring(n.length-o);n=n.substring(0,n.length-o),e=e.substring(0,e.length-o);var m=Hv(n,e);return r&&m.unshift([ut,r]),c&&m.push([ut,c]),mo(m,l),s&&Jv(m),m}function Hv(n,e){var t;if(!n)return[[Lt,e]];if(!e)return[[Bt,n]];var s=n.length>e.length?n:e,l=n.length>e.length?e:n,i=s.indexOf(l);if(i!==-1)return t=[[Lt,s.substring(0,i)],[ut,l],[Lt,s.substring(i+l.length)]],n.length>e.length&&(t[0][0]=t[2][0]=Bt),t;if(l.length===1)return[[Bt,n],[Lt,e]];var o=Gv(n,e);if(o){var r=o[0],c=o[1],m=o[2],g=o[3],f=o[4],v=un(r,m),k=un(c,g);return v.concat([[ut,f]],k)}return Zv(n,e)}function Zv(n,e){for(var t=n.length,s=e.length,l=Math.ceil((t+s)/2),i=l,o=2*l,r=new Array(o),c=new Array(o),m=0;m<o;m++)r[m]=-1,c[m]=-1;r[i+1]=0,c[i+1]=0;for(var g=t-s,f=g%2!==0,v=0,k=0,T=0,y=0,b=0;b<l;b++){for(var L=-b+v;L<=b-k;L+=2){var E=i+L,C;L===-b||L!==b&&r[E-1]<r[E+1]?C=r[E+1]:C=r[E-1]+1;for(var h=C-L;C<t&&h<s&&n.charAt(C)===e.charAt(h);)C++,h++;if(r[E]=C,C>t)k+=2;else if(h>s)v+=2;else if(f){var I=i+g-L;if(I>=0&&I<o&&c[I]!==-1){var O=t-c[I];if(C>=O)return rr(n,e,C,h)}}}for(var A=-b+T;A<=b-y;A+=2){var I=i+A,O;A===-b||A!==b&&c[I-1]<c[I+1]?O=c[I+1]:O=c[I-1]+1;for(var D=O-A;O<t&&D<s&&n.charAt(t-O-1)===e.charAt(s-D-1);)O++,D++;if(c[I]=O,O>t)y+=2;else if(D>s)T+=2;else if(!f){var E=i+g-A;if(E>=0&&E<o&&r[E]!==-1){var C=r[E],h=i+C-E;if(O=t-O,C>=O)return rr(n,e,C,h)}}}}return[[Bt,n],[Lt,e]]}function rr(n,e,t,s){var l=n.substring(0,t),i=e.substring(0,s),o=n.substring(t),r=e.substring(s),c=un(l,i),m=un(o,r);return c.concat(m)}function uo(n,e){if(!n||!e||n.charAt(0)!==e.charAt(0))return 0;for(var t=0,s=Math.min(n.length,e.length),l=s,i=0;t<l;)n.substring(i,l)==e.substring(i,l)?(t=l,i=t):s=l,l=Math.floor((s-t)/2+t);return Ec(n.charCodeAt(l-1))&&l--,l}function cr(n,e){var t=n.length,s=e.length;if(t==0||s==0)return 0;t>s?n=n.substring(t-s):t<s&&(e=e.substring(0,t));var l=Math.min(t,s);if(n==e)return l;for(var i=0,o=1;;){var r=n.substring(l-o),c=e.indexOf(r);if(c==-1)return i;o+=c,(c==0||n.substring(l-o)==e.substring(0,o))&&(i=o,o++)}}function kl(n,e){if(!n||!e||n.slice(-1)!==e.slice(-1))return 0;for(var t=0,s=Math.min(n.length,e.length),l=s,i=0;t<l;)n.substring(n.length-l,n.length-i)==e.substring(e.length-l,e.length-i)?(t=l,i=t):s=l,l=Math.floor((s-t)/2+t);return Lc(n.charCodeAt(n.length-l))&&l--,l}function Gv(n,e){var t=n.length>e.length?n:e,s=n.length>e.length?e:n;if(t.length<4||s.length*2<t.length)return null;function l(k,T,y){for(var b=k.substring(y,y+Math.floor(k.length/4)),L=-1,E="",C,h,I,O;(L=T.indexOf(b,L+1))!==-1;){var A=uo(k.substring(y),T.substring(L)),D=kl(k.substring(0,y),T.substring(0,L));E.length<D+A&&(E=T.substring(L-D,L)+T.substring(L,L+A),C=k.substring(0,y-D),h=k.substring(y+A),I=T.substring(0,L-D),O=T.substring(L+A))}return E.length*2>=k.length?[C,h,I,O,E]:null}var i=l(t,s,Math.ceil(t.length/4)),o=l(t,s,Math.ceil(t.length/2)),r;if(!i&&!o)return null;o?i?r=i[4].length>o[4].length?i:o:r=o:r=i;var c,m,g,f;n.length>e.length?(c=r[0],m=r[1],g=r[2],f=r[3]):(g=r[0],f=r[1],c=r[2],m=r[3]);var v=r[4];return[c,m,g,f,v]}function Jv(n){for(var e=!1,t=[],s=0,l=null,i=0,o=0,r=0,c=0,m=0;i<n.length;)n[i][0]==ut?(t[s++]=i,o=c,r=m,c=0,m=0,l=n[i][1]):(n[i][0]==Lt?c+=n[i][1].length:m+=n[i][1].length,l&&l.length<=Math.max(o,r)&&l.length<=Math.max(c,m)&&(n.splice(t[s-1],0,[Bt,l]),n[t[s-1]+1][0]=Lt,s--,s--,i=s>0?t[s-1]:-1,o=0,r=0,c=0,m=0,l=null,e=!0)),i++;for(e&&mo(n),Kv(n),i=1;i<n.length;){if(n[i-1][0]==Bt&&n[i][0]==Lt){var g=n[i-1][1],f=n[i][1],v=cr(g,f),k=cr(f,g);v>=k?(v>=g.length/2||v>=f.length/2)&&(n.splice(i,0,[ut,f.substring(0,v)]),n[i-1][1]=g.substring(0,g.length-v),n[i+1][1]=f.substring(v),i++):(k>=g.length/2||k>=f.length/2)&&(n.splice(i,0,[ut,g.substring(0,k)]),n[i-1][0]=Lt,n[i-1][1]=f.substring(0,f.length-k),n[i+1][0]=Bt,n[i+1][1]=g.substring(k),i++),i++}i++}}var ur=/[^a-zA-Z0-9]/,dr=/\s/,mr=/[\r\n]/,Xv=/\n\r?\n$/,Qv=/^\r?\n\r?\n/;function Kv(n){function e(k,T){if(!k||!T)return 6;var y=k.charAt(k.length-1),b=T.charAt(0),L=y.match(ur),E=b.match(ur),C=L&&y.match(dr),h=E&&b.match(dr),I=C&&y.match(mr),O=h&&b.match(mr),A=I&&k.match(Xv),D=O&&T.match(Qv);return A||D?5:I||O?4:L&&!C&&h?3:C||h?2:L||E?1:0}for(var t=1;t<n.length-1;){if(n[t-1][0]==ut&&n[t+1][0]==ut){var s=n[t-1][1],l=n[t][1],i=n[t+1][1],o=kl(s,l);if(o){var r=l.substring(l.length-o);s=s.substring(0,s.length-o),l=r+l.substring(0,l.length-o),i=r+i}for(var c=s,m=l,g=i,f=e(s,l)+e(l,i);l.charAt(0)===i.charAt(0);){s+=l.charAt(0),l=l.substring(1)+i.charAt(0),i=i.substring(1);var v=e(s,l)+e(l,i);v>=f&&(f=v,c=s,m=l,g=i)}n[t-1][1]!=c&&(c?n[t-1][1]=c:(n.splice(t-1,1),t--),n[t][1]=m,g?n[t+1][1]=g:(n.splice(t+1,1),t--))}t++}}function mo(n,e){n.push([ut,""]);for(var t=0,s=0,l=0,i="",o="",r;t<n.length;){if(t<n.length-1&&!n[t][1]){n.splice(t,1);continue}switch(n[t][0]){case Lt:l++,o+=n[t][1],t++;break;case Bt:s++,i+=n[t][1],t++;break;case ut:var c=t-l-s-1;if(e){if(c>=0&&$c(n[c][1])){var m=n[c][1].slice(-1);if(n[c][1]=n[c][1].slice(0,-1),i=m+i,o=m+o,!n[c][1]){n.splice(c,1),t--;var g=c-1;n[g]&&n[g][0]===Lt&&(l++,o=n[g][1]+o,g--),n[g]&&n[g][0]===Bt&&(s++,i=n[g][1]+i,g--),c=g}}if(Ac(n[t][1])){var m=n[t][1].charAt(0);n[t][1]=n[t][1].slice(1),i+=m,o+=m}}if(t<n.length-1&&!n[t][1]){n.splice(t,1);break}if(i.length>0||o.length>0){i.length>0&&o.length>0&&(r=uo(o,i),r!==0&&(c>=0?n[c][1]+=o.substring(0,r):(n.splice(0,0,[ut,o.substring(0,r)]),t++),o=o.substring(r),i=i.substring(r)),r=kl(o,i),r!==0&&(n[t][1]=o.substring(o.length-r)+n[t][1],o=o.substring(0,o.length-r),i=i.substring(0,i.length-r)));var f=l+s;i.length===0&&o.length===0?(n.splice(t-f,f),t=t-f):i.length===0?(n.splice(t-f,f,[Lt,o]),t=t-f+1):o.length===0?(n.splice(t-f,f,[Bt,i]),t=t-f+1):(n.splice(t-f,f,[Bt,i],[Lt,o]),t=t-f+2)}t!==0&&n[t-1][0]===ut?(n[t-1][1]+=n[t][1],n.splice(t,1)):t++,l=0,s=0,i="",o="";break}}n[n.length-1][1]===""&&n.pop();var v=!1;for(t=1;t<n.length-1;)n[t-1][0]===ut&&n[t+1][0]===ut&&(n[t][1].substring(n[t][1].length-n[t-1][1].length)===n[t-1][1]?(n[t][1]=n[t-1][1]+n[t][1].substring(0,n[t][1].length-n[t-1][1].length),n[t+1][1]=n[t-1][1]+n[t+1][1],n.splice(t-1,1),v=!0):n[t][1].substring(0,n[t+1][1].length)==n[t+1][1]&&(n[t-1][1]+=n[t+1][1],n[t][1]=n[t][1].substring(n[t+1][1].length)+n[t+1][1],n.splice(t+1,1),v=!0)),t++;v&&mo(n,e)}function Ec(n){return n>=55296&&n<=56319}function Lc(n){return n>=56320&&n<=57343}function Ac(n){return Lc(n.charCodeAt(0))}function $c(n){return Ec(n.charCodeAt(n.length-1))}function e_(n){for(var e=[],t=0;t<n.length;t++)n[t][1].length>0&&e.push(n[t]);return e}function hi(n,e,t,s){return $c(n)||Ac(s)?null:e_([[ut,n],[Bt,e],[Lt,t],[ut,s]])}function t_(n,e,t){var s=typeof t=="number"?{index:t,length:0}:t.oldRange,l=typeof t=="number"?null:t.newRange,i=n.length,o=e.length;if(s.length===0&&(l===null||l.length===0)){var r=s.index,c=n.slice(0,r),m=n.slice(r),g=l?l.index:null;e:{var f=r+o-i;if(g!==null&&g!==f||f<0||f>o)break e;var v=e.slice(0,f),k=e.slice(f);if(k!==m)break e;var T=Math.min(r,f),y=c.slice(0,T),b=v.slice(0,T);if(y!==b)break e;var L=c.slice(T),E=v.slice(T);return hi(y,L,E,m)}e:{if(g!==null&&g!==r)break e;var C=r,v=e.slice(0,C),k=e.slice(C);if(v!==c)break e;var h=Math.min(i-C,o-C),I=m.slice(m.length-h),O=k.slice(k.length-h);if(I!==O)break e;var L=m.slice(0,m.length-h),E=k.slice(0,k.length-h);return hi(c,L,E,I)}}if(s.length>0&&l&&l.length===0){e:{var y=n.slice(0,s.index),I=n.slice(s.index+s.length),T=y.length,h=I.length;if(o<T+h)break e;var b=e.slice(0,T),O=e.slice(o-h);if(y!==b||I!==O)break e;var L=n.slice(T,i-h),E=e.slice(T,o-h);return hi(y,L,E,I)}}return null}function Cl(n,e,t,s){return un(n,e,t,s,!0)}Cl.INSERT=Lt;Cl.DELETE=Bt;Cl.EQUAL=ut;var a_=Cl,il={exports:{}};(function(n,e){var t=200,s="__lodash_hash_undefined__",l=9007199254740991,i="[object Arguments]",o="[object Array]",r="[object Boolean]",c="[object Date]",m="[object Error]",g="[object Function]",f="[object GeneratorFunction]",v="[object Map]",k="[object Number]",T="[object Object]",y="[object Promise]",b="[object RegExp]",L="[object Set]",E="[object String]",C="[object Symbol]",h="[object WeakMap]",I="[object ArrayBuffer]",O="[object DataView]",A="[object Float32Array]",D="[object Float64Array]",V="[object Int8Array]",z="[object Int16Array]",B="[object Int32Array]",J="[object Uint8Array]",G="[object Uint8ClampedArray]",X="[object Uint16Array]",K="[object Uint32Array]",Q=/[\\^$.*+?()[\]{}|]/g,le=/\w*$/,H=/^\[object .+?Constructor\]$/,se=/^(?:0|[1-9]\d*)$/,ge={};ge[i]=ge[o]=ge[I]=ge[O]=ge[r]=ge[c]=ge[A]=ge[D]=ge[V]=ge[z]=ge[B]=ge[v]=ge[k]=ge[T]=ge[b]=ge[L]=ge[E]=ge[C]=ge[J]=ge[G]=ge[X]=ge[K]=!0,ge[m]=ge[g]=ge[h]=!1;var $e=typeof Ea=="object"&&Ea&&Ea.Object===Object&&Ea,ue=typeof self=="object"&&self&&self.Object===Object&&self,ae=$e||ue||Function("return this")(),me=e&&!e.nodeType&&e,Y=me&&!0&&n&&!n.nodeType&&n,j=Y&&Y.exports===me;function te(p,P){return p.set(P[0],P[1]),p}function de(p,P){return p.add(P),p}function Z(p,P){for(var U=-1,ne=p?p.length:0;++U<ne&&P(p[U],U,p)!==!1;);return p}function ce(p,P){for(var U=-1,ne=P.length,De=p.length;++U<ne;)p[De+U]=P[U];return p}function fe(p,P,U,ne){var De=-1,Le=p?p.length:0;for(ne&&Le&&(U=p[++De]);++De<Le;)U=P(U,p[De],De,p);return U}function Ne(p,P){for(var U=-1,ne=Array(p);++U<p;)ne[U]=P(U);return ne}function Oe(p,P){return p?.[P]}function je(p){var P=!1;if(p!=null&&typeof p.toString!="function")try{P=!!(p+"")}catch{}return P}function _e(p){var P=-1,U=Array(p.size);return p.forEach(function(ne,De){U[++P]=[De,ne]}),U}function Ce(p,P){return function(U){return p(P(U))}}function Te(p){var P=-1,U=Array(p.size);return p.forEach(function(ne){U[++P]=ne}),U}var Me=Array.prototype,Ee=Function.prototype,Xe=Object.prototype,re=ae["__core-js_shared__"],Fe=function(){var p=/[^.]+$/.exec(re&&re.keys&&re.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),he=Ee.toString,Re=Xe.hasOwnProperty,Ae=Xe.toString,Ds=RegExp("^"+he.call(Re).replace(Q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wt=j?ae.Buffer:void 0,is=ae.Symbol,Ms=ae.Uint8Array,Vt=Ce(Object.getPrototypeOf,Object),Tn=Object.create,Sn=Xe.propertyIsEnumerable,El=Me.splice,Bs=Object.getOwnPropertySymbols,os=wt?wt.isBuffer:void 0,En=Ce(Object.keys,Object),rs=Jt(ae,"DataView"),Fa=Jt(ae,"Map"),Gt=Jt(ae,"Promise"),cs=Jt(ae,"Set"),Fs=Jt(ae,"WeakMap"),Va=Jt(Object,"create"),Vs=Tt(rs),Ra=Tt(Fa),Rs=Tt(Gt),qs=Tt(cs),Us=Tt(Fs),wa=is?is.prototype:void 0,Ln=wa?wa.valueOf:void 0;function pa(p){var P=-1,U=p?p.length:0;for(this.clear();++P<U;){var ne=p[P];this.set(ne[0],ne[1])}}function Ll(){this.__data__=Va?Va(null):{}}function Al(p){return this.has(p)&&delete this.__data__[p]}function $l(p){var P=this.__data__;if(Va){var U=P[p];return U===s?void 0:U}return Re.call(P,p)?P[p]:void 0}function An(p){var P=this.__data__;return Va?P[p]!==void 0:Re.call(P,p)}function js(p,P){var U=this.__data__;return U[p]=Va&&P===void 0?s:P,this}pa.prototype.clear=Ll,pa.prototype.delete=Al,pa.prototype.get=$l,pa.prototype.has=An,pa.prototype.set=js;function mt(p){var P=-1,U=p?p.length:0;for(this.clear();++P<U;){var ne=p[P];this.set(ne[0],ne[1])}}function Il(){this.__data__=[]}function Ol(p){var P=this.__data__,U=ds(P,p);if(U<0)return!1;var ne=P.length-1;return U==ne?P.pop():El.call(P,U,1),!0}function Pl(p){var P=this.__data__,U=ds(P,p);return U<0?void 0:P[U][1]}function Nl(p){return ds(this.__data__,p)>-1}function Dl(p,P){var U=this.__data__,ne=ds(U,p);return ne<0?U.push([p,P]):U[ne][1]=P,this}mt.prototype.clear=Il,mt.prototype.delete=Ol,mt.prototype.get=Pl,mt.prototype.has=Nl,mt.prototype.set=Dl;function _t(p){var P=-1,U=p?p.length:0;for(this.clear();++P<U;){var ne=p[P];this.set(ne[0],ne[1])}}function Ml(){this.__data__={hash:new pa,map:new(Fa||mt),string:new pa}}function Bl(p){return Ua(this,p).delete(p)}function Fl(p){return Ua(this,p).get(p)}function Vl(p){return Ua(this,p).has(p)}function Rl(p,P){return Ua(this,p).set(p,P),this}_t.prototype.clear=Ml,_t.prototype.delete=Bl,_t.prototype.get=Fl,_t.prototype.has=Vl,_t.prototype.set=Rl;function It(p){this.__data__=new mt(p)}function ql(){this.__data__=new mt}function Ul(p){return this.__data__.delete(p)}function jl(p){return this.__data__.get(p)}function zl(p){return this.__data__.has(p)}function Yl(p,P){var U=this.__data__;if(U instanceof mt){var ne=U.__data__;if(!Fa||ne.length<t-1)return ne.push([p,P]),this;U=this.__data__=new _t(ne)}return U.set(p,P),this}It.prototype.clear=ql,It.prototype.delete=Ul,It.prototype.get=jl,It.prototype.has=zl,It.prototype.set=Yl;function us(p,P){var U=Hs(p)||ps(p)?Ne(p.length,String):[],ne=U.length,De=!!ne;for(var Le in p)(P||Re.call(p,Le))&&!(De&&(Le=="length"||li(Le,ne)))&&U.push(Le);return U}function $n(p,P,U){var ne=p[P];(!(Re.call(p,P)&&Dn(ne,U))||U===void 0&&!(P in p))&&(p[P]=U)}function ds(p,P){for(var U=p.length;U--;)if(Dn(p[U][0],P))return U;return-1}function na(p,P){return p&&Ws(P,Gs(P),p)}function zs(p,P,U,ne,De,Le,qe){var ze;if(ne&&(ze=Le?ne(p,De,Le,qe):ne(p)),ze!==void 0)return ze;if(!ia(p))return p;var it=Hs(p);if(it){if(ze=si(p),!P)return ei(p,ze)}else{var Ze=fa(p),yt=Ze==g||Ze==f;if(Mn(p))return ms(p,P);if(Ze==T||Ze==i||yt&&!Le){if(je(p))return Le?p:{};if(ze=la(yt?{}:p),!P)return ti(p,na(ze,p))}else{if(!ge[Ze])return Le?p:{};ze=ni(p,Ze,zs,P)}}qe||(qe=new It);var Ot=qe.get(p);if(Ot)return Ot;if(qe.set(p,ze),!it)var ct=U?ai(p):Gs(p);return Z(ct||p,function(bt,pt){ct&&(pt=bt,bt=p[pt]),$n(ze,pt,zs(bt,P,U,ne,pt,p,qe))}),ze}function Wl(p){return ia(p)?Tn(p):{}}function Hl(p,P,U){var ne=P(p);return Hs(p)?ne:ce(ne,U(p))}function Zl(p){return Ae.call(p)}function Gl(p){if(!ia(p)||oi(p))return!1;var P=Zs(p)||je(p)?Ds:H;return P.test(Tt(p))}function Jl(p){if(!Pn(p))return En(p);var P=[];for(var U in Object(p))Re.call(p,U)&&U!="constructor"&&P.push(U);return P}function ms(p,P){if(P)return p.slice();var U=new p.constructor(p.length);return p.copy(U),U}function Ys(p){var P=new p.constructor(p.byteLength);return new Ms(P).set(new Ms(p)),P}function qa(p,P){var U=P?Ys(p.buffer):p.buffer;return new p.constructor(U,p.byteOffset,p.byteLength)}function In(p,P,U){var ne=P?U(_e(p),!0):_e(p);return fe(ne,te,new p.constructor)}function On(p){var P=new p.constructor(p.source,le.exec(p));return P.lastIndex=p.lastIndex,P}function Xl(p,P,U){var ne=P?U(Te(p),!0):Te(p);return fe(ne,de,new p.constructor)}function Ql(p){return Ln?Object(Ln.call(p)):{}}function Kl(p,P){var U=P?Ys(p.buffer):p.buffer;return new p.constructor(U,p.byteOffset,p.length)}function ei(p,P){var U=-1,ne=p.length;for(P||(P=Array(ne));++U<ne;)P[U]=p[U];return P}function Ws(p,P,U,ne){U||(U={});for(var De=-1,Le=P.length;++De<Le;){var qe=P[De],ze=ne?ne(U[qe],p[qe],qe,U,p):void 0;$n(U,qe,ze===void 0?p[qe]:ze)}return U}function ti(p,P){return Ws(p,ga(p),P)}function ai(p){return Hl(p,Gs,ga)}function Ua(p,P){var U=p.__data__;return ii(P)?U[typeof P=="string"?"string":"hash"]:U.map}function Jt(p,P){var U=Oe(p,P);return Gl(U)?U:void 0}var ga=Bs?Ce(Bs,Object):ci,fa=Zl;(rs&&fa(new rs(new ArrayBuffer(1)))!=O||Fa&&fa(new Fa)!=v||Gt&&fa(Gt.resolve())!=y||cs&&fa(new cs)!=L||Fs&&fa(new Fs)!=h)&&(fa=function(p){var P=Ae.call(p),U=P==T?p.constructor:void 0,ne=U?Tt(U):void 0;if(ne)switch(ne){case Vs:return O;case Ra:return v;case Rs:return y;case qs:return L;case Us:return h}return P});function si(p){var P=p.length,U=p.constructor(P);return P&&typeof p[0]=="string"&&Re.call(p,"index")&&(U.index=p.index,U.input=p.input),U}function la(p){return typeof p.constructor=="function"&&!Pn(p)?Wl(Vt(p)):{}}function ni(p,P,U,ne){var De=p.constructor;switch(P){case I:return Ys(p);case r:case c:return new De(+p);case O:return qa(p,ne);case A:case D:case V:case z:case B:case J:case G:case X:case K:return Kl(p,ne);case v:return In(p,ne,U);case k:case E:return new De(p);case b:return On(p);case L:return Xl(p,ne,U);case C:return Ql(p)}}function li(p,P){return P=P??l,!!P&&(typeof p=="number"||se.test(p))&&p>-1&&p%1==0&&p<P}function ii(p){var P=typeof p;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?p!=="__proto__":p===null}function oi(p){return!!Fe&&Fe in p}function Pn(p){var P=p&&p.constructor,U=typeof P=="function"&&P.prototype||Xe;return p===U}function Tt(p){if(p!=null){try{return he.call(p)}catch{}try{return p+""}catch{}}return""}function Nn(p){return zs(p,!0,!0)}function Dn(p,P){return p===P||p!==p&&P!==P}function ps(p){return ri(p)&&Re.call(p,"callee")&&(!Sn.call(p,"callee")||Ae.call(p)==i)}var Hs=Array.isArray;function gs(p){return p!=null&&Bn(p.length)&&!Zs(p)}function ri(p){return Fn(p)&&gs(p)}var Mn=os||ui;function Zs(p){var P=ia(p)?Ae.call(p):"";return P==g||P==f}function Bn(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=l}function ia(p){var P=typeof p;return!!p&&(P=="object"||P=="function")}function Fn(p){return!!p&&typeof p=="object"}function Gs(p){return gs(p)?us(p):Jl(p)}function ci(){return[]}function ui(){return!1}n.exports=Nn})(il,il.exports);var ol={exports:{}};(function(n,e){var t=200,s="__lodash_hash_undefined__",l=1,i=2,o=9007199254740991,r="[object Arguments]",c="[object Array]",m="[object AsyncFunction]",g="[object Boolean]",f="[object Date]",v="[object Error]",k="[object Function]",T="[object GeneratorFunction]",y="[object Map]",b="[object Number]",L="[object Null]",E="[object Object]",C="[object Promise]",h="[object Proxy]",I="[object RegExp]",O="[object Set]",A="[object String]",D="[object Symbol]",V="[object Undefined]",z="[object WeakMap]",B="[object ArrayBuffer]",J="[object DataView]",G="[object Float32Array]",X="[object Float64Array]",K="[object Int8Array]",Q="[object Int16Array]",le="[object Int32Array]",H="[object Uint8Array]",se="[object Uint8ClampedArray]",ge="[object Uint16Array]",$e="[object Uint32Array]",ue=/[\\^$.*+?()[\]{}|]/g,ae=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,Y={};Y[G]=Y[X]=Y[K]=Y[Q]=Y[le]=Y[H]=Y[se]=Y[ge]=Y[$e]=!0,Y[r]=Y[c]=Y[B]=Y[g]=Y[J]=Y[f]=Y[v]=Y[k]=Y[y]=Y[b]=Y[E]=Y[I]=Y[O]=Y[A]=Y[z]=!1;var j=typeof Ea=="object"&&Ea&&Ea.Object===Object&&Ea,te=typeof self=="object"&&self&&self.Object===Object&&self,de=j||te||Function("return this")(),Z=e&&!e.nodeType&&e,ce=Z&&!0&&n&&!n.nodeType&&n,fe=ce&&ce.exports===Z,Ne=fe&&j.process,Oe=function(){try{return Ne&&Ne.binding&&Ne.binding("util")}catch{}}(),je=Oe&&Oe.isTypedArray;function _e(p,P){for(var U=-1,ne=p==null?0:p.length,De=0,Le=[];++U<ne;){var qe=p[U];P(qe,U,p)&&(Le[De++]=qe)}return Le}function Ce(p,P){for(var U=-1,ne=P.length,De=p.length;++U<ne;)p[De+U]=P[U];return p}function Te(p,P){for(var U=-1,ne=p==null?0:p.length;++U<ne;)if(P(p[U],U,p))return!0;return!1}function Me(p,P){for(var U=-1,ne=Array(p);++U<p;)ne[U]=P(U);return ne}function Ee(p){return function(P){return p(P)}}function Xe(p,P){return p.has(P)}function re(p,P){return p?.[P]}function Fe(p){var P=-1,U=Array(p.size);return p.forEach(function(ne,De){U[++P]=[De,ne]}),U}function he(p,P){return function(U){return p(P(U))}}function Re(p){var P=-1,U=Array(p.size);return p.forEach(function(ne){U[++P]=ne}),U}var Ae=Array.prototype,Ds=Function.prototype,wt=Object.prototype,is=de["__core-js_shared__"],Ms=Ds.toString,Vt=wt.hasOwnProperty,Tn=function(){var p=/[^.]+$/.exec(is&&is.keys&&is.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),Sn=wt.toString,El=RegExp("^"+Ms.call(Vt).replace(ue,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=fe?de.Buffer:void 0,os=de.Symbol,En=de.Uint8Array,rs=wt.propertyIsEnumerable,Fa=Ae.splice,Gt=os?os.toStringTag:void 0,cs=Object.getOwnPropertySymbols,Fs=Bs?Bs.isBuffer:void 0,Va=he(Object.keys,Object),Vs=ga(de,"DataView"),Ra=ga(de,"Map"),Rs=ga(de,"Promise"),qs=ga(de,"Set"),Us=ga(de,"WeakMap"),wa=ga(Object,"create"),Ln=Tt(Vs),pa=Tt(Ra),Ll=Tt(Rs),Al=Tt(qs),$l=Tt(Us),An=os?os.prototype:void 0,js=An?An.valueOf:void 0;function mt(p){var P=-1,U=p==null?0:p.length;for(this.clear();++P<U;){var ne=p[P];this.set(ne[0],ne[1])}}function Il(){this.__data__=wa?wa(null):{},this.size=0}function Ol(p){var P=this.has(p)&&delete this.__data__[p];return this.size-=P?1:0,P}function Pl(p){var P=this.__data__;if(wa){var U=P[p];return U===s?void 0:U}return Vt.call(P,p)?P[p]:void 0}function Nl(p){var P=this.__data__;return wa?P[p]!==void 0:Vt.call(P,p)}function Dl(p,P){var U=this.__data__;return this.size+=this.has(p)?0:1,U[p]=wa&&P===void 0?s:P,this}mt.prototype.clear=Il,mt.prototype.delete=Ol,mt.prototype.get=Pl,mt.prototype.has=Nl,mt.prototype.set=Dl;function _t(p){var P=-1,U=p==null?0:p.length;for(this.clear();++P<U;){var ne=p[P];this.set(ne[0],ne[1])}}function Ml(){this.__data__=[],this.size=0}function Bl(p){var P=this.__data__,U=ms(P,p);if(U<0)return!1;var ne=P.length-1;return U==ne?P.pop():Fa.call(P,U,1),--this.size,!0}function Fl(p){var P=this.__data__,U=ms(P,p);return U<0?void 0:P[U][1]}function Vl(p){return ms(this.__data__,p)>-1}function Rl(p,P){var U=this.__data__,ne=ms(U,p);return ne<0?(++this.size,U.push([p,P])):U[ne][1]=P,this}_t.prototype.clear=Ml,_t.prototype.delete=Bl,_t.prototype.get=Fl,_t.prototype.has=Vl,_t.prototype.set=Rl;function It(p){var P=-1,U=p==null?0:p.length;for(this.clear();++P<U;){var ne=p[P];this.set(ne[0],ne[1])}}function ql(){this.size=0,this.__data__={hash:new mt,map:new(Ra||_t),string:new mt}}function Ul(p){var P=Jt(this,p).delete(p);return this.size-=P?1:0,P}function jl(p){return Jt(this,p).get(p)}function zl(p){return Jt(this,p).has(p)}function Yl(p,P){var U=Jt(this,p),ne=U.size;return U.set(p,P),this.size+=U.size==ne?0:1,this}It.prototype.clear=ql,It.prototype.delete=Ul,It.prototype.get=jl,It.prototype.has=zl,It.prototype.set=Yl;function us(p){var P=-1,U=p==null?0:p.length;for(this.__data__=new It;++P<U;)this.add(p[P])}function $n(p){return this.__data__.set(p,s),this}function ds(p){return this.__data__.has(p)}us.prototype.add=us.prototype.push=$n,us.prototype.has=ds;function na(p){var P=this.__data__=new _t(p);this.size=P.size}function zs(){this.__data__=new _t,this.size=0}function Wl(p){var P=this.__data__,U=P.delete(p);return this.size=P.size,U}function Hl(p){return this.__data__.get(p)}function Zl(p){return this.__data__.has(p)}function Gl(p,P){var U=this.__data__;if(U instanceof _t){var ne=U.__data__;if(!Ra||ne.length<t-1)return ne.push([p,P]),this.size=++U.size,this;U=this.__data__=new It(ne)}return U.set(p,P),this.size=U.size,this}na.prototype.clear=zs,na.prototype.delete=Wl,na.prototype.get=Hl,na.prototype.has=Zl,na.prototype.set=Gl;function Jl(p,P){var U=ps(p),ne=!U&&Dn(p),De=!U&&!ne&&gs(p),Le=!U&&!ne&&!De&&Fn(p),qe=U||ne||De||Le,ze=qe?Me(p.length,String):[],it=ze.length;for(var Ze in p)(P||Vt.call(p,Ze))&&!(qe&&(Ze=="length"||De&&(Ze=="offset"||Ze=="parent")||Le&&(Ze=="buffer"||Ze=="byteLength"||Ze=="byteOffset")||ni(Ze,it)))&&ze.push(Ze);return ze}function ms(p,P){for(var U=p.length;U--;)if(Nn(p[U][0],P))return U;return-1}function Ys(p,P,U){var ne=P(p);return ps(p)?ne:Ce(ne,U(p))}function qa(p){return p==null?p===void 0?V:L:Gt&&Gt in Object(p)?fa(p):Pn(p)}function In(p){return ia(p)&&qa(p)==r}function On(p,P,U,ne,De){return p===P?!0:p==null||P==null||!ia(p)&&!ia(P)?p!==p&&P!==P:Xl(p,P,U,ne,On,De)}function Xl(p,P,U,ne,De,Le){var qe=ps(p),ze=ps(P),it=qe?c:la(p),Ze=ze?c:la(P);it=it==r?E:it,Ze=Ze==r?E:Ze;var yt=it==E,Ot=Ze==E,ct=it==Ze;if(ct&&gs(p)){if(!gs(P))return!1;qe=!0,yt=!1}if(ct&&!yt)return Le||(Le=new na),qe||Fn(p)?Ws(p,P,U,ne,De,Le):ti(p,P,it,U,ne,De,Le);if(!(U&l)){var bt=yt&&Vt.call(p,"__wrapped__"),pt=Ot&&Vt.call(P,"__wrapped__");if(bt||pt){var Ta=bt?p.value():p,ha=pt?P.value():P;return Le||(Le=new na),De(Ta,ha,U,ne,Le)}}return ct?(Le||(Le=new na),ai(p,P,U,ne,De,Le)):!1}function Ql(p){if(!Bn(p)||ii(p))return!1;var P=Mn(p)?El:ae;return P.test(Tt(p))}function Kl(p){return ia(p)&&Zs(p.length)&&!!Y[qa(p)]}function ei(p){if(!oi(p))return Va(p);var P=[];for(var U in Object(p))Vt.call(p,U)&&U!="constructor"&&P.push(U);return P}function Ws(p,P,U,ne,De,Le){var qe=U&l,ze=p.length,it=P.length;if(ze!=it&&!(qe&&it>ze))return!1;var Ze=Le.get(p);if(Ze&&Le.get(P))return Ze==P;var yt=-1,Ot=!0,ct=U&i?new us:void 0;for(Le.set(p,P),Le.set(P,p);++yt<ze;){var bt=p[yt],pt=P[yt];if(ne)var Ta=qe?ne(pt,bt,yt,P,p,Le):ne(bt,pt,yt,p,P,Le);if(Ta!==void 0){if(Ta)continue;Ot=!1;break}if(ct){if(!Te(P,function(ha,ja){if(!Xe(ct,ja)&&(bt===ha||De(bt,ha,U,ne,Le)))return ct.push(ja)})){Ot=!1;break}}else if(!(bt===pt||De(bt,pt,U,ne,Le))){Ot=!1;break}}return Le.delete(p),Le.delete(P),Ot}function ti(p,P,U,ne,De,Le,qe){switch(U){case J:if(p.byteLength!=P.byteLength||p.byteOffset!=P.byteOffset)return!1;p=p.buffer,P=P.buffer;case B:return!(p.byteLength!=P.byteLength||!Le(new En(p),new En(P)));case g:case f:case b:return Nn(+p,+P);case v:return p.name==P.name&&p.message==P.message;case I:case A:return p==P+"";case y:var ze=Fe;case O:var it=ne&l;if(ze||(ze=Re),p.size!=P.size&&!it)return!1;var Ze=qe.get(p);if(Ze)return Ze==P;ne|=i,qe.set(p,P);var yt=Ws(ze(p),ze(P),ne,De,Le,qe);return qe.delete(p),yt;case D:if(js)return js.call(p)==js.call(P)}return!1}function ai(p,P,U,ne,De,Le){var qe=U&l,ze=Ua(p),it=ze.length,Ze=Ua(P),yt=Ze.length;if(it!=yt&&!qe)return!1;for(var Ot=it;Ot--;){var ct=ze[Ot];if(!(qe?ct in P:Vt.call(P,ct)))return!1}var bt=Le.get(p);if(bt&&Le.get(P))return bt==P;var pt=!0;Le.set(p,P),Le.set(P,p);for(var Ta=qe;++Ot<it;){ct=ze[Ot];var ha=p[ct],ja=P[ct];if(ne)var Ao=qe?ne(ja,ha,ct,P,p,Le):ne(ha,ja,ct,p,P,Le);if(!(Ao===void 0?ha===ja||De(ha,ja,U,ne,Le):Ao)){pt=!1;break}Ta||(Ta=ct=="constructor")}if(pt&&!Ta){var Vn=p.constructor,Rn=P.constructor;Vn!=Rn&&"constructor"in p&&"constructor"in P&&!(typeof Vn=="function"&&Vn instanceof Vn&&typeof Rn=="function"&&Rn instanceof Rn)&&(pt=!1)}return Le.delete(p),Le.delete(P),pt}function Ua(p){return Ys(p,Gs,si)}function Jt(p,P){var U=p.__data__;return li(P)?U[typeof P=="string"?"string":"hash"]:U.map}function ga(p,P){var U=re(p,P);return Ql(U)?U:void 0}function fa(p){var P=Vt.call(p,Gt),U=p[Gt];try{p[Gt]=void 0;var ne=!0}catch{}var De=Sn.call(p);return ne&&(P?p[Gt]=U:delete p[Gt]),De}var si=cs?function(p){return p==null?[]:(p=Object(p),_e(cs(p),function(P){return rs.call(p,P)}))}:ci,la=qa;(Vs&&la(new Vs(new ArrayBuffer(1)))!=J||Ra&&la(new Ra)!=y||Rs&&la(Rs.resolve())!=C||qs&&la(new qs)!=O||Us&&la(new Us)!=z)&&(la=function(p){var P=qa(p),U=P==E?p.constructor:void 0,ne=U?Tt(U):"";if(ne)switch(ne){case Ln:return J;case pa:return y;case Ll:return C;case Al:return O;case $l:return z}return P});function ni(p,P){return P=P??o,!!P&&(typeof p=="number"||me.test(p))&&p>-1&&p%1==0&&p<P}function li(p){var P=typeof p;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?p!=="__proto__":p===null}function ii(p){return!!Tn&&Tn in p}function oi(p){var P=p&&p.constructor,U=typeof P=="function"&&P.prototype||wt;return p===U}function Pn(p){return Sn.call(p)}function Tt(p){if(p!=null){try{return Ms.call(p)}catch{}try{return p+""}catch{}}return""}function Nn(p,P){return p===P||p!==p&&P!==P}var Dn=In(function(){return arguments}())?In:function(p){return ia(p)&&Vt.call(p,"callee")&&!rs.call(p,"callee")},ps=Array.isArray;function Hs(p){return p!=null&&Zs(p.length)&&!Mn(p)}var gs=Fs||ui;function ri(p,P){return On(p,P)}function Mn(p){if(!Bn(p))return!1;var P=qa(p);return P==k||P==T||P==m||P==h}function Zs(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function Bn(p){var P=typeof p;return p!=null&&(P=="object"||P=="function")}function ia(p){return p!=null&&typeof p=="object"}var Fn=je?Ee(je):Kl;function Gs(p){return Hs(p)?Jl(p):ei(p)}function ci(){return[]}function ui(){return!1}n.exports=ri})(ol,ol.exports);var po={};Object.defineProperty(po,"__esModule",{value:!0});const s_=il.exports,n_=ol.exports;var Vi;(function(n){function e(i={},o={},r=!1){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});let c=s_(o);r||(c=Object.keys(c).reduce((m,g)=>(c[g]!=null&&(m[g]=c[g]),m),{}));for(const m in i)i[m]!==void 0&&o[m]===void 0&&(c[m]=i[m]);return Object.keys(c).length>0?c:void 0}n.compose=e;function t(i={},o={}){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});const r=Object.keys(i).concat(Object.keys(o)).reduce((c,m)=>(n_(i[m],o[m])||(c[m]=o[m]===void 0?null:o[m]),c),{});return Object.keys(r).length>0?r:void 0}n.diff=t;function s(i={},o={}){i=i||{};const r=Object.keys(o).reduce((c,m)=>(o[m]!==i[m]&&i[m]!==void 0&&(c[m]=o[m]),c),{});return Object.keys(i).reduce((c,m)=>(i[m]!==o[m]&&o[m]===void 0&&(c[m]=null),c),r)}n.invert=s;function l(i,o,r=!1){if(typeof i!="object")return o;if(typeof o!="object")return;if(!r)return o;const c=Object.keys(o).reduce((m,g)=>(i[g]===void 0&&(m[g]=o[g]),m),{});return Object.keys(c).length>0?c:void 0}n.transform=l})(Vi||(Vi={}));po.default=Vi;var xl={};Object.defineProperty(xl,"__esModule",{value:!0});var Ri;(function(n){function e(t){return typeof t.delete=="number"?t.delete:typeof t.retain=="number"?t.retain:typeof t.retain=="object"&&t.retain!==null?1:typeof t.insert=="string"?t.insert.length:1}n.length=e})(Ri||(Ri={}));xl.default=Ri;var go={};Object.defineProperty(go,"__esModule",{value:!0});const pr=xl;class l_{constructor(e){this.ops=e,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(e){e||(e=1/0);const t=this.ops[this.index];if(t){const s=this.offset,l=pr.default.length(t);if(e>=l-s?(e=l-s,this.index+=1,this.offset=0):this.offset+=e,typeof t.delete=="number")return{delete:e};{const i={};return t.attributes&&(i.attributes=t.attributes),typeof t.retain=="number"?i.retain=e:typeof t.retain=="object"&&t.retain!==null?i.retain=t.retain:typeof t.insert=="string"?i.insert=t.insert.substr(s,e):i.insert=t.insert,i}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?pr.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const e=this.ops[this.index];return e?typeof e.delete=="number"?"delete":typeof e.retain=="number"||typeof e.retain=="object"&&e.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const e=this.offset,t=this.index,s=this.next(),l=this.ops.slice(this.index);return this.offset=e,this.index=t,[s].concat(l)}}else return[]}}go.default=l_;(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const t=a_,s=il.exports,l=ol.exports,i=po;e.AttributeMap=i.default;const o=xl;e.Op=o.default;const r=go;e.OpIterator=r.default;const c=String.fromCharCode(0),m=(f,v)=>{if(typeof f!="object"||f===null)throw new Error(`cannot retain a ${typeof f}`);if(typeof v!="object"||v===null)throw new Error(`cannot retain a ${typeof v}`);const k=Object.keys(f)[0];if(!k||k!==Object.keys(v)[0])throw new Error(`embed types not matched: ${k} != ${Object.keys(v)[0]}`);return[k,f[k],v[k]]};class g{constructor(v){Array.isArray(v)?this.ops=v:v!=null&&Array.isArray(v.ops)?this.ops=v.ops:this.ops=[]}static registerEmbed(v,k){this.handlers[v]=k}static unregisterEmbed(v){delete this.handlers[v]}static getHandler(v){const k=this.handlers[v];if(!k)throw new Error(`no handlers for embed type "${v}"`);return k}insert(v,k){const T={};return typeof v=="string"&&v.length===0?this:(T.insert=v,k!=null&&typeof k=="object"&&Object.keys(k).length>0&&(T.attributes=k),this.push(T))}delete(v){return v<=0?this:this.push({delete:v})}retain(v,k){if(typeof v=="number"&&v<=0)return this;const T={retain:v};return k!=null&&typeof k=="object"&&Object.keys(k).length>0&&(T.attributes=k),this.push(T)}push(v){let k=this.ops.length,T=this.ops[k-1];if(v=s(v),typeof T=="object"){if(typeof v.delete=="number"&&typeof T.delete=="number")return this.ops[k-1]={delete:T.delete+v.delete},this;if(typeof T.delete=="number"&&v.insert!=null&&(k-=1,T=this.ops[k-1],typeof T!="object"))return this.ops.unshift(v),this;if(l(v.attributes,T.attributes)){if(typeof v.insert=="string"&&typeof T.insert=="string")return this.ops[k-1]={insert:T.insert+v.insert},typeof v.attributes=="object"&&(this.ops[k-1].attributes=v.attributes),this;if(typeof v.retain=="number"&&typeof T.retain=="number")return this.ops[k-1]={retain:T.retain+v.retain},typeof v.attributes=="object"&&(this.ops[k-1].attributes=v.attributes),this}}return k===this.ops.length?this.ops.push(v):this.ops.splice(k,0,v),this}chop(){const v=this.ops[this.ops.length-1];return v&&typeof v.retain=="number"&&!v.attributes&&this.ops.pop(),this}filter(v){return this.ops.filter(v)}forEach(v){this.ops.forEach(v)}map(v){return this.ops.map(v)}partition(v){const k=[],T=[];return this.forEach(y=>{(v(y)?k:T).push(y)}),[k,T]}reduce(v,k){return this.ops.reduce(v,k)}changeLength(){return this.reduce((v,k)=>k.insert?v+o.default.length(k):k.delete?v-k.delete:v,0)}length(){return this.reduce((v,k)=>v+o.default.length(k),0)}slice(v=0,k=1/0){const T=[],y=new r.default(this.ops);let b=0;for(;b<k&&y.hasNext();){let L;b<v?L=y.next(v-b):(L=y.next(k-b),T.push(L)),b+=o.default.length(L)}return new g(T)}compose(v){const k=new r.default(this.ops),T=new r.default(v.ops),y=[],b=T.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){let E=b.retain;for(;k.peekType()==="insert"&&k.peekLength()<=E;)E-=k.peekLength(),y.push(k.next());b.retain-E>0&&T.next(b.retain-E)}const L=new g(y);for(;k.hasNext()||T.hasNext();)if(T.peekType()==="insert")L.push(T.next());else if(k.peekType()==="delete")L.push(k.next());else{const E=Math.min(k.peekLength(),T.peekLength()),C=k.next(E),h=T.next(E);if(h.retain){const I={};if(typeof C.retain=="number")I.retain=typeof h.retain=="number"?E:h.retain;else if(typeof h.retain=="number")C.retain==null?I.insert=C.insert:I.retain=C.retain;else{const A=C.retain==null?"insert":"retain",[D,V,z]=m(C[A],h.retain),B=g.getHandler(D);I[A]={[D]:B.compose(V,z,A==="retain")}}const O=i.default.compose(C.attributes,h.attributes,typeof C.retain=="number");if(O&&(I.attributes=O),L.push(I),!T.hasNext()&&l(L.ops[L.ops.length-1],I)){const A=new g(k.rest());return L.concat(A).chop()}}else typeof h.delete=="number"&&(typeof C.retain=="number"||typeof C.retain=="object"&&C.retain!==null)&&L.push(h)}return L.chop()}concat(v){const k=new g(this.ops.slice());return v.ops.length>0&&(k.push(v.ops[0]),k.ops=k.ops.concat(v.ops.slice(1))),k}diff(v,k){if(this.ops===v.ops)return new g;const T=[this,v].map(C=>C.map(h=>{if(h.insert!=null)return typeof h.insert=="string"?h.insert:c;const I=C===v?"on":"with";throw new Error("diff() called "+I+" non-document")}).join("")),y=new g,b=t(T[0],T[1],k,!0),L=new r.default(this.ops),E=new r.default(v.ops);return b.forEach(C=>{let h=C[1].length;for(;h>0;){let I=0;switch(C[0]){case t.INSERT:I=Math.min(E.peekLength(),h),y.push(E.next(I));break;case t.DELETE:I=Math.min(h,L.peekLength()),L.next(I),y.delete(I);break;case t.EQUAL:I=Math.min(L.peekLength(),E.peekLength(),h);const O=L.next(I),A=E.next(I);l(O.insert,A.insert)?y.retain(I,i.default.diff(O.attributes,A.attributes)):y.push(A).delete(I);break}h-=I}}),y.chop()}eachLine(v,k=`
`){const T=new r.default(this.ops);let y=new g,b=0;for(;T.hasNext();){if(T.peekType()!=="insert")return;const L=T.peek(),E=o.default.length(L)-T.peekLength(),C=typeof L.insert=="string"?L.insert.indexOf(k,E)-E:-1;if(C<0)y.push(T.next());else if(C>0)y.push(T.next(C));else{if(v(y,T.next(1).attributes||{},b)===!1)return;b+=1,y=new g}}y.length()>0&&v(y,{},b)}invert(v){const k=new g;return this.reduce((T,y)=>{if(y.insert)k.delete(o.default.length(y));else{if(typeof y.retain=="number"&&y.attributes==null)return k.retain(y.retain),T+y.retain;if(y.delete||typeof y.retain=="number"){const b=y.delete||y.retain;return v.slice(T,T+b).forEach(E=>{y.delete?k.push(E):y.retain&&y.attributes&&k.retain(o.default.length(E),i.default.invert(y.attributes,E.attributes))}),T+b}else if(typeof y.retain=="object"&&y.retain!==null){const b=v.slice(T,T+1),L=new r.default(b.ops).next(),[E,C,h]=m(y.retain,L.insert),I=g.getHandler(E);return k.retain({[E]:I.invert(C,h)},i.default.invert(y.attributes,L.attributes)),T+1}}return T},0),k.chop()}transform(v,k=!1){if(k=!!k,typeof v=="number")return this.transformPosition(v,k);const T=v,y=new r.default(this.ops),b=new r.default(T.ops),L=new g;for(;y.hasNext()||b.hasNext();)if(y.peekType()==="insert"&&(k||b.peekType()!=="insert"))L.retain(o.default.length(y.next()));else if(b.peekType()==="insert")L.push(b.next());else{const E=Math.min(y.peekLength(),b.peekLength()),C=y.next(E),h=b.next(E);if(C.delete)continue;if(h.delete)L.push(h);else{const I=C.retain,O=h.retain;let A=typeof O=="object"&&O!==null?O:E;if(typeof I=="object"&&I!==null&&typeof O=="object"&&O!==null){const D=Object.keys(I)[0];if(D===Object.keys(O)[0]){const V=g.getHandler(D);V&&(A={[D]:V.transform(I[D],O[D],k)})}}L.retain(A,i.default.transform(C.attributes,h.attributes,k))}}return L.chop()}transformPosition(v,k=!1){k=!!k;const T=new r.default(this.ops);let y=0;for(;T.hasNext()&&y<=v;){const b=T.peekLength(),L=T.peekType();if(T.next(),L==="delete"){v-=Math.min(b,v-y);continue}else L==="insert"&&(y<v||!k)&&(v+=b);y+=b}return v}}g.Op=o.default,g.OpIterator=r.default,g.AttributeMap=i.default,g.handlers={},e.default=g,n.exports=g,n.exports.default=g})(Pt,Pt.exports);var we=Eu(Pt.exports);class sa extends Ft{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}sa.blotName="break";sa.tagName="BR";class ta extends ll{}const i_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function wl(n){return n.replace(/[&<>"']/g,e=>i_[e])}class Et extends ro{static allowedChildren=[Et,sa,Ft,ta];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,t){const s=Et.order.indexOf(e),l=Et.order.indexOf(t);return s>=0||l>=0?s-l:e===t?0:e<t?-1:1}formatAt(e,t,s,l){if(Et.compare(this.statics.blotName,s)<0&&this.scroll.query(s,Se.BLOT)){const i=this.isolate(e,t);l&&i.wrap(s,l)}else super.formatAt(e,t,s,l)}optimize(e){if(super.optimize(e),this.parent instanceof Et&&Et.compare(this.statics.blotName,this.parent.statics.blotName)>0){const t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}const gr=1;class vt extends cn{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Ic(this)),this.cache.delta}deleteAt(e,t){super.deleteAt(e,t),this.cache={}}formatAt(e,t,s,l){t<=0||(this.scroll.query(s,Se.BLOCK)?e+t===this.length()&&this.format(s,l):super.formatAt(e,Math.min(t,this.length()-e-1),s,l),this.cache={})}insertAt(e,t,s){if(s!=null){super.insertAt(e,t,s),this.cache={};return}if(t.length===0)return;const l=t.split(`
`),i=l.shift();i.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let o=this;l.reduce((r,c)=>(o=o.split(r,!0),o.insertAt(0,c),c.length),e+i.length)}insertBefore(e,t){const{head:s}=this.children;super.insertBefore(e,t),s instanceof sa&&s.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+gr),this.cache.length}moveChildren(e,t){super.moveChildren(e,t),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t&&(e===0||e>=this.length()-gr)){const l=this.clone();return e===0?(this.parent.insertBefore(l,this),this):(this.parent.insertBefore(l,this.next),l)}const s=super.split(e,t);return this.cache={},s}}vt.blotName="block";vt.tagName="P";vt.defaultChild=sa;vt.allowedChildren=[sa,Et,Ft,ta];class zt extends Ft{attach(){super.attach(),this.attributes=new yl(this.domNode)}delta(){return new we().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,t){const s=this.scroll.query(e,Se.BLOCK_ATTRIBUTE);s!=null&&this.attributes.attribute(s,t)}formatAt(e,t,s,l){this.format(s,l)}insertAt(e,t,s){if(s!=null){super.insertAt(e,t,s);return}const l=t.split(`
`),i=l.pop(),o=l.map(c=>{const m=this.scroll.create(vt.blotName);return m.insertAt(0,c),m}),r=this.split(e);o.forEach(c=>{this.parent.insertBefore(c,r)}),i&&this.parent.insertBefore(this.scroll.create("text",i),r)}}zt.scope=Se.BLOCK_BLOT;function Ic(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(kt).reduce((t,s)=>s.length()===0?t:t.insert(s.value(),Ut(s,{},e)),new we).insert(`
`,Ut(n))}function Ut(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(e={...e,...n.formats()},t&&delete e["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?e:Ut(n.parent,e,t)}class Qt extends Ft{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,t,s){super(e,t),this.selection=s,this.textNode=document.createTextNode(Qt.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,t){if(this.savedLength!==0){super.format(e,t);return}let s=this,l=0;for(;s!=null&&s.statics.scope!==Se.BLOCK_BLOT;)l+=s.offset(s.parent),s=s.parent;s!=null&&(this.savedLength=Qt.CONTENTS.length,s.optimize(),s.formatAt(l,Qt.CONTENTS.length,e,t),this.savedLength=0)}index(e,t){return e===this.textNode?0:super.index(e,t)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const t=this.prev instanceof ta?this.prev:null,s=t?t.length():0,l=this.next instanceof ta?this.next:null,i=l?l.text:"",{textNode:o}=this,r=o.data.split(Qt.CONTENTS).join("");o.data=Qt.CONTENTS;let c;if(t)c=t,(r||l)&&(t.insertAt(t.length(),r+i),l&&l.remove());else if(l)c=l,l.insertAt(0,r);else{const m=document.createTextNode(r);c=this.scroll.create(m),this.parent.insertBefore(c,this)}if(this.remove(),e){const m=(v,k)=>t&&v===t.domNode?k:v===o?s+k-1:l&&v===l.domNode?s+r.length+k:null,g=m(e.start.node,e.start.offset),f=m(e.end.node,e.end.offset);if(g!==null&&f!==null)return{startNode:c.domNode,startOffset:g,endNode:c.domNode,endOffset:f}}return null}update(e,t){if(e.some(s=>s.type==="characterData"&&s.target===this.textNode)){const s=this.restore();s&&(t.range=s)}}optimize(e){super.optimize(e);let{parent:t}=this;for(;t;){if(t.domNode.tagName==="A"){this.savedLength=Qt.CONTENTS.length,t.isolate(this.offset(t),this.length()).unwrap(),this.savedLength=0;break}t=t.parent}}value(){return""}}var Oc={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function l(c,m,g){this.fn=c,this.context=m,this.once=g||!1}function i(c,m,g,f,v){if(typeof g!="function")throw new TypeError("The listener must be a function");var k=new l(g,f||c,v),T=t?t+m:m;return c._events[T]?c._events[T].fn?c._events[T]=[c._events[T],k]:c._events[T].push(k):(c._events[T]=k,c._eventsCount++),c}function o(c,m){--c._eventsCount===0?c._events=new s:delete c._events[m]}function r(){this._events=new s,this._eventsCount=0}r.prototype.eventNames=function(){var m=[],g,f;if(this._eventsCount===0)return m;for(f in g=this._events)e.call(g,f)&&m.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(g)):m},r.prototype.listeners=function(m){var g=t?t+m:m,f=this._events[g];if(!f)return[];if(f.fn)return[f.fn];for(var v=0,k=f.length,T=new Array(k);v<k;v++)T[v]=f[v].fn;return T},r.prototype.listenerCount=function(m){var g=t?t+m:m,f=this._events[g];return f?f.fn?1:f.length:0},r.prototype.emit=function(m,g,f,v,k,T){var y=t?t+m:m;if(!this._events[y])return!1;var b=this._events[y],L=arguments.length,E,C;if(b.fn){switch(b.once&&this.removeListener(m,b.fn,void 0,!0),L){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,g),!0;case 3:return b.fn.call(b.context,g,f),!0;case 4:return b.fn.call(b.context,g,f,v),!0;case 5:return b.fn.call(b.context,g,f,v,k),!0;case 6:return b.fn.call(b.context,g,f,v,k,T),!0}for(C=1,E=new Array(L-1);C<L;C++)E[C-1]=arguments[C];b.fn.apply(b.context,E)}else{var h=b.length,I;for(C=0;C<h;C++)switch(b[C].once&&this.removeListener(m,b[C].fn,void 0,!0),L){case 1:b[C].fn.call(b[C].context);break;case 2:b[C].fn.call(b[C].context,g);break;case 3:b[C].fn.call(b[C].context,g,f);break;case 4:b[C].fn.call(b[C].context,g,f,v);break;default:if(!E)for(I=1,E=new Array(L-1);I<L;I++)E[I-1]=arguments[I];b[C].fn.apply(b[C].context,E)}}return!0},r.prototype.on=function(m,g,f){return i(this,m,g,f,!1)},r.prototype.once=function(m,g,f){return i(this,m,g,f,!0)},r.prototype.removeListener=function(m,g,f,v){var k=t?t+m:m;if(!this._events[k])return this;if(!g)return o(this,k),this;var T=this._events[k];if(T.fn)T.fn===g&&(!v||T.once)&&(!f||T.context===f)&&o(this,k);else{for(var y=0,b=[],L=T.length;y<L;y++)(T[y].fn!==g||v&&!T[y].once||f&&T[y].context!==f)&&b.push(T[y]);b.length?this._events[k]=b.length===1?b[0]:b:o(this,k)}return this},r.prototype.removeAllListeners=function(m){var g;return m?(g=t?t+m:m,this._events[g]&&o(this,g)):(this._events=new s,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=t,r.EventEmitter=r,n.exports=r})(Oc);var o_=Oc.exports,qi=new WeakMap;const Ui=["error","warn","log","info"];let ji="warn";function Pc(n){if(ji&&Ui.indexOf(n)<=Ui.indexOf(ji)){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];console[n](...t)}}function xa(n){return Ui.reduce((e,t)=>(e[t]=Pc.bind(console,t,n),e),{})}xa.level=n=>{ji=n};Pc.level=xa.level;const vi=xa("quill:events"),r_=["selectionchange","mousedown","mouseup","click"];r_.forEach(n=>{document.addEventListener(n,function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];Array.from(document.querySelectorAll(".ql-container")).forEach(l=>{const i=qi.get(l);i&&i.emitter&&i.emitter.handleDOM(...t)})})});class xe extends o_{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",vi.error)}emit(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return vi.log.call(vi,...t),super.emit(...t)}handleDOM(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),l=1;l<t;l++)s[l-1]=arguments[l];(this.domListeners[e.type]||[]).forEach(i=>{let{node:o,handler:r}=i;(e.target===o||o.contains(e.target))&&r(e,...s)})}listenDOM(e,t,s){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:t,handler:s})}}const _i=xa("quill:selection");class Za{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=t}}class c_{constructor(e,t){this.emitter=t,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Za(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,xe.sources.USER),1)}),this.emitter.on(xe.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const s=this.getNativeRange();s!=null&&s.start.node!==this.cursor.textNode&&this.emitter.once(xe.events.SCROLL_UPDATE,(l,i)=>{try{this.root.contains(s.start.node)&&this.root.contains(s.end.node)&&this.setNativeRange(s.start.node,s.start.offset,s.end.node,s.end.offset);const o=i.some(r=>r.type==="characterData"||r.type==="childList"||r.type==="attributes"&&r.target===this.root);this.update(o?xe.sources.SILENT:l)}catch{}})}),this.emitter.on(xe.events.SCROLL_OPTIMIZE,(s,l)=>{if(l.range){const{startNode:i,startOffset:o,endNode:r,endOffset:c}=l.range;this.setNativeRange(i,o,r,c),this.update(xe.sources.SILENT)}}),this.update(xe.sources.SILENT)}handleComposition(){this.emitter.on(xe.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(xe.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(xe.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,t){this.scroll.update();const s=this.getNativeRange();if(!(s==null||!s.native.collapsed||this.scroll.query(e,Se.BLOCK))){if(s.start.node!==this.cursor.textNode){const l=this.scroll.find(s.start.node,!1);if(l==null)return;if(l instanceof kt){const i=l.split(s.start.offset);l.parent.insertBefore(this.cursor,i)}else l.insertBefore(this.cursor,s.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.scroll.length();e=Math.min(e,s-1),t=Math.min(e+t,s-1)-e;let l,[i,o]=this.scroll.leaf(e);if(i==null)return null;if(t>0&&o===i.length()){const[g]=this.scroll.leaf(e+1);if(g){const[f]=this.scroll.line(e),[v]=this.scroll.line(e+1);f===v&&(i=g,o=0)}}[l,o]=i.position(o,!0);const r=document.createRange();if(t>0)return r.setStart(l,o),[i,o]=this.scroll.leaf(e+t),i==null?null:([l,o]=i.position(o,!0),r.setEnd(l,o),r.getBoundingClientRect());let c="left",m;if(l instanceof Text){if(!l.data.length)return null;o<l.data.length?(r.setStart(l,o),r.setEnd(l,o+1)):(r.setStart(l,o-1),r.setEnd(l,o),c="right"),m=r.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;m=i.domNode.getBoundingClientRect(),o>0&&(c="right")}return{bottom:m.top+m.height,height:m.height,left:m[c],right:m[c],top:m.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const t=e.getRangeAt(0);if(t==null)return null;const s=this.normalizeNative(t);return _i.info("getNativeRange",s),s}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const t=this.getNativeRange();return t==null?[null,null]:[this.normalizedToRange(t),t]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&yi(this.root,document.activeElement)}normalizedToRange(e){const t=[[e.start.node,e.start.offset]];e.native.collapsed||t.push([e.end.node,e.end.offset]);const s=t.map(o=>{const[r,c]=o,m=this.scroll.find(r,!0),g=m.offset(this.scroll);return c===0?g:m instanceof kt?g+m.index(r,c):g+m.length()}),l=Math.min(Math.max(...s),this.scroll.length()-1),i=Math.min(l,...s);return new Za(i,l-i)}normalizeNative(e){if(!yi(this.root,e.startContainer)||!e.collapsed&&!yi(this.root,e.endContainer))return null;const t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach(s=>{let{node:l,offset:i}=s;for(;!(l instanceof Text)&&l.childNodes.length>0;)if(l.childNodes.length>i)l=l.childNodes[i],i=0;else if(l.childNodes.length===i)l=l.lastChild,l instanceof Text?i=l.data.length:l.childNodes.length>0?i=l.childNodes.length:i=l.childNodes.length+1;else break;s.node=l,s.offset=i}),t}rangeToNative(e){const t=this.scroll.length(),s=(l,i)=>{l=Math.min(t-1,l);const[o,r]=this.scroll.leaf(l);return o?o.position(r,i):[null,-1]};return[...s(e.index,!1),...s(e.index+e.length,!0)]}setNativeRange(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(_i.info("setNativeRange",e,t,s,l),e!=null&&(this.root.parentNode==null||e.parentNode==null||s.parentNode==null))return;const o=document.getSelection();if(o!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:r}=this.getNativeRange()||{};if(r==null||i||e!==r.startContainer||t!==r.startOffset||s!==r.endContainer||l!==r.endOffset){e instanceof Element&&e.tagName==="BR"&&(t=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),s instanceof Element&&s.tagName==="BR"&&(l=Array.from(s.parentNode.childNodes).indexOf(s),s=s.parentNode);const c=document.createRange();c.setStart(e,t),c.setEnd(s,l),o.removeAllRanges(),o.addRange(c)}}else o.removeAllRanges(),this.root.blur()}setRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xe.sources.API;if(typeof t=="string"&&(s=t,t=!1),_i.info("setRange",e),e!=null){const l=this.rangeToNative(e);this.setNativeRange(...l,t)}else this.setNativeRange(null);this.update(s)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xe.sources.USER;const t=this.lastRange,[s,l]=this.getRange();if(this.lastRange=s,this.lastNative=l,this.lastRange!=null&&(this.savedRange=this.lastRange),!oo(t,this.lastRange)){if(!this.composing&&l!=null&&l.native.collapsed&&l.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const i=[xe.events.SELECTION_CHANGE,ws(this.lastRange),ws(t),e];this.emitter.emit(xe.events.EDITOR_CHANGE,...i),e!==xe.sources.SILENT&&this.emitter.emit(...i)}}}function yi(n,e){try{e.parentNode}catch{return!1}return n.contains(e)}const u_=/^[ -~]*$/;class d_{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let t=this.scroll.length();this.scroll.batchStart();const s=fr(e),l=new we;return p_(s.ops.slice()).reduce((o,r)=>{const c=Pt.exports.Op.length(r);let m=r.attributes||{},g=!1,f=!1;if(r.insert!=null){if(l.retain(c),typeof r.insert=="string"){const T=r.insert;f=!T.endsWith(`
`)&&(t<=o||!!this.scroll.descendant(zt,o)[0]),this.scroll.insertAt(o,T);const[y,b]=this.scroll.line(o);let L=$a({},Ut(y));if(y instanceof vt){const[E]=y.descendant(kt,b);E&&(L=$a(L,Ut(E)))}m=Pt.exports.AttributeMap.diff(L,m)||{}}else if(typeof r.insert=="object"){const T=Object.keys(r.insert)[0];if(T==null)return o;const y=this.scroll.query(T,Se.INLINE)!=null;if(y)(t<=o||!!this.scroll.descendant(zt,o)[0])&&(f=!0);else if(o>0){const[b,L]=this.scroll.descendant(kt,o-1);b instanceof ta?b.value()[L]!==`
`&&(g=!0):b instanceof Ft&&b.statics.scope===Se.INLINE_BLOT&&(g=!0)}if(this.scroll.insertAt(o,T,r.insert[T]),y){const[b]=this.scroll.descendant(kt,o);if(b){const L=$a({},Ut(b));m=Pt.exports.AttributeMap.diff(L,m)||{}}}}t+=c}else if(l.push(r),r.retain!==null&&typeof r.retain=="object"){const T=Object.keys(r.retain)[0];if(T==null)return o;this.scroll.updateEmbedAt(o,T,r.retain[T])}Object.keys(m).forEach(T=>{this.scroll.formatAt(o,c,T,m[T])});const v=g?1:0,k=f?1:0;return t+=v+k,l.retain(v),l.delete(k),o+c+v+k},0),l.reduce((o,r)=>typeof r.delete=="number"?(this.scroll.deleteAt(o,r.delete),o):o+Pt.exports.Op.length(r),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(s)}deleteText(e,t){return this.scroll.deleteAt(e,t),this.update(new we().retain(e).delete(t))}formatLine(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(s).forEach(i=>{this.scroll.lines(e,Math.max(t,1)).forEach(o=>{o.format(i,s[i])})}),this.scroll.optimize();const l=new we().retain(e).retain(t,ws(s));return this.update(l)}formatText(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s).forEach(i=>{this.scroll.formatAt(e,t,i,s[i])});const l=new we().retain(e).retain(t,ws(s));return this.update(l)}getContents(e,t){return this.delta.slice(e,e+t)}getDelta(){return this.scroll.lines().reduce((e,t)=>e.concat(t.delta()),new we)}getFormat(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=[],l=[];t===0?this.scroll.path(e).forEach(r=>{const[c]=r;c instanceof vt?s.push(c):c instanceof kt&&l.push(c)}):(s=this.scroll.lines(e,t),l=this.scroll.descendants(kt,e,t));const[i,o]=[s,l].map(r=>{const c=r.shift();if(c==null)return{};let m=Ut(c);for(;Object.keys(m).length>0;){const g=r.shift();if(g==null)return m;m=m_(Ut(g),m)}return m});return{...i,...o}}getHTML(e,t){const[s,l]=this.scroll.line(e);if(s){const i=s.length();return s.length()>=l+t&&!(l===0&&t===i)?dn(s,l,t,!0):dn(this.scroll,e,t,!0)}return""}getText(e,t){return this.getContents(e,t).filter(s=>typeof s.insert=="string").map(s=>s.insert).join("")}insertContents(e,t){const s=fr(t),l=new we().retain(e).concat(s);return this.scroll.insertContents(e,s),this.update(l)}insertEmbed(e,t,s){return this.scroll.insertAt(e,t,s),this.update(new we().retain(e).insert({[t]:s}))}insertText(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,t),Object.keys(s).forEach(l=>{this.scroll.formatAt(e,t.length,l,s[l])}),this.update(new we().retain(e).insert(t,ws(s)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==vt.blotName)return!1;const t=e;return t.children.length>1?!1:t.children.head instanceof sa}removeFormat(e,t){const s=this.getText(e,t),[l,i]=this.scroll.line(e+t);let o=0,r=new we;l!=null&&(o=l.length()-i,r=l.delta().slice(i,i+o-1).insert(`
`));const m=this.getContents(e,t+o).diff(new we().insert(s).concat(r)),g=new we().retain(e).concat(m);return this.applyDelta(g)}update(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const l=this.delta;if(t.length===1&&t[0].type==="characterData"&&t[0].target.data.match(u_)&&this.scroll.find(t[0].target)){const i=this.scroll.find(t[0].target),o=Ut(i),r=i.offset(this.scroll),c=t[0].oldValue.replace(Qt.CONTENTS,""),m=new we().insert(c),g=new we().insert(i.value()),f=s&&{oldRange:hr(s.oldRange,-r),newRange:hr(s.newRange,-r)};e=new we().retain(r).concat(m.diff(g,f)).reduce((k,T)=>T.insert?k.insert(T.insert,o):k.push(T),new we),this.delta=l.compose(e)}else this.delta=this.getDelta(),(!e||!oo(l.compose(e),this.delta))&&(e=l.diff(this.delta,s));return e}}function Cs(n,e,t){if(n.length===0){const[k]=bi(t.pop());return e<=0?`</li></${k}>`:`</li></${k}>${Cs([],e-1,t)}`}const[{child:s,offset:l,length:i,indent:o,type:r},...c]=n,[m,g]=bi(r);if(o>e)return t.push(r),o===e+1?`<${m}><li${g}>${dn(s,l,i)}${Cs(c,o,t)}`:`<${m}><li>${Cs(n,e+1,t)}`;const f=t[t.length-1];if(o===e&&r===f)return`</li><li${g}>${dn(s,l,i)}${Cs(c,o,t)}`;const[v]=bi(t.pop());return`</li></${v}>${Cs(n,e-1,t)}`}function dn(n,e,t){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(e,t);if(n instanceof ta)return wl(n.value().slice(e,e+t)).replaceAll(" ","&nbsp;");if(n instanceof ea){if(n.statics.blotName==="list-container"){const m=[];return n.children.forEachAt(e,t,(g,f,v)=>{const k="formats"in g&&typeof g.formats=="function"?g.formats():{};m.push({child:g,offset:f,length:v,indent:k.indent||0,type:k.list})}),Cs(m,-1,[])}const l=[];if(n.children.forEachAt(e,t,(m,g,f)=>{l.push(dn(m,g,f))}),s||n.statics.blotName==="list")return l.join("");const{outerHTML:i,innerHTML:o}=n.domNode,[r,c]=i.split(`>${o}<`);return r==="<table"?`<table style="border: 1px solid #000;">${l.join("")}<${c}`:`${r}>${l.join("")}<${c}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function m_(n,e){return Object.keys(e).reduce((t,s)=>{if(n[s]==null)return t;const l=e[s];return l===n[s]?t[s]=l:Array.isArray(l)?l.indexOf(n[s])<0?t[s]=l.concat([n[s]]):t[s]=l:t[s]=[l,n[s]],t},{})}function bi(n){const e=n==="ordered"?"ol":"ul";switch(n){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function fr(n){return n.reduce((e,t)=>{if(typeof t.insert=="string"){const s=t.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(s,t.attributes)}return e.push(t)},new we)}function hr(n,e){let{index:t,length:s}=n;return new Za(t+e,s)}function p_(n){const e=[];return n.forEach(t=>{typeof t.insert=="string"?t.insert.split(`
`).forEach((l,i)=>{i&&e.push({insert:`
`,attributes:t.attributes}),l&&e.push({insert:l,attributes:t.attributes})}):e.push(t)}),e}class ma{static DEFAULTS={};constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=t}}const Un="\uFEFF";class fo extends Ft{constructor(e,t){super(e,t),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(s=>{this.contentNode.appendChild(s)}),this.leftGuard=document.createTextNode(Un),this.rightGuard=document.createTextNode(Un),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,t)}restore(e){let t=null,s;const l=e.data.split(Un).join("");if(e===this.leftGuard)if(this.prev instanceof ta){const i=this.prev.length();this.prev.insertAt(i,l),t={startNode:this.prev.domNode,startOffset:i+l.length}}else s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this),t={startNode:s,startOffset:l.length};else e===this.rightGuard&&(this.next instanceof ta?(this.next.insertAt(0,l),t={startNode:this.next.domNode,startOffset:l.length}):(s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this.next),t={startNode:s,startOffset:l.length}));return e.data=Un,t}update(e,t){e.forEach(s=>{if(s.type==="characterData"&&(s.target===this.leftGuard||s.target===this.rightGuard)){const l=this.restore(s.target);l&&(t.range=l)}})}}class g_{isComposing=!1;constructor(e,t){this.scroll=e,this.emitter=t,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const t=e.target instanceof Node?this.scroll.find(e.target,!0):null;t&&!(t instanceof fo)&&(this.emitter.emit(xe.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(xe.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(xe.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(xe.events.COMPOSITION_END,e),this.isComposing=!1}}class Ns{static DEFAULTS={modules:{}};static themes={default:Ns};modules={};constructor(e,t){this.quill=e,this.options=t}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const t=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}const f_=n=>n.parentElement||n.getRootNode().host||null,h_=n=>{const e=n.getBoundingClientRect(),t="offsetWidth"in n&&Math.abs(e.width)/n.offsetWidth||1,s="offsetHeight"in n&&Math.abs(e.height)/n.offsetHeight||1;return{top:e.top,right:e.left+n.clientWidth*t,bottom:e.top+n.clientHeight*s,left:e.left}},jn=n=>{const e=parseInt(n,10);return Number.isNaN(e)?0:e},vr=(n,e,t,s,l,i)=>n<t&&e>s?0:n<t?-(t-n+l):e>s?e-n>s-t?n+l-t:e-s+i:0,v_=(n,e)=>{const t=n.ownerDocument;let s=e,l=n;for(;l;){const i=l===t.body,o=i?{top:0,right:window.visualViewport?.width??t.documentElement.clientWidth,bottom:window.visualViewport?.height??t.documentElement.clientHeight,left:0}:h_(l),r=getComputedStyle(l),c=vr(s.left,s.right,o.left,o.right,jn(r.scrollPaddingLeft),jn(r.scrollPaddingRight)),m=vr(s.top,s.bottom,o.top,o.bottom,jn(r.scrollPaddingTop),jn(r.scrollPaddingBottom));if(c||m)if(i)t.defaultView?.scrollBy(c,m);else{const{scrollLeft:g,scrollTop:f}=l;m&&(l.scrollTop+=m),c&&(l.scrollLeft+=c);const v=l.scrollLeft-g,k=l.scrollTop-f;s={left:s.left-v,top:s.top-k,right:s.right-v,bottom:s.bottom-k}}l=i||r.position==="fixed"?null:f_(l)}},__=100,y_=["block","break","cursor","inline","scroll","text"],b_=(n,e,t)=>{const s=new As;return y_.forEach(l=>{const i=e.query(l);i&&s.register(i)}),n.forEach(l=>{let i=e.query(l);i||t.error(`Cannot register "${l}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(s.register(i),i="blotName"in i?i.requiredContainer??null:null,o+=1,o>__){t.error(`Cycle detected in registering blot requiredContainer: "${l}"`);break}}),s},Ss=xa("quill"),zn=new As;ea.uiClass="ql-ui";class oe{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:zn,theme:"default"};static events=xe.events;static sources=xe.sources;static version="2.0.3";static imports={delta:we,parchment:Wv,"core/module":ma,"core/theme":Ns};static debug(e){e===!0&&(e="log"),xa.level(e)}static find(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return qi.get(e)||zn.find(e,t)}static import(e){return this.imports[e]==null&&Ss.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],t=!!(!(arguments.length<=1)&&arguments[1]),s="attrName"in e?e.attrName:e.blotName;typeof s=="string"?this.register(`formats/${s}`,e,t):Object.keys(e).forEach(l=>{this.register(l,e[l],t)})}else{const e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],s=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!s&&Ss.warn(`Overwriting ${e} with`,t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&t&&typeof t!="boolean"&&t.blotName!=="abstract"&&zn.register(t),typeof t.register=="function"&&t.register(zn)}}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=k_(e,t),this.container=this.options.container,this.container==null){Ss.error("Invalid Quill container",e);return}this.options.debug&&oe.debug(this.options.debug);const s=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",qi.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new xe;const l=co.blotName,i=this.options.registry.query(l);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${l}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new d_(this.scroll),this.selection=new c_(this.scroll,this.emitter),this.composition=new g_(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(xe.events.EDITOR_CHANGE,o=>{o===xe.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(xe.events.SCROLL_UPDATE,(o,r)=>{const c=this.selection.lastRange,[m]=this.selection.getRange(),g=c&&m?{oldRange:c,newRange:m}:void 0;Xt.call(this,()=>this.editor.update(null,r,g),o)}),this.emitter.on(xe.events.SCROLL_EMBED_UPDATE,(o,r)=>{const c=this.selection.lastRange,[m]=this.selection.getRange(),g=c&&m?{oldRange:c,newRange:m}:void 0;Xt.call(this,()=>{const f=new we().retain(o.offset(this)).retain({[o.statics.blotName]:r});return this.editor.update(f,[],g)},oe.sources.USER)}),s){const o=this.clipboard.convert({html:`${s}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const s=e;e=document.createElement("div"),e.classList.add(s)}return this.container.insertBefore(e,t),e}blur(){this.selection.setRange(null)}deleteText(e,t,s){return[e,t,,s]=va(e,t,s),Xt.call(this,()=>this.editor.deleteText(e,t),s,e,-1*t)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const t=e();return this.allowReadOnlyEdits=!1,t}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xe.sources.API;return Xt.call(this,()=>{const l=this.getSelection(!0);let i=new we;if(l==null)return i;if(this.scroll.query(e,Se.BLOCK))i=this.editor.formatLine(l.index,l.length,{[e]:t});else{if(l.length===0)return this.selection.format(e,t),i;i=this.editor.formatText(l.index,l.length,{[e]:t})}return this.setSelection(l,xe.sources.SILENT),i},s)}formatLine(e,t,s,l,i){let o;return[e,t,o,i]=va(e,t,s,l,i),Xt.call(this,()=>this.editor.formatLine(e,t,o),i,e,0)}formatText(e,t,s,l,i){let o;return[e,t,o,i]=va(e,t,s,l,i),Xt.call(this,()=>this.editor.formatText(e,t,o),i,e,0)}getBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=null;if(typeof e=="number"?s=this.selection.getBounds(e,t):s=this.selection.getBounds(e.index,e.length),!s)return null;const l=this.container.getBoundingClientRect();return{bottom:s.bottom-l.top,height:s.height,left:s.left-l.left,right:s.right-l.left,top:s.top-l.top,width:s.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,t]=va(e,t),this.editor.getContents(e,t)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}getModule(e){return this.theme.modules[e]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(t=t??this.getLength()-e),[e,t]=va(e,t),this.editor.getHTML(e,t)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(t=t??this.getLength()-e),[e,t]=va(e,t),this.editor.getText(e,t)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,t,s){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:oe.sources.API;return Xt.call(this,()=>this.editor.insertEmbed(e,t,s),l,e)}insertText(e,t,s,l,i){let o;return[e,,o,i]=va(e,0,s,l,i),Xt.call(this,()=>this.editor.insertText(e,t,o),i,e,t.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,t,s){return[e,t,,s]=va(e,t,s),Xt.call(this,()=>this.editor.removeFormat(e,t),s,e)}scrollRectIntoView(e){v_(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,t=e&&this.selection.getBounds(e.index,e.length);t&&this.scrollRectIntoView(t)}setContents(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe.sources.API;return Xt.call(this,()=>{e=new we(e);const s=this.getLength(),l=this.editor.deleteText(0,s),i=this.editor.insertContents(0,e),o=this.editor.deleteText(this.getLength()-1,1);return l.compose(i).compose(o)},t)}setSelection(e,t,s){e==null?this.selection.setRange(null,t||oe.sources.API):([e,t,,s]=va(e,t,s),this.selection.setRange(new Za(Math.max(0,e),t),s),s!==xe.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe.sources.API;const s=new we().insert(e);return this.setContents(s,t)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xe.sources.USER;const t=this.scroll.update(e);return this.selection.update(e),t}updateContents(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe.sources.API;return Xt.call(this,()=>(e=new we(e),this.editor.applyDelta(e)),t,!0)}}function _r(n){return typeof n=="string"?document.querySelector(n):n}function ki(n){return Object.entries(n??{}).reduce((e,t)=>{let[s,l]=t;return{...e,[s]:l===!0?{}:l}},{})}function yr(n){return Object.fromEntries(Object.entries(n).filter(e=>e[1]!==void 0))}function k_(n,e){const t=_r(n);if(!t)throw new Error("Invalid Quill container");const l=!e.theme||e.theme===oe.DEFAULTS.theme?Ns:oe.import(`themes/${e.theme}`);if(!l)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:i,...o}=oe.DEFAULTS,{modules:r,...c}=l.DEFAULTS;let m=ki(e.modules);m!=null&&m.toolbar&&m.toolbar.constructor!==Object&&(m={...m,toolbar:{container:m.toolbar}});const g=$a({},ki(i),ki(r),m),f={...o,...yr(c),...yr(e)};let v=e.registry;return v?e.formats&&Ss.warn('Ignoring "formats" option because "registry" is specified'):v=e.formats?b_(e.formats,f.registry,Ss):f.registry,{...f,registry:v,container:t,theme:l,modules:Object.entries(g).reduce((k,T)=>{let[y,b]=T;if(!b)return k;const L=oe.import(`modules/${y}`);return L==null?(Ss.error(`Cannot load ${y} module. Are you sure you registered it?`),k):{...k,[y]:$a({},L.DEFAULTS||{},b)}},{}),bounds:_r(f.bounds)}}function Xt(n,e,t,s){if(!this.isEnabled()&&e===xe.sources.USER&&!this.allowReadOnlyEdits)return new we;let l=t==null?null:this.getSelection();const i=this.editor.delta,o=n();if(l!=null&&(t===!0&&(t=l.index),s==null?l=br(l,o,e):s!==0&&(l=br(l,t,s,e)),this.setSelection(l,xe.sources.SILENT)),o.length()>0){const r=[xe.events.TEXT_CHANGE,o,i,e];this.emitter.emit(xe.events.EDITOR_CHANGE,...r),e!==xe.sources.SILENT&&this.emitter.emit(...r)}return o}function va(n,e,t,s,l){let i={};return typeof n.index=="number"&&typeof n.length=="number"?typeof e!="number"?(l=s,s=t,t=e,e=n.length,n=n.index):(e=n.length,n=n.index):typeof e!="number"&&(l=s,s=t,t=e,e=0),typeof t=="object"?(i=t,l=s):typeof t=="string"&&(s!=null?i[t]=s:l=t),l=l||xe.sources.API,[n,e,i,l]}function br(n,e,t,s){const l=typeof t=="number"?t:0;if(n==null)return null;let i,o;return e&&typeof e.transformPosition=="function"?[i,o]=[n.index,n.index+n.length].map(r=>e.transformPosition(r,s!==xe.sources.USER)):[i,o]=[n.index,n.index+n.length].map(r=>r<e||r===e&&s===xe.sources.USER?r:l>=0?r+l:Math.max(e,r+l)),new Za(i,o-i)}class ss extends bl{}function kr(n){return n instanceof vt||n instanceof zt}function Cr(n){return typeof n.updateContent=="function"}class C_ extends co{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=vt;static allowedChildren=[vt,zt,ss];constructor(e,t,s){let{emitter:l}=s;super(e,t),this.emitter=l,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(xe.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(xe.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,t){this.emitter.emit(xe.events.SCROLL_EMBED_UPDATE,e,t)}deleteAt(e,t){const[s,l]=this.line(e),[i]=this.line(e+t);if(super.deleteAt(e,t),i!=null&&s!==i&&l>0){if(s instanceof zt||i instanceof zt){this.optimize();return}const o=i.children.head instanceof sa?null:i.children.head;s.moveChildren(i,o),s.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,t,s,l){super.formatAt(e,t,s,l),this.optimize()}insertAt(e,t,s){if(e>=this.length())if(s==null||this.scroll.query(t,Se.BLOCK)==null){const l=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(l),s==null&&t.endsWith(`
`)?l.insertAt(0,t.slice(0,-1),s):l.insertAt(0,t,s)}else{const l=this.scroll.create(t,s);this.appendChild(l)}else super.insertAt(e,t,s);this.optimize()}insertBefore(e,t){if(e.statics.scope===Se.INLINE_BLOT){const s=this.scroll.create(this.statics.defaultChild.blotName);s.appendChild(e),super.insertBefore(s,t)}else super.insertBefore(e,t)}insertContents(e,t){const s=this.deltaToRenderBlocks(t.concat(new we().insert(`
`))),l=s.pop();if(l==null)return;this.batchStart();const i=s.shift();if(i){const c=i.type==="block"&&(i.delta.length()===0||!this.descendant(zt,e)[0]&&e<this.length()),m=i.type==="block"?i.delta:new we().insert({[i.key]:i.value});Ci(this,e,m);const g=i.type==="block"?1:0,f=e+m.length()+g;c&&this.insertAt(f-1,`
`);const v=Ut(this.line(e)[0]),k=Pt.exports.AttributeMap.diff(v,i.attributes)||{};Object.keys(k).forEach(T=>{this.formatAt(f-1,1,T,k[T])}),e=f}let[o,r]=this.children.find(e);if(s.length&&(o&&(o=o.split(r),r=0),s.forEach(c=>{if(c.type==="block"){const m=this.createBlock(c.attributes,o||void 0);Ci(m,0,c.delta)}else{const m=this.create(c.key,c.value);this.insertBefore(m,o||void 0),Object.keys(c.attributes).forEach(g=>{m.format(g,c.attributes[g])})}})),l.type==="block"&&l.delta.length()){const c=o?o.offset(o.scroll)+r:this.length();Ci(this,c,l.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const t=this.path(e).pop();if(!t)return[null,-1];const[s,l]=t;return s instanceof kt?[s,l]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(kr,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const s=(l,i,o)=>{let r=[],c=o;return l.children.forEachAt(i,o,(m,g,f)=>{kr(m)?r.push(m):m instanceof bl&&(r=r.concat(s(m,g,c))),c-=f}),r};return s(this,e,t)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,t),e.length>0&&this.emitter.emit(xe.events.SCROLL_OPTIMIZE,e,t))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let t=xe.sources.USER;typeof e=="string"&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(s=>{let{target:l}=s;const i=this.find(l,!0);return i&&!Cr(i)}),e.length>0&&this.emitter.emit(xe.events.SCROLL_BEFORE_UPDATE,t,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(xe.events.SCROLL_UPDATE,t,e)}updateEmbedAt(e,t,s){const[l]=this.descendant(i=>i instanceof zt,e);l&&l.statics.blotName===t&&Cr(l)&&l.updateContent(s)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const t=[];let s=new we;return e.forEach(l=>{const i=l?.insert;if(!!i)if(typeof i=="string"){const o=i.split(`
`);o.slice(0,-1).forEach(c=>{s.insert(c,l.attributes),t.push({type:"block",delta:s,attributes:l.attributes??{}}),s=new we});const r=o[o.length-1];r&&s.insert(r,l.attributes)}else{const o=Object.keys(i)[0];if(!o)return;this.query(o,Se.INLINE)?s.push(l):(s.length()&&t.push({type:"block",delta:s,attributes:{}}),s=new we,t.push({type:"blockEmbed",key:o,value:i[o],attributes:l.attributes??{}}))}}),s.length()&&t.push({type:"block",delta:s,attributes:{}}),t}createBlock(e,t){let s;const l={};Object.entries(e).forEach(r=>{let[c,m]=r;this.query(c,Se.BLOCK&Se.BLOT)!=null?s=c:l[c]=m});const i=this.create(s||this.statics.defaultChild.blotName,s?e[s]:void 0);this.insertBefore(i,t||void 0);const o=i.length();return Object.entries(l).forEach(r=>{let[c,m]=r;i.formatAt(0,o,c,m)}),i}}function Ci(n,e,t){t.reduce((s,l)=>{const i=Pt.exports.Op.length(l);let o=l.attributes||{};if(l.insert!=null){if(typeof l.insert=="string"){const r=l.insert;n.insertAt(s,r);const[c]=n.descendant(kt,s),m=Ut(c);o=Pt.exports.AttributeMap.diff(m,o)||{}}else if(typeof l.insert=="object"){const r=Object.keys(l.insert)[0];if(r==null)return s;if(n.insertAt(s,r,l.insert[r]),n.scroll.query(r,Se.INLINE)!=null){const[m]=n.descendant(kt,s),g=Ut(m);o=Pt.exports.AttributeMap.diff(g,o)||{}}}}return Object.keys(o).forEach(r=>{n.formatAt(s,i,r,o[r])}),s+i},e)}const ho={scope:Se.BLOCK,whitelist:["right","center","justify"]},x_=new ua("align","align",ho),Nc=new aa("align","ql-align",ho),Dc=new Ba("align","text-align",ho);class Mc extends Ba{value(e){let t=super.value(e);return t.startsWith("rgb(")?(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${t.split(",").map(l=>`00${parseInt(l,10).toString(16)}`.slice(-2)).join("")}`):t}}const w_=new aa("color","ql-color",{scope:Se.INLINE}),vo=new Mc("color","color",{scope:Se.INLINE}),T_=new aa("background","ql-bg",{scope:Se.INLINE}),_o=new Mc("background","background-color",{scope:Se.INLINE});class ns extends ss{static create(e){const t=super.create(e);return t.setAttribute("spellcheck","false"),t}code(e,t){return this.children.map(s=>s.length()<=1?"":s.domNode.innerText).join(`
`).slice(e,e+t)}html(e,t){return`<pre>
${wl(this.code(e,t))}
</pre>`}}class At extends vt{static TAB="  ";static register(){oe.register(ns)}}class yo extends Et{}yo.blotName="code";yo.tagName="CODE";At.blotName="code-block";At.className="ql-code-block";At.tagName="DIV";ns.blotName="code-block-container";ns.className="ql-code-block-container";ns.tagName="DIV";ns.allowedChildren=[At];At.allowedChildren=[ta,sa,Qt];At.requiredContainer=ns;const bo={scope:Se.BLOCK,whitelist:["rtl"]},Bc=new ua("direction","dir",bo),Fc=new aa("direction","ql-direction",bo),Vc=new Ba("direction","direction",bo),Rc={scope:Se.INLINE,whitelist:["serif","monospace"]},qc=new aa("font","ql-font",Rc);class S_ extends Ba{value(e){return super.value(e).replace(/["']/g,"")}}const Uc=new S_("font","font-family",Rc),jc=new aa("size","ql-size",{scope:Se.INLINE,whitelist:["small","large","huge"]}),zc=new Ba("size","font-size",{scope:Se.INLINE,whitelist:["10px","18px","32px"]}),E_=xa("quill:keyboard"),L_=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Tl extends ma{static match(e,t){return["altKey","ctrlKey","metaKey","shiftKey"].some(s=>!!t[s]!==e[s]&&t[s]!==null)?!1:t.key===e.key||t.key===e.which}constructor(e,t){super(e,t),this.bindings={},Object.keys(this.options.bindings).forEach(s=>{this.options.bindings[s]&&this.addBinding(this.options.bindings[s])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const l=$_(e);if(l==null){E_.warn("Attempted to add invalid keyboard binding",l);return}typeof t=="function"&&(t={handler:t}),typeof s=="function"&&(s={handler:s}),(Array.isArray(l.key)?l.key:[l.key]).forEach(o=>{const r={...l,key:o,...t,...s};this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const l=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(L=>Tl.match(e,L));if(l.length===0)return;const i=oe.find(e.target,!0);if(i&&i.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[r,c]=this.quill.getLine(o.index),[m,g]=this.quill.getLeaf(o.index),[f,v]=o.length===0?[m,g]:this.quill.getLeaf(o.index+o.length),k=m instanceof ll?m.value().slice(0,g):"",T=f instanceof ll?f.value().slice(v):"",y={collapsed:o.length===0,empty:o.length===0&&r.length()<=1,format:this.quill.getFormat(o),line:r,offset:c,prefix:k,suffix:T,event:e};l.some(L=>{if(L.collapsed!=null&&L.collapsed!==y.collapsed||L.empty!=null&&L.empty!==y.empty||L.offset!=null&&L.offset!==y.offset)return!1;if(Array.isArray(L.format)){if(L.format.every(E=>y.format[E]==null))return!1}else if(typeof L.format=="object"&&!Object.keys(L.format).every(E=>L.format[E]===!0?y.format[E]!=null:L.format[E]===!1?y.format[E]==null:oo(L.format[E],y.format[E])))return!1;return L.prefix!=null&&!L.prefix.test(y.prefix)||L.suffix!=null&&!L.suffix.test(y.suffix)?!1:L.handler.call(this,o,y,L)!==!0})&&e.preventDefault()})}handleBackspace(e,t){const s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let l={};const[i]=this.quill.getLine(e.index);let o=new we().retain(e.index-s).delete(s);if(t.offset===0){const[r]=this.quill.getLine(e.index-1);if(r&&!(r.statics.blotName==="block"&&r.length()<=1)){const m=i.formats(),g=this.quill.getFormat(e.index-1,1);if(l=Pt.exports.AttributeMap.diff(m,g)||{},Object.keys(l).length>0){const f=new we().retain(e.index+i.length()-2).retain(1,l);o=o.compose(f)}}}this.quill.updateContents(o,oe.sources.USER),this.quill.focus()}handleDelete(e,t){const s=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(e.index>=this.quill.getLength()-s)return;let l={};const[i]=this.quill.getLine(e.index);let o=new we().retain(e.index).delete(s);if(t.offset>=i.length()-1){const[r]=this.quill.getLine(e.index+1);if(r){const c=i.formats(),m=this.quill.getFormat(e.index,1);l=Pt.exports.AttributeMap.diff(c,m)||{},Object.keys(l).length>0&&(o=o.retain(r.length()-1).retain(1,l))}}this.quill.updateContents(o,oe.sources.USER),this.quill.focus()}handleDeleteRange(e){ko({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,t){const s=Object.keys(t.format).reduce((i,o)=>(this.quill.scroll.query(o,Se.BLOCK)&&!Array.isArray(t.format[o])&&(i[o]=t.format[o]),i),{}),l=new we().retain(e.index).delete(e.length).insert(`
`,s);this.quill.updateContents(l,oe.sources.USER),this.quill.setSelection(e.index+1,oe.sources.SILENT),this.quill.focus()}}const A_={bindings:{bold:xi("bold"),italic:xi("italic"),underline:xi("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",oe.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",oe.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,e){e.format.indent!=null?this.quill.format("indent","-1",oe.sources.USER):e.format.list!=null&&this.quill.format("list",!1,oe.sources.USER)}},"indent code-block":xr(!0),"outdent code-block":xr(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,oe.sources.USER)}},tab:{key:"Tab",handler(n,e){if(e.format.table)return!0;this.quill.history.cutoff();const t=new we().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(t,oe.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,oe.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,oe.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,e){const t={list:!1};e.format.indent&&(t.indent=!1),this.quill.formatLine(n.index,n.length,t,oe.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[e,t]=this.quill.getLine(n.index),s={...e.formats(),list:"checked"},l=new we().retain(n.index).insert(`
`,s).retain(e.length()-t-1).retain(1,{list:"unchecked"});this.quill.updateContents(l,oe.sources.USER),this.quill.setSelection(n.index+1,oe.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,e){const[t,s]=this.quill.getLine(n.index),l=new we().retain(n.index).insert(`
`,e.format).retain(t.length()-s-1).retain(1,{header:null});this.quill.updateContents(l,oe.sources.USER),this.quill.setSelection(n.index+1,oe.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const e=this.quill.getModule("table");if(e){const[t,s,l,i]=e.getTable(n),o=I_(t,s,l,i);if(o==null)return;let r=t.offset();if(o<0){const c=new we().retain(r).insert(`
`);this.quill.updateContents(c,oe.sources.USER),this.quill.setSelection(n.index+1,n.length,oe.sources.SILENT)}else if(o>0){r+=t.length();const c=new we().retain(r).insert(`
`);this.quill.updateContents(c,oe.sources.USER),this.quill.setSelection(r,oe.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,e){const{event:t,line:s}=e,l=s.offset(this.quill.scroll);t.shiftKey?this.quill.setSelection(l-1,oe.sources.USER):this.quill.setSelection(l+s.length(),oe.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,e){if(this.quill.scroll.query("list")==null)return!0;const{length:t}=e.prefix,[s,l]=this.quill.getLine(n.index);if(l>t)return!0;let i;switch(e.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(n.index," ",oe.sources.USER),this.quill.history.cutoff();const o=new we().retain(n.index-l).delete(t+1).retain(s.length()-2-l).retain(1,{list:i});return this.quill.updateContents(o,oe.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-t,oe.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[e,t]=this.quill.getLine(n.index);let s=2,l=e;for(;l!=null&&l.length()<=1&&l.formats()["code-block"];)if(l=l.prev,s-=1,s<=0){const i=new we().retain(n.index+e.length()-t-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,oe.sources.USER),this.quill.setSelection(n.index-1,oe.sources.SILENT),!1}return!0}},"embed left":Yn("ArrowLeft",!1),"embed left shift":Yn("ArrowLeft",!0),"embed right":Yn("ArrowRight",!1),"embed right shift":Yn("ArrowRight",!0),"table down":wr(!1),"table up":wr(!0)}};Tl.DEFAULTS=A_;function xr(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(e,t){let{event:s}=t;const l=this.quill.scroll.query("code-block"),{TAB:i}=l;if(e.length===0&&!s.shiftKey){this.quill.insertText(e.index,i,oe.sources.USER),this.quill.setSelection(e.index+i.length,oe.sources.SILENT);return}const o=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:r,length:c}=e;o.forEach((m,g)=>{n?(m.insertAt(0,i),g===0?r+=i.length:c+=i.length):m.domNode.textContent.startsWith(i)&&(m.deleteAt(0,i.length),g===0?r-=i.length:c-=i.length)}),this.quill.update(oe.sources.USER),this.quill.setSelection(r,c,oe.sources.SILENT)}}}function Yn(n,e){return{key:n,shiftKey:e,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(s){let{index:l}=s;n==="ArrowRight"&&(l+=s.length+1);const[i]=this.quill.getLeaf(l);return i instanceof Ft?(n==="ArrowLeft"?e?this.quill.setSelection(s.index-1,s.length+1,oe.sources.USER):this.quill.setSelection(s.index-1,oe.sources.USER):e?this.quill.setSelection(s.index,s.length+1,oe.sources.USER):this.quill.setSelection(s.index+s.length+1,oe.sources.USER),!1):!0}}}function xi(n){return{key:n[0],shortKey:!0,handler(e,t){this.quill.format(n,!t.format[n],oe.sources.USER)}}}function wr(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,t){const s=n?"prev":"next",l=t.line,i=l.parent[s];if(i!=null){if(i.statics.blotName==="table-row"){let o=i.children.head,r=l;for(;r.prev!=null;)r=r.prev,o=o.next;const c=o.offset(this.quill.scroll)+Math.min(t.offset,o.length()-1);this.quill.setSelection(c,0,oe.sources.USER)}}else{const o=l.table()[s];o!=null&&(n?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,oe.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,oe.sources.USER))}return!1}}}function $_(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=ws(n);else return null;return n.shortKey&&(n[L_]=n.shortKey,delete n.shortKey),n}function ko(n){let{quill:e,range:t}=n;const s=e.getLines(t);let l={};if(s.length>1){const i=s[0].formats(),o=s[s.length-1].formats();l=Pt.exports.AttributeMap.diff(o,i)||{}}e.deleteText(t,oe.sources.USER),Object.keys(l).length>0&&e.formatLine(t.index,1,l,oe.sources.USER),e.setSelection(t.index,oe.sources.SILENT)}function I_(n,e,t,s){return e.prev==null&&e.next==null?t.prev==null&&t.next==null?s===0?-1:1:t.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const O_=/font-weight:\s*normal/,P_=["P","OL","UL"],Tr=n=>n&&P_.includes(n.tagName),N_=n=>{Array.from(n.querySelectorAll("br")).filter(e=>Tr(e.previousElementSibling)&&Tr(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)})},D_=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(O_)).forEach(e=>{const t=n.createDocumentFragment();t.append(...e.childNodes),e.parentNode?.replaceChild(t,e)})};function M_(n){n.querySelector('[id^="docs-internal-guid-"]')&&(D_(n),N_(n))}const B_=/\bmso-list:[^;]*ignore/i,F_=/\bmso-list:[^;]*\bl(\d+)/i,V_=/\bmso-list:[^;]*\blevel(\d+)/i,R_=(n,e)=>{const t=n.getAttribute("style"),s=t?.match(F_);if(!s)return null;const l=Number(s[1]),i=t?.match(V_),o=i?Number(i[1]):1,r=new RegExp(`@list l${l}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),c=e.match(r),m=c&&c[1]==="bullet"?"bullet":"ordered";return{id:l,indent:o,type:m,element:n}},q_=n=>{const e=Array.from(n.querySelectorAll("[style*=mso-list]")),t=[],s=[];e.forEach(o=>{(o.getAttribute("style")||"").match(B_)?t.push(o):s.push(o)}),t.forEach(o=>o.parentNode?.removeChild(o));const l=n.documentElement.innerHTML,i=s.map(o=>R_(o,l)).filter(o=>o);for(;i.length;){const o=[];let r=i.shift();for(;r;)o.push(r),r=i.length&&i[0]?.element===r.element.nextElementSibling&&i[0].id===r.id?i.shift():null;const c=document.createElement("ul");o.forEach(f=>{const v=document.createElement("li");v.setAttribute("data-list",f.type),f.indent>1&&v.setAttribute("class",`ql-indent-${f.indent-1}`),v.innerHTML=f.element.innerHTML,c.appendChild(v)});const m=o[0]?.element,{parentNode:g}=m??{};m&&g?.replaceChild(c,m),o.slice(1).forEach(f=>{let{element:v}=f;g?.removeChild(v)})}};function U_(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&q_(n)}const j_=[U_,M_],z_=n=>{n.documentElement&&j_.forEach(e=>{e(n)})},Y_=xa("quill:clipboard"),W_=[[Node.TEXT_NODE,l1],[Node.TEXT_NODE,Er],["br",Q_],[Node.ELEMENT_NODE,Er],[Node.ELEMENT_NODE,X_],[Node.ELEMENT_NODE,J_],[Node.ELEMENT_NODE,s1],["li",t1],["ol, ul",a1],["pre",K_],["tr",n1],["b",wi("bold")],["i",wi("italic")],["strike",wi("strike")],["style",e1]],H_=[x_,Bc].reduce((n,e)=>(n[e.keyName]=e,n),{}),Sr=[Dc,_o,vo,Vc,Uc,zc].reduce((n,e)=>(n[e.keyName]=e,n),{});class Z_ extends ma{static DEFAULTS={matchers:[]};constructor(e,t){super(e,t),this.quill.root.addEventListener("copy",s=>this.onCaptureCopy(s,!1)),this.quill.root.addEventListener("cut",s=>this.onCaptureCopy(s,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],W_.concat(this.options.matchers??[]).forEach(s=>{let[l,i]=s;this.addMatcher(l,i)})}addMatcher(e,t){this.matchers.push([e,t])}convert(e){let{html:t,text:s}=e,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(l[At.blotName])return new we().insert(s||"",{[At.blotName]:l[At.blotName]});if(!t)return new we().insert(s||"",l);const i=this.convertHTML(t);return kn(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||l.table)?i.compose(new we().retain(i.length()-1).delete(1)):i}normalizeHTML(e){z_(e)}convertHTML(e){const t=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(t);const s=t.body,l=new WeakMap,[i,o]=this.prepareMatching(s,l);return Co(this.quill.scroll,s,i,o,l)}dangerouslyPasteHTML(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oe.sources.API;if(typeof e=="string"){const l=this.convert({html:e,text:""});this.quill.setContents(l,t),this.quill.setSelection(0,oe.sources.SILENT)}else{const l=this.convert({html:t,text:""});this.quill.updateContents(new we().retain(e).concat(l),s),this.quill.setSelection(e+l.length(),oe.sources.SILENT)}}onCaptureCopy(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[s]=this.quill.selection.getRange();if(s==null)return;const{html:l,text:i}=this.onCopy(s,t);e.clipboardData?.setData("text/plain",i),e.clipboardData?.setData("text/html",l),t&&ko({range:s,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(t=>t[0]!=="#").join(`
`)}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const t=this.quill.getSelection(!0);if(t==null)return;const s=e.clipboardData?.getData("text/html");let l=e.clipboardData?.getData("text/plain");if(!s&&!l){const o=e.clipboardData?.getData("text/uri-list");o&&(l=this.normalizeURIList(o))}const i=Array.from(e.clipboardData?.files||[]);if(!s&&i.length>0){this.quill.uploader.upload(t,i);return}if(s&&i.length>0){const o=new DOMParser().parseFromString(s,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(t,i);return}}this.onPaste(t,{html:s,text:l})}onCopy(e){const t=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:t}}onPaste(e,t){let{text:s,html:l}=t;const i=this.quill.getFormat(e.index),o=this.convert({text:s,html:l},i);Y_.log("onPaste",o,{text:s,html:l});const r=new we().retain(e.index).delete(e.length).concat(o);this.quill.updateContents(r,oe.sources.USER),this.quill.setSelection(r.length()-e.length,oe.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,t){const s=[],l=[];return this.matchers.forEach(i=>{const[o,r]=i;switch(o){case Node.TEXT_NODE:l.push(r);break;case Node.ELEMENT_NODE:s.push(r);break;default:Array.from(e.querySelectorAll(o)).forEach(c=>{t.has(c)?t.get(c)?.push(r):t.set(c,[r])});break}}),[s,l]}}function ls(n,e,t,s){return s.query(e)?n.reduce((l,i)=>{if(!i.insert)return l;if(i.attributes&&i.attributes[e])return l.push(i);const o=t?{[e]:t}:{};return l.insert(i.insert,{...o,...i.attributes})},new we):n}function kn(n,e){let t="";for(let s=n.ops.length-1;s>=0&&t.length<e.length;--s){const l=n.ops[s];if(typeof l.insert!="string")break;t=l.insert+t}return t.slice(-1*e.length)===e}function La(n,e){if(!(n instanceof Element))return!1;const t=e.query(n);return t&&t.prototype instanceof Ft?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function G_(n,e){return n.previousElementSibling&&n.nextElementSibling&&!La(n.previousElementSibling,e)&&!La(n.nextElementSibling,e)}const Wn=new WeakMap;function Yc(n){return n==null?!1:(Wn.has(n)||(n.tagName==="PRE"?Wn.set(n,!0):Wn.set(n,Yc(n.parentNode))),Wn.get(n))}function Co(n,e,t,s,l){return e.nodeType===e.TEXT_NODE?s.reduce((i,o)=>o(e,i,n),new we):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((i,o)=>{let r=Co(n,o,t,s,l);return o.nodeType===e.ELEMENT_NODE&&(r=t.reduce((c,m)=>m(o,c,n),r),r=(l.get(o)||[]).reduce((c,m)=>m(o,c,n),r)),i.concat(r)},new we):new we}function wi(n){return(e,t,s)=>ls(t,n,!0,s)}function J_(n,e,t){const s=ua.keys(n),l=aa.keys(n),i=Ba.keys(n),o={};return s.concat(l).concat(i).forEach(r=>{let c=t.query(r,Se.ATTRIBUTE);c!=null&&(o[c.attrName]=c.value(n),o[c.attrName])||(c=H_[r],c!=null&&(c.attrName===r||c.keyName===r)&&(o[c.attrName]=c.value(n)||void 0),c=Sr[r],c!=null&&(c.attrName===r||c.keyName===r)&&(c=Sr[r],o[c.attrName]=c.value(n)||void 0))}),Object.entries(o).reduce((r,c)=>{let[m,g]=c;return ls(r,m,g,t)},e)}function X_(n,e,t){const s=t.query(n);if(s==null)return e;if(s.prototype instanceof Ft){const l={},i=s.value(n);if(i!=null)return l[s.blotName]=i,new we().insert(l,s.formats(n,t))}else if(s.prototype instanceof cn&&!kn(e,`
`)&&e.insert(`
`),"blotName"in s&&"formats"in s&&typeof s.formats=="function")return ls(e,s.blotName,s.formats(n,t),t);return e}function Q_(n,e){return kn(e,`
`)||e.insert(`
`),e}function K_(n,e,t){const s=t.query("code-block"),l=s&&"formats"in s&&typeof s.formats=="function"?s.formats(n,t):!0;return ls(e,"code-block",l,t)}function e1(){return new we}function t1(n,e,t){const s=t.query(n);if(s==null||s.blotName!=="list"||!kn(e,`
`))return e;let l=-1,i=n.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(l+=1),i=i.parentNode;return l<=0?e:e.reduce((o,r)=>r.insert?r.attributes&&typeof r.attributes.indent=="number"?o.push(r):o.insert(r.insert,{indent:l,...r.attributes||{}}):o,new we)}function a1(n,e,t){const s=n;let l=s.tagName==="OL"?"ordered":"bullet";const i=s.getAttribute("data-checked");return i&&(l=i==="true"?"checked":"unchecked"),ls(e,"list",l,t)}function Er(n,e,t){if(!kn(e,`
`)){if(La(n,t)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&n.nextSibling){let s=n.nextSibling;for(;s!=null;){if(La(s,t))return e.insert(`
`);const l=t.query(s);if(l&&l.prototype instanceof zt)return e.insert(`
`);s=s.firstChild}}}return e}function s1(n,e,t){const s={},l=n.style||{};return l.fontStyle==="italic"&&(s.italic=!0),l.textDecoration==="underline"&&(s.underline=!0),l.textDecoration==="line-through"&&(s.strike=!0),(l.fontWeight?.startsWith("bold")||parseInt(l.fontWeight,10)>=700)&&(s.bold=!0),e=Object.entries(s).reduce((i,o)=>{let[r,c]=o;return ls(i,r,c,t)},e),parseFloat(l.textIndent||0)>0?new we().insert("	").concat(e):e}function n1(n,e,t){const s=n.parentElement?.tagName==="TABLE"?n.parentElement:n.parentElement?.parentElement;if(s!=null){const i=Array.from(s.querySelectorAll("tr")).indexOf(n)+1;return ls(e,"table",i,t)}return e}function l1(n,e,t){let s=n.data;if(n.parentElement?.tagName==="O:P")return e.insert(s.trim());if(!Yc(n)){if(s.trim().length===0&&s.includes(`
`)&&!G_(n,t))return e;s=s.replace(/[^\S\u00a0]/g," "),s=s.replace(/ {2,}/g," "),(n.previousSibling==null&&n.parentElement!=null&&La(n.parentElement,t)||n.previousSibling instanceof Element&&La(n.previousSibling,t))&&(s=s.replace(/^ /,"")),(n.nextSibling==null&&n.parentElement!=null&&La(n.parentElement,t)||n.nextSibling instanceof Element&&La(n.nextSibling,t))&&(s=s.replace(/ $/,"")),s=s.replaceAll("\xA0"," ")}return e.insert(s)}class i1 extends ma{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,t){super(e,t),this.quill.on(oe.events.EDITOR_CHANGE,(s,l,i,o)=>{s===oe.events.SELECTION_CHANGE?l&&o!==oe.sources.SILENT&&(this.currentRange=l):s===oe.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===oe.sources.USER?this.record(l,i):this.transform(l)),this.currentRange=zi(this.currentRange,l))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",s=>{s.inputType==="historyUndo"?(this.undo(),s.preventDefault()):s.inputType==="historyRedo"&&(this.redo(),s.preventDefault())})}change(e,t){if(this.stack[e].length===0)return;const s=this.stack[e].pop();if(!s)return;const l=this.quill.getContents(),i=s.delta.invert(l);this.stack[t].push({delta:i,range:zi(s.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(s.delta,oe.sources.USER),this.ignoreChange=!1,this.restoreSelection(s)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,t){if(e.ops.length===0)return;this.stack.redo=[];let s=e.invert(t),l=this.currentRange;const i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(s=s.compose(o.delta),l=o.range)}else this.lastRecorded=i;s.length()!==0&&(this.stack.undo.push({delta:s,range:l}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){Lr(this.stack.undo,e),Lr(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,oe.sources.USER);else{const t=r1(this.quill.scroll,e.delta);this.quill.setSelection(t,oe.sources.USER)}}}function Lr(n,e){let t=e;for(let s=n.length-1;s>=0;s-=1){const l=n[s];n[s]={delta:t.transform(l.delta,!0),range:l.range&&zi(l.range,t)},t=l.delta.transform(t),n[s].delta.length()===0&&n.splice(s,1)}}function o1(n,e){const t=e.ops[e.ops.length-1];return t==null?!1:t.insert!=null?typeof t.insert=="string"&&t.insert.endsWith(`
`):t.attributes!=null?Object.keys(t.attributes).some(s=>n.query(s,Se.BLOCK)!=null):!1}function r1(n,e){const t=e.reduce((l,i)=>l+(i.delete||0),0);let s=e.length()-t;return o1(n,e)&&(s-=1),s}function zi(n,e){if(!n)return n;const t=e.transformPosition(n.index),s=e.transformPosition(n.index+n.length);return{index:t,length:s-t}}class Wc extends ma{constructor(e,t){super(e,t),e.root.addEventListener("drop",s=>{s.preventDefault();let l=null;if(document.caretRangeFromPoint)l=document.caretRangeFromPoint(s.clientX,s.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(s.clientX,s.clientY);l=document.createRange(),l.setStart(o.offsetNode,o.offset),l.setEnd(o.offsetNode,o.offset)}const i=l&&e.selection.normalizeNative(l);if(i){const o=e.selection.normalizedToRange(i);s.dataTransfer?.files&&this.upload(o,s.dataTransfer.files)}})}upload(e,t){const s=[];Array.from(t).forEach(l=>{l&&this.options.mimetypes?.includes(l.type)&&s.push(l)}),s.length>0&&this.options.handler.call(this,e,s)}}Wc.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,e){if(!this.quill.scroll.query("image"))return;const t=e.map(s=>new Promise(l=>{const i=new FileReader;i.onload=()=>{l(i.result)},i.readAsDataURL(s)}));Promise.all(t).then(s=>{const l=s.reduce((i,o)=>i.insert({image:o}),new we().retain(n.index).delete(n.length));this.quill.updateContents(l,xe.sources.USER),this.quill.setSelection(n.index+s.length,xe.sources.SILENT)})}};const c1=["insertText","insertReplacementText"];class u1 extends ma{constructor(e,t){super(e,t),e.root.addEventListener("beforeinput",s=>{this.handleBeforeInput(s)}),/Android/i.test(navigator.userAgent)||e.on(oe.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){ko({range:e,quill:this.quill})}replaceText(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(t){const s=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new we().retain(e.index).insert(t,s),oe.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+t.length,0,oe.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!c1.includes(e.inputType))return;const t=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!t||t.collapsed===!0)return;const s=d1(e);if(s==null)return;const l=this.quill.selection.normalizeNative(t),i=l?this.quill.selection.normalizedToRange(l):null;i&&this.replaceText(i,s)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function d1(n){return typeof n.data=="string"?n.data:n.dataTransfer?.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const m1=/Mac/i.test(navigator.platform),p1=100,g1=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||m1&&n.key==="a"&&n.ctrlKey===!0);class f1 extends ma{isListening=!1;selectionChangeDeadline=0;constructor(e,t){super(e,t),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,t){let{line:s,event:l}=t;if(!(s instanceof ea)||!s.uiNode)return!0;const i=getComputedStyle(s.domNode).direction==="rtl";return i&&l.key!=="ArrowRight"||!i&&l.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(l.shiftKey?1:0),oe.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&g1(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+p1,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const t=e.getRangeAt(0);if(t.collapsed!==!0||t.startOffset!==0)return;const s=this.quill.scroll.find(t.startContainer);if(!(s instanceof ea)||!s.uiNode)return;const l=document.createRange();l.setStartAfter(s.uiNode),l.setEndAfter(s.uiNode),e.removeAllRanges(),e.addRange(l)}}oe.register({"blots/block":vt,"blots/block/embed":zt,"blots/break":sa,"blots/container":ss,"blots/cursor":Qt,"blots/embed":fo,"blots/inline":Et,"blots/scroll":C_,"blots/text":ta,"modules/clipboard":Z_,"modules/history":i1,"modules/keyboard":Tl,"modules/uploader":Wc,"modules/input":u1,"modules/uiNode":f1});class h1 extends aa{add(e,t){let s=0;if(t==="+1"||t==="-1"){const l=this.value(e)||0;s=t==="+1"?l+1:l-1}else typeof t=="number"&&(s=t);return s===0?(this.remove(e),!0):super.add(e,s.toString())}canAdd(e,t){return super.canAdd(e,t)||super.canAdd(e,parseInt(t,10))}value(e){return parseInt(super.value(e),10)||void 0}}const v1=new h1("indent","ql-indent",{scope:Se.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class _1 extends vt{static blotName="blockquote";static tagName="blockquote"}class y1 extends vt{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}class Cn extends ss{}Cn.blotName="list-container";Cn.tagName="OL";class xn extends vt{static create(e){const t=super.create();return t.setAttribute("data-list",e),t}static formats(e){return e.getAttribute("data-list")||void 0}static register(){oe.register(Cn)}constructor(e,t){super(e,t);const s=t.ownerDocument.createElement("span"),l=i=>{if(!e.isEnabled())return;const o=this.statics.formats(t,e);o==="checked"?(this.format("list","unchecked"),i.preventDefault()):o==="unchecked"&&(this.format("list","checked"),i.preventDefault())};s.addEventListener("mousedown",l),s.addEventListener("touchstart",l),this.attachUI(s)}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-list",t):super.format(e,t)}}xn.blotName="list";xn.tagName="LI";Cn.allowedChildren=[xn];xn.requiredContainer=Cn;class xo extends Et{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class b1 extends xo{static blotName="italic";static tagName=["EM","I"]}class rl extends Et{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const t=super.create(e);return t.setAttribute("href",this.sanitize(e)),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}static formats(e){return e.getAttribute("href")}static sanitize(e){return Hc(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,t){e!==this.statics.blotName||!t?super.format(e,t):this.domNode.setAttribute("href",this.constructor.sanitize(t))}}function Hc(n,e){const t=document.createElement("a");t.href=n;const s=t.href.slice(0,t.href.indexOf(":"));return e.indexOf(s)>-1}class k1 extends Et{static blotName="script";static tagName=["SUB","SUP"];static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}class C1 extends xo{static blotName="strike";static tagName=["S","STRIKE"]}class x1 extends Et{static blotName="underline";static tagName="U"}class w1 extends fo{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const t=super.create(e);return typeof e=="string"&&(window.katex.render(e,t,{throwOnError:!1,errorColor:"#f00"}),t.setAttribute("data-value",e)),t}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const Ar=["alt","height","width"];class T1 extends Ft{static blotName="image";static tagName="IMG";static create(e){const t=super.create(e);return typeof e=="string"&&t.setAttribute("src",this.sanitize(e)),t}static formats(e){return Ar.reduce((t,s)=>(e.hasAttribute(s)&&(t[s]=e.getAttribute(s)),t),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return Hc(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,t){Ar.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}}const $r=["height","width"];class S1 extends zt{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const t=super.create(e);return t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen","true"),t.setAttribute("src",this.sanitize(e)),t}static formats(e){return $r.reduce((t,s)=>(e.hasAttribute(s)&&(t[s]=e.getAttribute(s)),t),{})}static sanitize(e){return rl.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,t){$r.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const Qs=new aa("code-token","hljs",{scope:Se.INLINE});class ba extends Et{static formats(e,t){for(;e!=null&&e!==t.domNode;){if(e.classList&&e.classList.contains(At.className))return super.formats(e,t);e=e.parentNode}}constructor(e,t,s){super(e,t,s),Qs.add(this.domNode,s)}format(e,t){e!==ba.blotName?super.format(e,t):t?Qs.add(this.domNode,t):(Qs.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Qs.value(this.domNode)||this.unwrap()}}ba.blotName="code-token";ba.className="ql-token";class jt extends At{static create(e){const t=super.create(e);return typeof e=="string"&&t.setAttribute("data-language",e),t}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-language",t):super.format(e,t)}replaceWith(e,t){return this.formatAt(0,this.length(),ba.blotName,!1),super.replaceWith(e,t)}}class tn extends ns{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,t){e===jt.blotName&&(this.forceNext=!0,this.children.forEach(s=>{s.format(e,t)}))}formatAt(e,t,s,l){s===jt.blotName&&(this.forceNext=!0),super.formatAt(e,t,s,l)}highlight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const l=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,i=jt.formats(this.children.head.domNode);if(t||this.forceNext||this.cachedText!==l){if(l.trim().length>0||this.cachedText==null){const o=this.children.reduce((c,m)=>c.concat(Ic(m,!1)),new we),r=e(l,i);o.diff(r).reduce((c,m)=>{let{retain:g,attributes:f}=m;return g?(f&&Object.keys(f).forEach(v=>{[jt.blotName,ba.blotName].includes(v)&&this.formatAt(c,g,v,f[v])}),c+g):c},0)}this.cachedText=l,this.forceNext=!1}}html(e,t){const[s]=this.children.find(e);return`<pre data-language="${s?jt.formats(s.domNode):"plain"}">
${wl(this.code(e,t))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const t=jt.formats(this.children.head.domNode);t!==this.uiNode.value&&(this.uiNode.value=t)}}}tn.allowedChildren=[jt];jt.requiredContainer=tn;jt.allowedChildren=[ba,Qt,ta,sa];const E1=(n,e,t)=>{if(typeof n.versionString=="string"){const s=n.versionString.split(".")[0];if(parseInt(s,10)>=11)return n.highlight(t,{language:e}).value}return n.highlight(e,t).value};class Zc extends ma{static register(){oe.register(ba,!0),oe.register(jt,!0),oe.register(tn,!0)}constructor(e,t){if(super(e,t),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((s,l)=>{let{key:i}=l;return s[i]=!0,s},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(oe.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof tn))return;const t=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(s=>{let{key:l,label:i}=s;const o=t.ownerDocument.createElement("option");o.textContent=i,o.setAttribute("value",l),t.appendChild(o)}),t.addEventListener("change",()=>{e.format(jt.blotName,t.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(t),e.children.head&&(t.value=jt.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(oe.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(oe.sources.USER);const s=this.quill.getSelection();(e==null?this.quill.scroll.descendants(tn):[e]).forEach(i=>{i.highlight(this.highlightBlot,t)}),this.quill.update(oe.sources.SILENT),s!=null&&this.quill.setSelection(s,oe.sources.SILENT)}highlightBlot(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(t=this.languages[t]?t:"plain",t==="plain")return wl(e).split(`
`).reduce((l,i,o)=>(o!==0&&l.insert(`
`,{[At.blotName]:t}),l.insert(i)),new we);const s=this.quill.root.ownerDocument.createElement("div");return s.classList.add(At.className),s.innerHTML=E1(this.options.hljs,t,e),Co(this.quill.scroll,s,[(l,i)=>{const o=Qs.value(l);return o?i.compose(new we().retain(i.length(),{[ba.blotName]:o})):i}],[(l,i)=>l.data.split(`
`).reduce((o,r,c)=>(c!==0&&o.insert(`
`,{[At.blotName]:t}),o.insert(r)),i)],new WeakMap)}}Zc.DEFAULTS={hljs:(()=>window.hljs)(),interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class Kt extends vt{static blotName="table";static tagName="TD";static create(e){const t=super.create();return e?t.setAttribute("data-row",e):t.setAttribute("data-row",wo()),t}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,t){e===Kt.blotName&&t?this.domNode.setAttribute("data-row",t):super.format(e,t)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class Ga extends ss{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),t=this.children.tail.formats(),s=this.next.children.head.formats(),l=this.next.children.tail.formats();return e.table===t.table&&e.table===s.table&&e.table===l.table}return!1}optimize(e){super.optimize(e),this.children.forEach(t=>{if(t.next==null)return;const s=t.formats(),l=t.next.formats();if(s.table!==l.table){const i=this.splitAfter(t);i&&i.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class Ia extends ss{static blotName="table-body";static tagName="TBODY"}class cl extends ss{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(Ga),t=e.reduce((s,l)=>Math.max(l.children.length,s),0);e.forEach(s=>{new Array(t-s.children.length).fill(0).forEach(()=>{let l;s.children.head!=null&&(l=Kt.formats(s.children.head.domNode));const i=this.scroll.create(Kt.blotName,l);s.appendChild(i),i.optimize()})})}cells(e){return this.rows().map(t=>t.children.at(e))}deleteColumn(e){const[t]=this.descendant(Ia);t==null||t.children.head==null||t.children.forEach(s=>{const l=s.children.at(e);l?.remove()})}insertColumn(e){const[t]=this.descendant(Ia);t==null||t.children.head==null||t.children.forEach(s=>{const l=s.children.at(e),i=Kt.formats(s.children.head.domNode),o=this.scroll.create(Kt.blotName,i);s.insertBefore(o,l)})}insertRow(e){const[t]=this.descendant(Ia);if(t==null||t.children.head==null)return;const s=wo(),l=this.scroll.create(Ga.blotName);t.children.head.children.forEach(()=>{const o=this.scroll.create(Kt.blotName,s);l.appendChild(o)});const i=t.children.at(e);t.insertBefore(l,i)}rows(){const e=this.children.head;return e==null?[]:e.children.map(t=>t)}}cl.allowedChildren=[Ia];Ia.requiredContainer=cl;Ia.allowedChildren=[Ga];Ga.requiredContainer=Ia;Ga.allowedChildren=[Kt];Kt.requiredContainer=Ga;function wo(){return`row-${Math.random().toString(36).slice(2,6)}`}class L1 extends ma{static register(){oe.register(Kt),oe.register(Ga),oe.register(Ia),oe.register(cl)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(cl).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,t]=this.getTable();t!=null&&(e.deleteColumn(t.cellOffset()),this.quill.update(oe.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update(oe.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const t=e.offset();e.remove(),this.quill.update(oe.sources.USER),this.quill.setSelection(t,oe.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[t,s]=this.quill.getLine(e.index);if(t==null||t.statics.blotName!==Kt.blotName)return[null,null,null,-1];const l=t.parent;return[l.parent.parent,l,t,s]}insertColumn(e){const t=this.quill.getSelection();if(!t)return;const[s,l,i]=this.getTable(t);if(i==null)return;const o=i.cellOffset();s.insertColumn(o+e),this.quill.update(oe.sources.USER);let r=l.rowOffset();e===0&&(r+=1),this.quill.setSelection(t.index+r,t.length,oe.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const t=this.quill.getSelection();if(!t)return;const[s,l,i]=this.getTable(t);if(i==null)return;const o=l.rowOffset();s.insertRow(o+e),this.quill.update(oe.sources.USER),e>0?this.quill.setSelection(t,oe.sources.SILENT):this.quill.setSelection(t.index+l.children.length,t.length,oe.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,t){const s=this.quill.getSelection();if(s==null)return;const l=new Array(e).fill(0).reduce(i=>{const o=new Array(t).fill(`
`).join("");return i.insert(o,{table:wo()})},new we().retain(s.index));this.quill.updateContents(l,oe.sources.USER),this.quill.setSelection(s.index,oe.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(oe.events.SCROLL_OPTIMIZE,e=>{e.some(t=>["TD","TR","TBODY","TABLE"].includes(t.target.tagName)?(this.quill.once(oe.events.TEXT_CHANGE,(s,l,i)=>{i===oe.sources.USER&&this.balanceTables()}),!0):!1)})}}const Ir=xa("quill:toolbar");class To extends ma{constructor(e,t){if(super(e,t),Array.isArray(this.options.container)){const s=document.createElement("div");s.setAttribute("role","toolbar"),A1(s,this.options.container),e.container?.parentNode?.insertBefore(s,e.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){Ir.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{const l=this.options.handlers?.[s];l&&this.addHandler(s,l)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(oe.events.EDITOR_CHANGE,()=>{const[s]=this.quill.selection.getRange();this.update(s)})}addHandler(e,t){this.handlers[e]=t}attach(e){let t=Array.from(e.classList).find(l=>l.indexOf("ql-")===0);if(!t)return;if(t=t.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[t]==null&&this.quill.scroll.query(t)==null){Ir.warn("ignoring attaching to nonexistent format",t,e);return}const s=e.tagName==="SELECT"?"change":"click";e.addEventListener(s,l=>{let i;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const r=e.options[e.selectedIndex];r.hasAttribute("selected")?i=!1:i=r.value||!1}else e.classList.contains("ql-active")?i=!1:i=e.value||!e.hasAttribute("value"),l.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[t]!=null)this.handlers[t].call(this,i);else if(this.quill.scroll.query(t).prototype instanceof Ft){if(i=prompt(`Enter ${t}`),!i)return;this.quill.updateContents(new we().retain(o.index).delete(o.length).insert({[t]:i}),oe.sources.USER)}else this.quill.format(t,i,oe.sources.USER);this.update(o)}),this.controls.push([t,e])}update(e){const t=e==null?{}:this.quill.getFormat(e);this.controls.forEach(s=>{const[l,i]=s;if(i.tagName==="SELECT"){let o=null;if(e==null)o=null;else if(t[l]==null)o=i.querySelector("option[selected]");else if(!Array.isArray(t[l])){let r=t[l];typeof r=="string"&&(r=r.replace(/"/g,'\\"')),o=i.querySelector(`option[value="${r}"]`)}o==null?(i.value="",i.selectedIndex=-1):o.selected=!0}else if(e==null)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){const o=t[l],r=o===i.getAttribute("value")||o!=null&&o.toString()===i.getAttribute("value")||o==null&&!i.getAttribute("value");i.classList.toggle("ql-active",r),i.setAttribute("aria-pressed",r.toString())}else{const o=t[l]!=null;i.classList.toggle("ql-active",o),i.setAttribute("aria-pressed",o.toString())}})}}To.DEFAULTS={};function Or(n,e,t){const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add(`ql-${e}`),s.setAttribute("aria-pressed","false"),t!=null?(s.value=t,s.setAttribute("aria-label",`${e}: ${t}`)):s.setAttribute("aria-label",e),n.appendChild(s)}function A1(n,e){Array.isArray(e[0])||(e=[e]),e.forEach(t=>{const s=document.createElement("span");s.classList.add("ql-formats"),t.forEach(l=>{if(typeof l=="string")Or(s,l);else{const i=Object.keys(l)[0],o=l[i];Array.isArray(o)?$1(s,i,o):Or(s,i,o)}}),n.appendChild(s)})}function $1(n,e,t){const s=document.createElement("select");s.classList.add(`ql-${e}`),t.forEach(l=>{const i=document.createElement("option");l!==!1?i.setAttribute("value",String(l)):i.setAttribute("selected","selected"),s.appendChild(i)}),n.appendChild(s)}To.DEFAULTS={container:null,handlers:{clean(){const n=this.quill.getSelection();if(n!=null)if(n.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(t=>{this.quill.scroll.query(t,Se.INLINE)!=null&&this.quill.format(t,!1,oe.sources.USER)})}else this.quill.removeFormat(n.index,n.length,oe.sources.USER)},direction(n){const{align:e}=this.quill.getFormat();n==="rtl"&&e==null?this.quill.format("align","right",oe.sources.USER):!n&&e==="right"&&this.quill.format("align",!1,oe.sources.USER),this.quill.format("direction",n,oe.sources.USER)},indent(n){const e=this.quill.getSelection(),t=this.quill.getFormat(e),s=parseInt(t.indent||0,10);if(n==="+1"||n==="-1"){let l=n==="+1"?1:-1;t.direction==="rtl"&&(l*=-1),this.quill.format("indent",s+l,oe.sources.USER)}},link(n){n===!0&&(n=prompt("Enter link URL:")),this.quill.format("link",n,oe.sources.USER)},list(n){const e=this.quill.getSelection(),t=this.quill.getFormat(e);n==="check"?t.list==="checked"||t.list==="unchecked"?this.quill.format("list",!1,oe.sources.USER):this.quill.format("list","unchecked",oe.sources.USER):this.quill.format("list",n,oe.sources.USER)}}};const I1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',O1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',P1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',N1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',D1='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',M1='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',B1='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',F1='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',Pr='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',V1='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',R1='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',q1='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',U1='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',j1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',z1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Y1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',W1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',H1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Z1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',G1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',J1='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',X1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',Q1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',K1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',ey='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',ty='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',ay='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',sy='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',ny='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',ly='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',iy='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',oy='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',ry='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>';var mn={align:{"":I1,center:O1,right:P1,justify:N1},background:D1,blockquote:M1,bold:B1,clean:F1,code:Pr,"code-block":Pr,color:V1,direction:{"":R1,rtl:q1},formula:U1,header:{"1":j1,"2":z1,"3":Y1,"4":W1,"5":H1,"6":Z1},italic:G1,image:J1,indent:{"+1":X1,"-1":Q1},link:K1,list:{bullet:ey,check:ty,ordered:ay},script:{sub:sy,super:ny},strike:ly,table:iy,underline:oy,video:ry};const cy='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let Nr=0;function Dr(n,e){n.setAttribute(e,`${n.getAttribute(e)!=="true"}`)}class Sl{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",t=>{switch(t.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),t.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),Dr(this.label,"aria-expanded"),Dr(this.options,"aria-hidden")}buildItem(e){const t=document.createElement("span");t.tabIndex="0",t.setAttribute("role","button"),t.classList.add("ql-picker-item");const s=e.getAttribute("value");return s&&t.setAttribute("data-value",s),e.textContent&&t.setAttribute("data-label",e.textContent),t.addEventListener("click",()=>{this.selectItem(t,!0)}),t.addEventListener("keydown",l=>{switch(l.key){case"Enter":this.selectItem(t,!0),l.preventDefault();break;case"Escape":this.escape(),l.preventDefault();break}}),t}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=cy,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${Nr}`,Nr+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(t=>{const s=this.buildItem(t);e.appendChild(s),t.selected===!0&&this.selectItem(s)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.container.querySelector(".ql-selected");e!==s&&(s?.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const s=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(s)}else this.selectItem(null);const t=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",t)}}class Gc extends Sl{constructor(e,t){super(e),this.label.innerHTML=t,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(s=>{s.classList.add("ql-primary")})}buildItem(e){const t=super.buildItem(e);return t.style.backgroundColor=e.getAttribute("value")||"",t}selectItem(e,t){super.selectItem(e,t);const s=this.label.querySelector(".ql-color-label"),l=e&&e.getAttribute("data-value")||"";s&&(s.tagName==="line"?s.style.stroke=l:s.style.fill=l)}}class Jc extends Sl{constructor(e,t){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(s=>{s.innerHTML=t[s.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,t){super.selectItem(e,t);const s=e||this.defaultItem;if(s!=null){if(this.label.innerHTML===s.innerHTML)return;this.label.innerHTML=s.innerHTML}}}const uy=n=>{const{overflowY:e}=getComputedStyle(n,null);return e!=="visible"&&e!=="clip"};class Xc{constructor(e,t){this.quill=e,this.boundsContainer=t||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,uy(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const t=e.left+e.width/2-this.root.offsetWidth/2,s=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${t}px`,this.root.style.top=`${s}px`,this.root.classList.remove("ql-flip");const l=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect();let o=0;if(i.right>l.right&&(o=l.right-i.right,this.root.style.left=`${t+o}px`),i.left<l.left&&(o=l.left-i.left,this.root.style.left=`${t+o}px`),i.bottom>l.bottom){const r=i.bottom-i.top,c=e.bottom-e.top+r;this.root.style.top=`${s-c}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const dy=[!1,"center","right","justify"],my=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],py=[!1,"serif","monospace"],gy=["1","2","3",!1],fy=["small",!1,"large","huge"];class wn extends Ns{constructor(e,t){super(e,t);const s=l=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",s);return}this.tooltip!=null&&!this.tooltip.root.contains(l.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(i=>{i.container.contains(l.target)||i.close()})};e.emitter.listenDOM("click",document.body,s)}addModule(e){const t=super.addModule(e);return e==="toolbar"&&this.extendToolbar(t),t}buildButtons(e,t){Array.from(e).forEach(s=>{(s.getAttribute("class")||"").split(/\s+/).forEach(i=>{if(!!i.startsWith("ql-")&&(i=i.slice(3),t[i]!=null))if(i==="direction")s.innerHTML=t[i][""]+t[i].rtl;else if(typeof t[i]=="string")s.innerHTML=t[i];else{const o=s.value||"";o!=null&&t[i][o]&&(s.innerHTML=t[i][o])}})})}buildPickers(e,t){this.pickers=Array.from(e).map(l=>{if(l.classList.contains("ql-align")&&(l.querySelector("option")==null&&Xs(l,dy),typeof t.align=="object"))return new Jc(l,t.align);if(l.classList.contains("ql-background")||l.classList.contains("ql-color")){const i=l.classList.contains("ql-background")?"background":"color";return l.querySelector("option")==null&&Xs(l,my,i==="background"?"#ffffff":"#000000"),new Gc(l,t[i])}return l.querySelector("option")==null&&(l.classList.contains("ql-font")?Xs(l,py):l.classList.contains("ql-header")?Xs(l,gy):l.classList.contains("ql-size")&&Xs(l,fy)),new Sl(l)});const s=()=>{this.pickers.forEach(l=>{l.update()})};this.quill.on(xe.events.EDITOR_CHANGE,s)}}wn.DEFAULTS=$a({},Ns.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let n=this.container.querySelector("input.ql-image[type=file]");n==null&&(n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),n.classList.add("ql-image"),n.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,n.files),n.value=""}),this.container.appendChild(n)),n.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class Qc extends Xc{constructor(e,t){super(e,t),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;t!=null?this.textbox.value=t:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const s=this.quill.getBounds(this.quill.selection.savedRange);s!=null&&this.position(s),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:t}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,xe.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,xe.sources.USER)),this.quill.root.scrollTop=t;break}case"video":e=hy(e);case"formula":{if(!e)break;const t=this.quill.getSelection(!0);if(t!=null){const s=t.index+t.length;this.quill.insertEmbed(s,this.root.getAttribute("data-mode"),e,xe.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(s+1," ",xe.sources.USER),this.quill.setSelection(s+2,xe.sources.USER)}break}}this.textbox.value="",this.hide()}}function hy(n){let e=n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=n.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:n}function Xs(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(s=>{const l=document.createElement("option");s===t?l.setAttribute("selected","selected"):l.setAttribute("value",String(s)),n.appendChild(l)})}const vy=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class _y extends Qc{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,t){super(e,t),this.quill.on(xe.events.EDITOR_CHANGE,(s,l,i,o)=>{if(s===xe.events.SELECTION_CHANGE)if(l!=null&&l.length>0&&o===xe.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const r=this.quill.getLines(l.index,l.length);if(r.length===1){const c=this.quill.getBounds(l);c!=null&&this.position(c)}else{const c=r[r.length-1],m=this.quill.getIndex(c),g=Math.min(c.length()-1,l.index+l.length-m),f=this.quill.getBounds(new Za(m,g));f!=null&&this.position(f)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(xe.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const t=this.quill.getBounds(e);t!=null&&this.position(t)}},1)})}cancel(){this.show()}position(e){const t=super.position(e),s=this.root.querySelector(".ql-tooltip-arrow");return s.style.marginLeft="",t!==0&&(s.style.marginLeft=`${-1*t-s.offsetWidth/2}px`),t}}class Kc extends wn{constructor(e,t){t.modules.toolbar!=null&&t.modules.toolbar.container==null&&(t.modules.toolbar.container=vy),super(e,t),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new _y(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),mn),this.buildPickers(e.container.querySelectorAll("select"),mn))}}Kc.DEFAULTS=$a({},wn.DEFAULTS,{modules:{toolbar:{handlers:{link(n){n?this.quill.theme.tooltip.edit():this.quill.format("link",!1,oe.sources.USER)}}}}});const yy=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class by extends Qc{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const t=this.linkRange;this.restoreFocus(),this.quill.formatText(t,"link",!1,xe.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(xe.events.SELECTION_CHANGE,(e,t,s)=>{if(e!=null){if(e.length===0&&s===xe.sources.USER){const[l,i]=this.quill.scroll.descendant(rl,e.index);if(l!=null){this.linkRange=new Za(e.index-i,l.length());const o=rl.formats(l.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const r=this.quill.getBounds(this.linkRange);r!=null&&this.position(r);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class eu extends wn{constructor(e,t){t.modules.toolbar!=null&&t.modules.toolbar.container==null&&(t.modules.toolbar.container=yy),super(e,t),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),mn),this.buildPickers(e.container.querySelectorAll("select"),mn),this.tooltip=new by(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(t,s)=>{e.handlers.link.call(e,!s.format.link)}))}}eu.DEFAULTS=$a({},wn.DEFAULTS,{modules:{toolbar:{handlers:{link(n){if(n){const e=this.quill.getSelection();if(e==null||e.length===0)return;let t=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(t)&&t.indexOf("mailto:")!==0&&(t=`mailto:${t}`);const{tooltip:s}=this.quill.theme;s.edit("link",t)}else this.quill.format("link",!1,oe.sources.USER)}}}}});oe.register({"attributors/attribute/direction":Bc,"attributors/class/align":Nc,"attributors/class/background":T_,"attributors/class/color":w_,"attributors/class/direction":Fc,"attributors/class/font":qc,"attributors/class/size":jc,"attributors/style/align":Dc,"attributors/style/background":_o,"attributors/style/color":vo,"attributors/style/direction":Vc,"attributors/style/font":Uc,"attributors/style/size":zc},!0);oe.register({"formats/align":Nc,"formats/direction":Fc,"formats/indent":v1,"formats/background":_o,"formats/color":vo,"formats/font":qc,"formats/size":jc,"formats/blockquote":_1,"formats/code-block":At,"formats/header":y1,"formats/list":xn,"formats/bold":xo,"formats/code":yo,"formats/italic":b1,"formats/link":rl,"formats/script":k1,"formats/strike":C1,"formats/underline":x1,"formats/formula":w1,"formats/image":T1,"formats/video":S1,"modules/syntax":Zc,"modules/table":L1,"modules/toolbar":To,"themes/bubble":Kc,"themes/snow":eu,"ui/icons":mn,"ui/picker":Sl,"ui/icon-picker":Jc,"ui/color-picker":Gc,"ui/tooltip":Xc},!0);const ky={props:{content:String,value:String,disabled:{type:Boolean,default:!1},options:{type:Object,default:()=>({})}},emits:["ready","change","input","blur","focus","update:value"],setup(n,{emit:e}){const t=n,s={theme:"snow",boundary:document.body,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},placeholder:"Insert content here ...",readOnly:!1},l=g=>{const f=new MutationObserver(v=>{v.forEach(()=>{})});return f.observe(g,{childList:!0,subtree:!0}),f},i=M(null);let o=null,r="";const c=(g,f)=>{for(const v in f)!g[v]||v!=="modules"?g[v]=f[v]:c(g[v],f[v]);return g},m=()=>{if(i.value){const g=c(s,t.options);g.readOnly=!!t.disabled,o=new oe(i.value,g),t.value&&o.clipboard.dangerouslyPasteHTML(t.value),o.on("selection-change",f=>{e(f?"focus":"blur",o)}),o.on("text-change",()=>{t.disabled&&o.enable(!1);let f=i.value.children[0].innerHTML;const v=o.getText();f==="<p><br></p>"&&(f=""),r=f,e("update:value",r),e("change",{html:f,text:v,quill:o})}),e("ready",o)}};return rt(()=>t.value,g=>{o&&g!==r?(r=g,o.clipboard.dangerouslyPasteHTML(g)):g||o.setText("")}),rt(()=>t.disabled,g=>{o&&o.enable(!g)}),Je(()=>{if(m(),i.value){const g=l(i.value);Io(()=>{g.disconnect()})}}),Lu(()=>{const g=i.value.previousSibling;g&&g.nodeType===1&&g.className.indexOf("ql-toolbar")>-1&&g.parentNode.removeChild(g)}),Io(()=>{o=null}),(g,f)=>(u(),x("section",{ref_key:"editor",ref:i},null,512))}};const Cy={class:"am-desc-editor__header"},xy={class:"am-desc-editor__header-warning"},wy=d("span",{class:"am-icon-triangle-info"},null,-1),Ty={key:1,class:"am-quill-wrapper"},tu={props:{modelValue:{type:String,default:""},mode:{type:String,default:"html"}},emits:["update:modelValue","setMode"],setup(n,{emit:e}){const t=n;let s=F("amLabels"),l=M(t.mode),i=_({get:()=>t.modelValue,set:f=>{e("update:modelValue",f)}});function o(){l.value="text",e("setMode","text")}function r(){l.value="html",e("setMode","html")}const c={theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]]},readOnly:!1};let m=F("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),g=_(()=>({"--am-c-desce-text-op03":W(m.value.colorMainText,.03),"--am-c-desce-warn-op10":W(m.value.colorWarning,.1)}));return(f,v)=>a(l)?(u(),x("div",{key:0,class:"am-desc-editor",style:be(a(g))},[d("div",Cy,[$(Au,null,{default:S(()=>[$(ke,{category:a(l)==="text"?"primary":"secondary",type:a(l)==="text"?"filled":"plain",size:"small",onClick:o},{default:S(()=>[ie(w(a(s).text_mode),1)]),_:1},8,["category","type"]),$(ke,{category:a(l)==="html"?"primary":"secondary",type:a(l)==="html"?"filled":"plain",size:"small",onClick:r},{default:S(()=>[ie(w(a(s).html_mode),1)]),_:1},8,["category","type"])]),_:1}),d("div",xy,[wy,ie(" "+w(a(s).content_mode_tooltip),1)])]),a(l)==="html"?(u(),q(St,{key:0,modelValue:a(i),"onUpdate:modelValue":v[0]||(v[0]=k=>ye(i)?i.value=k:i=k),type:"textarea",rows:3,style:{width:"100%"}},null,8,["modelValue"])):N("",!0),a(l)==="text"?(u(),x("div",Ty,[$(ky,{value:a(i),"onUpdate:value":v[1]||(v[1]=k=>ye(i)?i.value=k:i=k),options:c},null,8,["value"])])):N("",!0)],4)):N("",!0)}};const Sy=["innerHTML"],Ey={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:e}){const t=n,s=Ie(),l=F("settings");let i=F("amLabels"),o=_(()=>s.getters["entities/getEmployee"](s.getters["employee/getId"])),r=_(()=>s.getters["entities/getLocations"]),c=_(()=>r.value.map(y=>({value:y.id,label:y.name}))),m=M(null),g=M(!1),f=M({firstName:_({get:()=>s.getters["employee/getFirstName"],set:y=>{s.commit("employee/setFirstName",y||"")}}),lastName:_({get:()=>s.getters["employee/getLastName"],set:y=>{s.commit("employee/setLastName",y||"")}}),email:_({get:()=>s.getters["employee/getEmail"],set:y=>{s.commit("employee/setEmail",y||"")}}),phone:_({get:()=>s.getters["employee/getPhone"],set:y=>{s.commit("employee/setPhone",y||"")}}),locationId:_({get:()=>s.getters["employee/getLocationId"],set:y=>{s.commit("employee/setLocationId",y||"")}}),description:_({get:()=>s.getters["employee/getDescription"],set:y=>{s.commit("employee/setDescription",y||"")}})}),v=_(()=>({firstName:[{required:!0,message:i.enter_first_name_warning,trigger:["submit","change"]}],lastName:[{required:!0,message:i.enter_last_name_warning,trigger:["submit","change"]}],email:[{required:!0,message:i.enter_email_warning,trigger:["submit","change"]}],locationId:[{required:r.value.filter(y=>y.status==="visible").length>0,message:i.enter_location_warning,trigger:["submit","change"]}]})),k=M({firstName:{template:Ye.text,props:{itemName:"firstName",label:i.first_name_colon,placeholder:i.enter_first_name,class:_(()=>`am-caepif__item ${t.responsiveClass}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:i.last_name_colon,placeholder:i.enter_last_name,class:_(()=>`am-caepif__item ${t.responsiveClass}`)}},email:{template:Ye.text,props:{itemName:"email",label:i.email_colon,placeholder:i.enter_email,class:_(()=>`am-caepif__item ${t.responsiveClass}`)}},phone:{countryPhoneIso:_({get:()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:"",set:y=>{s.commit("auth/setProfileCountryPhoneIso",y?y.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:i.phone_colon,placeholder:i.enter_phone,defaultCode:_(()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:""),phoneError:_(()=>g.value),whatsAppLabel:i.whatsapp_opt_in_text,isWhatsApp:l.notifications.whatsAppEnabled&&l.notifications.whatsAppAccessToken&&l.notifications.whatsAppBusinessID&&l.notifications.whatsAppPhoneID,class:_(()=>`am-caepif__item ${t.responsiveClass}`)}}}),T=M({locationId:{template:Ye.select,props:{itemName:"locationId",label:`${i.location}:`,placeholder:i.select_location,class:_(()=>`am-caepif__item ${t.responsiveClass} ${l.zoom.enabled||"am-w-100"}`),options:c.value}}});return gn(()=>{r.value.length||delete T.value.locationId}),e({employeeFormRef:m}),(y,b)=>{const L=xt,E=et;return u(),q(E,{ref_key:"employeeFormRef",ref:m,model:a(f),rules:a(v),"label-position":"top",class:R(["am-caepif",t.responsiveClass])},{default:S(()=>[d("div",{class:R(["am-caepif__block",[{"am-w-70":a(o).pictureFullPath},t.responsiveClass]])},[(u(!0),x(ee,null,pe(a(k),(C,h)=>(u(),q(Ct(C.template),Nt({key:h,ref_for:!0,ref:"customerCollectorRef",modelValue:a(f)[h],"onUpdate:modelValue":I=>a(f)[h]=I,countryPhoneIso:C.countryPhoneIso,"onUpdate:countryPhoneIso":I=>C.countryPhoneIso=I},C.props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))],2),a(o).pictureFullPath?(u(),x("div",{key:0,class:R(["am-caepif__block am-w-30",t.responsiveClass])},[d("div",{class:"am-caepif__img",style:be({backgroundImage:`url(${a(o).pictureFullPath})`})},null,4)],2)):N("",!0),d("div",{class:R(["am-caepif__block",t.responsiveClass])},[(u(!0),x(ee,null,pe(a(T),(C,h)=>(u(),q(Ct(C.template),Nt({key:h,ref_for:!0,ref:"customerCollectorRef",modelValue:a(f)[h],"onUpdate:modelValue":I=>a(f)[h]=I},C.props,Ji(C.handlers?C.handlers:{})),{default:S(()=>[C.slots&&C.slots.default?(u(),x("div",{key:0,innerHTML:C.slots.default},null,8,Sy)):N("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128)),$(L,{label:a(i).description_colon},{default:S(()=>[$(tu,{modelValue:a(f).description,"onUpdate:modelValue":b[0]||(b[0]=C=>a(f).description=C),mode:a(s).getters["employee/getDescriptionMode"],onSetMode:b[1]||(b[1]=C=>a(s).commit("employee/setDescriptionMode",C))},null,8,["modelValue","mode"])]),_:1},8,["label"])],2)]),_:1},8,["model","rules","class"])}}};const Ly={class:"am-caes__category-header"},Ay={class:"am-caes__category-header__text"},$y={class:"am-caes__service-header"},Iy={class:"am-caes__service-header__text"},Oy={class:"am-caes__service-content"},Py={class:"am-caes__service-content__text"},Ny={class:"am-caes__service-content__text"},Dy={class:"am-caes__service-content__text"},My={class:"am-caes__service-content__inner am-caes__service-content__disabled"},By={class:"am-caes__service-content__text"},Fy={name:"CabinetEmployeeProfileServices"},Vy=Object.assign(Fy,{props:{responsiveClass:{type:String,default:""}},setup(n){const e=n;let t=Ie(),s=F("amLabels"),l=M(""),i={components:{IconComponent:He},template:'<IconComponent icon="search"/>'},o=M({}),r=_(()=>t.getters["employee/getEmployee"]),c=_(()=>t.getters["entities/getCategories"].filter(b=>b.status==="visible"&&b.serviceList.length>0&&(!l.value.trim()||b.serviceList.filter(L=>L.name.toLowerCase().includes(l.value.toLowerCase().trim())).length))),m=_(()=>c.value.length===1?"category_"+c.value[0].id:null),g=M(0);function f(b){const L=b.serviceList.filter(E=>r.value.serviceList[b.id][E.id].enabled);return L.length>0&&L.length<b.serviceList.length}function v(b){const L=b.serviceList.filter(E=>r.value.serviceList[b.id][E.id].enabled);o.value[b.id]=L.length!==0}function k(b,L){L.serviceList.forEach(E=>{t.commit("employee/setServiceEnabled",{categoryId:L.id,serviceId:E.id,value:b})})}Je(()=>{c.value.forEach(b=>{o.value[b.id]=b.serviceList.filter(L=>r.value.serviceList[b.id][L.id].enabled).length!==0})});let T=F("amColors"),y=_(()=>({"--am-c-caes-primary":T.value.colorPrimary,"--am-c-caes-text":T.value.colorMainText,"--am-c-caes-text-op03":W(T.value.colorMainText,.03),"--am-c-caes-inp-bgr-op03":W(T.value.colorInpBgr,.03)}));return(b,L)=>{const E=Is,C=Os;return u(),x("div",null,[d("div",null,[$(St,{modelValue:a(l),"onUpdate:modelValue":L[0]||(L[0]=h=>ye(l)?l.value=h:l=h),"icon-start":a(i)},null,8,["modelValue","icon-start"])]),$(C,{modelValue:a(m),"onUpdate:modelValue":L[2]||(L[2]=h=>ye(m)?m.value=h:m=h),class:"am-caes",style:be(a(y))},{default:S(()=>[(u(!0),x(ee,null,pe(a(c),h=>(u(),q(E,{key:"category_"+h.id,name:"category_"+h.id,class:"am-caes__category"},{title:S(()=>[d("div",Ly,[$(ft,{modelValue:a(o)[h.id],"onUpdate:modelValue":I=>a(o)[h.id]=I,indeterminate:f(h),onClick:I=>{I.stopPropagation(),ye(m)?m.value=`category_${h.id}`:m=`category_${h.id}`},onChange:I=>k(I,h)},null,8,["modelValue","onUpdate:modelValue","indeterminate","onClick","onChange"]),d("div",Ay,w(h.name),1)])]),default:S(()=>[$(C,{modelValue:a(g),"onUpdate:modelValue":L[1]||(L[1]=I=>ye(g)?g.value=I:g=I),class:"am-caes__inner"},{default:S(()=>[(u(!0),x(ee,null,pe(a(c).find(I=>I.id===h.id).serviceList.filter(I=>!a(l).trim()||I.name.toLowerCase().includes(a(l).toLowerCase())),I=>(u(),q(E,{key:`service_${I.id}`,name:`service_${I.id}`,class:"am-caes__service"},{title:S(()=>[d("div",$y,[$(ft,{modelValue:a(r).serviceList[h.id][I.id].enabled,"onUpdate:modelValue":O=>a(r).serviceList[h.id][I.id].enabled=O,onClick:O=>{O.stopPropagation(),ye(g)?g.value=`service_${I.id}`:g=`service_${I.id}`},onChange:O=>v(h)},null,8,["modelValue","onUpdate:modelValue","onClick","onChange"]),d("div",Iy,w(I.name),1)])]),default:S(()=>[d("div",Oy,[d("div",{class:R(["am-caes__service-content__item",e.responsiveClass])},[d("div",Py,w(a(s).minimum_capacity),1),$(ht,{modelValue:a(r).serviceList[h.id][I.id].minCapacity,"onUpdate:modelValue":O=>a(r).serviceList[h.id][I.id].minCapacity=O,class:"am-caes__service-content__inner",min:1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])],2),d("div",{class:R(["am-caes__service-content__item",e.responsiveClass])},[d("div",Ny,w(a(s).maximum_capacity),1),$(ht,{modelValue:a(r).serviceList[h.id][I.id].maxCapacity,"onUpdate:modelValue":O=>a(r).serviceList[h.id][I.id].maxCapacity=O,class:"am-caes__service-content__inner",min:a(r).serviceList[h.id][I.id].minCapacity,size:"small"},null,8,["modelValue","onUpdate:modelValue","min"])],2),(u(!0),x(ee,null,pe(a(r).serviceList[h.id][I.id].customPricing.durations,(O,A)=>(u(),x(ee,{key:A},[d("div",{class:R(["am-caes__service-content__item",e.responsiveClass])},[d("div",Dy,w(a(s).duration),1),d("div",My,w(a(fn)(A,a(s).h,a(s).min)),1)],2),d("div",{class:R(["am-caes__service-content__item",e.responsiveClass])},[d("div",By,w(a(s).price),1),$(St,{modelValue:O.price,"onUpdate:modelValue":D=>O.price=D,class:"am-caes__service-content__inner",placeholder:"",size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue"])],2)],64))),128))])]),_:2},1032,["name"]))),128))]),_:2},1032,["modelValue"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])])}}});const Aa={props:{modelValue:{type:String},id:{type:String,default:""},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},placeholder:{type:String,default:""},start:{type:String,default:""},end:{type:String,default:""},step:{type:String,default:""},minTime:{type:String,default:""},maxTime:{type:String,default:""},name:{type:String,default:""},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:He},template:'<IconComponent icon="clock"/>'})},suffixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:He},template:'<IconComponent icon="arrow-up"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:He},template:'<IconComponent icon="close"/>'})},appendToBody:{type:Boolean,default:!0},popperClass:{type:String,default:""},class:{type:String,default:""},parentClass:{type:String,default:""},format:{type:String,default:"HH:mm"}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,{modelValue:s}=Xn(t),l=_({get:()=>s.value,set:m=>{e("update:modelValue",m)}}),i=M(null);Je(()=>{i.value.select.popperPaneRef.style.setProperty("--am-c-option-bgr",r.value.colorDropBgr),i.value.select.popperPaneRef.style.setProperty("--am-c-option-border",r.value.colorDropBorder),i.value.select.popperPaneRef.style.setProperty("--am-c-option-text",r.value.colorDropText),i.value.select.popperPaneRef.style.setProperty("--am-c-option-text-op65",W(r.value.colorDropText,.65)),i.value.select.popperPaneRef.style.setProperty("--am-c-option-text-op50",W(r.value.colorDropText,.5)),i.value.select.popperPaneRef.style.setProperty("--am-c-option-hover",W(r.value.colorDropText,.1)),i.value.select.popperPaneRef.style.setProperty("--am-c-option-selected",r.value.colorPrimary),i.value.select.popperPaneRef.style.setProperty("--am-c-option-selected-op10",W(r.value.colorPrimary,.1)),i.value.select.popperPaneRef.style.setProperty("--am-c-option-img-bgr",r.value.colorSuccess),i.value.select.popperPaneRef.style.setProperty("--am-c-option-img-text",r.value.colorMainBgr),i.value.select.popperPaneRef.style.setProperty("--am-font-family",o.value.fontFamily)});let o=F("amFonts",M({fontFamily:"Amelia Roboto, sans-serif",fontUrl:"",customFontFamily:"",fontFormat:"",customFontSelected:!1})),r=F("amColors",M({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),c=_(()=>({"--am-c-timeselect-bgr":r.value.colorInpBgr,"--am-c-timeselect-border":r.value.colorInpBorder,"--am-c-timeselect-text":r.value.colorInpText,"--am-c-timeselect-placeholder":r.value.colorInpPlaceHolder,"--am-c-timeselect-shadow":W(r.value.colorInpText,.05),"--am-c-timeselect-text-op60":W(r.value.colorInpText,.6),"--am-c-timeselect-text-op40":W(r.value.colorInpText,.4),"--am-c-timeselect-text-op10":W(r.value.colorInpText,.03),"--am-font-family":o.value.fontFamily}));return(m,g)=>{const f=$u;return u(),x("div",{class:R(["am-time-select__wrapper",n.parentClass]),style:be(a(c))},[$(f,{id:n.id,ref_key:"amTimeSelect",ref:i,modelValue:a(l),"onUpdate:modelValue":g[0]||(g[0]=v=>ye(l)?l.value=v:null),class:R(["am-time-select",[`am-time-select--${n.size}`,{"am-time-select--disabled":n.disabled},t.class]]),disabled:n.disabled,placeholder:n.placeholder,"append-to-body":n.appendToBody,"clear-icon":n.clearIcon,clearable:n.clearable,editable:n.editable,name:n.name,"popper-class":`am-time-select__popper${n.popperClass?" "+n.popperClass:n.popperClass}`,"prefix-icon":n.prefixIcon,"suffix-icon":n.suffixIcon,end:n.end,"max-time":n.maxTime,"min-time":n.minTime,start:n.start,step:n.step,format:n.format},null,8,["id","modelValue","class","disabled","placeholder","append-to-body","clear-icon","clearable","editable","name","popper-class","prefix-icon","suffix-icon","end","max-time","min-time","start","step","format"])],6)}}};const Ry={class:"am-csd__period-header"},qy={class:"am-csd__period-content__inner"},Uy=d("span",{class:"am-icon-clearable"},null,-1),jy={name:"WorkPeriod"},zy=Object.assign(jy,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},periodIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=n;let s=Ie();const l=F("settings");let i=F("amLabels"),o=F("pageWidth"),r=M(null),c=_(()=>t.visibility);const{width:m}=Ka(r),g=_(()=>tt(m.value));rt(c,K=>{K&&setTimeout(()=>{y.value=JSON.parse(JSON.stringify(O.value[t.periodIndex]))},300)});let f=M(!1),v=M(null),k=M("");function T(){f.value=!1,k.value=""}let y=M(null),b=M({startTime:_({get:()=>A.value.startTime,set:K=>{A.value.startTime=K}}),endTime:_({get:()=>A.value.endTime,set:K=>{A.value.endTime=K}}),periodServiceList:_({get:()=>A.value.periodServiceList,set:K=>{A.value.periodServiceList=K}}),periodLocationList:_({get:()=>A.value.periodLocationList,set:K=>{A.value.periodLocationList=K}})}),L=M(null),E=_(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),C=M();Be("formWrapper",C);let h=M(s.getters["entities/getLocations"]),I=_(()=>{let K=Rr(s),Q=A.value.periodServiceList.filter(le=>K.map(H=>H.id).indexOf(le)===-1);return K.concat(s.getters["entities/getServices"].filter(le=>Q.indexOf(le.id)!==-1))}),O=_(()=>s.getters["employee/getEmployee"][t.origin][t.originIndex].periodList),A=_(()=>t.periodIndex!==null?O.value[t.periodIndex]:null);function D(K){return Mt(qt(K)-l.general.timeSlotLength)}function V(K){let Q=Mt(qt(K)+l.general.timeSlotLength);return Q==="00:00"?null:Q}function z(){L.value.validate(K=>{K?e("close"):console.log(111)})}function B(){t.isNew?O.value.pop():O.value[t.periodIndex]=y.value,e("close")}let J=F("amFonts"),G=F("amColors"),X=_(()=>({"--am-c-csd-text":G.value.colorMainText,"--am-c-csd-bgr":G.value.colorMainBgr,"--am-c-csd-text-op10":W(G.value.colorMainText,.1),"--am-c-scroll-op30":W(G.value.colorPrimary,.3),"--am-c-scroll-op10":W(G.value.colorPrimary,.1),"--am-font-family":J.value.fontFamily}));return(K,Q)=>{const le=xt,H=et;return u(),q(Ja,{visibility:a(t).visibility,style:be(a(X)),"custom-class":`am-csd am-csd__period${a(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":B},qr({footer:S(()=>[d("div",{class:R(["am-csd__period-footer",a(g)])},[$(ke,{category:"secondary",type:"plain",size:a(o)>430?"default":"small",onClick:B},{default:S(()=>[ie(w(a(i).cancel),1)]),_:1},8,["size"]),$(ke,{size:a(o)>430?"default":"small",onClick:z},{default:S(()=>[ie(w(a(i).save),1)]),_:1},8,["size"])],2)]),default:S(()=>[a(A)?(u(),x("div",{key:0,ref_key:"popupPeriodRef",ref:r,class:"am-csd__period-content"},[d("div",qy,[a(f)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:v,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:T,onTriggerClose:T},{title:S(()=>[Uy,ie(" "+w(a(k)),1)]),_:1},512)):N("",!0),$(H,{ref_key:"periodFormRef",ref:L,class:"am-csd__period-form",rules:a(E),model:a(b),"label-position":"top"},{default:S(()=>[$(le,{label:`${a(i).time}:`,prop:"startTime",class:R(["am-csd__period-form__item am-w-50",a(g)])},{default:S(()=>[$(Aa,{modelValue:a(A).startTime,"onUpdate:modelValue":Q[0]||(Q[0]=se=>a(A).startTime=se),placeholder:a(i).from,start:"00:00",end:D("24:00"),"min-time":a(t).periodIndex===0?null:D(a(O)[a(t).periodIndex-1].endTime),"max-time":a(t).periodIndex===a(O).length-1?null:a(A).endTime,step:a(Mt)(a(l).general.timeSlotLength)},null,8,["modelValue","placeholder","end","min-time","max-time","step"])]),_:1},8,["label","class"]),$(le,{label:`${a(i).time}:`,prop:"endTime",class:R(["am-csd__period-form__item am-w-50",a(g)])},{default:S(()=>[$(Aa,{modelValue:a(A).endTime,"onUpdate:modelValue":Q[1]||(Q[1]=se=>a(A).endTime=se),placeholder:a(i).to_upper,disabled:!a(A).startTime,start:V("00:00"),end:"24:00","min-time":a(A).startTime,"max-time":a(t).periodIndex===a(O).length-1?null:V(a(O)[a(t).periodIndex+1].startTime),step:a(Mt)(a(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","min-time","max-time","step"])]),_:1},8,["label","class"]),$(le,{label:`${a(i).heading_services}:`,prop:"periodServiceList",class:"am-csd__period-form__item"},{default:S(()=>[$(We,{modelValue:a(A).periodServiceList,"onUpdate:modelValue":Q[2]||(Q[2]=se=>a(A).periodServiceList=se),placeholder:`${a(i).all_services}`,multiple:""},{default:S(()=>[(u(!0),x(ee,null,pe(a(I),se=>(u(),q(Ve,{key:se.id,value:se.id,label:se.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(h).length>0?(u(),q(le,{key:0,label:`${a(i).location}:`,prop:"periodLocationList",class:"am-csd__period-form__item"},{default:S(()=>[$(We,{modelValue:a(A).periodLocationList,"onUpdate:modelValue":Q[3]||(Q[3]=se=>a(A).periodLocationList=se),placeholder:`${a(i).all_locations}`,multiple:""},{default:S(()=>[(u(!0),x(ee,null,pe(a(h),se=>(u(),q(Ve,{key:se.id,value:se.id,label:se.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["rules","model"])])],512)):N("",!0)]),_:2},[a(t).title?{name:"header",fn:S(()=>[d("div",Ry,w(a(t).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const Yy={class:"am-csd__timeOut-header"},Wy={class:"am-csd__timeOut-content__inner"},Hy=d("span",{class:"am-icon-clearable"},null,-1),Zy={name:"WorkTimeOut"},Gy=Object.assign(Zy,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},timeOutIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const t=n;let s=Ie();const l=F("settings");let i=F("amLabels"),o=F("pageWidth"),r=M(null),c=_(()=>t.visibility);const{width:m}=Ka(r),g=_(()=>tt(m.value));rt(c,X=>{X&&setTimeout(()=>{y.value=JSON.parse(JSON.stringify(h.value[t.timeOutIndex]))},300)});let f=M(!1),v=M(null),k=M("");function T(){f.value=!1,k.value=""}let y=M(null),b=M({startTime:_({get:()=>O.value.startTime,set:X=>{O.value.startTime=X}}),endTime:_({get:()=>O.value.endTime,set:X=>{O.value.endTime=X}})}),L=M(null),E=_(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),C=M();Be("formWrapper",C);let h=_(()=>s.getters["employee/getEmployee"][t.origin][t.originIndex].timeOutList),I=_(()=>s.getters["employee/getEmployee"][t.origin][t.originIndex].periodList),O=_(()=>t.timeOutIndex!==null?h.value[t.timeOutIndex]:null);_(()=>I.value.length?D(I.value[0].startTime):"00:00"),_(()=>I.value.length?A(I.value[I.value.length-1].endTime):"00:00");function A(X){return Mt(qt(X)-l.general.timeSlotLength)}function D(X){let K=Mt(qt(X)+l.general.timeSlotLength);return K==="00:00"?null:K}function V(){L.value.validate(X=>{X?e("close"):console.log(111)})}function z(){t.isNew?h.value.pop():h.value[t.timeOutIndex]=y.value,e("close")}let B=F("amFonts"),J=F("amColors"),G=_(()=>({"--am-c-csd-text":J.value.colorMainText,"--am-c-csd-bgr":J.value.colorMainBgr,"--am-c-csd-text-op10":W(J.value.colorMainText,.1),"--am-c-scroll-op30":W(J.value.colorPrimary,.3),"--am-c-scroll-op10":W(J.value.colorPrimary,.1),"--am-font-family":B.value.fontFamily}));return(X,K)=>{const Q=xt,le=et;return u(),q(Ja,{visibility:a(t).visibility,style:be(a(G)),"custom-class":`am-csd am-csd__timeOut${a(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":z},qr({footer:S(()=>[d("div",{class:R(["am-csd__timeOut-footer",a(g)])},[$(ke,{category:"secondary",type:"plain",size:a(o)>430?"default":"small",onClick:z},{default:S(()=>[ie(w(a(i).cancel),1)]),_:1},8,["size"]),$(ke,{size:a(o)>430?"default":"small",onClick:V},{default:S(()=>[ie(w(a(i).save),1)]),_:1},8,["size"])],2)]),default:S(()=>[a(O)?(u(),x("div",{key:0,ref_key:"popupTimeOutRef",ref:r,class:"am-csd__timeOut-content"},[d("div",Wy,[a(f)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:v,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:T,onTriggerClose:T},{title:S(()=>[Hy,ie(" "+w(a(k)),1)]),_:1},512)):N("",!0),$(le,{ref_key:"timeOutFormRef",ref:L,class:"am-csd__timeOut-form",rules:a(E),model:a(b),"label-position":"top"},{default:S(()=>[$(Q,{label:`${a(i).time}:`,prop:"startTime",class:R(["am-csd__timeOut-form__item am-w-50",a(g)])},{default:S(()=>[$(Aa,{modelValue:a(O).startTime,"onUpdate:modelValue":K[0]||(K[0]=H=>a(O).startTime=H),placeholder:a(i).from,start:D(a(I)[0].startTime),end:A(a(I)[a(I).length-1].endTime),step:a(Mt)(a(l).general.timeSlotLength),"max-time":a(h)[a(t).timeOutIndex].endTime},null,8,["modelValue","placeholder","start","end","step","max-time"])]),_:1},8,["label","class"]),$(Q,{label:`${a(i).time}:`,prop:"endTime",class:R(["am-csd__timeOut-form__item am-w-50",a(g)])},{default:S(()=>[$(Aa,{modelValue:a(O).endTime,"onUpdate:modelValue":K[1]||(K[1]=H=>a(O).endTime=H),placeholder:a(i).to_upper,disabled:!a(O).startTime,start:D(a(I)[0].startTime),end:A(a(I)[a(I).length-1].endTime),"min-time":a(h)[a(t).timeOutIndex].startTime,step:a(Mt)(a(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","end","min-time","step"])]),_:1},8,["label","class"])]),_:1},8,["rules","model"])])],512)):N("",!0)]),_:2},[a(t).title?{name:"header",fn:S(()=>[d("div",Yy,w(a(t).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const Jy={class:"am-cc__edit"},Xy=d("span",{class:"am-icon-edit"},null,-1),Qy={class:"am-cc__edit-text"},Ky=d("span",{class:"am-icon-search"},null,-1),eb={class:"am-cc__edit-text"},tb=d("span",{class:"am-icon-clearable"},null,-1),ab={class:"am-cc__edit-text"},sb=d("span",{class:"am-icon-clearable"},null,-1),nb={class:"am-cc__edit-text"},lb={name:"DotsPopup"},ka=Object.assign(lb,{props:{index:{type:Number,default:0},referenceClass:{type:String,default:""},haveDuplicate:{type:Boolean,default:!1},haveDelete:{type:Boolean,default:!0},haveEdit:{type:Boolean,default:!0},haveView:{type:Boolean,default:!1}},emits:["remove","edit","duplicate"],setup(n,{emit:e}){const t=n;let s=F("amLabels"),l=M(!1);function i(k){k.stopPropagation(),l.value=!l.value}function o(){e("edit",t.index),m()}function r(){e("remove",t.index),m()}function c(){e("duplicate",t.index),m()}function m(){l.value=!1}let g=F("amFonts"),f=F("amColors"),v=_(()=>({"--am-c-cc-error":f.value.colorError,"--am-c-cc-error-op15":W(f.value.colorError,.15),"--am-c-cc-bgr":f.value.colorMainBgr,"--am-c-cc-text":f.value.colorMainText,"--am-c-cc-text-op10":W(f.value.colorMainText,.1),"--am-c-cc-text-op15":W(f.value.colorMainText,.15),"--am-font-family":g.value.fontFamily}));return(k,T)=>{const y=hn;return u(),q(y,{ref:"editRef",visible:a(l),"onUpdate:visible":T[0]||(T[0]=b=>ye(l)?l.value=b:l=b),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(v),trigger:"click"},{reference:S(()=>[d("span",{class:R(["am-cc__edit-btn am-icon-dots-vertical",a(t).referenceClass]),onClick:i},null,2)]),default:S(()=>[Yt((u(),x("div",Jy,[a(t).haveEdit?(u(),x("div",{key:0,class:"am-cc__edit-item",onClick:o},[Xy,d("span",Qy,w(a(s).edit),1)])):N("",!0),a(t).haveView?(u(),x("div",{key:1,class:"am-cc__edit-item",onClick:o},[Ky,d("span",eb,w(a(s).view),1)])):N("",!0),a(t).haveDelete?(u(),x("div",{key:2,class:"am-cc__edit-item am-delete",onClick:r},[tb,d("span",ab,w(a(s).delete),1)])):N("",!0),a(t).haveDuplicate?(u(),x("div",{key:3,class:"am-cc__edit-item am-clone",onClick:c},[sb,d("span",nb,w(a(s).duplicate),1)])):N("",!0)])),[[a(ra),m]])]),_:1},8,["visible","popper-style"])}}});const ib={class:"am-caeper__heading-item am-w-20"},ob={class:"am-caeper__heading-item am-w-40"},rb={class:"am-caeper__heading-item am-w-40"},cb={key:1},ub={class:"am-caeper__heading-item am-w-20"},db={key:0,class:"am-caeper__error"},mb={name:"WorkPeriods"},au=Object.assign(mb,{props:{title:{type:String,default:""},type:{type:String,default:""},index:{type:Number,default:0},enabled:{type:Boolean,default:!1},headerVisible:{type:Boolean,default:!0},applyToAllDaysVisible:{type:Boolean,default:!0},footerVisible:{type:Boolean,default:!0},editVisible:{type:Boolean,default:!0},error:{type:String,default:""},responsiveClass:{type:String,default:""}},emits:["addPeriod"],setup(n,{emit:e}){const t=n;let s=Ie(),l=F("amLabels"),i=_(()=>s.getters["entities/getLocations"]),o=_(()=>s.getters["entities/getServices"]),r=_(()=>Rr(s)),c=_(()=>{let E=s.getters["employee/getEmployee"];switch(t.type){case"weekDayList":return E.weekDayList[t.index].periodList;case"specialDayList":return E.specialDayList[t.index].periodList}return[]}),m=_(()=>{let E=s.getters["employee/getEmployee"];return t.type==="weekDayList"?E.weekDayList[t.index].timeOutList:[]}),g=M(null),f=M(null),v=M(null);function k(){c.value.push({id:null,locationId:null,startTime:"",endTime:"",periodLocationList:[],periodServiceList:[],editing:!0}),v.value=!0,g.value=c.value.length-1,e("addPeriod")}function T(){let E=[];s.getters["employee/getEmployee"].weekDayList[t.index].periodList.forEach(C=>{E.push({id:null,locationId:null,startTime:C.startTime,endTime:C.endTime,periodLocationList:[...C.periodLocationList],periodServiceList:[...C.periodServiceList],editing:!1})}),s.getters["employee/getEmployee"].weekDayList.forEach((C,h)=>{h!==t.index&&(C.periodList=JSON.parse(JSON.stringify(E)))})}function y(){return!c.value.length||!c.value.filter(E=>E.startTime&&E.endTime).length||c.value[c.value.length-1].endTime!=="00:00"}let b=F("amColors"),L=_(()=>({"--am-c-caeper-bgr":b.value.colorMainBgr,"--am-c-caeper-text":b.value.colorMainText,"--am-c-caeper-text-op80":W(b.value.colorMainText,.8)}));return(E,C)=>Yt((u(),x("div",{class:"am-caeper",style:be(a(L))},[a(t).headerVisible&&a(c).length?(u(),x("div",{key:0,class:R(["am-caeper__heading",a(t).responsiveClass])},[d("div",ib,w(a(l).time),1),d("div",ob,w(a(l).service_colon),1),d("div",rb,w(a(l).location),1)],2)):N("",!0),(u(!0),x(ee,null,pe(a(c),(h,I)=>(u(),x("div",{key:I,class:"am-caeper__content"},[d("div",{class:R(["am-caeper__content-item am-w-20",a(t).responsiveClass])},w(h.startTime?h.startTime.substring(0,5):"")+" - "+w(h.endTime?h.endTime.substring(0,5):""),3),d("div",{class:R(["am-caeper__content-item am-w-40",[a(t).responsiveClass,{"am-cabinet-empty":!h.periodServiceList.length}]])},w(h.periodServiceList.filter(O=>a(r).map(A=>A.id).indexOf(O)!==-1).map(O=>a(o).find(A=>A.id===O).name).join(", ")),3),d("div",{class:R(["am-caeper__content-item am-w-40",[a(t).responsiveClass,{"am-cabinet-empty":!h.periodLocationList.length}]])},w(h.periodLocationList.map(O=>a(i).find(A=>A.id===O).name).join(", ")),3),a(t).editVisible?(u(),q(ka,{key:0,index:I,onRemove:O=>a(c).splice(I,1),onEdit:O=>ye(g)?g.value=I:g=I},null,8,["index","onRemove","onEdit"])):N("",!0)]))),128)),a(m).length?(u(),x("span",cb,w(a(l).breaks),1)):N("",!0),a(t).headerVisible&&a(m).length?(u(),x("div",{key:2,class:R(["am-caeper__heading",a(t).responsiveClass])},[d("div",ub,w(a(l).time),1)],2)):N("",!0),(u(!0),x(ee,null,pe(a(m),(h,I)=>(u(),x("div",{key:I,class:"am-caeper__content"},[d("div",{class:R(["am-caeper__content-item am-w-20",a(t).responsiveClass])},w(h.startTime?h.startTime.substring(0,5):"")+" - "+w(h.endTime?h.endTime.substring(0,5):""),3),a(t).editVisible?(u(),q(ka,{key:0,index:I,onRemove:O=>a(m).splice(I,1),onEdit:O=>ye(f)?f.value=I:f=I},null,8,["index","onRemove","onEdit"])):N("",!0)]))),128)),a(t).footerVisible?(u(),x("div",{key:3,class:R(["am-caeper__footer",[{"am-error":a(t).error},a(t).responsiveClass]])},[a(t).error?(u(),x("div",db,w(a(t).error),1)):N("",!0),y()?(u(),q(ke,{key:1,prefix:"plus",size:"small",onClick:C[0]||(C[0]=h=>k())},{default:S(()=>[ie(w(a(l).add_period),1)]),_:1})):N("",!0),a(t).applyToAllDaysVisible?(u(),q(ke,{key:2,size:"small",category:"secondary",type:"plain",onClick:T},{default:S(()=>[ie(w(a(l).apply_to_all_days),1)]),_:1})):N("",!0)],2)):N("",!0),$(zy,{title:a(t).title,visibility:a(g)!==null,origin:a(t).type,"period-index":a(g),"origin-index":n.index,"is-new":a(v),onClose:C[1]||(C[1]=()=>{ye(g)?g.value=null:g=null,ye(v)?v.value=null:v=null})},null,8,["title","visibility","origin","period-index","origin-index","is-new"]),$(Gy,{title:a(l).break_hours,visibility:a(f)!==null,origin:a(t).type,"time-out-index":a(f),"origin-index":n.index,"is-new":!1,"is-break":!0,onClose:C[2]||(C[2]=()=>{ye(f)?f.value=null:f=null})},null,8,["title","visibility","origin","time-out-index","origin-index"])],4)),[[Ur,a(t).enabled]])}});const pb={class:"am-caewh__header"},gb={class:"am-caewh__header-text"},fb={class:"am-caewh__content"},hb={name:"WeekDays"},vb=Object.assign(hb,{props:{responsiveClass:{type:String,default:""}},setup(n){const e=n;let t=Ie(),s=F("amLabels"),l=_(()=>t.getters["employee/getEmployee"]),i=M([{label:s.weekday_monday,value:"monday"},{label:s.weekday_tuesday,value:"tuesday"},{label:s.weekday_wednesday,value:"wednesday"},{label:s.weekday_thursday,value:"thursday"},{label:s.weekday_friday,value:"friday"},{label:s.weekday_saturday,value:"saturday"},{label:s.weekday_sunday,value:"sunday"}]),o=F("amColors"),r=_(()=>({"--am-c-caewh-primary":o.value.colorPrimary,"--am-c-caewh-bgr":o.value.colorMainBgr,"--am-c-caewh-text":o.value.colorMainText,"--am-c-caewh-text-op03":W(o.value.colorMainText,.03),"--am-c-caewh-bgr-op03":W(o.value.colorInpBgr,.03)}));return(c,m)=>(u(),x("div",{class:"am-caewh",style:be(a(r))},[(u(!0),x(ee,null,pe(a(l).weekDayList,(g,f)=>(u(),x("div",{key:f,class:"am-caewh__item"},[d("div",pb,[d("div",gb,w(a(i)[f].label),1),$(st,{modelValue:g.enabled,"onUpdate:modelValue":v=>g.enabled=v,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",fb,[$(au,{title:a(s).working_hours,enabled:g.enabled,index:f,type:"weekDayList","responsive-class":a(e).responsiveClass},null,8,["title","enabled","index","responsive-class"])])]))),128))],4))}});const _b={class:"am-ces__img-holder"},yb={width:"240",height:"195",viewBox:"0 0 240 195",fill:"none",xmlns:"http://www.w3.org/2000/svg"},bb={"clip-path":"url(#clip0_1811_81872)"},kb=["fill"],Cb=["fill"],xb=["fill"],wb=["fill"],Tb=["fill"],Sb=["fill"],Eb=["fill"],Lb={opacity:"0.5"},Ab=["fill"],$b=["fill"],Ib=["fill"],Ob=["fill"],Pb=["fill"],Nb=["stroke"],Db={opacity:"0.5"},Mb=["stroke"],Bb=Iu('<circle cx="109.964" cy="55.167" r="34.0723" transform="rotate(-45 109.964 55.167)" fill="url(#paint0_linear_1811_81872)" fill-opacity="0.7"></circle><mask id="mask0_1811_81872" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="75" y="21" width="69" height="69"><circle cx="109.714" cy="55.167" r="34.0723" transform="rotate(-45 109.714 55.167)" fill="url(#paint1_linear_1811_81872)"></circle></mask><g mask="url(#mask0_1811_81872)"><rect x="111.095" y="4.51782" width="10.0968" height="107.245" transform="rotate(30 111.095 4.51782)" fill="url(#paint2_linear_1811_81872)" fill-opacity="0.6"></rect><rect x="125.427" y="2.67041" width="3.39099" height="107.245" transform="rotate(30 125.427 2.67041)" fill="url(#paint3_linear_1811_81872)" fill-opacity="0.6"></rect></g>',3),Fb={id:"paint0_linear_1811_81872",x1:"144.037",y1:"91.6409",x2:"83.5731",y2:"31.1781",gradientUnits:"userSpaceOnUse"},Vb=["stop-color"],Rb=["stop-color"],qb={id:"paint1_linear_1811_81872",x1:"143.786",y1:"91.6409",x2:"83.3226",y2:"31.1781",gradientUnits:"userSpaceOnUse"},Ub=["stop-color"],jb=["stop-color"],zb={id:"paint2_linear_1811_81872",x1:"116.144",y1:"4.51782",x2:"116.144",y2:"111.763",gradientUnits:"userSpaceOnUse"},Yb=["stop-color"],Wb=["stop-color"],Hb={id:"paint3_linear_1811_81872",x1:"127.122",y1:"2.67041",x2:"127.122",y2:"109.915",gradientUnits:"userSpaceOnUse"},Zb=["stop-color"],Gb=["stop-color"],Jb={id:"clip0_1811_81872"},Xb=["fill"],Qb={class:"am-ces__content"},Kb={class:"am-ces__heading"},e0={class:"am-ces__text"},Na={props:{heading:{type:String,default:""},text:{type:String,default:""}},setup(n){const e=n;let t=F("amColors"),s=_(()=>({"--am-c-ces-text":t.value.colorMainText,"--am-c-ces-text-op70":W(t.value.colorMainText,.7)}));return(l,i)=>(u(),x("div",{class:"am-ces",style:be(a(s))},[d("div",_b,[(u(),x("svg",yb,[d("g",bb,[d("path",{d:"M10.0934 144.996C11.624 145.051 13.0595 145.879 14.0693 147.034C15.0791 148.184 15.6995 149.633 16.0934 151.114C16.8587 153.976 16.3878 157.359 15.5727 160.207C12.4708 159.097 10.5599 155.792 9.69496 154.053C8.32741 151.304 7.5259 145.513 10.0889 144.996",fill:a(t).colorMainText},null,8,kb),d("path",{d:"M20.033 163.676C19.0549 162.272 19.0322 160.32 19.8066 158.79C20.5809 157.264 22.0662 156.163 23.7009 155.661C24.4571 155.43 25.3356 155.33 25.9922 155.769C26.6081 156.181 26.8752 156.987 26.7937 157.721C26.7122 158.455 26.3409 159.129 25.9017 159.723C24.3937 161.765 22.5598 163.463 20.033 163.671",fill:a(t).colorMainText},null,8,Cb),d("path",{d:"M20.3771 173.244C20.3771 173.244 20.3137 173.036 20.2367 172.651C20.1552 172.225 20.0465 171.677 19.9198 171.021C19.6752 169.649 19.2858 167.697 19.5801 165.541C19.8609 163.395 20.7167 161.557 21.6133 160.461C22.0526 159.908 22.4782 159.514 22.7907 159.274C22.9401 159.148 23.076 159.071 23.1575 159.007C23.2435 158.948 23.2933 158.921 23.2979 158.93C23.3296 158.966 22.5733 159.437 21.7356 160.556C20.8888 161.656 20.0737 163.458 19.793 165.573C19.5032 167.688 19.8609 169.621 20.0692 170.998C20.1779 171.691 20.2684 172.252 20.3228 172.642C20.3726 173.031 20.3952 173.249 20.3771 173.249V173.244Z",fill:a(t).colorMainText},null,8,xb),d("path",{d:"M11.0894 149.357C11.0894 149.357 11.1392 149.434 11.2161 149.593C11.2977 149.769 11.4063 150 11.5377 150.281C11.8094 150.883 12.1988 151.757 12.6652 152.839C13.598 155.009 14.8478 158.024 16.152 161.38C17.4561 164.74 18.5656 167.81 19.3354 170.038C19.7203 171.152 20.0282 172.058 20.232 172.687C20.3271 172.986 20.4041 173.226 20.4629 173.412C20.5128 173.579 20.5354 173.665 20.5309 173.67C20.5263 173.674 20.4856 173.588 20.4222 173.425C20.3543 173.239 20.2637 173.004 20.155 172.714C19.9195 172.071 19.5935 171.179 19.195 170.088C18.3845 167.869 17.2524 164.812 15.9528 161.452C14.6486 158.097 13.426 155.076 12.5294 152.894C12.0901 151.821 11.7278 150.942 11.4652 150.308C11.3475 150.018 11.2569 149.783 11.1844 149.602C11.1211 149.439 11.0939 149.353 11.0984 149.348L11.0894 149.357Z",fill:a(t).colorMainText},null,8,wb),d("path",{d:"M16.6956 166.913C14.8662 163.802 11.4564 161.683 7.85639 161.421C6.94167 161.353 5.83676 161.507 5.42922 162.331C5.02167 163.155 5.56507 164.128 6.18997 164.808C8.78922 167.62 13.1817 168.602 16.7273 167.162",fill:a(t).colorMainText},null,8,Tb),d("path",{d:"M9.25113 163.875C9.25113 163.875 9.4549 163.87 9.82622 163.897C10.0119 163.911 10.2383 163.925 10.4964 163.974C10.7545 164.024 11.0534 164.051 11.3749 164.137C11.6964 164.214 12.0541 164.296 12.4209 164.427C12.7968 164.536 13.1817 164.699 13.5847 164.871C14.3817 165.233 15.233 165.709 16.0391 166.325C16.8406 166.95 17.5153 167.647 18.0677 168.331C18.3304 168.679 18.584 169.014 18.7832 169.354C19.0006 169.68 19.1636 170.006 19.313 170.3C19.476 170.59 19.5711 170.876 19.6798 171.116C19.7885 171.356 19.8519 171.573 19.9062 171.75C20.0149 172.103 20.0692 172.297 20.0557 172.302C20.0104 172.32 19.7885 171.528 19.1772 170.368C19.0187 170.083 18.8511 169.766 18.6292 169.449C18.43 169.119 18.1764 168.797 17.9092 168.457C17.3613 167.792 16.6911 167.113 15.9032 166.497C15.1108 165.89 14.2821 165.419 13.4987 165.052C13.1047 164.88 12.7243 164.713 12.3575 164.599C11.9998 164.463 11.6511 164.377 11.3341 164.287C10.0617 163.965 9.24207 163.92 9.2466 163.875H9.25113Z",fill:a(t).colorMainText},null,8,Sb),d("path",{d:"M91.9065 80.3956L75.8945 162.72L73.7979 173.497L180.693 172.972C185.488 172.95 189.74 168.688 191.285 162.362L210.24 84.6386C211.413 79.8341 208.841 74.8394 205.2 74.8394L97.0099 74.9526C94.619 74.9526 92.5314 77.185 91.9065 80.3956Z",fill:a(t).colorMainBgr},null,8,Eb),d("g",Lb,[d("path",{d:"M91.9065 80.3951L75.8945 162.72L73.7979 173.497L180.693 172.972C185.488 172.949 189.74 168.688 191.285 162.362L210.24 84.6381C211.413 79.8336 208.841 74.8389 205.2 74.8389L97.0099 74.9521C94.619 74.9521 92.5314 77.1845 91.9065 80.3951Z",fill:a(t).colorMainText},null,8,Ab)]),d("path",{d:"M170.441 157.146L159.125 65.9412C158.663 62.2053 155.683 59.4159 152.169 59.4295L127.35 59.511C125.511 59.5155 123.75 60.2989 122.445 61.6846L110.663 74.2099L41.6378 74.5721C37.422 74.5948 34.1797 78.5842 34.7367 83.0718L45.2469 167.366C45.7133 171.097 48.6839 173.882 52.1933 173.873L172.488 173.638C185.887 173.914 187.164 169.961 187.164 169.961C171.808 173.362 170.441 157.159 170.441 157.15V157.146Z",fill:a(t).colorMainText},null,8,$b),d("rect",{x:"130.984",y:"80.0801",width:"5.5062",height:"25.0888",rx:"2.7531",transform:"rotate(-45 130.984 80.0801)",fill:a(t).colorMainBgr},null,8,Ib),d("path",{d:"M147.845 104.347C142.496 98.9978 142.496 90.3249 147.845 84.9756C148.737 84.084 150.182 84.084 151.074 84.9756L178.063 111.965C181.183 115.085 181.183 120.144 178.063 123.265C174.942 126.385 169.883 126.385 166.763 123.265L147.845 104.347Z",fill:a(t).colorMainBgr},null,8,Ob),d("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M151.42 91.7928C151.138 91.5115 150.682 91.5115 150.401 91.7928C150.12 92.0741 150.12 92.5303 150.401 92.8116L161.801 104.212C162.083 104.493 162.539 104.493 162.82 104.212C163.101 103.931 163.101 103.474 162.82 103.193L151.42 91.7928ZM165.702 105.806C165.42 105.524 164.964 105.524 164.683 105.806C164.402 106.087 164.402 106.543 164.683 106.825L165.11 107.252C165.391 107.533 165.847 107.533 166.129 107.252C166.41 106.97 166.41 106.514 166.129 106.233L165.702 105.806Z",fill:a(t).colorMainText},null,8,Pb),d("circle",{cx:"109.964",cy:"55.167",r:"37.6805",transform:"rotate(-45 109.964 55.167)",stroke:a(t).colorMainText,"stroke-width":"8"},null,8,Nb),d("g",Db,[d("circle",{cx:"109.964",cy:"55.167",r:"37.6805",transform:"rotate(-45 109.964 55.167)",stroke:a(t).colorMainBgr,"stroke-width":"8"},null,8,Mb)]),Bb]),d("defs",null,[d("linearGradient",Fb,[d("stop",{"stop-color":a(t).colorMainBgr},null,8,Vb),d("stop",{offset:"1","stop-color":a(t).colorMainBgr},null,8,Rb)]),d("linearGradient",qb,[d("stop",{"stop-color":a(t).colorMainBgr},null,8,Ub),d("stop",{offset:"1","stop-color":a(t).colorMainBgr},null,8,jb)]),d("linearGradient",zb,[d("stop",{"stop-color":a(t).colorMainText},null,8,Yb),d("stop",{offset:"1","stop-color":a(t).colorMainText,"stop-opacity":"0"},null,8,Wb)]),d("linearGradient",Hb,[d("stop",{"stop-color":a(t).colorMainText},null,8,Zb),d("stop",{offset:"1","stop-color":a(t).colorMainText,"stop-opacity":"0"},null,8,Gb)]),d("clipPath",Jb,[d("rect",{width:"240",height:"194.717",fill:a(t).colorMainText},null,8,Xb)])])]))]),d("div",Qb,[d("div",Kb,w(a(e).heading),1),d("div",e0,w(a(e).text),1)])],4))}};const t0={class:"am-caesd__item"},a0={class:"am-caesd__item-header"},s0={key:2},n0={key:0,class:"am-caesd__footer"},l0={name:"SpecialDays"},i0=Object.assign(l0,{props:{responsiveClass:{type:String,default:""}},setup(n){const e=n;let t=Ie(),s=F("amLabels"),l=F("localLanguage"),i=_(()=>t.getters["employee/getEmployee"].specialDayList),o=lt({data:null,index:null}),r=M({range:_({get:()=>t.getters["employee/getEmployee"].specialDayList[o.index].range,set:h=>{t.getters["employee/getEmployee"].specialDayList[o.index].range=h}})}),c=M([]),m=_(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}]}));function g(h){i.value.splice(h,1)}function f(h){o.index=h,o.data=JSON.parse(JSON.stringify(i.value[h]))}function v(h){let I=[];i.value[h].periodList.forEach(O=>{I.push({id:null,locationId:null,startTime:O.startTime,endTime:O.endTime,periodLocationList:[...O.periodLocationList],periodServiceList:[...O.periodServiceList],editing:!1})}),t.getters["employee/getEmployee"].specialDayList.push({id:null,range:[],periodList:I}),o.index=i.value.length-1,o.data={}}let k=M("");function T(h){let I=t.getters["employee/getEmployee"].specialDayList[h].periodList;c.value[h].validate(O=>{O&&I.length>0?(k.value="",o.index=null,o.data=null):k.value="Please add period to special day"})}function y(h){Object.keys(o.data).length===0?i.value.pop():i.value[h]=o.data,o.index=null,o.data=null,k.value=""}function b(){i.value.push({id:null,range:[],periodList:[]}),o.index=i.value.length-1,o.data={}}function L(h,I){h?c.value[I]=h:c.value.splice(I,1)}let E=F("amColors"),C=_(()=>({"--am-c-caesd-bgr":E.value.colorMainBgr,"--am-c-caesd-text":E.value.colorMainText,"--am-c-caesd-text-op03":W(E.value.colorMainText,.03),"--am-c-caesd-text-op80":W(E.value.colorMainText,.8)}));return(h,I)=>{const O=xt,A=et;return u(),x("div",{class:"am-caesd",style:be(a(C))},[(u(!0),x(ee,null,pe(a(i),(D,V)=>(u(),x("div",{key:V,class:"am-caesd__content"},[d("div",t0,[d("div",a0,[a(o).index!==V?(u(),x(ee,{key:0},[d("div",null,w(D.range[0]?a(dt)(a(ve)(D.range[0]).format("YYYY-MM-DD")):"")+" - "+w(D.range[1]?a(dt)(a(ve)(D.range[1]).format("YYYY-MM-DD")):""),1),$(ka,{index:V,"have-duplicate":!0,onRemove:z=>g(V),onEdit:z=>f(V),onDuplicate:z=>v(V)},null,8,["index","onRemove","onEdit","onDuplicate"])],64)):N("",!0),a(o).index===V?(u(),q(A,{key:1,ref_for:!0,ref:z=>L(z,V),class:"am-caesd__form",rules:a(m),model:a(r),"label-position":"top"},{default:S(()=>[$(O,{prop:"range"},{default:S(()=>[$(Ht,{modelValue:a(r).range,"onUpdate:modelValue":I[0]||(I[0]=z=>a(r).range=z),type:"daterange",size:"small","popper-class":"am-cap__datepicker-popper","prefix-icon":Ge({components:{IconComponent:He},template:"<IconComponent icon='calendar'/>"}),format:a(Wt)(),placeholder:a(s).select_date,lang:a(l)},null,8,["modelValue","prefix-icon","format","placeholder","lang"])]),_:1})]),_:2},1032,["rules","model"])):N("",!0),a(k)?(u(),x("div",s0)):N("",!0)]),d("div",{class:R(["am-caesd__item-inner",{"am-editable":a(o).index===V}])},[$(au,{title:a(s).special_days,enabled:!0,index:V,type:"specialDayList","apply-to-all-days-visible":!1,"header-visible":a(o).index===V,"edit-visible":a(o).index===V,"footer-visible":a(o).index===V,error:a(o).index===V?a(k):"","responsive-class":a(e).responsiveClass,onAddPeriod:I[1]||(I[1]=()=>{ye(k)?k.value="":k=""})},null,8,["title","index","header-visible","edit-visible","footer-visible","error","responsive-class"])],2)]),a(o).index===V?(u(),x("div",n0,[$(ke,{category:"secondary",type:"plain",size:"small",onClick:z=>y(V)},{default:S(()=>[ie(w(a(s).cancel),1)]),_:2},1032,["onClick"]),$(ke,{size:"small",onClick:z=>T(V)},{default:S(()=>[ie(w(a(s).save),1)]),_:2},1032,["onClick"])])):N("",!0)]))),128)),a(i).length===0?(u(),q(Na,{key:0,heading:a(s).no_special_days_yet},null,8,["heading"])):N("",!0),a(o).index===null?(u(),x("div",{key:1,class:R(a(i).length===0?"add-btn":"")},[$(ke,{size:"small",onClick:I[2]||(I[2]=D=>b())},{default:S(()=>[ie(w(a(s).add_special_day),1)]),_:1})],2)):N("",!0)],4)}}});const o0={key:0,class:"am-caedo__title_emp"},r0={class:"am-caedo__heading-item am-w-50"},c0={class:"am-caedo__heading-item am-w-30"},u0={class:"am-caedo__heading-item am-w-20"},d0={class:"am-caedo__content-item"},m0={key:0,class:"am-caedo__wrapper"},p0={class:"am-caedo__footer"},g0={key:4,class:"am-caedo__title_global"},f0={class:"am-caedo__heading-item am-w-50"},h0={class:"am-caedo__heading-item am-w-30"},v0={class:"am-caedo__heading-item am-w-20"},_0={class:"am-caedo__content-item"},y0={name:"DaysOff"},b0=Object.assign(y0,{props:{responsiveClass:{type:String,default:""}},setup(n){const e=n;let t=Ie(),s=F("amLabels"),l=F("localLanguage");const i=F("settings");let o=_(()=>t.getters["employee/getEmployee"].dayOffList),r=M([]),c=lt({data:null,index:null}),m=M({range:_({get:()=>t.getters["employee/getEmployee"].dayOffList[c.index].range,set:I=>{t.getters["employee/getEmployee"].dayOffList[c.index].range=I}}),name:_({get:()=>t.getters["employee/getEmployee"].dayOffList[c.index].name,set:I=>{t.getters["employee/getEmployee"].dayOffList[c.index].name=I}}),repeat:_({get:()=>t.getters["employee/getEmployee"].dayOffList[c.index].repeat,set:I=>{t.getters["employee/getEmployee"].dayOffList[c.index].repeat=I}})}),g=M([]),f=_(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}],name:[{required:!0,message:s.days_off_name_warning,trigger:["submit","change"]}]}));function v(I){o.value.splice(I,1)}function k(I){c.index=I,c.data=JSON.parse(JSON.stringify(o.value[I]))}function T(I){g.value[I].validate(O=>{O&&(c.index=null,c.data=null)})}function y(I){Object.keys(c.data).length===0?o.value.pop():o.value[I]=c.data,c.index=null,c.data=null}function b(){o.value.push({id:null,name:"",repeat:!1,range:[]}),c.index=o.value.length-1,c.data={}}function L(I){let O=I.range[0]?dt(ve(I.range[0]).format("YYYY-MM-DD")):"",A=I.range[1]?dt(ve(I.range[1]).format("YYYY-MM-DD")):"";return`${O} - ${A}`}function E(I,O){I?g.value[O]=I:g.value.splice(O,1)}Je(()=>{r.value=i.daysOff.map(I=>new Object({range:[I.startDate,I.endDate],name:I.name,repeat:I.repeat}))});let C=F("amColors"),h=_(()=>({"--am-c-caedo-bgr":C.value.colorMainBgr,"--am-c-caedo-text":C.value.colorMainText,"--am-c-caedo-text-op80":W(C.value.colorMainText,.8),"--am-c-caedo-text-op03":W(C.value.colorMainText,.03)}));return(I,O)=>{const A=xt,D=et;return u(),x("div",{class:"am-caedo",style:be(a(h))},[a(r).length?(u(),x("span",o0,w(a(s).employee_days_off),1)):N("",!0),a(o).length||a(r).length?(u(),x("div",{key:1,class:R(["am-caedo__heading",a(e).responsiveClass])},[d("div",r0,w(a(s).date),1),d("div",c0,w(a(s).name),1),d("div",u0,w(a(s).days_off_repeat_yearly),1)],2)):N("",!0),(u(!0),x(ee,null,pe(a(o),(V,z)=>(u(),x("div",{key:z,class:"am-caedo__content"},[d("div",d0,[d("div",{class:R(["am-caedo__content-item__inner am-w-50",a(e).responsiveClass])},[d("div",{class:R(["am-caedo__content-item__label",a(e).responsiveClass])},w(a(s).date),3),ie(" "+w(L(V)),1)],2),d("div",{class:R(["am-caedo__content-item__inner am-w-30",a(e).responsiveClass])},[d("div",{class:R(["am-caedo__content-item__label",a(e).responsiveClass])},w(a(s).name),3),ie(" "+w(V.name),1)],2),d("div",{class:R(["am-caedo__content-item__inner am-w-20",a(e).responsiveClass])},[d("div",{class:R(["am-caedo__content-item__label",a(e).responsiveClass])},w(a(s).days_off_repeat_yearly),3),ie(" "+w(V.repeat?a(s).yes:a(s).no),1)],2),a(c).index===null?(u(),q(ka,{key:0,index:z,onRemove:B=>v(z),onEdit:B=>k(z)},null,8,["index","onRemove","onEdit"])):N("",!0)]),a(c).index===z?(u(),x("div",m0,[$(D,{ref_for:!0,ref:B=>E(B,z),class:"am-caedo__form",rules:a(f),model:a(m),"label-position":"top"},{default:S(()=>[$(A,{label:`${a(s).date}:`,prop:"range"},{default:S(()=>[$(Ht,{modelValue:a(m).range,"onUpdate:modelValue":O[0]||(O[0]=B=>a(m).range=B),type:"daterange","popper-class":"am-cap__datepicker-popper",format:a(Wt)(),placeholder:a(s).select_date,lang:a(l)},null,8,["modelValue","format","placeholder","lang"])]),_:1},8,["label"]),$(A,{label:`${a(s).name}:`,prop:"name"},{default:S(()=>[$(St,{modelValue:a(m).name,"onUpdate:modelValue":O[1]||(O[1]=B=>a(m).name=B)},null,8,["modelValue"])]),_:1},8,["label"]),$(A,{prop:"repeat"},{default:S(()=>[$(ft,{modelValue:a(m).repeat,"onUpdate:modelValue":O[2]||(O[2]=B=>a(m).repeat=B),label:a(s).days_off_repeat_yearly},null,8,["modelValue","label"])]),_:1})]),_:2},1032,["rules","model"]),d("div",p0,[$(ke,{category:"secondary",size:"small",type:"plain",onClick:B=>y(z)},{default:S(()=>[ie(w(a(s).cancel),1)]),_:2},1032,["onClick"]),$(ke,{size:"small",onClick:B=>T(z)},{default:S(()=>[ie(w(a(s).save),1)]),_:2},1032,["onClick"])])])):N("",!0)]))),128)),a(o).length===0&&a(r).length===0?(u(),q(Na,{key:2,heading:a(s).no_days_off_yet},null,8,["heading"])):N("",!0),a(c).index===null?(u(),x("div",{key:3,class:R(a(o).length===0&&a(r).length===0?"add-btn":"")},[$(ke,{size:"small",onClick:O[3]||(O[3]=V=>b())},{default:S(()=>[ie(w(a(s).add_day_off),1)]),_:1})],2)):N("",!0),a(r).length?(u(),x("span",g0,w(a(s).company_days_off),1)):N("",!0),a(r).length?(u(),x("div",{key:5,class:R(["am-caedo__heading",a(e).responsiveClass])},[d("div",f0,w(a(s).date),1),d("div",h0,w(a(s).name),1),d("div",v0,w(a(s).days_off_repeat_yearly),1)],2)):N("",!0),(u(!0),x(ee,null,pe(a(r),(V,z)=>(u(),x("div",{key:z,class:"am-caedo__content"},[d("div",_0,[d("div",{class:R(["am-caedo__content-item__inner am-w-50",a(e).responsiveClass])},[d("div",{class:R(["am-caedo__content-item__label",a(e).responsiveClass])},w(a(s).date),3),ie(" "+w(L(V)),1)],2),d("div",{class:R(["am-caedo__content-item__inner am-w-30",a(e).responsiveClass])},[d("div",{class:R(["am-caedo__content-item__label",a(e).responsiveClass])},w(a(s).name),3),ie(" "+w(V.name),1)],2),d("div",{class:R(["am-caedo__content-item__inner am-w-20",a(e).responsiveClass])},[d("div",{class:R(["am-caedo__content-item__label",a(e).responsiveClass])},w(a(s).days_off_repeat_yearly),3),ie(" "+w(V.repeat?a(s).yes:a(s).no),1)],2)])]))),128))],4)}}});const k0={class:"am-cc__edit"},C0={class:"am-cc__edit-text"},x0={class:"am-cc__edit-text"},w0={class:"am-cc__edit"},T0={class:"am-cc__edit-text"},S0={class:"am-cc__edit-text"},E0={class:"am-cc__edit"},L0={class:"am-cc__edit-text"},A0={class:"am-cc__edit-text"},$0={name:"StripeConnect"},I0=Object.assign($0,{setup(n){let e=Ie(),t=F("amLabels"),s=_(()=>e.getters["auth/getStripeProvider"]),l=M(!1);function i(k){k.stopPropagation(),l.value=!l.value}function o(k){qd(e,k),m()}function r(){jd(e),m()}function c(){Ud(e),m()}function m(){l.value=!1}let g=F("amFonts"),f=F("amColors"),v=_(()=>({"--am-c-cc-error":f.value.colorError,"--am-c-cc-error-op15":W(f.value.colorError,.15),"--am-c-cc-bgr":f.value.colorMainBgr,"--am-c-cc-text":f.value.colorMainText,"--am-c-cc-text-op10":W(f.value.colorMainText,.1),"--am-c-cc-text-op15":W(f.value.colorMainText,.15),"--am-font-family":g.value.fontFamily}));return(k,T)=>{const y=hn;return a(s)&&a(s).id&&a(s).completed?(u(),q(y,{key:0,ref:"stripeConnectRef",visible:a(l),"onUpdate:visible":T[2]||(T[2]=b=>ye(l)?l.value=b:l=b),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(v),trigger:"click"},{reference:S(()=>[$(ke,{onClick:i},{default:S(()=>[ie(w(a(t).stripe_connect)+" "+w("("+(a(s).email?a(s).email:a(s).id)+")"),1)]),_:1})]),default:S(()=>[Yt((u(),x("div",k0,[d("div",{class:"am-cc__edit-item",onClick:T[0]||(T[0]=b=>r())},[d("span",C0,w(a(t).stripe_preview),1)]),d("div",{class:"am-cc__edit-item",onClick:T[1]||(T[1]=b=>c())},[d("span",x0,w(a(t).disconnect),1)])])),[[a(ra),m]])]),_:1},8,["visible","popper-style"])):a(s)&&a(s).id&&!a(s).completed?(u(),q(y,{key:1,ref:"stripeConnectRef",visible:a(l),"onUpdate:visible":T[5]||(T[5]=b=>ye(l)?l.value=b:l=b),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(v),trigger:"click"},{reference:S(()=>[$(ke,{onClick:i},{default:S(()=>[ie(w(a(t).stripe_connect)+" "+w("("+(a(s).email?a(s).email:a(s).id)+")"),1)]),_:1})]),default:S(()=>[Yt((u(),x("div",w0,[d("div",{class:"am-cc__edit-item",onClick:T[3]||(T[3]=b=>o(a(s).type))},[d("span",T0,w(a(t).stripe_onboard),1)]),d("div",{class:"am-cc__edit-item",onClick:T[4]||(T[4]=b=>c())},[d("span",S0,w(a(t).disconnect),1)])])),[[a(ra),m]])]),_:1},8,["visible","popper-style"])):(u(),q(y,{key:2,ref:"stripeConnectRef",visible:a(l),"onUpdate:visible":T[8]||(T[8]=b=>ye(l)?l.value=b:l=b),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(v),trigger:"click"},{reference:S(()=>[$(ke,{onClick:i},{default:S(()=>[ie(w(a(t).stripe_connect),1)]),_:1})]),default:S(()=>[Yt((u(),x("div",E0,[d("div",{class:"am-cc__edit-item",onClick:T[6]||(T[6]=b=>o("standard"))},[d("span",L0,w(a(t).stripe_account_standard),1)]),d("div",{class:"am-cc__edit-item",onClick:T[7]||(T[7]=b=>o("express"))},[d("span",A0,w(a(t).stripe_account_express),1)])])),[[a(ra),m]])]),_:1},8,["visible","popper-style"]))}}});const O0=["innerHTML"],P0={props:{responsiveClass:{type:String,default:""}},setup(n){const e=n,t=Ie(),s=F("baseUrls"),l=F("settings");let i=F("amLabels"),o=_(()=>t.getters["auth/getGoogleLoading"]||t.getters["auth/getOutlookLoading"]||t.getters["auth/getAppleLoading"]||t.getters["auth/getStripeLoading"]||t.getters["auth/getZoomLoading"]),r=_(()=>{let y=t.getters["auth/getZoomUsers"];return y.length?y.map(b=>({value:b.id,label:`${b.first_name} ${b.last_name} (${b.email})`})):[]}),c=_(()=>{let y=t.getters["auth/getGoogleCalendars"];return y.length?y.map(b=>({value:b.calendarId,label:b.summary})):[]}),m=_(()=>{let y=t.getters["auth/getOutlookCalendars"];return y.length?y.map(b=>({value:b.id,label:b.name})):[]}),g=_(()=>{let y=t.getters["auth/getAppleCalendars"];return y.length?y.map(b=>({value:b.id,label:b.name})):[]}),f=_(()=>t.getters["employee/getGoogleToken"]?i.google_sign_out:i.google_sign_in),v=_(()=>t.getters["employee/getOutlookToken"]?i.outlook_sign_out:i.outlook_sign_in),k=M({googleId:_({get:()=>t.getters["employee/getGoogleCalendarId"],set:y=>{t.commit("employee/setGoogleCalendarId",y||"")}}),googleBtn:"",outlookId:_({get:()=>t.getters["employee/getOutlookCalendarId"],set:y=>{t.commit("employee/setOutlookCalendarId",y||"")}}),outlookBtn:"",appleId:_({get:()=>t.getters["employee/getAppleCalendarId"],set:y=>{t.commit("employee/setAppleCalendarId",y||"")}}),zoomUserId:_({get:()=>t.getters["employee/getZoomUserId"],set:y=>{t.commit("employee/setZoomUserId",y||"")}})}),T=M({googleId:{template:Ye.select,props:{itemName:"googleId",label:i.google_calendar,placeholder:"",class:_(()=>`am-caepif__item ${e.responsiveClass}`),disabled:_(()=>!t.getters["employee/getGoogleToken"]),clearable:!1,options:c.value,loading:_(()=>t.getters["auth/getGoogleLoading"]),loadingIcon:"loading"}},googleBtn:{template:Ge(ke),props:{class:_(()=>`am-caepif__item am-google-calendar-button ${e.responsiveClass}`),category:_(()=>"primary")},slots:{default:_(()=>`<img src="${s.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/google-button.svg" alt="Google" />${f.value}`)},handlers:{click:()=>{t.getters["employee/getGoogleToken"]?Dd(t):Nd(t)}}},outlookId:{template:Ye.select,props:{itemName:"outlookId",label:i.outlook_calendar,placeholder:"",class:_(()=>`am-caepif__item ${e.responsiveClass}`),disabled:_(()=>!t.getters["employee/getOutlookToken"]),clearable:!1,options:m.value,loading:_(()=>t.getters["auth/getOutlookLoading"]),loadingIcon:"loading"}},outlookBtn:{template:Ge(ke),props:{class:_(()=>`am-caepif__item am-outlook-button ${e.responsiveClass}`),category:_(()=>"primary")},slots:{default:_(()=>`<div class="am-outlook-img"><img src="${s.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/outlook-calendar.png" alt="Outlook"/></div>${v.value}`)},handlers:{click:()=>{t.getters["employee/getOutlookToken"]?Fd(t):Bd(t)}}},appleId:{template:Ye.select,props:{itemName:"appleId",label:i.apple_calendar,placeholder:"",class:_(()=>`am-caepif__item ${e.responsiveClass}`),disabled:!1,clearable:!0,options:g.value,loading:_(()=>t.getters["auth/getAppleLoading"]),loadingIcon:"loading"}},zoomUserId:{template:Ye.select,props:{itemName:"zoomUserId",label:i.zoom_user,placeholder:i.zoom_user_placeholder,class:_(()=>`am-caepif__item ${e.responsiveClass}`),options:r.value}}});return gn(()=>{l.zoom.enabled||delete T.value.zoomUserId,l.googleCalendar.enabled||(delete T.value.googleId,delete T.value.googleBtn),l.outlookCalendar.enabled||(delete T.value.outlookId,delete T.value.outlookBtn),l.appleCalendar||delete T.value.appleId}),(y,b)=>{const L=et;return a(o)?(u(),q(Zt,{key:1})):(u(),q(L,{key:0,ref:"employeeFormRef",model:a(k),"label-position":"top",class:R(["am-caedo",e.responsiveClass])},{default:S(()=>[a(l).payments.stripe.enabled&&a(l).payments.stripe.connect.enabled?(u(),q(I0,{key:0})):N("",!0),d("div",{class:R(["am-caepif__block",e.responsiveClass])},[(u(!0),x(ee,null,pe(a(T),(E,C)=>(u(),q(Ct(E.template),Nt({key:C,ref_for:!0,ref:"customerCollectorRef",modelValue:a(k)[C],"onUpdate:modelValue":h=>a(k)[C]=h},E.props,Ji(E.handlers?E.handlers:{})),{default:S(()=>[E.slots&&E.slots.default?(u(),x("div",{key:0,innerHTML:E.slots.default},null,8,O0)):N("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128))],2)]),_:1},8,["model","class"]))}}};const N0={props:{tabActive:{type:String,required:!0},passwordActive:{type:Boolean,default:!1}},emits:["changePassword","savePassword","saveChanges"],setup(n,{emit:e}){const t=n;let s=F("amLabels");function l(){t.tabActive==="password"?e("savePassword"):e("saveChanges")}let i=F("amColors"),o=_(()=>({"--am-c-caepf-text-op15":W(i.value.colorMainText,.15)}));return(r,c)=>(u(),x("div",{class:R(["am-caepf",{"am-single-btn":t.tabActive!=="details"||t.passwordActive}]),style:be(a(o))},[t.tabActive==="details"&&!t.passwordActive?(u(),q(ke,{key:0,size:"medium",category:"secondary",type:"plain",onClick:c[0]||(c[0]=m=>e("changePassword"))},{default:S(()=>[ie(w(a(s).change_password),1)]),_:1})):N("",!0),$(ke,{size:"medium",onClick:l},{default:S(()=>[ie(w(t.tabActive!=="password"?a(s).save:a(s).change_password),1)]),_:1})],6))}},D0={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:e}){const t=n,s=Ie();let l=F("amLabels"),i=M(null),o=M({newPass:_({get:()=>s.getters["auth/getNewPassword"],set:m=>{s.commit("auth/setNewPassword",m||"")}}),confirmPass:_({get:()=>s.getters["auth/getConfirmPassword"],set:m=>{s.commit("auth/setConfirmPassword",m||"")}})}),r=M({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:l.new_password_colon,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${t.responsiveClass}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:l.new_password_colon_retype,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${t.responsiveClass}`)}}}),c=M({newPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"},{validator:()=>s.getters["auth/getNewPassword"]===s.getters["auth/getConfirmPassword"],message:l.passwords_not_match,trigger:"submit"}]});return e({passFormRef:i}),(m,g)=>{const f=et;return u(),q(f,{ref_key:"passFormRef",ref:i,model:a(o),rules:a(c),"label-position":"top",class:R(["am-capi__form",n.responsiveClass])},{default:S(()=>[(u(!0),x(ee,null,pe(a(r),(v,k)=>(u(),q(Ct(v.template),Nt({key:v.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:a(o)[k],"onUpdate:modelValue":T=>a(o)[k]=T},v.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"])}}};const M0=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),B0={name:"CabinetEmployeeProfile"},F0=Object.assign(B0,{setup(n){let e=Ie();const t=F("settings");let s=F("amLabels"),l=M(null);const{width:i}=Ka(l);let o=_(()=>tt(i.value));Be("pageWidth",i);let r=_(()=>e.getters["entities/getReady"]);const c=M("details");let m=M(""),g=M("success"),f=M(!1);function v(){f.value=!1}function k(){f.value=!1,m.value=""}let T=M(null),y=_(()=>e.getters["employee/getEmployee"]),b=_(()=>e.getters["auth/getGoogleLoading"]||e.getters["auth/getOutlookLoading"]||e.getters["auth/getAppleLoading"]||e.getters["auth/getStripeLoading"]||e.getters["auth/getZoomLoading"]),L=M(!1),E=F("timeZone");function C(){T.value.employeeFormRef.validate(z=>{!z||(L.value=!0,Pe.post("/users/providers/"+y.value.id,Ou(e,E.value),Object.assign(Ue(e),{params:{source:"cabinet-provider"}})).then(()=>{m.value=s.profile_data_success,g.value="success"}).catch(B=>{m.value=B.response.data.message,g.value="error"}).finally(()=>{f.value=!0,L.value=!1}))})}let h=M(null),I=M(!1);function O(){I.value=!0,c.value="password"}function A(){h.value.passFormRef.validate(z=>{if(z){let B=e.getters["auth/getProfile"];L.value=!0,Pe.post("/users/providers/"+B.id,{password:e.getters["auth/getNewPassword"]},Ue(e)).then(()=>{m.value=s.password_success,I.value=!1,c.value="details",e.commit("auth/setNewPassword",""),e.commit("auth/setConfirmPassword","")}).catch(()=>{f.value=!0}).finally(()=>{L.value=!1})}})}let D=F("amColors"),V=_(()=>({"--am-c-caep-primary":D.value.colorPrimary,"--am-c-caep-text":D.value.colorMainText,"--am-c-caep-text-op10":W(D.value.colorMainText,.1)}));return(z,B)=>{const J=Xa,G=Qa;return u(),x("div",{ref_key:"pageContainer",ref:l,class:"am-caep",style:be(a(V))},[a(r)&&!a(L)&&!a(b)?(u(),x("div",{key:0,class:R(["am-caep__inner",a(o)])},[a(f)?(u(),q($t,{key:0,type:a(g),"show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:k,onTriggerClose:k},{title:S(()=>[M0,ie(" "+w(a(m)),1)]),_:1},8,["type"])):N("",!0),$(G,{modelValue:c.value,"onUpdate:modelValue":B[0]||(B[0]=X=>c.value=X)},{default:S(()=>[$(J,{label:a(s).details,name:"details",onClick:v},{default:S(()=>[$(Ey,{ref_key:"detailsRef",ref:T,"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"]),a(t).roles.allowConfigureServices?(u(),q(J,{key:0,label:a(s).heading_services,name:"services"},{default:S(()=>[$(Vy,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(t).roles.allowConfigureSchedule?(u(),q(J,{key:1,label:a(s).working_hours,name:"workingHours"},{default:S(()=>[$(vb,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(t).roles.allowConfigureSpecialDays?(u(),q(J,{key:2,label:a(s).special_days,name:"specialDays"},{default:S(()=>[$(i0,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(t).roles.allowConfigureDaysOff?(u(),q(J,{key:3,label:a(s).days_off,name:"daysOff"},{default:S(()=>[$(b0,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(I)?(u(),q(J,{key:4,label:a(s).password,name:"password"},{default:S(()=>[a(L)?(u(),q(Si,{key:1,"item-direction":"column",count:2})):(u(),q(D0,{key:0,ref_key:"changePassRef",ref:h},null,512))]),_:1},8,["label"])):N("",!0),a(t).zoom.enabled||a(t).googleCalendar.enabled||a(t).outlookCalendar.enabled||a(t).appleCalendar||a(t).payments.stripe.enabled&&a(t).payments.stripe.connect.enabled?(u(),q(J,{key:5,label:a(s).integrations_settings,name:"integrations"},{default:S(()=>[$(P0,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]),$(N0,{"tab-active":c.value,"password-active":a(I),onChangePassword:O,onSavePassword:A,onSaveChanges:C},null,8,["tab-active","password-active"])],2)):(u(),q(Zt,{key:1}))],4)}}});function su(n,e){Pe.get("/users/customers",{params:vn(n)}).then(t=>{e(t.data.data.users)}).catch(()=>{e([])})}function pn(n,e="",t={},s=()=>{}){n.commit("customerInfo/setLoading",!0),setTimeout(()=>{su(Object.assign({search:e,page:1,limit:ot.general.customersFilterLimit,skipCount:1},t),l=>{n.commit("customerInfo/setCustomers",l),n.commit("customerInfo/setLoading",!1),s()})},500)}function So(n){n.getters["customerInfo/getCustomers"].length||pn(n)}const V0={key:0,class:"am-capf__zone"},R0={class:"am-capf__menu"},q0=d("span",{class:"am-icon-filter"},null,-1),U0={key:0},j0={key:0,class:"am-capf__list"},z0=["onClick"],Y0=d("span",{class:"am-icon-close"},null,-1),W0=[Y0],H0={name:"CabinetFilters"},Eo=Object.assign(H0,{props:{paramList:{type:[Object,Array],default:()=>[]},stepKey:{type:String,default:""},responsiveClass:{type:String,default:""},empty:{type:Boolean,default:!1}},emits:["changeFilters","addAppointment"],setup(n,{emit:e}){const t=n;let s=Ie(),l=_(()=>s.getters["entities/getReady"]),i=_(()=>s.getters.getLoading),o=_(()=>t.stepKey==="packages"?"packagesList":t.stepKey);const r=F("shortcodeData"),c=F("settings");let m=F("amCustomize");const g=F("labels"),f=F("localLanguage");let v=_(()=>c.general.usedLanguages.includes(f.value)),k=_(()=>{let Q=lt({...g});if(t.stepKey){let le=m.value[o.value].translations;le&&Object.keys(le).forEach(H=>{le[H][f.value]&&v.value?Q[H]=le[H][f.value]:le[H].default&&(Q[H]=le[H].default)})}return Q});function T(Q){return Q==="customers"?"user":Q==="services"?"service":Q==="providers"?"employee":Q==="locations"?"locations":Q==="packages"?"shipment":Q==="events"?"star-outline":""}function y(){e("changeFilters")}let b=F("containerWidth"),L={components:{IconComponent:He},template:'<IconComponent icon="filter"/>'},E=M(!1),C=M({dates:_({get:()=>s.getters["cabinetFilters/getDates"],set:Q=>{Pu(Q[0],Q[1]),s.commit("cabinetFilters/setDates",Q),e("changeFilters")}}),customers:_({get:()=>s.getters["cabinetFilters/getCustomers"],set:Q=>{s.commit("cabinetFilters/setCustomers",Q)}}),services:_({get:()=>s.getters["cabinetFilters/getServices"],set:Q=>{s.commit("cabinetFilters/setServices",Q)}}),providers:_({get:()=>s.getters["cabinetFilters/getProviders"],set:Q=>{s.commit("cabinetFilters/setProviders",Q)}}),locations:_({get:()=>s.getters["cabinetFilters/getLocations"],set:Q=>{s.commit("cabinetFilters/setLocations",Q)}}),packages:_({get:()=>s.getters["cabinetFilters/getPackages"],set:Q=>{s.commit("cabinetFilters/setPackages",Q)}}),events:_({get:()=>s.getters["cabinetFilters/getEvents"],set:Q=>{s.commit("cabinetFilters/setEvents",Q)}})}),h=_(()=>t.stepKey==="events"?s.getters["cabinetFilters/getEventFiltersOption"](r.value.cabinetType):t.stepKey==="packages"?s.getters["cabinetFilters/getPackageFilterOptions"]:s.getters["cabinetFilters/getAppointmentFilterOptions"](r.value.cabinetType)),I=_(()=>{let Q=0;return Object.keys(h.value).forEach(le=>{m.value[o.value].options[`${le}Filter`].visibility&&(le==="customers"||le==="events"||h.value[le].length>0)&&Q++}),Q});function O(Q,le){switch(Q){case"customers":D(le);break;case"events":V(le);break}}function A(){r.value.cabinetType==="employee"&&D("",s.getters["auth/getPreloadedCustomers"])}function D(Q="",le=[]){if(le.length){s.dispatch("cabinetFilters/injectCustomerOptions",le);return}setTimeout(()=>{su({search:Q,page:1,limit:ot.general.customersFilterLimit,skipCount:1},H=>{s.dispatch("cabinetFilters/injectCustomerOptions",H),s.getters["auth/getPreloadedCustomers"].length===0&&s.commit("auth/setPreloadedCustomers",H)})},500)}function V(Q="",le=[]){if(le.length){s.dispatch("cabinetFilters/injectEventsOptions",le);return}setTimeout(()=>{Qu({dates:[ve().format("YYYY-MM-DD")],timeZone:s.getters["cabinet/getTimeZone"],group:!0,page:1,limit:c.general.itemsPerPageBackEnd,search:Q},H=>{s.dispatch("cabinetFilters/injectEventsOptions",H)})},500)}function z(Q){let le=Q.charAt(0).toUpperCase()+Q.slice(1);s.commit(`cabinetFilters/set${le}`,[]),e("changeFilters")}let B=_(()=>m.value[o.value].options),J=_(()=>t.stepKey==="appointments"?r.value.cabinetType==="employee"?B.value.servicesFilter.visibility||B.value.customersFilter.visibility||B.value.locationsFilter.visibility:B.value.servicesFilter.visibility||B.value.providersFilter.visibility||B.value.locationsFilter.visibility:t.stepKey==="events"?r.value.cabinetType==="employee"?B.value.eventsFilter.visibility||B.value.customersFilter.visibility||B.value.locationsFilter.visibility:B.value.eventsFilter.visibility||B.value.providersFilter.visibility||B.value.locationsFilter.visibility:B.value.packagesFilter.visibility||B.value.servicesFilter.visibility||B.value.providersFilter.visibility||B.value.locationsFilter.visibility),G=_(()=>t.stepKey==="appointments"?r.value.cabinetType==="employee"?!!(h.value.services.length||h.value.customers.length||h.value.locations.length):!!(h.value.services.length||h.value.providers.length||h.value.locations.length):t.stepKey==="events"?r.value.cabinetType==="employee"?!!(h.value.events.length||h.value.customers.length||h.value.locations.length):!!(h.value.events.length||h.value.providers.length||h.value.locations.length):!!(h.value.packages.length||h.value.services.length||h.value.providers.length||h.value.locations.length));Je(()=>{A()});let X=F("amColors"),K=_(()=>({"--am-c-capf-heading-text":X.value.colorMainText,"--am-c-capf-text":X.value.colorInpText,"--am-c-capf-text-op10":W(X.value.colorInpText,.1),"--am-c-select-border":X.value.colorInpBorder,"--am-c-select-bgr":X.value.colorInpBgr}));return(Q,le)=>!a(i)&&a(l)?(u(),x("div",{key:0,class:"am-capf",style:be(a(K))},[a(b)<=480&&a(B).timeZone.visibility&&a(t).stepKey!=="packages"?(u(),x("div",V0,[$(Ti,{size:"small"})])):N("",!0),d("div",R0,[a(b)<=480&&a(B).timeZone.visibility&&a(t).stepKey==="packages"?(u(),q(Ti,{key:0,size:"small"})):N("",!0),a(t).stepKey!=="packages"?(u(),q(Ht,{key:1,modelValue:a(C).dates,"onUpdate:modelValue":le[0]||(le[0]=H=>a(C).dates=H),type:"daterange",editable:!1,size:"small",clearable:!1,format:a(Wt)(),style:be(a(K)),lang:a(f),class:R(["am-capf__menu-datepicker",a(t).responsiveClass]),"popper-class":"am-capf__menu-datepicker-popper","custom-input-display":!0},null,8,["modelValue","format","style","lang","class"])):N("",!0),!a(t).empty&&a(J)&&a(G)?(u(),q(ke,{key:2,icon:a(L),"icon-only":a(b)<=700,"custom-class":"am-capf__menu-btn",size:"small",category:"primary",type:a(B).filterBtn?a(B).filterBtn.buttonType:"filled",onClick:le[1]||(le[1]=H=>ye(E)?E.value=!a(E):E=!a(E))},{default:S(()=>[q0,a(b)>700?(u(),x("span",U0,w(a(k).filters),1)):N("",!0)]),_:1},8,["icon","icon-only","type"])):N("",!0)]),$(_a,{name:"am-slide-fade"},{default:S(()=>[a(E)&&!a(t).empty?(u(),x("div",j0,[(u(!0),x(ee,null,pe(Object.keys(a(h)),H=>(u(),x(ee,{key:H},[(a(h)[H].length>0||H==="customers"||H==="events")&&a(m)[a(o)].options[`${H}Filter`].visibility?(u(),x("span",{key:0,class:R(["am-capf__list-item",[{"am-selected":a(C)[H].length>0},`am-capf__list-item-${a(I)}`,a(t).responsiveClass]])},[$(We,{id:`am-select-${H}`,modelValue:a(C)[H],"onUpdate:modelValue":se=>a(C)[H]=se,multiple:H!=="customers"&&H!=="events",remote:"",clearable:"",filterable:H==="customers"||H==="events",placeholder:a(k)[H+(H==="customers"?"":"_dropdown")],"prefix-icon":T(H),"collapse-tags":!0,size:"small","popper-class":"am-filter-select-popper","remote-method":se=>{O(H,se)},onChange:y,onClear:A},{default:S(()=>[(u(!0),x(ee,null,pe(a(h)[H],se=>(u(),q(Ve,{key:se.id,value:se.id,label:se.firstName?se.firstName+" "+se.lastName:se.name},null,8,["value","label"]))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","multiple","filterable","placeholder","prefix-icon","remote-method"]),a(C)[H].length>0?(u(),x("span",{key:0,class:"am-capf__clear",onClick:se=>z(H)},W0,8,z0)):N("",!0)],2)):N("",!0)],64))),128))])):N("",!0)]),_:1})],4)):N("",!0)}});function Z0(n,e){let t=n.getters["entities/getService"](e.serviceId),s=0,l=0;return e.bookings.forEach(i=>{if(["approved","pending"].includes(i.status)){let o=i.duration?i.duration:t.duration;o>s&&(s=o);let r=0;i.extras.forEach(c=>{r+=t.extras.find(g=>g.id===c.extraId).duration*c.quantity}),r>l&&(l=r)}}),s+l}function nu(n,e,t){for(let s in n)n[s].appointments.forEach(l=>{let i={};l.bookings.forEach(r=>{r.customerId in i||(i[r.customerId]=[]),i[r.customerId][r.id]=r.status});let o={};for(let r in i)for(let c in i[r])(!(r in o)||i[r][c]==="approved"||i[r][c]==="pending")&&(o[r]=c);l.bookings.forEach(r=>{r.customerId in o&&parseInt(r.id)!==parseInt(o[r.customerId])||(e===""&&(l.bookingStart=Qn(l.bookingStart),l.bookingEnd=Qn(l.bookingEnd)),t||(l.bookings=[r]))})});if(e===""){let s={};for(let l in n)n[l].appointments.forEach(i=>{let o=i.bookingStart.split(" ")[0];o in s?s[o].appointments.push(i):s[o]={appointments:[i],date:o}});return s}return n}function lu(n,e){let t=[];return n.forEach(s=>{if(["approved","pending"].includes(s.status)&&s.customFields){let l=JSON.parse(s.customFields);Object.keys(l).forEach(i=>{let o=l[i].type==="file"?l[i]?.value?l[i].value:"":l[i].value;(Array.isArray(o)?o.length:o)&&t.push({label:l[i].label,value:o})})}}),e==="customer"?t:[...new Set(t.filter(s=>s.value).map(s=>s.label))].map(s=>new Object({label:s}))}function G0(n,e){let t={};return n.forEach(s=>{["approved","pending"].includes(s.status)&&s.extras.forEach(l=>{l.extraId in t||(t[l.extraId]={quantity:0,price:l.price,name:e.extras.find(i=>i.id===l.extraId).name}),t[l.extraId].quantity=t[l.extraId].quantity+l.quantity})}),t}const J0={class:"am-cc__periods-date"},X0={class:"am-cc__periods-time"},Q0={key:0,class:"am-cc__periods-link__list"},K0=["href"],ek=d("span",{class:"am-icon-link"},null,-1),tk=["href"],ak=d("span",{class:"am-icon-link"},null,-1),sk=["href"],nk=d("span",{class:"am-icon-link"},null,-1),lk=["href"],ik=d("span",{class:"am-icon-link"},null,-1),ok={name:"TemplatePeriods"},rk=Object.assign(ok,{props:{data:{type:[Array,Object,String]}},setup(n){const e=n,t=F("amLabels");let s=F("containerWidth"),l=_(()=>tt(s.value));return(i,o)=>(u(),x("div",{class:R(["am-cc__periods",a(l)])},[(u(!0),x(ee,null,pe(a(e).data,(r,c)=>(u(),x("div",{key:c,class:"am-cc__periods-item"},[d("span",J0,w(a(dt)(r.date)),1),d("span",X0,w(`${a(sn)(r.startTime)} - ${a(sn)(r.endTime)}`),1),r.googleMeetLink||r.zoomLink||r.lessonSpaceLink||r.microsoftTeamsLink?(u(),x("div",Q0,[r.googleMeetLink?(u(),x("a",{key:0,class:"am-cc__periods-link",href:r.googleMeetLink,target:"_blank"},[ek,ie(" "+w(a(t).google_meet_link),1)],8,K0)):N("",!0),r.microsoftTeamsLink?(u(),x("a",{key:1,class:"am-cc__periods-link",href:r.microsoftTeamsLink,target:"_blank"},[ak,ie(" "+w(a(t).microsoft_teams_link),1)],8,tk)):N("",!0),r.zoomLink?(u(),x("a",{key:2,class:"am-cc__periods-link",href:r.zoomLink,target:"_blank"},[nk,ie(" "+w(a(t).zoom_link),1)],8,sk)):N("",!0),r.lessonSpaceLink?(u(),x("a",{key:3,class:"am-cc__periods-link",href:r.lessonSpaceLink,target:"_blank"},[ik,ie(" "+w(a(t).lesson_space_link),1)],8,lk)):N("",!0)])):N("",!0)]))),128))],2))}});const ck={class:"am-cc__extras-name"},uk={key:0,class:"am-cc__extras-duration"},dk={key:1,class:"am-cc__extras-price"},mk={key:2,class:"am-cc__extras-quantity"},pk={name:"TemplateExtras"},gk=Object.assign(pk,{props:{data:{type:[Array,Object,String]}},setup(n){const e=n,t=F("amLabels"),s=F("shortcodeData");let l=F("containerWidth"),i=_(()=>tt(l.value));return(o,r)=>(u(),x("div",{class:R(["am-cc__extras",a(i)])},[(u(!0),x(ee,null,pe(a(e).data,(c,m)=>(u(),x("div",{key:m,class:"am-cc__extras-item"},[d("span",ck,w(c.name),1),c.duration||c.price||c.quantity?(u(),x("div",{key:0,class:R(["am-cc__extras-item__inner",[{"am-flex-space":!c.price&&c.duration},{"am-flex-end":!c.duration}]])},[c.duration?(u(),x("span",uk,w(a(fn)(c.duration,a(t).h,a(t).min)),1)):N("",!0),a(s).cabinetType==="customer"&&c.price?(u(),x("span",dk,w(a(nt)(c.price)),1)):N("",!0),c.quantity?(u(),x("span",mk," x"+w(c.quantity),1)):N("",!0)],2)):N("",!0)]))),128))],2))}});const fk={class:"am-cc__tickets-item_inner"},hk={class:"am-cc__tickets-name"},vk={class:"am-cc__tickets-calc"},_k={key:0,class:"am-cc__tickets-price"},yk={name:"TemplateTickets"},bk=Object.assign(yk,{props:{data:{type:[Array,Object,String]}},setup(n){const e=n,t=F("amLabels"),s=F("shortcodeData");let l=F("containerWidth"),i=_(()=>tt(l.value));return(o,r)=>(u(),x("div",{class:R(["am-cc__tickets",a(i)])},[(u(!0),x(ee,null,pe(a(e).data,(c,m)=>(u(),x("div",{key:m,class:"am-cc__tickets-item"},[d("div",fk,[d("span",hk,w(c.name),1),d("span",vk,w(`${c.persons} ${c.persons>1?a(t).event_tickets:a(t).event_ticket}${a(s).cabinetType==="customer"?" x "+a(nt)(c.price):""}`),1)]),a(s).cabinetType==="customer"?(u(),x("div",_k,w(a(nt)(c.persons*c.price)),1)):N("",!0)]))),128))],2))}});const kk=["innerHTML"],Ck={key:0,class:"am-cc__cf-value"},xk={class:"am-cc__cf-value__inner"},wk={name:"TemplateCustomFields"},Tk=Object.assign(wk,{props:{data:{type:[Array,Object,String]}},setup(n){const e=n;let t=F("containerWidth"),s=_(()=>tt(t.value));function l(i){return i?Array.isArray(i)?i.length===0?"/":i.map(o=>typeof o=="object"&&o!==null&&!Array.isArray(o)?o.name||"/":o||"/").join(", "):i:"/"}return(i,o)=>(u(),x("div",{class:R(["am-cc__cf",a(s)])},[(u(!0),x(ee,null,pe(a(e).data,(r,c)=>(u(),x("div",{key:c,class:"am-cc__cf-item"},[d("span",{class:"am-cc__cf-name",innerHTML:r.label},null,8,kk),"value"in r?(u(),x("div",Ck,[d("span",xk,w(l(r.value)),1)])):N("",!0)]))),128))],2))}});const Sk={class:"am-cc__employee-heading"},Ek={class:"am-cc__employee-heading__inner"},Lk={class:"am-cc__employee-name"},Ak=["innerHTML"],$k={key:1,class:"am-cc__employee-wrapper"},Ik={class:"am-cc__employee-heading"},Ok={class:"am-cc__employee-heading__inner"},Pk={class:"am-cc__employee-name"},Nk=["innerHTML"],Dk={name:"TemplateEmployee"},Mk=Object.assign(Dk,{props:{data:{type:[Object,Array]}},setup(n){const e=n;let t=_(()=>!Array.isArray(e.data)),s=F("containerWidth"),l=_(()=>tt(s.value));function i(c){let m=c.firstName.charAt(0).toUpperCase(),g=c.lastName.charAt(0).toUpperCase();return`${m}${g}`}function o(c){return c.pictureThumbPath?{backgroundImage:`url(${c.pictureThumbPath})`}:{}}function r(c){return c&&c.includes("<!-- Content -->")?c.slice(16).length:c?c.length:!1}return(c,m)=>(u(),x("div",{class:R(["am-cc__employee",a(l)])},[a(t)?(u(),x(ee,{key:0},[d("div",Sk,[d("span",{class:"am-cc__employee-img",style:be(o(a(e).data))},[a(e).data.pictureThumbPath?N("",!0):(u(),x(ee,{key:0},[ie(w(i(a(e).data)),1)],64))],4),d("div",Ek,[d("span",Lk,w(`${a(e).data.firstName} ${a(e).data.lastName}`),1),a(e).data.badge?(u(),x("span",{key:0,class:"am-cc__employee-badge",style:be({background:a(e).data.badge.color})},w(a(e).data.badge.content),5)):N("",!0)])]),a(e).data.description?(u(),x("div",{key:0,class:R(["am-cc__employee-desc",{"ql-description":a(e).data.description.includes("<!-- Content -->")}]),innerHTML:a(e).data.description},null,10,Ak)):N("",!0)],64)):(u(),x("div",$k,[(u(!0),x(ee,null,pe(a(e).data,g=>(u(),x(ee,{key:g.id},[d("div",Ik,[d("span",{class:"am-cc__employee-img",style:be(o(g))},[g.pictureThumbPath?N("",!0):(u(),x(ee,{key:0},[ie(w(i(g)),1)],64))],4),d("div",Ok,[d("span",Pk,w(`${g.firstName} ${g.lastName}`),1),g.badge?(u(),x("span",{key:0,class:"am-cc__employee-badge",style:be({background:g.badge.color})},w(g.badge.content),5)):N("",!0)])]),r(g.description)?(u(),x("div",{key:0,class:R(["am-cc__employee-desc",{"ql-description":g.description.includes("<!-- Content -->")}]),innerHTML:g.description},null,10,Nk)):N("",!0)],64))),128))]))],2))}});const Bk={class:"am-cc__customers-item_inner"},Fk={class:"am-cc__customers-name"},Vk={class:"am-cc__customers-info"},Rk={class:"am-cc__customers-info"},qk={name:"TemplateCustomers"},Uk=Object.assign(qk,{props:{data:{type:[Array,Object,String]}},setup(n){const e=n;let t=F("containerWidth"),s=_(()=>tt(t.value));return(l,i)=>(u(),x("div",{class:R(["am-cc__customers",a(s)])},[(u(!0),x(ee,null,pe(a(e).data,(o,r)=>(u(),x("div",{key:r,class:"am-cc__customers-item"},[d("div",Bk,[d("span",Fk,w(o.firstName)+" "+w(o.lastName),1),d("span",Vk,w(o.email),1),d("span",Rk,w(o.phone),1)])]))),128))],2))}});const jk={class:"am-cc__popover-inner"},zk={key:0,class:"am-cc__popover-heading"},Yk={name:"CollapseCardPopoverTemplate"},fs=Object.assign(Yk,{props:{headerText:{type:String,default:""},type:{type:String,required:!0},contentData:{type:[Array,Object,String],default:""}},setup(n){const e=n;let t=M({period:Ge(rk),extras:Ge(gk),ticket:Ge(bk),customField:Ge(Tk),employee:Ge(Mk),customers:Ge(Uk)}),s=F("amFonts"),l=F("amColors"),i=_(()=>({"--am-c-cc-primary":l.value.colorPrimary,"--am-c-cc-primary-op70":W(l.value.colorPrimary,.7),"--am-c-cc-success":l.value.colorSuccess,"--am-c-cc-success-op15":W(l.value.colorSuccess,.15),"--am-c-cc-bgr":l.value.colorMainBgr,"--am-c-cc-text":l.value.colorMainText,"--am-c-cc-text-op10":W(l.value.colorMainText,.1),"--am-c-cc-text-op15":W(l.value.colorMainText,.15),"--am-c-cc-text-op70":W(l.value.colorMainText,.7),"--am-c-cc-text-op80":W(l.value.colorMainText,.8),"--am-c-cc-text-op90":W(l.value.colorMainText,.9),"--am-c-scroll-op30":W(l.value.colorPrimary,.3),"--am-c-scroll-op10":W(l.value.colorPrimary,.1),"--am-font-family":s.value.fontFamily,"--am-rad-input":"6px","--am-fs-input":"15px"}));return(o,r)=>{const c=hn;return u(),q(c,{"show-arrow":!1,persistent:!1,width:"auto","popper-class":"am-cc__popover","popper-style":a(i),trigger:"click"},{reference:S(()=>[Fr(o.$slots,"default")]),default:S(()=>[d("div",jk,[a(e).headerText?(u(),x("div",zk,w(a(e).headerText),1)):N("",!0),(u(),q(Ct(a(t)[a(e).type]),{class:"am-cc__popover-content",data:a(e).contentData},null,8,["data"]))])]),_:3},8,["popper-style"])}}});function Wk(n){let e=Zi(null,n.coupon,n.tax?n.tax[0]:null,n.price-n.price/100*n.discount,!1);return e.price-e.discount+e.tax}const hs=lt(window.wpAmeliaLabels);function Mr(n,e,t,s=null){t.type==="package"&&n.commit("cabinet/setPackageLoading",!0),t.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!0),t.type==="event"&&n.commit("cabinet/setEventsLoading",!0),n.commit("cabinet/setPaymentLinkLoader",t.bookings?t.bookings[0].id:t.id);let l=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(n.getters["auth/getProfile"]));i.birthday=null,l.customer=i,l.type!=="package"?(l[l.type]=t,l.booking=t.bookings[0],l.paymentId=t.bookings[0].payments[0].id):l=Object.assign(l,l.package),Pe.post("/payments/link",{data:l,paymentMethod:e}).then(o=>{!o.data.data.error&&o.data.data.paymentLink?window.location.href=o.data.data.paymentLink:n.commit("cabinet/setPaymentLinkError",{value:!0,type:t.type})}).catch(o=>{n.commit("cabinet/setPaymentLinkError",{value:!0,type:t.type})}).finally(()=>{n.commit("cabinet/setPaymentLinkLoader",null),t.type==="package"&&n.commit("cabinet/setPackageLoading",!1),t.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!1),t.type==="event"&&n.commit("cabinet/setEventsLoading",!1)})}function Yi(n,e){if(n.type!=="package"&&(!n.bookings||n.bookings.length===0))return!1;e=JSON.parse(e);let t=e&&"payments"in e&&e.payments&&"paymentLinks"in e.payments&&e.payments.paymentLinks?e.payments.paymentLinks:ot.payments.paymentLinks,s=!1;switch(n.type){case"package":s=!n.end||ve(n.end,"YYYY-MM-DD HH:mm").isAfter(ve());break;case"appointment":s=ve(n.bookingStart,"YYYY-MM-DD HH:mm:ss").isAfter(ve())&&n.bookings[0].payments.length>0;break;case"event":s=ve(n.periods[n.periods.length-1].periodEnd,"YYYY-MM-DD HH:mm:ss").isAfter(ve())&&n.bookings[0].payments.length>0;break}return Wi(ot).length&&ot&&t&&t.enabled&&s}function Wi(n){typeof n=="string"&&(n=JSON.parse(n));let e=[];return n=n.payments,ot.payments.wc.enabled?e.push({value:"wc",label:hs.wc}):ot.payments.mollie.enabled&&(!("mollie"in n)||n.mollie.enabled)?e.push({value:"mollie",label:hs.on_line}):(ot.payments.payPal.enabled&&(!("payPal"in n)||n.payPal.enabled)&&e.push({value:"payPal",label:hs.pay_pal}),ot.payments.stripe.enabled&&(!("stripe"in n)||n.stripe.enabled)&&e.push({value:"stripe",label:hs.credit_card}),ot.payments.razorpay.enabled&&(!("razorpay"in n)||n.razorpay.enabled)&&e.push({value:"razorpay",label:hs.razorpay}),ot.payments.square.enabled&&(!("square"in n)||n.square.enabled)&&e.push({value:"square",label:hs.square})),e}function Hn(n,e){switch(e.type){case"appointment":{let t=pl(n,{price:e.bookings[0].price,persons:e.bookings[0].persons,aggregatedPrice:e.bookings[0].aggregatedPrice,extras:e.bookings[0].extras,serviceId:null,tax:e.bookings[0].tax,coupon:e.bookings[0].coupon},!1);return t.total-t.discount+t.tax>e.bookings[0].payments.filter(s=>s.status!=="refunded"&&s.status!=="pending").reduce((s,l)=>s+l.amount,0)}case"event":return Wr(e)>e.bookings[0].payments.filter(t=>t.status!=="refunded"&&t.status!=="pending").reduce((t,s)=>t+s.amount,0);case"package":return Wk(e)>e.payments.filter(t=>t.status!=="refunded"&&t.status!=="pending").reduce((t,s)=>t+s.amount,0)}}const Hk={class:"am-cc__edit"},Zk=["onClick"],Gk={class:"am-cc__edit-text"},Jk={name:"PaymentButton"},iu=Object.assign(Jk,{props:{reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},type:{type:String},btnSize:{type:String,default:"mini"},class:{type:String,default:""}},setup(n){const e=n;let t=Ie();const s=F("amLabels");let l=_(()=>Wi(e.bookable.settings)),i=_(()=>t.getters["cabinet/getPaymentLinkLoader"]),o=jr({components:{IconComponent:He},template:'<IconComponent icon="arrow-down"></IconComponent>'}),r=M(!1);function c(y){y.stopPropagation(),l.value.length===1?Mr(t,l.value[0].value,e.reservation):r.value=!r.value}function m(){r.value=!1}let g=M(!1);function f(){g.value=!1}let v=F("amFonts"),k=F("amColors"),T=_(()=>({"--am-c-cc-primary":k.value.colorPrimary,"--am-c-cc-primary-op70":W(k.value.colorPrimary,.7),"--am-c-cc-error":k.value.colorError,"--am-c-cc-error-op15":W(k.value.colorError,.15),"--am-c-cc-warning":k.value.colorWarning,"--am-c-cc-warning-op15":W(k.value.colorWarning,.15),"--am-c-cc-success":k.value.colorSuccess,"--am-c-cc-success-op15":W(k.value.colorSuccess,.15),"--am-c-cc-bgr":k.value.colorMainBgr,"--am-c-cc-text":k.value.colorMainText,"--am-c-cc-text-op10":W(k.value.colorMainText,.1),"--am-c-cc-text-op15":W(k.value.colorMainText,.15),"--am-c-cc-text-op70":W(k.value.colorMainText,.7),"--am-c-cc-text-op90":W(k.value.colorMainText,.9),"--am-font-family":v.value.fontFamily,"--am-rad-input":"6px","--am-fs-input":"15px"}));return(y,b)=>{const L=hn;return a(Yi)(a(e).reservation,a(e).bookable.settings)?(u(),q(L,{key:0,ref:"payRef",visible:a(r),"onUpdate:visible":b[0]||(b[0]=E=>ye(r)?r.value=E:r=E),persistent:!1,"show-arrow":!1,"popper-class":"am-cc__popper","popper-style":a(T),trigger:"click"},{reference:S(()=>[$(ke,{size:a(e).btnSize,type:a(e).type,suffix:a(l).length>1&&a(Hn)(a(t),a(e).reservation)?a(o):"",class:R([{"am-button-single":a(l).length===1||!a(Hn)(a(t),a(e).reservation)},a(e).class]),loading:!!a(i),"loading-icon":"loading",disabled:!a(Hn)(a(t),a(e).reservation),onClick:c},{default:S(()=>[ie(w(a(Hn)(a(t),a(e).reservation)?a(s).pay_now_btn:a(s).paid),1)]),_:1},8,["size","type","suffix","class","loading","disabled"])]),default:S(()=>[Yt((u(),x("div",Hk,[(u(!0),x(ee,null,pe(a(Wi)(a(e).bookable.settings),E=>Yt((u(),x("div",{key:E.value,class:"am-cc__edit-item",onClick:C=>a(Mr)(a(t),E.value,a(e).reservation)},[d("span",Gk,w(E.label),1)],8,Zk)),[[a(ra),m]])),128))])),[[a(ra),f]])]),_:1},8,["visible","popper-style"])):N("",!0)}}});const Xk={class:"am-cc__time"},Qk={key:0,class:"am-cc__name"},Kk={key:0,class:"am-cc__name"},eC={key:1,class:"am-cc__places"},tC={key:2,class:"am-cc__customer"},aC={key:0,class:"am-cc__edit"},sC=d("span",{class:"am-icon-edit"},null,-1),nC={class:"am-cc__edit-text"},lC={key:0,class:"am-cc__edit"},iC=d("span",{class:"am-icon-users-plus"},null,-1),oC={class:"am-cc__edit-text"},rC={class:"am-cc__edit"},cC=d("span",{class:"am-icon-user"},null,-1),uC={class:"am-cc__edit-text"},dC={class:"am-cc__edit"},mC=d("span",{class:"am-icon-date-time"},null,-1),pC={class:"am-cc__edit-text"},gC=d("span",{class:"am-icon-clearable"},null,-1),fC={class:"am-cc__edit-text"},hC={class:"am-cc__content-inner"},vC={class:"am-cc__data"},_C=d("span",{class:"am-icon-user"},null,-1),yC={class:"am-cc__data-text"},bC={class:"am-cc__data"},kC=d("span",{class:"am-icon-user"},null,-1),CC={class:"am-cc__data-text"},xC={key:2,class:"am-cc__data"},wC=d("span",{class:"am-icon-payments"},null,-1),TC={class:"am-cc__data-text"},SC={key:3,class:"am-cc__data"},EC=d("span",{class:"am-icon-clock"},null,-1),LC={class:"am-cc__data-text"},AC={class:"am-cc__data"},$C=d("span",{class:"am-icon-clock"},null,-1),IC={class:"am-cc__data-text"},OC={key:5,class:"am-cc__data link"},PC=d("span",{class:"am-icon-link"},null,-1),NC=["href"],DC={key:6,class:"am-cc__data link"},MC=d("span",{class:"am-icon-link"},null,-1),BC=["href"],FC={key:7,class:"am-cc__data link"},VC=d("span",{class:"am-icon-link"},null,-1),RC=["href"],qC={key:8,class:"am-cc__data link"},UC=d("span",{class:"am-icon-link"},null,-1),jC=["href"],zC={class:"am-cc__data"},YC=d("span",{class:"am-icon-border-plus"},null,-1),WC={class:"am-cc__data-text"},HC={class:"am-cc__data"},ZC=d("span",{class:"am-icon-file-text"},null,-1),GC={class:"am-cc__data-text"},JC={class:"am-cc__data"},XC=d("span",{class:"am-icon-tickets"},null,-1),QC={class:"am-cc__data-text"},KC=d("span",{class:"am-icon-locations"},null,-1),ex=["href"],tx={key:1,class:"am-cc__data-text"},ax={name:"CollapseCard"},ou=Object.assign(ax,{props:{start:{type:[String,Object,Array,Function],required:!0},name:{type:String,default:""},employee:{type:[Object,Array],default:()=>{}},customers:{type:[Array],default:()=>{}},location:{type:[String,Object],default:""},price:{type:Number,default:0},duration:{type:Number,default:0},periods:{type:Array,default:()=>{}},extras:{type:Object,default:()=>{}},tickets:{type:Object,default:()=>{}},customFields:{type:Array,default:()=>[]},googleMeetLink:{type:String,default:""},microsoftTeamsLink:{type:String,default:""},zoomLink:{type:String,default:""},lessonSpaceLink:{type:String,default:""},reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},booking:{type:Object,default:()=>{}},isPackageBooking:{type:Boolean,default:!1},responsiveClass:{type:String,default:""},parentWidth:{type:Number,default:1200},customizedOptions:{type:Object,required:!0}},emits:["cancelBooking","rescheduling","editAppointment","editEvent","addEventAttendee","listEventAttendees"],setup(n,{emit:e}){const t=n,s=F("shortcodeData"),l=F("settings");let i=F("originKey");const o=F("amLabels");let r=M(!1);function c(I){I.stopPropagation(),r.value=!r.value}function m(){r.value=!1}function g(){e("cancelBooking",t.booking),r.value=!1}function f(I){e("edit"+I.charAt(0).toUpperCase()+I.slice(1),t.reservation),r.value=!1}function v(I){e("addEventAttendee",I),r.value=!1}function k(I){e("listEventAttendees",I),r.value=!1}function T(){e("rescheduling",t.reservation,t.booking),r.value=!1}function y(I){return Array.isArray(I)?o.value.event_staff:!Array.isArray(I)&&I.rank&&I.rank==="organizer"?o.value.event_organizer:`${t.employee.firstName} ${t.employee.lastName}`}let b=_(()=>t.reservation.type==="event"?t.reservation.maxCapacity-t.reservation.places+"/"+t.reservation.maxCapacity:""),L=_(()=>{if(t.reservation.type==="appointment")return{label:o.value[s.value.cabinetType==="employee"?t.reservation.status:t.booking.status],class:s.value.cabinetType==="employee"?t.reservation.status:t.booking.status};if(t.reservation.type==="event"){if(s.value.cabinetType==="customer")return{label:o.value[t.booking.status],class:t.booking.status};switch(t.reservation.status){case"rejected":case"canceled":return{label:o.value.canceled,class:"canceled"};case"full":return{label:o.value.full,class:"full"};case"waiting":return{label:o.value.waiting_list,class:"waiting"};case"upcoming":return{label:o.value.upcoming,class:"upcoming"};case"approved":if(t.reservation.closed)return{label:o.value.closed,class:"closed"};if(t.reservation.opened&&t.reservation.places>0)return{label:o.value.opened,class:"opened"}}}return{label:"",class:""}}),E=F("amFonts"),C=F("amColors"),h=_(()=>({"--am-c-cc-primary":C.value.colorPrimary,"--am-c-cc-primary-op15":W(C.value.colorPrimary,.15),"--am-c-cc-primary-op70":W(C.value.colorPrimary,.7),"--am-c-cc-error":C.value.colorError,"--am-c-cc-error-op15":W(C.value.colorError,.15),"--am-c-cc-warning":C.value.colorWarning,"--am-c-cc-warning-op15":W(C.value.colorWarning,.15),"--am-c-cc-success":C.value.colorSuccess,"--am-c-cc-success-op15":W(C.value.colorSuccess,.15),"--am-c-cc-bgr":C.value.colorMainBgr,"--am-c-cc-text":C.value.colorMainText,"--am-c-cc-text-op03":W(C.value.colorMainText,.03),"--am-c-cc-text-op10":W(C.value.colorMainText,.1),"--am-c-cc-text-op15":W(C.value.colorMainText,.15),"--am-c-cc-text-op70":W(C.value.colorMainText,.7),"--am-c-cc-text-op90":W(C.value.colorMainText,.9),"--am-font-family":E.value.fontFamily,"--am-rad-input":"6px","--am-fs-input":"15px"}));return(I,O)=>{const A=hn;return u(),x("div",{class:"am-cc",style:be(a(h))},[$(Du,null,{default:S(()=>[$(Nu,{"heading-class":"am-cc__heading-wrapper",side:a(t).parentWidth>500},{heading:S(()=>[d("div",{class:R(["am-cc__heading",a(t).responsiveClass])},[d("div",{class:R(["am-cc__heading-info",a(t).responsiveClass])},[d("div",{class:R(["am-cc__heading-info__part",a(t).responsiveClass])},[d("div",Xk,w(a(t).start),1),a(t).parentWidth>650?(u(),x("div",Qk,w(a(t).name),1)):N("",!0),a(t).reservation.type==="event"&&a(s).cabinetType==="employee"&&a(t).parentWidth<=650?(u(),x("div",{key:1,class:R(["am-cc__places",a(t).responsiveClass])},w(a(b)),3)):N("",!0),a(t).reservation.type==="appointment"&&a(s).cabinetType==="employee"&&a(t).customers.length===1&&a(t).customizedOptions.customer.visibility&&a(t).parentWidth<=650?(u(),x("div",{key:2,class:R(["am-cc__customer",a(t).responsiveClass])},w(`${a(t).customers[0].firstName} ${a(t).customers[0].lastName}`),3)):N("",!0),(a(t).booking||a(s).cabinetType==="employee")&&a(t).parentWidth<=650?(u(),x("div",{key:3,class:R(["am-cc__status",`am-cc__status-${a(L).class}`])},w(a(L).label),3)):N("",!0)],2),d("div",{class:R(["am-cc__heading-info__part",a(t).responsiveClass])},[a(t).parentWidth<=650?(u(),x("div",Kk,w(a(t).name),1)):N("",!0),a(t).reservation.type==="event"&&a(s).cabinetType==="employee"&&a(t).parentWidth>650?(u(),x("div",eC,w(a(b)),1)):N("",!0),a(t).reservation.type==="appointment"&&a(s).cabinetType==="employee"&&a(t).customers.length===1&&a(t).customizedOptions.customer.visibility&&a(t).parentWidth>650?(u(),x("div",tC,w(`${a(t).customers[0].firstName} ${a(t).customers[0].lastName}`),1)):N("",!0),(a(t).booking||a(s).cabinetType==="employee")&&a(t).parentWidth>650?(u(),x("div",{key:3,class:R(["am-cc__status",`am-cc__status-${a(L).class}`])},w(a(L).label),3)):N("",!0)],2)],2),a(s).cabinetType==="employee"?(u(),x("div",{key:0,class:R(["am-cc__heading-actions",a(t).responsiveClass])},[a(t).reservation.type!=="appointment"||a(l).roles.allowWriteAppointments?(u(),q(A,{key:0,ref:"editRef",visible:a(r),"onUpdate:visible":O[3]||(O[3]=D=>ye(r)?r.value=D:r=D),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(h),trigger:"click"},{reference:S(()=>[a(t).reservation?(u(),x("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:c})):N("",!0)]),default:S(()=>[a(t).reservation.type==="appointment"&&a(l).roles.allowWriteAppointments||a(t).reservation.type==="event"&&a(l).roles.allowWriteEvents?Yt((u(),x("div",aC,[d("div",{class:"am-cc__edit-item am-edit",onClick:O[0]||(O[0]=D=>f(a(t).reservation.type))},[sC,d("span",nC,w(a(o).edit),1)])])),[[a(ra),m]]):N("",!0),a(t).reservation.type==="event"?(u(),x(ee,{key:1},[a(l).roles.allowWriteEvents?Yt((u(),x("div",lC,[d("div",{class:"am-cc__edit-item am-edit",onClick:O[1]||(O[1]=D=>v(a(t).reservation))},[iC,d("span",oC,w(a(o).event_add_attendee),1)])])),[[a(ra),m]]):N("",!0),Yt((u(),x("div",rC,[d("div",{class:"am-cc__edit-item am-edit",onClick:O[2]||(O[2]=D=>k(a(t).reservation))},[cC,d("span",uC,w(a(o).attendees),1)])])),[[a(ra),m]])],64)):N("",!0)]),_:1},8,["visible","popper-style"])):N("",!0)],2)):(a(t).booking&&a(t).booking.status==="approved"||a(t).booking.status==="pending"||a(t).booking.status==="waiting")&&(!a(t).isPackageBooking&&a(t).booking.price>0&&a(Yi)(a(t).reservation,a(t).bookable.settings)||!!(a(t).reservation.cancelable||a(l).roles.allowCustomerReschedule&&a(t).reservation.reschedulable))?(u(),x("div",{key:1,class:R(["am-cc__heading-actions",a(t).responsiveClass])},[a(t).booking.status!=="waiting"&&!a(t).isPackageBooking&&a(t).booking.price>0&&a(Yi)(a(t).reservation,a(t).bookable.settings)?(u(),q(iu,{key:0,reservation:a(t).reservation,bookable:a(t).bookable},null,8,["reservation","bookable"])):N("",!0),a(t).reservation.cancelable||a(l).roles.allowCustomerReschedule&&a(t).reservation.reschedulable?(u(),q(A,{key:1,ref:"editRef",visible:a(r),"onUpdate:visible":O[4]||(O[4]=D=>ye(r)?r.value=D:r=D),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(h),trigger:"click"},{reference:S(()=>[a(t).booking?(u(),x("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:c})):N("",!0)]),default:S(()=>[Yt((u(),x("div",dC,[a(t).reservation.type==="appointment"&&a(l).roles.allowCustomerReschedule&&a(t).reservation.reschedulable?(u(),x("div",{key:0,class:"am-cc__edit-item",onClick:T},[mC,d("span",pC,w(a(o).reschedule),1)])):N("",!0),a(t).reservation.cancelable?(u(),x("div",{key:1,class:"am-cc__edit-item am-delete",onClick:g},[gC,d("span",fC,w(a(o).cancel),1)])):N("",!0)])),[[a(ra),m]])]),_:1},8,["visible","popper-style"])):N("",!0)],2)):N("",!0)],2)]),default:S(()=>[d("div",{class:R(["am-cc__content",a(t).responsiveClass])},[d("div",hC,[a(i)==="capc"&&n.customizedOptions.employee.visibility?(u(),x(ee,{key:0},[(Array.isArray(a(t).employee)?a(t).employee.length:Object.keys(a(t).employee).length)?(u(),q(fs,{key:0,"header-text":Array.isArray(a(t).employee)?a(o).view_employees:a(o).provider_profile,type:"employee","content-data":a(t).employee},{default:S(()=>[d("div",vC,[_C,d("span",yC,w(y(a(t).employee)),1)])]),_:1},8,["header-text","content-data"])):N("",!0)],64)):N("",!0),a(i)==="cape"&&a(t).reservation.type==="appointment"&&a(t).customers.length>1&&a(t).customizedOptions.customer.visibility?(u(),x(ee,{key:1},[a(t).customers.length?(u(),q(fs,{key:0,"header-text":a(o).customers,type:"customers","content-data":a(t).customers},{default:S(()=>[d("div",bC,[kC,d("span",CC,w(a(o).customers),1)])]),_:1},8,["header-text","content-data"])):N("",!0)],64)):N("",!0),a(t).price&&a(t).customizedOptions.price.visibility?(u(),x("div",xC,[wC,d("span",TC,w(a(nt)(a(t).price)),1)])):N("",!0),a(t).duration?(u(),x("div",SC,[EC,d("span",LC,w(a(fn)(a(t).duration,a(o).h,a(o).min)),1)])):N("",!0),n.periods.length?(u(),q(fs,{key:4,"header-text":a(o).event_timetable,type:"period","content-data":a(t).periods},{default:S(()=>[d("div",AC,[$C,d("span",IC,w(a(o).event_timetable),1)])]),_:1},8,["header-text","content-data"])):N("",!0),a(t).googleMeetLink?(u(),x("div",OC,[PC,d("a",{class:"am-cc__data-text link",href:a(t).googleMeetLink,target:"_blank"},w(a(o).google_meet_link),9,NC)])):N("",!0),a(t).microsoftTeamsLink?(u(),x("div",DC,[MC,d("a",{class:"am-cc__data-text link",href:a(t).microsoftTeamsLink,target:"_blank"},w(a(o).microsoft_teams_link),9,BC)])):N("",!0),a(t).zoomLink?(u(),x("div",FC,[VC,d("a",{class:"am-cc__data-text link",href:a(t).zoomLink,target:"_blank"},w(a(o).zoom_link),9,RC)])):N("",!0),a(t).lessonSpaceLink?(u(),x("div",qC,[UC,d("a",{class:"am-cc__data-text link",href:a(t).lessonSpaceLink,target:"_blank"},w(a(o).lesson_space_link),9,jC)])):N("",!0),Object.keys(a(t).extras).length?(u(),q(fs,{key:9,"header-text":`${Object.keys(a(t).extras).length} ${a(o).extras}`,type:"extras","content-data":a(t).extras},{default:S(()=>[d("div",zC,[YC,d("span",WC,w(`${Object.keys(a(t).extras).length} ${a(o).extras}`),1)])]),_:1},8,["header-text","content-data"])):N("",!0),a(t).customFields.length?(u(),q(fs,{key:10,"header-text":a(o).custom_fields,type:"customField","content-data":a(t).customFields},{default:S(()=>[d("div",HC,[ZC,d("span",GC,w(a(o).custom_fields),1)])]),_:1},8,["header-text","content-data"])):N("",!0),Object.keys(a(t).tickets).length?(u(),q(fs,{key:11,"header-text":a(o).event_tickets,type:"ticket","content-data":a(t).tickets},{default:S(()=>[d("div",JC,[XC,d("span",QC,w(a(o).event_tickets),1)])]),_:1},8,["header-text","content-data"])):N("",!0),a(t).location?(u(),x("div",{key:12,class:R(["am-cc__data",{link:a(t).location.address}])},[KC,a(t).location.address?(u(),x("a",{key:0,class:"am-cc__data-text",href:`https://maps.google.com/?q=${a(t).location.address}`,target:"_blank"},w(a(t).location.name),9,ex)):(u(),x("span",tx,w(a(t).location.name),1))],2)):N("",!0)])],2)]),_:1},8,["side"])]),_:1})],4)}}});const sx={class:"am-csd__header"},nx={class:"am-csd__header-text"},lx=d("span",{class:"am-icon-clearable"},null,-1),ix={class:"am-csd__footer"},ox={name:"AppointmentBooking"},ru=Object.assign(ox,{props:{visibility:{type:Boolean,default:!1},appointment:{type:Object,default:null},employees:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},slotsParams:{type:Object,default:()=>{}},labels:{type:Object,required:!0},customizedOptions:{type:Object,required:!0}},emits:["close","success","error","employee-selection","location-selection"],setup(n,{emit:e}){const t=n;let s=Ie();const l=F("settings");let i=F("amLabels"),o=M(null),r=M(null);rt(()=>t.appointment,_e=>{setTimeout(()=>{O.value++},200);let Ce=JSON.parse(JSON.stringify(_e));Ce&&Ce.bookingStart&&(o.value=Ce.bookingStart.split(" ")[0],r.value=Ce.bookingStart.split(" ")[1].substring(0,5))});let c=M(null),m=M(0),g=F("sidebarCollapsed");window.addEventListener("resize",f);function f(){c.value&&(m.value=c.value.offsetWidth)}rt(g,_e=>{_e?setTimeout(()=>{v()},1500):setTimeout(()=>{v()},500)});function v(){m.value=c.value.offsetWidth}Je(()=>{Gi(()=>{m.value=c.value.offsetWidth})});let k=_(()=>t.visibility);rt(k,_e=>{_e&&setTimeout(()=>{m.value=c.value.offsetWidth},300)});let T=_(()=>tt(m.value)),y=M(!1),b=M(null),L=M("");function E(){y.value=!1,L.value=""}let C=M(null),h=_(()=>C.value?C.value.calendarSlotsLoading:!0),I=F("cabinetType"),O=M(0),A=M(!1),D=M({employee:null,location:null}),V=M(!0),z=M(!0),B=_(()=>t.appointment&&!t.appointment.id&&(t.employees.length||t.locations.length)&&(t.customizedOptions.employee.visibility||t.customizedOptions.location.visibility)&&(V.value||z.value)),J=M(null),G=_(()=>B.value?{employee:[{required:"employee"in t.customizedOptions?t.customizedOptions.employee.required:!1,message:i.value.please_select_employee,trigger:"submit"}],location:[{required:"location"in t.customizedOptions?t.customizedOptions.location.required:!1,message:i.value.please_select_location,trigger:"submit"}]}:{}),X=_(()=>{let _e={};return D.value.employee?_e.providerIds=[D.value.employee]:"providerIds"in t.slotsParams&&t.slotsParams.providerIds.length&&(_e.providerIds=t.slotsParams.providerIds),D.value.location?_e.locationId=D.value.location:"locationId"in t.slotsParams&&t.slotsParams.locationId?_e.locationId=t.slotsParams.locationId:_e.locationId=null,Object.assign({},t.slotsParams,_e)});function K(){J.value&&J.value.clearValidate(),A.value=!0,O.value++,e("employee-selection",D.value.employee),e("location-selection",D.value.location)}function Q(_e){D.value.employee=_e,K()}function le(){B.value&&(D.value.employee=null,D.value.location=null,V.value=!0,z.value=!0,K()),e("close")}rt(k,_e=>{_e&&t.employees.length===1&&(D.value.employee=t.employees[0].id,V.value=!1),_e&&t.locations.length===1&&(D.value.location=t.locations[0].id,z.value=!1),_e&&(t.locations.length===1||t.employees.length===1)&&K()});let H=M();Be("formWrapper",H);let se=_(()=>s.getters["entities/getService"](t.appointment.serviceId).duration);Be("calendarSlotDuration",se);let ge=M(!0);Be("calendarChangeSideBar",ge);let $e=M(0);Be("calendarServiceDuration",$e);function ue(){"id"in t.appointment?me():j()}function ae(_e){let Ce=_e?"UTC":s.getters["cabinet/getTimeZone"],Te=o.value+" "+r.value,Me=null,Ee=null;if(_e){let Xe=Po(Te);Ee=Oo(Xe),Me=Xe}else Me=Te;return{utcOffset:Ee,bookingStart:Me,timeZone:Ce}}function me(){C.value.calendarSlotsLoading=!0;let _e=ae(!1);an()===s.getters["cabinet/getTimeZone"]&&l.general.showClientTimeZone&&(_e.utcOffset=Oo(Po(o.value+" "+r.value))),Pe.post("/bookings/reassign/"+t.appointment.bookings.filter(Ce=>Ce.status==="approved"||Ce.status==="pending")[0].id,_e,Object.assign(Ue(s),{params:{source:"cabinet-"+I.value}})).then(()=>{C.value.calendarSlotsLoading=!1,e("success",{message:i.value.appointment_rescheduled})}).catch(Ce=>{C.value.calendarSlotsLoading=!1,Ce.response&&(!("data"in Ce.response.data)&&"message"in Ce.response.data&&(y.value=!0,L.value=Ce.response.data.message,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500)),"data"in Ce.response&&"data"in Ce.response.data&&"cancelBookingUnavailable"in Ce.response.data.data&&(y.value=!0,L.value=t.labels.booking_cancel_exception,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500)),"data"in Ce.response&&"data"in Ce.response.data&&"timeSlotUnavailable"in Ce.response.data.data&&Ce.response.data.data.timeSlotUnavailable===!0&&(y.value=!0,L.value=t.labels.time_slot_unavailable,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500)),"data"in Ce.response&&"data"in Ce.response.data&&"rescheduleBookingUnavailable"in Ce.response.data.data&&Ce.response.data.data.rescheduleBookingUnavailable===!0&&(y.value=!0,L.value=t.labels.booking_reschedule_exception,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500))),e("error")})}function Y(){C.value.calendarSlotsLoading=!0;let _e=ae(l.general.showClientTimeZone&&s.getters["cabinet/getTimeZone"]===an()),Ce=JSON.parse(JSON.stringify(t.appointment));Ce.bookingStart=_e.bookingStart,Ce.bookings[0].utcOffset=_e.utcOffset,Ce.bookings[0].timeZone=_e.timeZone,Ce.providerId=parseInt(te.value),Ce.locationId=parseInt(de.value),Pe.post("/bookings",Ce,Ue(s)).then(Te=>{C.value.calendarSlotsLoading=!1,Fu(s,Te),e("success",{message:i.value.booking_added_success})}).catch(Te=>{C.value.calendarSlotsLoading=!1,Te.response&&("customerAlreadyBooked"in Te.response.data.data&&Te.response.data.data.customerAlreadyBooked===!0&&(y.value=!0,L.value=t.labels.customer_already_booked_app,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500)),"timeSlotUnavailable"in Te.response.data.data&&Te.response.data.data.timeSlotUnavailable===!0&&(y.value=!0,L.value=t.labels.time_slot_unavailable,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500)),"packageBookingUnavailable"in Te.response.data.data&&Te.response.data.data.packageBookingUnavailable===!0&&(y.value=!0,L.value=t.labels.package_booking_unavailable,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500)),"customerBlocked"in Te.response.data.data&&Te.response.data.data.customerBlocked===!0&&(y.value=!0,L.value=t.labels.customer_blocked,setTimeout(function(){gt(H.value,b.value.$el,0,300)},500))),e("error",Te)})}function j(){B.value?J.value.validate(_e=>{_e?Y():setTimeout(()=>{gt(H.value,J.value.$el,0,300)},200)}):Y()}let te=M(null),de=M(null),Z=M(null);function ce(_e,Ce){if(Z.value=Ce,A.value=!1,!t.appointment.bookingStart)return{calendarStartDate:zr(Object.keys(Ce))[0],calendarEventSlots:[],calendarEventSlot:null};let Te=t.appointment.bookingStart.split(" ");return{calendarStartDate:Te[0],calendarEventSlots:Te[0]in Ce?Object.keys(Ce[Te[0]]):[],calendarEventSlot:Te[1].slice(0,5)}}Be("useSlotsCallback",ce),Be("useRange",()=>{if(!t.appointment.bookingStart)return{start:null,end:null};let _e=t.appointment.bookingStart.split(" ")[0];return{start:ve(_e,"YYYY-MM-DD").startOf("month").subtract(6,"days").format("YYYY-MM-DD"),end:ve(_e,"YYYY-MM-DD").endOf("month").add(12,"days").format("YYYY-MM-DD")}}),Be("useSelectedDuration",()=>{});function fe(){let _e=Object.keys(Z.value[o.value]);_e.length&&(te.value=r.value&&Z.value[o.value][r.value]?Z.value[o.value][r.value][0][0]:Z.value[o.value][_e[0]][0][0],de.value=r.value&&Z.value[o.value][r.value]?Z.value[o.value][r.value][0][1]:Z.value[o.value][_e[0]][0][1])}Be("useBusySlots",()=>[]),Be("useSelectedDate",(_e,Ce)=>(o.value=Ce,t.appointment&&t.appointment.bookingStart&&(r.value=t.appointment.bookingStart.split(" ")[1].substring(0,5)),fe(),Object.keys(Z.value[Ce]))),Be("useSelectedTime",(_e,Ce)=>{r.value=Ce.substring(0,5),o.value?fe():t.appointment&&(o.value=t.appointment.bookingStart.split(" ")[0],fe())}),Be("useDeselectedDate",()=>{o.value="",r.value="",te.value=null,de.value=null});let Ne=F("amFonts"),Oe=F("amColors"),je=_(()=>({"--am-c-csd-text":Oe.value.colorMainText,"--am-c-csd-bgr":Oe.value.colorMainBgr,"--am-c-csd-text-op10":W(Oe.value.colorMainText,.1),"--am-c-scroll-op30":W(Oe.value.colorPrimary,.3),"--am-c-scroll-op10":W(Oe.value.colorPrimary,.1),"--am-font-family":Ne.value.fontFamily}));return(_e,Ce)=>{const Te=xt,Me=et;return u(),q(Ja,{visibility:a(t).visibility,"custom-class":"am-csd am-csd__reschedule",style:be(a(je)),position:"center"},{footer:S(()=>[d("div",ix,[$(ke,{category:"secondary",size:a(m)<=360?"small":"default",type:a(t).customizedOptions.cancelBtn.buttonType,disabled:a(A)||a(h),onClick:le},{default:S(()=>[ie(w(n.labels.cancel),1)]),_:1},8,["size","type","disabled"]),$(ke,{size:a(m)<=360?"small":"default",type:a(t).customizedOptions.continueBtn.buttonType,disabled:!!(a(A)||a(h)||!a(o)||!a(r)),onClick:ue},{default:S(()=>[ie(w(n.labels.continue),1)]),_:1},8,["size","type","disabled"])])]),default:S(()=>[d("div",{ref_key:"popupInnerRef",ref:c,class:"am-csd__inner"},[d("div",sx,[d("div",nx,w(n.labels.no_selected_slot_requirements),1),d("div",{class:"am-csd__header-btn",onClick:le},[$(He,{icon:"close"})])]),d("div",{ref_key:"rescheduleRef",ref:H,class:"am-csd__content"},[a(y)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:b,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:E,onTriggerClose:E},{title:S(()=>[lx,ie(" "+w(a(L)),1)]),_:1},512)):N("",!0),a(B)?(u(),q(Me,{key:1,ref_key:"packageFormRef",ref:J,class:"am-csd__filter-wrapper",rules:a(G),model:a(D),"label-position":"top"},{default:S(()=>[d("div",{class:R(["am-csd__filter am-csd__filter-employee",a(T)])},[a(t).employees.length&&a(V)&&a(t).customizedOptions.employee.visibility?(u(),q(Te,{key:0,class:R([{"am-csd__filter-full":!(a(t).locations.length&&a(z)&&a(t).customizedOptions.location.visibility)},a(T)]),label:`${a(i).package_appointment_employee}:`,prop:"employee"},{default:S(()=>[$(We,{modelValue:a(D).employee,"onUpdate:modelValue":Ce[0]||(Ce[0]=Ee=>a(D).employee=Ee),clearable:"",filterable:a(t).customizedOptions.employee.filterable,placeholder:`${a(i).package_select_employee}...`,"fit-input-width":!0,"popper-class":"am-csd__filter-employees",disabled:a(A),onChange:K},{default:S(()=>[(u(!0),x(ee,null,pe(a(t).employees,Ee=>(u(),q(Ve,{key:Ee.id,value:Ee.id,label:`${Ee.firstName} ${Ee.lastName}`},{default:S(()=>[$(Mu,{identifier:Ee.id,label:`${Ee.firstName} ${Ee.lastName}`,price:0,"image-thumb":Ee.pictureThumbPath,description:Ee.description,"dialog-title":a(i).employee_information_package,"dialog-button-text":a(i).select_this_employee_package,badge:Ee.badge,onClick:Q},null,8,["identifier","label","image-thumb","description","dialog-title","dialog-button-text","badge"])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):N("",!0),a(t).locations.length&&a(z)&&a(t).customizedOptions.location.visibility?(u(),q(Te,{key:1,class:R([{"am-csd__filter-full":!(a(t).employees.length&&a(V)&&a(t).customizedOptions.employee.visibility)},a(T)]),label:`${a(i).package_appointment_location}:`,prop:"location"},{default:S(()=>[$(We,{modelValue:a(D).location,"onUpdate:modelValue":Ce[1]||(Ce[1]=Ee=>a(D).location=Ee),clearable:"",filterable:a(t).customizedOptions.location.filterable,placeholder:`${a(i).package_select_location}...`,"fit-input-width":!0,disabled:a(A),onChange:K},{default:S(()=>[(u(!0),x(ee,null,pe(a(t).locations,Ee=>(u(),q(Ve,{key:Ee.id,value:Ee.id,label:Ee.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):N("",!0)],2)]),_:1},8,["rules","model"])):N("",!0),a(t).appointment!==null?(u(),q(Bu,{key:2,id:0,ref_key:"calendarRef",ref:C,"preselect-slot":!1,"load-counter":a(O),"end-time":a(t).customizedOptions.endTimeVisibility.visibility,"time-zone":a(t).customizedOptions.timeZoneVisibility.visibility,"label-slots-selected":n.labels.date_time_slots_selected,"fetched-slots":null,"service-id":0,date:a(t).appointment&&a(t).appointment.bookingStart?a(t).appointment.bookingStart.split(" ")[0]:"","slots-params":a(X)},null,8,["load-counter","end-time","time-zone","label-slots-selected","date","slots-params"])):N("",!0)],512)],512)]),_:1},8,["visibility","style"])}}});const rx={class:"am-csd__inner"},cx={class:"am-csd__header"},ux={class:"am-csd__header-text"},dx={class:"am-csd__content"},mx={class:"am-ccpss__heading"},px={class:"am-csd__footer"},gx={name:"CancelBooking"},Da=Object.assign(gx,{props:{visibility:{type:Boolean,required:!0},title:{type:String,default:""},description:{type:String,default:""},closeBtnText:{type:String,required:!0},confirmBtnText:{type:String,required:!0},loading:{type:Boolean,default:!1},count:{type:Number,default:1},customizedOptions:{type:Object,required:!0}},emits:["close","confirm","decline"],setup(n,{emit:e}){const t=n;let s=F("containerWidth"),l=F("amFonts"),i=F("amColors"),o=_(()=>({"--am-c-csd-text":i.value.colorMainText,"--am-c-csd-bgr":i.value.colorMainBgr,"--am-font-family":l.value.fontFamily}));return(r,c)=>{const m=dl,g=ml;return u(),q(Ja,{visibility:a(t).visibility,"custom-class":"am-csd am-csd__cancel",style:be(a(o)),position:"center"},{footer:S(()=>[d("div",px,[$(ke,{category:"secondary",size:a(s)<=360?"small":"default",type:n.customizedOptions.cancelBtn.buttonType,disabled:n.loading,onClick:c[1]||(c[1]=()=>{e("decline")})},{default:S(()=>[ie(w(a(t).closeBtnText),1)]),_:1},8,["size","type","disabled"]),$(ke,{category:"danger",size:a(s)<=360?"small":"default",type:n.customizedOptions.confirmBtn.buttonType,disabled:n.loading,onClick:c[2]||(c[2]=()=>{e("confirm")})},{default:S(()=>[ie(w(a(t).confirmBtnText),1)]),_:1},8,["size","type","disabled"])])]),default:S(()=>[d("div",rx,[n.loading?(u(),q(g,{key:1,animated:"",class:"am-ccpss"},{template:S(()=>[d("div",mx,[$(m,{variant:"rect"})]),(u(!0),x(ee,null,pe(new Array(a(t).count),f=>(u(),x("div",{key:f,class:"am-ccpss__text"},[$(m,{variant:"rect"})]))),128))]),_:1})):(u(),x(ee,{key:0},[d("div",cx,[d("div",ux,w(a(t).title),1),d("div",{class:"am-csd__header-btn",onClick:c[0]||(c[0]=()=>{e("close")})},[$(He,{icon:"close"})])]),d("div",dx,[d("p",null,w(a(t).description),1)])],64))])]),_:1},8,["visibility","style"])}}});const fx={name:"CabinetAppointmentsList"},cu=Object.assign(fx,{props:{groupedAppointments:{type:Object,default:null},responsiveClass:{type:String,default:""},pageWidth:{type:Number},isPackageBooking:{type:Boolean,default:!1},stepKey:{type:String,required:!0}},emits:["booked","canceled","editAppointment"],setup(n,{emit:e}){const t=n;let s=Ie(),l=F("originKey");const i=F("settings");let o=F("amLabels"),r=F("cabinetType"),c=M(null),m=M(null),g=M(null);function f(V=null){m.value=null,e("booked",V)}let v=M(!1);function k(){v.value=!0,Pe.post("/bookings/cancel/"+c.value.id,{type:"appointment"},Object.assign(Ue(s),{params:{source:"cabinet-"+r.value}})).then(()=>{c.value=null,e("canceled",{message:o.value.appointment_canceled})}).catch(V=>{console.log(V)}).finally(()=>{v.value=!1})}function T(V){let z={total:0,bookable:0,discount:0,tax:0};return V.bookings.forEach(B=>{if(B.status==="approved"||B.status==="pending"){let J=pl(s,{price:B.price,persons:B.persons,aggregatedPrice:B.aggregatedPrice,extras:B.extras,tax:B.tax,coupon:B.coupon},!1);z.total+=J.total,z.bookable+=J.bookable,z.discount+=J.discount,z.tax+=J.tax}}),z.total-z.discount+z.tax}function y(V){let z=[],B=0,J=V;J.bookings.forEach(X=>{X.extras.forEach(K=>{z.push({id:K.extraId,quantity:K.quantity})}),"duration"in X&&X.duration&&X.duration>B&&(X.status==="approved"||X.status==="pending")&&(B=X.duration)});let G={serviceId:J.serviceId,serviceDuration:B||null,locationId:J.locationId,providerIds:[J.providerId],extras:JSON.stringify(z),excludeAppointmentId:J.isGroup?null:J.id,group:1,timeZone:s.getters["cabinet/getTimeZone"],page:"cabinet"};m.value=V,g.value=G}function b(V){return s.getters["entities/getEmployee"](V)}let L=F("amCustomize");const E=F("labels"),C=F("localLanguage");let h=_(()=>i.general.usedLanguages.includes(C.value));function I(V){let z=lt({...E}),B=L.value[V].translations;return B&&Object.keys(B).forEach(J=>{B[J][C.value]&&h.value?z[J]=B[J][C.value]:B[J].default&&(z[J]=B[J].default)}),z}function O(V){return L.value[V].options}let A=F("amColors"),D=_(()=>({"--am-c-capa-bgr":A.value.colorMainBgr,"--am-c-capa-text":A.value.colorMainText,"--am-c-capa-text-op70":W(A.value.colorMainText,.7),"--am-c-capa-text-op25":W(A.value.colorMainText,.25),"--am-c-capa-primary":A.value.colorPrimary}));return(V,z)=>(u(),x(ee,null,[d("div",{class:R(["am-capa__wrapper",[{"am-no-border":a(t).groupedAppointments&&Object.keys(a(t).groupedAppointments).length===1},a(t).responsiveClass]]),style:be(a(D))},[(u(!0),x(ee,null,pe(a(t).groupedAppointments,(B,J)=>(u(),x("div",{key:J,class:"am-capa"},[d("div",{class:R(["am-capa__date",[{"am-today":a(dt)(J)===a(dt)(a(at)().format("YYYY-MM-DD"))},{"am-no-flag":a(t).groupedAppointments&&Object.keys(a(t).groupedAppointments).length===1},a(t).responsiveClass]])},w(a(dt)(J)),3),(u(!0),x(ee,null,pe(B.appointments,(G,X)=>(u(),x(ee,{key:X},[a(s).getters["entities/getService"](G.serviceId)?(u(),q(ou,{key:0,start:a(sn)(G.bookingStart.split(" ")[1].slice(0,5)),name:a(s).getters["entities/getService"](G.serviceId).name,employee:b(G.provider.id),customers:G.bookings.filter(K=>K.status!=="rejected"&&K.status!=="canceled").map(K=>K.customer),price:T(G),duration:a(Z0)(a(s),G),periods:[],extras:a(G0)(G.bookings,a(s).getters["entities/getService"](G.serviceId)),tickets:[],"custom-fields":a(lu)(G.bookings,a(r)),location:G.locationId?a(s).getters["entities/getLocation"](G.locationId):null,"google-meet-link":G.googleMeetUrl,"microsoft-teams-link":G.microsoftTeamsUrl,"zoom-link":G.zoomMeeting?G.zoomMeeting.joinUrl:"","lesson-space-link":G.lessonSpace,bookable:G.service,reservation:G,booking:G.bookings[0],"is-package-booking":a(t).isPackageBooking,"responsive-class":a(t).responsiveClass,"parent-width":a(t).pageWidth,"customized-options":O(a(t).stepKey),onCancelBooking:z[0]||(z[0]=K=>{ye(c)?c.value=K:c=K}),onRescheduling:y,onEditAppointment:z[1]||(z[1]=K=>{a(e)("editAppointment",K)})},null,8,["start","name","employee","customers","price","duration","extras","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","is-package-booking","responsive-class","parent-width","customized-options"])):N("",!0)],64))),128))]))),128))],6),a(l)==="capc"?(u(),q(Da,{key:0,visibility:a(c)!==null,title:I("cancelAppointment").cancel_appointment,description:I("cancelAppointment").confirm_cancel_appointment,"close-btn-text":I("cancelAppointment").close,"confirm-btn-text":I("cancelAppointment").confirm,"customized-options":O("cancelAppointment"),loading:a(v),onClose:z[2]||(z[2]=B=>ye(c)?c.value=null:c=null),onDecline:z[3]||(z[3]=B=>ye(c)?c.value=null:c=null),onConfirm:k},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):N("",!0),a(l)==="capc"?(u(),q(ru,{key:1,visibility:a(m)!==null,appointment:a(m),"slots-params":a(g),labels:I("rescheduleAppointment"),"customized-options":O("rescheduleAppointment"),onClose:z[4]||(z[4]=B=>ye(m)?m.value=null:m=null),onSuccess:f,onError:z[5]||(z[5]=()=>{})},null,8,["visibility","appointment","slots-params","labels","customized-options"])):N("",!0)],64))}});const hx={class:"am-capai-def__notify"},vx=["innerHTML"],_x={props:{slotsProps:{type:Object,required:!0},slotsLoading:{type:Boolean,required:!0},isDisabledDate:{type:Function,required:!0},freeSlots:{type:Object,required:!0},times:{type:Array,required:!0},getFreeTimes:{type:Function,required:!0}},emits:["removeSlots","fetchSlots","changedSlotCondition","getSelectedDatesTimes","filterOut","getFreeTimes","selectDate","selectTime"],setup(n,{expose:e,emit:t}){const s=n;let l=Ie(),i=F("amLabels"),o=F("localLanguage");const r=F("settings");let c=F("licence");const m=M(null);let{width:g}=Ka(m),f=_(()=>tt(g.value)),v=M({categoryId:_({get:()=>l.getters["appointment/getCategoryId"],set:G=>{l.commit("appointment/setCategoryId",G||null)}}),serviceId:_({get:()=>l.getters["appointment/getServiceId"],set:G=>{l.commit("appointment/setServiceId",G||null)}}),providerId:_({get:()=>l.getters["appointment/getProviderId"],set:G=>{l.commit("appointment/setProviderId",G||null)}}),locationId:_({get:()=>l.getters["appointment/getLocationId"],set:G=>{l.commit("appointment/setLocationId",G||null)}}),lessonSpace:_({get:()=>l.getters["appointment/getLessonSpace"],set:G=>{l.commit("appointment/setLessonSpace",G||"")}}),startDate:_({get:()=>l.getters["appointment/getStartDate"],set:G=>{l.commit("appointment/setStartDate",G||"")}}),startTime:_({get:()=>l.getters["appointment/getStartTime"],set:G=>{l.commit("appointment/setStartTime",G||"")}}),notifyParticipants:_({get:()=>l.getters["appointment/getNotifyParticipants"],set:G=>{l.commit("appointment/setNotifyParticipants",G)}}),internalNotes:_({get:()=>l.getters["appointment/getInternalNotes"],set:G=>{l.commit("appointment/setInternalNotes",G||"")}})}),k=_(()=>({serviceId:[{required:!0,message:i.value.please_select_service,trigger:["submit","change"]}],startDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],startTime:[{required:!0,message:i.value.select_time_warning,trigger:["submit","change"]}]})),T=_(()=>l.getters["entities/filteredCategories"](l.getters["appointment/getSelection"])),y=M(l.getters["entities/filteredCategories"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),b=_(()=>l.getters["entities/filteredServices"](l.getters["appointment/getSelection"])),L=M(l.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),E=_(()=>l.getters["appointment/getId"]&&l.getters["appointment/getServiceId"]&&L.value.map(G=>G.id).indexOf(l.getters["appointment/getServiceId"])===-1?l.getters["entities/getService"](l.getters["appointment/getServiceId"]):null),C=_(()=>l.getters["entities/filteredLocations"](l.getters["appointment/getSelection"])),h=M(l.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),I=_(()=>l.getters["appointment/getId"]&&l.getters["appointment/getLocationId"]&&h.value.map(G=>G.id).indexOf(l.getters["appointment/getLocationId"])===-1?l.getters["entities/getLocation"](l.getters["appointment/getLocationId"]):null),O=M(l.getters["entities/getSpaces"]);function A(){l.commit("appointment/setTargetedDate",null),l.commit("appointment/setStartDate",null),l.commit("appointment/setStartTime",null),t("removeSlots")}function D(G,X=null,K=!1){let Q=l.getters["appointment/getTargetedDate"];!G&&!Q?G=ve().toDate():!G&&Q&&(G=Q),l.commit("appointment/setTargetedDate",G&&K?G:Q),v.value.serviceId&&t("fetchSlots",G,X,K)}function V(){v.value.startDate&&D(v.value.startDate)}function z(G){t("selectTime",G)}function B(G){G?t("selectDate",G):A()}function J(G){G?(clearTimeout(this.searchSpacesTimer),l.commit("auth/setSpacesLoading",!0),Pe.get("/entities",{params:{types:["spaces"],lessonSpaceSearch:G}}).then(X=>{O.value=X.data.data.spaces}).catch(X=>{console.log(X)}).finally(()=>{l.commit("auth/setSpacesLoading",!1)})):O.value=l.getters["entities/getSpaces"]}return rt(()=>v.value.serviceId,G=>{l.dispatch("appointment/updateEmployeeService",G||null),G&&(l.dispatch("appointment/recreateAllBookingCustomFields",{label:i.value.required_field}),V())}),Je(()=>{L.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setServiceId",L.value[0].id),h.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setLocationId",h.value[0].id)}),e({detailsFormRef:m}),(G,X)=>{const K=xt,Q=gl,le=et;return u(),q(le,{ref_key:"detailsFormRef",ref:m,model:a(v),rules:a(k),class:"am-capai-def"},{default:S(()=>[a(y).length>1?(u(),q(K,{key:0,label:`${a(i).category}`,class:"am-capai-def__item"},{default:S(()=>[$(We,{modelValue:a(v).categoryId,"onUpdate:modelValue":X[0]||(X[0]=H=>a(v).categoryId=H),clearable:"",filterable:"",placeholder:`${a(i).select_service_category}`},{default:S(()=>[(u(!0),x(ee,null,pe(a(y),H=>(u(),q(Ve,{key:H.id,value:H.id,label:H.name,disabled:a(v).serviceId&&typeof a(T).find(se=>se.id===H.id)>"u"},null,8,["value","label","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),$(K,{label:`${a(i).services_dropdown}`,prop:"serviceId",class:"am-capai-def__item"},{default:S(()=>[$(We,{modelValue:a(v).serviceId,"onUpdate:modelValue":X[1]||(X[1]=H=>a(v).serviceId=H),disabled:a(L).length===1,clearable:"",filterable:"",placeholder:`${a(i).select_service}`},{default:S(()=>[(u(!0),x(ee,null,pe(a(L),H=>(u(),q(Ve,{key:H.id,value:H.id,label:H.name,disabled:typeof a(b).find(se=>se.id===H.id)>"u"},null,8,["value","label","disabled"]))),128)),a(E)?(u(),q(Ve,{key:a(E).id,value:a(E).id,label:a(E).name},null,8,["value","label"])):N("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),!a(c).isStarter&&a(h).length>1?(u(),q(K,{key:1,label:`${a(i).location}`,class:"am-capai-def__item"},{default:S(()=>[$(We,{modelValue:a(v).locationId,"onUpdate:modelValue":X[2]||(X[2]=H=>a(v).locationId=H),disabled:a(h).length===1,clearable:"",filterable:"",placeholder:`${a(i).select_location}`,onChange:V},{default:S(()=>[(u(!0),x(ee,null,pe(a(h),H=>(u(),q(Ve,{key:H.id,value:H.id,label:H.name,disabled:a(I)===null&&typeof a(C).find(se=>se.id===H.id)>"u"},null,8,["value","label","disabled"]))),128)),a(I)?(u(),q(Ve,{key:a(I).id,value:a(I).id,label:a(I).name},null,8,["value","label"])):N("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])):N("",!0),a(r).lessonSpace.enabled?(u(),q(K,{key:2,label:`${a(i).lesson_space}`,class:"am-capai-def__item"},{default:S(()=>[$(We,{modelValue:a(v).lessonSpace,"onUpdate:modelValue":X[3]||(X[3]=H=>a(v).lessonSpace=H),filterable:"",clearable:"",remote:"","remote-method":J,placeholder:`${a(i).select}`},{default:S(()=>[(u(),q(Ve,{key:0,value:0,label:a(i).lesson_space_new_space},null,8,["label"])),(u(!0),x(ee,null,pe(a(O),H=>(u(),q(Ve,{key:H.id,value:H.id,label:H.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),$(K,{label:`${a(i).date}`,prop:"startDate",class:R(["am-capai-def__item am-w-50",a(f)])},{default:S(()=>[$(Ht,{modelValue:a(v).startDate,"onUpdate:modelValue":X[4]||(X[4]=H=>a(v).startDate=H),type:"date",format:a(Wt)(),placeholder:a(i).select_date,clearable:!0,size:"default",lang:a(o),disabled:!a(v).serviceId,"disabled-date":(H,se)=>a(s).isDisabledDate(H,null,!0,se),"popper-class":n.slotsLoading?"am-slots-loader":"",onPanelChange:X[5]||(X[5]=H=>{D(H,null,!0)}),onChange:B,onFocus:X[6]||(X[6]=H=>a(v).serviceId&&!a(v).startDate?D(null,null,!0):!1)},null,8,["modelValue","format","placeholder","lang","disabled","disabled-date","popper-class"])]),_:1},8,["label","class"]),$(K,{label:`${a(i).time}`,prop:"startTime",class:R(["am-capai-def__item am-w-50",a(f)])},{default:S(()=>[$(We,{modelValue:a(v).startTime,"onUpdate:modelValue":X[7]||(X[7]=H=>a(v).startTime=H),placeholder:`${a(i).select_time}`,disabled:!a(v).startDate,"prefix-icon":"clock","prefix-icon-color":"var(--am-c-select-placeholder)",onChange:z},{default:S(()=>[(u(!0),x(ee,null,pe(a(s).getFreeTimes(null,{date:a(v).startDate,times:a(s).times,time:a(v).startTime},!0),H=>(u(),q(Ve,{key:H,value:H,label:H},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label","class"]),$(K,{class:"am-capai-def__item"},{default:S(()=>[d("div",hx,[$(ft,{modelValue:a(v).notifyParticipants,"onUpdate:modelValue":X[8]||(X[8]=H=>a(v).notifyParticipants=H),label:a(i).notify_customers},null,8,["modelValue","label"]),$(Q,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(i).notify_customers_tooltip},null,8,vx)]),default:S(()=>[$(He,{icon:"info-reverse"})]),_:1})])]),_:1}),$(K,{label:`${a(i).note_internal}`,class:"am-capai-def__item"},{default:S(()=>[$(St,{modelValue:a(v).internalNotes,"onUpdate:modelValue":X[9]||(X[9]=H=>a(v).internalNotes=H),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};function uu(n,e){return Object.assign({},e,{gender:e.gender?e.gender:"",note:e.note?e.note:"",phone:e.phone?e.phone:"",birthday:e.birthday?ve(e.birthday.date.split(" ")[0]).toDate():null,translations:e.translations?JSON.parse(e.translations):{defaultLanguage:""}})}function yx(n){let e=n.getters["customerInfo/getCustomer"];return Object.assign({},e,{birthday:e.birthday?ve(e.birthday).format("YYYY-MM-DD"):null,translations:e.translations.defaultLanguage?JSON.stringify(e.translations):null})}const vs=lt(window.wpAmeliaLabels);function bx(){return[{value:"approved",label:vs.approved,icon:"check",color:"var(--am-c-success)"},{value:"pending",label:vs.pending,icon:"refresh",color:"var(--am-c-warning)"},{value:"canceled",label:vs.canceled,icon:"close",color:"var(--am-c-error)"},{value:"rejected",label:vs.rejected,icon:"info-reverse",color:"var(--am-c-main-text)"},{value:"waiting",label:vs.waiting,icon:"clock",color:"var(--am-c-warning)"},{value:"no-show",label:vs["no-show"],icon:"clock",color:"var(--am-c-warning)"}]}const kx=d("span",{class:"am-icon-triangle-info"},null,-1),Cx={key:0,class:"am-capai-warn__content"},xx={key:0,class:"am-capai-warn__heading"},wx={key:1,class:"am-capai-warn__text"},du={props:{heading:{type:String,default:""},text:{type:String,default:""}},setup(n){const e=n;let t=F("amColors"),s=_(()=>({"--am-c-warning":t.value.colorWarning,"--am-c-warning-op10":W(t.value.colorWarning,.1),"--am-c-main-text":t.value.colorMainText,"--am-c-main-text-op10":W(t.value.colorMainText,.1)}));return(l,i)=>(u(),x("div",{class:"am-capai-warn",style:be(a(s))},[kx,e.heading||e.text?(u(),x("div",Cx,[e.heading?(u(),x("div",xx,w(e.heading),1)):N("",!0),e.text?(u(),x("div",wx,w(e.text),1)):N("",!0)])):N("",!0)],4))}};const Tx={class:"am-cap-aec__header"},Sx=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),mu={props:{visibility:{type:Boolean,required:!0},customCss:{type:Object,default:()=>{}},responsiveClass:{type:String,default:""}},emits:["update:visibility","addedCustomer"],setup(n,{emit:e}){const t=n,s=F("settings");let l=F("amLabels");const i=Ie();let o=M(null),r=M(!1),c=M("success"),m=M("");function g(){r.value=!1,i.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let f=_(()=>i.getters["customerInfo/getCustomerId"]),v=_(()=>{let A=[];return s.wordpress.locale in i.getters["entities/getSettings"].languages&&A.push({value:i.getters["entities/getSettings"].languages[s.wordpress.locale].wp_locale,label:i.getters["entities/getSettings"].languages[s.wordpress.locale].name}),s.general.usedLanguages.forEach(D=>{D in i.getters["entities/getSettings"].languages&&A.push({value:i.getters["entities/getSettings"].languages[D].wp_locale,label:i.getters["entities/getSettings"].languages[D].name})}),A}),k=M(null),T=M(!1),y=M({firstName:_({get:()=>i.getters["customerInfo/getCustomerFirstName"],set:A=>{i.commit("customerInfo/setCustomerFirstName",A||"")}}),lastName:_({get:()=>i.getters["customerInfo/getCustomerLastName"],set:A=>{i.commit("customerInfo/setCustomerLastName",A||"")}}),email:_({get:()=>i.getters["customerInfo/getCustomerEmail"],set:A=>{i.commit("customerInfo/setCustomerEmail",A||"")}}),phone:_({get:()=>i.getters["customerInfo/getCustomerPhone"],set:A=>{i.commit("customerInfo/setCustomerPhone",A||"")}}),language:_({get:()=>i.getters["customerInfo/getCustomerLanguage"],set:A=>{i.commit("customerInfo/setCustomerLanguage",A||"")}}),gender:_({get:()=>i.getters["customerInfo/getCustomerGender"],set:A=>{i.commit("customerInfo/setCustomerGender",A||"")}}),birthday:_({get:()=>i.getters["customerInfo/getCustomerBirthday"]||"",set:A=>{i.commit("customerInfo/setCustomerBirthday",A?ve(A).format("YYYY-MM-DD"):"")}}),note:_({get:()=>i.getters["customerInfo/getCustomerNote"],set:A=>{i.commit("customerInfo/setCustomerNote",A||"")}})}),b=M({firstName:[{required:!0,message:l.value.enter_first_name_warning,trigger:["submit","blur"]}],lastName:[{required:!0,message:l.value.enter_last_name_warning,trigger:["submit","blur"]}]}),L=M({firstName:{template:Ye.text,props:{itemName:"firstName",label:l.value.first_name_colon,placeholder:l.value.enter_first_name,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`),iconStart:Ge({components:{IconComponent:He},template:'<IconComponent icon="user"/>'})}},lastName:{template:Ye.text,props:{itemName:"lastName",label:l.value.last_name_colon,placeholder:l.value.enter_last_name,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`),iconStart:Ge({components:{IconComponent:He},template:'<IconComponent icon="user"/>'})}},email:{template:Ye.text,props:{itemName:"email",label:l.value.email_colon,placeholder:l.value.enter_email,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`),iconStart:Ge({components:{IconComponent:He},template:'<IconComponent icon="email"/>'})}},phone:{countryPhoneIso:_({get:()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]||"",set:A=>{i.commit("customerInfo/setCustomerCountryPhoneIso",A?A.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:l.value.phone_colon,placeholder:l.value.enter_phone,defaultCode:_(()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]||""),phoneError:_(()=>T.value),whatsAppLabel:l.value.whatsapp_opt_in_text,isWhatsApp:s.notifications.whatsAppEnabled&&s.notifications.whatsAppAccessToken&&s.notifications.whatsAppBusinessID&&s.notifications.whatsAppPhoneID,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`)}},language:{template:Ye.select,props:{itemName:"language",label:l.value.notification_language,placeholder:l.value.language,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:He},template:`
          <IconComponent icon="pennant"/>`}),options:v.value}},gender:{template:Ye.select,props:{itemName:"gender",label:l.value.gender,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:He},template:`
          <IconComponent icon="gender"/>`}),options:[{label:l.value.female,value:"female"},{label:l.value.male,value:"male"}]}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:l.value.date_of_birth,placeholder:l.value.enter_date_of_birth,clearable:!0,readOnly:!1,class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`)}},note:{template:Ye["text-area"],props:{itemName:"note",label:l.value.note_internal,itemType:"textarea",class:_(()=>`am-cap-aec__form-item ${t.responsiveClass}`)}}});function E(){i.dispatch("customerInfo/resetCustomer"),e("update:visibility",!1)}let C=_(()=>i.getters["customerInfo/getLoading"]);function h(){k.value.validate(A=>{if(!A)return;i.commit("customerInfo/setLoading",!0);let D=yx(i);Pe.post("/users/customers"+(D.id?"/"+D.id:""),D,Object.assign(Ue(i),{params:{source:"cabinet-provider"}})).then(V=>{i.commit("auth/setPreloadedCustomers",i.getters["auth/getPreloadedCustomers"].concat([V.data.data.user]).sort((z,B)=>z.id-B.id)),e("addedCustomer",V.data.data.user),E()}).catch(V=>{"response"in V&&V.response&&(m.value=V.response.data.message,r.value=!0)}).finally(()=>{i.commit("customerInfo/setLoading",!1)})})}let I=F("amColors"),O=_(()=>({"--am-c-aec-text":I.value.colorMainText}));return(A,D)=>{const V=et;return u(),q(Ja,{visibility:t.visibility,position:"center","custom-class":"am-slide-popup-aec","custom-css":{...n.customCss,...a(O)},"onUpdate:visibility":E},{header:S(()=>[d("div",Tx,[a(f)?(u(),x(ee,{key:0},[ie(w(a(l).edit_customer),1)],64)):(u(),x(ee,{key:1},[ie(w(a(l).add_customer),1)],64))])]),footer:S(()=>[$(ke,{type:"plain",category:"secondary",onClick:E},{default:S(()=>[ie(w(a(l).cancel),1)]),_:1}),$(ke,{onClick:h},{default:S(()=>[ie(w(a(l).save),1)]),_:1})]),default:S(()=>[a(r)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:o,type:a(c),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:g,onTriggerClose:g},{title:S(()=>[Sx,ie(" "+w(a(m)),1)]),_:1},8,["type"])):N("",!0),a(C)?(u(),q(Zt,{key:2})):(u(),q(V,{key:1,ref_key:"customerFormRef",ref:k,model:a(y),rules:a(b),"label-position":"top",class:"am-cap-aec__form"},{default:S(()=>[(u(!0),x(ee,null,pe(a(L),(z,B)=>(u(),q(Ct(z.template),Nt({key:B},z.props,{modelValue:a(y)[B],"onUpdate:modelValue":J=>a(y)[B]=J,countryPhoneIso:z.countryPhoneIso,"onUpdate:countryPhoneIso":J=>z.countryPhoneIso=J}),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))]),_:1},8,["model","rules"]))]),_:1},8,["visibility","custom-css"])}}};const Ex={class:"am-cap__cust-option"},Lx={class:"am-cap__cust-option__heading"},Ax={key:0,class:"am-cap__cust-option__inner"},$x={key:1,class:"am-cap__cust-option__inner"},Ix={class:"am-capai-cuf__content"},Ox={class:"am-capai-cuf__bulk-label"},Px={key:0,class:"am-capai-customer__data"},Nx=d("span",{class:"am-icon-phone"},null,-1),Dx=["href"],Mx={key:1,class:"am-capai-customer__data"},Bx=d("span",{class:"am-icon-email"},null,-1),Fx=["href"],Vx={props:{responsiveClass:{type:String,default:""},capacityWarning:{type:String,default:""},appointmentCapacity:{type:Number,default:0},savedAppointment:{type:Object,default:()=>{}}},emits:["changedSlotCondition"],setup(n,{expose:e,emit:t}){const s=n;let l=Ie();const i=F("shortcodeData"),o=F("settings");let r=F("amCustomize"),c=F("amLabels"),m=F("pageWidth"),g=_(()=>l.getters["appointment/getEmployeeService"]),f=M(null),v=M({customersIds:_({get:()=>l.getters["customerInfo/getCustomersIds"],set:se=>l.commit("customerInfo/setCustomersIds",se)})}),k=M({customersIds:[{required:!0,message:c.value.select_customers,trigger:["submit","change"]}]}),T=_(()=>l.getters["customerInfo/getLoading"]),y=_(()=>l.getters["customerInfo/getCustomers"]),b=M(o.general.defaultAppointmentStatus),L=_(()=>bx().filter(se=>l.getters["appointment/getId"]?se.value!=="waiting":(se.value==="approved"||se.value==="pending")&&se.value!=="no-show")),E=_(()=>l.getters["appointment/getBookings"]?l.getters["appointment/getBookings"]:[]),C=M(!1);function h(se){l.commit("customerInfo/setCustomersIds",[se.id].concat(l.getters["customerInfo/getCustomersIds"])),l.commit("customerInfo/setCustomers",[se].concat(l.getters["customerInfo/getCustomers"])),I()}function I(){let se=l.getters["appointment/getBookings"].map(Y=>parseInt(Y.customer.id)),ge=!1,$e=g.value.settings?JSON.parse(g.value.settings):null;v.value.customersIds.filter(Y=>!se.includes(Y)).forEach(Y=>{let j={};s.savedAppointment&&s.savedAppointment.bookings.forEach(te=>{parseInt(te.customer.id)===parseInt(Y)&&(j=te)}),ge=l.getters["appointment/getBookings"].length>1,l.getters["appointment/getBookings"].push(Object.assign({id:null,customer:y.value.find(te=>te.id===parseInt(Y)),persons:1,status:$e&&"general"in $e&&"defaultAppointmentStatus"in $e.general?$e.general.defaultAppointmentStatus:o.general.defaultAppointmentStatus,duration:Object.keys(g.value.customPricing.durations)[0],extras:g.value.extras.map(te=>new Object({extraId:te.id,quantity:0})),customFields:{}},j)),l.dispatch("appointment/resetBookingCustomFields",l.getters["appointment/getBookings"].length-1),l.dispatch("appointment/addCustomFieldsFormRules",{key:l.getters["appointment/getBookings"].length-1,label:c.value.required_field}),l.commit("appointment/setBooking",{index:l.getters["appointment/getBookings"].length-1,value:l.getters["appointment/getBookings"][l.getters["appointment/getBookings"].length-1]})});let ue=se.filter(Y=>!v.value.customersIds.includes(Y)),ae=[];l.getters["appointment/getBookings"].forEach((Y,j)=>{ue.indexOf(Y.customer.id)!==-1&&ae.push(j)});let me=l.getters["appointment/getBookings"].length;for(let Y=me-1;Y>=0;Y--)ae.indexOf(Y)!==-1&&(ge=!0,l.dispatch("appointment/removeBooking",Y));ge&&t("changedSlotCondition")}function O(){l.dispatch("customerInfo/resetCustomer"),C.value=!0}function A(se){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),C.value=!0,Pe.get("/users/customers/"+se,Object.assign({params:{source:"cabinet-provider"}},Ue(l))).then(ge=>{l.commit("customerInfo/setCustomer",uu(l,ge.data.data.user))}).catch(ge=>{console.log(ge)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}function D(se){l.dispatch("appointment/removeBooking",se),l.dispatch("appointment/deleteAllCustomFieldsFormRules"),l.dispatch("appointment/addAllCustomFieldsFormRules",{label:c.value.required_field}),t("changedSlotCondition")}const{noShowData:V}=F("noShowData");function z(se,ge){return se&&ge?"am-w-50":""}function B(se){se&&l.commit("appointment/setAllBookingsStatus",se)}function J(se,ge){l.commit("appointment/setBookingStatus",{index:se,value:ge})}function G(se,ge){l.commit("appointment/setBookingPersons",{index:se,value:ge}),t("changedSlotCondition")}function X(se,ge){l.commit("appointment/setBookingDuration",{index:se,value:ge}),t("changedSlotCondition")}let K=_(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerPhone.visibility:!0),Q=_(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerEmail.visibility:!0),le=F("amColors"),H=_(()=>({"--am-c-card-text":le.value.colorMainText}));return Je(()=>{if(l.getters["appointment/getId"]){let se=l.getters["appointment/getBookings"].map(ge=>ge.customer.id);l.commit("customerInfo/setCustomersIds",se),pn(l,"",{limit:se.length,customers:se},()=>{l.commit("customerInfo/setCustomers",l.getters["customerInfo/getCustomers"].concat(l.getters["auth/getPreloadedCustomers"].filter(ge=>l.getters["customerInfo/getCustomers"].map($e=>$e.id).indexOf(ge.id)===-1)).sort((ge,$e)=>ge.id-$e.id))})}else l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),e({customersFormRef:f}),(se,ge)=>{const $e=xt,ue=et;return u(),x("div",{class:"am-capai-cuf",style:be(a(H))},[s.capacityWarning?(u(),q(du,{key:0,heading:s.capacityWarning},null,8,["heading"])):N("",!0),d("div",{class:R(["am-capai-cuf__heading",s.responsiveClass])},[$(ue,{ref_key:"customersFormRef",ref:f,model:a(v),rules:a(k),class:R(["am-capai-cuf__heading-form",s.responsiveClass])},{default:S(()=>[$($e,{prop:"customersIds",class:"am-capai-cuf__heading-form__item"},{default:S(()=>[$(We,{modelValue:a(v).customersIds,"onUpdate:modelValue":ge[0]||(ge[0]=ae=>a(v).customersIds=ae),filterable:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","popper-class":"am-capai-cuf__popper-customer",placeholder:`${a(c).select_customers}`,"remote-method":ae=>{a(pn)(a(l),ae)},loading:a(T),onChange:I,onFocus:ge[1]||(ge[1]=ae=>a(So)(a(l)))},{default:S(()=>[(u(!0),x(ee,null,pe(a(y),ae=>(u(),q(Ve,{key:ae.id,disabled:a(g)?.maxCapacity===n.appointmentCapacity&&a(v).customersIds.indexOf(ae.id)===-1,value:ae.id,label:ae.email&&a(Q)?ae.email:ae.firstName+" "+ae.lastName},{default:S(()=>[d("div",Ex,[d("div",Lx,w(ae.firstName+" "+ae.lastName),1),a(Q)&&ae.email?(u(),x("div",Ax,w(ae.email),1)):N("",!0),a(K)&&ae.phone?(u(),x("div",$x,w(ae.phone),1)):N("",!0)])]),_:2},1032,["disabled","value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})]),_:1},8,["model","rules","class"]),a(o).roles.allowWriteCustomers?(u(),q(ke,{key:0,class:R(["am-capai-cuf__heading-add",s.responsiveClass]),size:"default",prefix:"plus",icon:"plus","icon-only":a(m)<=540,disabled:a(g)?.maxCapacity===n.appointmentCapacity,onClick:O},{default:S(()=>[ie(w(a(c).new_customer),1)]),_:1},8,["class","icon-only","disabled"])):N("",!0)],2),d("div",Ix,[a(l).getters["appointment/getBookings"].length>1?(u(),x("div",{key:0,class:R(["am-capai-cuf__bulk",s.responsiveClass])},[d("div",Ox,w(a(c).change_group_status),1),$(We,{modelValue:a(b),"onUpdate:modelValue":ge[2]||(ge[2]=ae=>ye(b)?b.value=ae:b=ae),clearable:"",size:"small",placeholder:"Group Status","popper-class":"am-capai-cuf__popper","parent-class":`am-capai-cuf__bulk-status ${s.responsiveClass}`,"prefix-icon":a(b)?a(L).find(ae=>ae.value===a(b)).icon:"circle-empty","prefix-icon-color":a(b)?a(L).find(ae=>ae.value===a(b)).color:"var(--am-c-select-text-op40)",onChange:B},{default:S(()=>[(u(!0),x(ee,null,pe(a(L),ae=>(u(),q(Ve,{key:ae.value,value:ae.value,label:ae.label},{default:S(()=>[d("span",{class:R(`am-icon-${ae.icon}`),style:be(`color: ${ae.color}`)},null,6),ie(" "+w(ae.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","parent-class","prefix-icon","prefix-icon-color"])],2)):N("",!0),(u(!0),x(ee,null,pe(a(E),(ae,me)=>(u(),x("div",{key:me,class:R(["am-capai-cuf__card",s.responsiveClass])},[d("div",{class:R(["am-capai-cuf__card-info",s.responsiveClass])},[d("div",{class:R(["am-capai-customer__name",a(V)(ae.customer.noShowCount).class])},[a(V)(ae.customer.noShowCount).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(V)(ae.customer.noShowCount).icon}`)},null,2)):N("",!0),ie(" "+w(ae.customer.firstName+" "+ae.customer.lastName),1)],2),ae.customer.phone&&a(K)?(u(),x("div",Px,[Nx,d("a",{href:`tel:${ae.customer.phone}`},w(ae.customer.phone),9,Dx)])):N("",!0),ae.customer.email&&a(Q)?(u(),x("div",Mx,[Bx,d("a",{href:`mailto:${ae.customer.email}`},w(ae.customer.email),9,Fx)])):N("",!0)],2),d("div",{class:R(["am-capai-cuf__card-booking",s.responsiveClass])},[$(We,{modelValue:ae.status,"onUpdate:modelValue":Y=>ae.status=Y,"prefix-icon":a(L).find(Y=>Y.value===ae.status).icon,"prefix-icon-color":a(L).find(Y=>Y.value===ae.status).color,"popper-class":"am-capai-cuf__popper",size:"small",onChange:Y=>J(me,Y)},{default:S(()=>[(u(!0),x(ee,null,pe(a(L),Y=>(u(),q(Ve,{key:Y.value,value:Y.value,label:a(L).find(j=>j.value===ae.status).label},{default:S(()=>[d("span",{class:R(`am-icon-${Y.icon}`),style:be(`color: ${Y.color}`)},null,6),ie(" "+w(Y.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","prefix-icon","prefix-icon-color","onChange"]),a(g).maxCapacity>1?(u(),q(We,{key:0,modelValue:ae.persons,"onUpdate:modelValue":Y=>ae.persons=Y,"parent-class":`${z(a(g).maxCapacity>1,Object.keys(a(g).customPricing.durations).length>1)} ${s.responsiveClass}`,placeholder:a(c).persons,"prefix-icon":"users","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:Y=>G(me,Y)},{default:S(()=>[(u(!0),x(ee,null,pe(a(g)?.maxCapacity,Y=>(u(),q(Ve,{key:Y,disabled:n.appointmentCapacity-ae.persons+Y>a(g)?.maxCapacity,value:Y,label:Y},null,8,["disabled","value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):N("",!0),Object.keys(a(g).customPricing.durations).length>1?(u(),q(We,{key:1,modelValue:ae.duration,"onUpdate:modelValue":Y=>ae.duration=Y,"parent-class":`${z(a(g).maxCapacity>1,Object.keys(a(g).customPricing.durations).length>1)} ${s.responsiveClass}`,placeholder:a(c).duration,"prefix-icon":"clock","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:Y=>X(me,Y)},{default:S(()=>[(u(!0),x(ee,null,pe(Object.keys(a(g).customPricing.durations),Y=>(u(),q(Ve,{key:Y,value:Y,label:a(fn)(Y,a(c).h,a(c).min)},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):N("",!0)],2),$(ka,{index:me,"reference-class":s.responsiveClass,"have-edit":a(o).roles.allowWriteCustomers,onRemove:D,onEdit:Y=>A(ae.customer.id)},null,8,["index","reference-class","have-edit","onEdit"])],2))),128))]),a(C)?(u(),q(mu,{key:1,visibility:a(C),"responsive-class":s.responsiveClass,"onUpdate:visibility":ge[3]||(ge[3]=ae=>ye(C)?C.value=ae:C=ae),onAddedCustomer:h},null,8,["visibility","responsive-class"])):N("",!0)],4)}}};const Rx=d("span",{class:"am-icon-email"},null,-1),qx=["href"],Ux=d("span",{class:"am-icon-phone"},null,-1),jx=["href"],zx={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:e}){const t=n;let s=Ie();const l=F("shortcodeData");let i=F("amCustomize");const o=F("settings");let r=F("amLabels"),c=M(null),m=M({}),g=_(()=>s.getters["appointment/getCustomFieldsRules"]),f=M({}),v=_(()=>s.getters["appointment/getCustomFields"]),k=_(()=>s.getters["appointment/getServiceId"]),T=_(()=>s.getters["customerInfo/getCustomersIds"]),y=M(null);function b(O,A){let D=s.getters["appointment/getBookings"][O].id;(A.type!=="file"||D)&&(m.value[`${O}cf${A.id}`]=_({get:()=>{let V=s.getters["appointment/getBookings"][O].customFields[A.id]?.value;return V||""},set:V=>s.dispatch("appointment/updateBookingCustomField",{bookingKey:O,fieldId:A.id,value:V})}))}function L(O,A){let D=s.getters["appointment/getBookings"][O].id;(A.type!=="file"||D)&&(f.value[O][A.id]={template:Ye[A.type],props:{id:A.id,itemName:`${O}cf${A.id}`,label:A.label,options:A.options,class:`am-capai-cfields__item am-cf-width-${A.width}`}}),A.type==="text-area"&&(f.value[O][A.id].props={...f.value[O][A.id].props,itemType:"textarea"}),A.type==="file"&&D&&(f.value[O][A.id].props={...f.value[O][A.id].props,btnLabel:r.value.upload_file_here,isUpload:!1,bookingId:D}),A.type==="datepicker"&&(f.value[O][A.id].props={...f.value[O][A.id].props,weekStartsFromDay:o.wordpress.startOfWeek})}function E(){m.value={},s.getters["appointment/getBookings"].forEach((O,A)=>{f.value[A]={},s.getters["appointment/getCustomFields"].forEach(D=>{b(A,D),L(A,D)})})}const{noShowData:C}=F("noShowData");let h=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),I=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0);return rt([k,T],()=>{E()}),gn(()=>{E()}),Je(()=>{s.getters["appointment/getBookings"].filter(O=>O.status!=="canceled"&&O.status!=="rejected").length<2&&(y.value=0)}),e({customFieldsFormRef:c}),(O,A)=>{const D=Is,V=Os,z=et;return u(),q(z,{ref_key:"customFieldsFormRef",ref:c,model:a(m),rules:a(g),"label-position":"top",class:R(["am-capai-cfields am-capai-cfields__form",t.responsiveClass])},{default:S(()=>[$(V,{modelValue:a(y),"onUpdate:modelValue":A[0]||(A[0]=B=>ye(y)?y.value=B:y=B),class:"am-capai-collapse",accordion:""},{default:S(()=>[(u(!0),x(ee,null,pe(a(s).getters["appointment/getBookings"].filter(B=>B.status!=="canceled"&&B.status!=="rejected"),(B,J)=>(u(),q(D,{key:J,name:J,class:"am-capai-collapse__item"},{title:S(()=>[d("div",{class:R(["am-capai-customer__name",[{"am-pb-16":!(B.customer.email&&a(I)||B.customer.phone&&a(h))},a(C)(B.customer.noShowCount).class]])},[a(C)(B.customer.noShowCount).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(C)(B.customer.noShowCount).icon}`)},null,2)):N("",!0),ie(" "+w(B.customer.firstName+" "+B.customer.lastName),1)],2)]),default:S(()=>[B.customer.email&&a(I)||B.customer.phone&&a(h)?(u(),x("div",{key:0,class:R(["am-capai-customer__data-wrapper",t.responsiveClass])},[B.customer.email&&a(I)?(u(),x("div",{key:0,class:R(["am-capai-customer__data",t.responsiveClass])},[Rx,d("a",{href:`mailto:${B.customer.email}`},w(B.customer.email),9,qx)],2)):N("",!0),B.customer.phone&&a(h)?(u(),x("div",{key:1,class:R(["am-capai-customer__data",t.responsiveClass])},[Ux,d("a",{href:`tel:${B.customer.phone}`},w(B.customer.phone),9,jx)],2)):N("",!0)],2)):N("",!0),(u(!0),x(ee,null,pe(a(v),G=>(u(),x(ee,{key:J+"_"+G.id},[J in a(f)&&`${J}cf${G.id}`in a(m)?(u(),q(Ct(a(f)[J][G.id].template),Nt({key:0,modelValue:a(m)[`${J}cf${G.id}`],"onUpdate:modelValue":X=>a(m)[`${J}cf${G.id}`]=X},a(f)[J][G.id].props),null,16,["modelValue","onUpdate:modelValue"])):N("",!0)],64))),128))]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["model","rules","class"])}}};const Yx={key:0,class:"am-capai-ext__heading-extra"},Wx=d("span",{class:"am-icon-email"},null,-1),Hx=["href"],Zx=d("span",{class:"am-icon-phone"},null,-1),Gx=["href"],Jx={class:"am-capai-ext__wrapper"},Xx={class:"am-capai-ext__inner-info"},Qx={class:"am-capai-ext__inner-name"},Kx={key:0,class:"am-capai-ext__inner-duration"},e2={class:"am-capai-ext__total"},t2={props:{responsiveClass:{type:String,default:""}},emits:["changedSlotCondition"],setup(n,{emit:e}){const t=n,s=Ie(),l=F("shortcodeData");let i=F("amCustomize"),o=F("amLabels"),r=_(()=>s.getters["appointment/getEmployeeService"]),c=_(()=>s.getters["appointment/getBookings"]),m=M(null);function g(E,C,h){E.duration&&(h.extras[C].quantity===0||h.extras[C].quantity===1)&&e("changedSlotCondition")}function f(E){return E.extras.length?E.extras.reduce((C,h)=>C+("price"in h?h.price:r.value.extras.find(I=>I.id===h.extraId).price)*h.quantity,0):0}function v(E){return E.filter(C=>C.quantity>0).length}const{noShowData:k}=F("noShowData");let T=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),y=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),b=F("amColors"),L=_(()=>({"--am-c-ext-text-op60":W(b.value.colorMainText,.6)}));return Je(()=>{c.value.filter(E=>E.status!=="canceled"&&E.status!=="rejected").length<2&&(m.value=0)}),(E,C)=>{const h=Is,I=Os;return u(),q(I,{modelValue:a(m),"onUpdate:modelValue":C[0]||(C[0]=O=>ye(m)?m.value=O:m=O),class:"am-capai-ext am-capai-collapse",accordion:"",style:be(a(L))},{default:S(()=>[(u(!0),x(ee,null,pe(a(c).filter(O=>O.status!=="canceled"&&O.status!=="rejected"),(O,A)=>(u(),q(h,{key:A,name:A,class:"am-capai-ext__item am-capai-collapse__item"},{title:S(()=>[d("div",{class:R(["am-capai-ext__heading",{"am-pb-16":!(O.customer.email&&a(y)||O.customer.phone&&a(T))}])},[d("div",{class:R(["am-capai-customer__name",a(k)(O.customer.noShowCount).class])},[a(k)(O.customer.noShowCount).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(k)(O.customer.noShowCount).icon}`)},null,2)):N("",!0),ie(" "+w(O.customer.firstName+" "+O.customer.lastName),1)],2),v(O.extras)>0?(u(),x("div",Yx,w(`${a(o).extras}: ${v(O.extras)}`),1)):N("",!0)],2)]),default:S(()=>[O.customer.email&&a(y)||O.customer.phone&&a(T)?(u(),x("div",{key:0,class:R(["am-capai-customer__data-wrapper",t.responsiveClass])},[O.customer.email&&a(y)?(u(),x("div",{key:0,class:R(["am-capai-customer__data",t.responsiveClass])},[Wx,d("a",{href:`mailto:${O.customer.email}`},w(O.customer.email),9,Hx)],2)):N("",!0),O.customer.phone&&a(T)?(u(),x("div",{key:1,class:R(["am-capai-customer__data",t.responsiveClass])},[Zx,d("a",{href:`tel:${O.customer.phone}`},w(O.customer.phone),9,Gx)],2)):N("",!0)],2)):N("",!0),d("div",Jx,[(u(!0),x(ee,null,pe(a(r).extras,(D,V)=>(u(),x("div",{key:V,class:R(["am-capai-ext__inner",[{"am-border-bottom":V!==a(r).extras.length-1},t.responsiveClass]])},[d("div",Xx,[d("div",Qx,w(D.name),1),D.duration?(u(),x("div",Kx,w(`${a(o).duration}: ${a(fn)(D.duration,a(o).h,a(o).min)}`),1)):N("",!0)]),d("div",{class:R(["am-capai-ext__inner-selection",t.responsiveClass])},[d("div",{class:R(["am-capai-ext__inner-price",t.responsiveClass])},[D.price?(u(),x(ee,{key:0},[ie(w(a(nt)("price"in O.extras[V]?O.extras[V].price:D.price)),1)],64)):(u(),x(ee,{key:1},[ie(w(a(o).free),1)],64))],2),$(ht,{modelValue:O.extras[V].quantity,"onUpdate:modelValue":z=>O.extras[V].quantity=z,class:R(t.responsiveClass),size:"small",min:0,max:D.maxQuantity,onChange:z=>g(D,V,O)},null,8,["modelValue","onUpdate:modelValue","class","max","onChange"])],2)],2))),128)),d("div",e2,w(`${a(o).subtotal}: ${a(nt)(f(O))}`),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};const a2={class:"am-fs__rs-every"},s2={key:1},n2={class:"am-fs__rs-on-week"},l2=["onClick"],i2={key:2},o2={class:"am-fs__rs-on-month"},r2={class:"am-fs__rs-ends"},c2={class:"am-fs__rs-ends-choose"},u2={class:"am-fs__rs-ends-options"},d2={class:"am-fs__rs-ends-after"},m2={class:"am-fs__rs-summary"},p2={key:0},g2={key:1},f2={key:0},h2=ie(", "),v2={key:0},_2={key:1},y2={name:"RecurringSetup"},b2=Object.assign(y2,{props:{service:{type:Object,default:()=>{}},startDate:{type:String,default:""},startTime:{type:String,default:""},maxDate:{type:String,default:""},globalClass:{type:String,default:""}},setup(n){const e=n;let t=F("amLabels"),s=F("amCustomize"),l=Ie(),i=F("containerWidth",0),o=_(()=>i.value<560||i.value-240<520),r=_({get:()=>l.getters["recurring/getRepeatType"],set:O=>{l.commit("recurring/setRepeatType",O)}}),c=_({get:()=>l.getters["recurring/getRepeatInterval"],set:O=>{l.commit("recurring/setRepeatInterval",O)}}),m=_({get:()=>l.getters["recurring/getOccurrenceType"],set:O=>{l.commit("recurring/setOccurrenceType",O)}}),g=_({get:()=>l.getters["recurring/getOccurrenceDate"]?l.getters["recurring/getOccurrenceDate"]:new Date(e.startDate),set:O=>{l.commit("recurring/setOccurrenceDate",O)}}),f=_({get:()=>l.getters["recurring/getOccurrenceCount"],set:O=>{l.commit("recurring/setOccurrenceCount",O)}}),v=_({get:()=>l.getters["recurring/getMonthly"],set:O=>{l.commit("recurring/setMonthly",O)}});const k=M([{label:t.value.recurrence_day,labelPlural:t.value.recurrence_days,value:"daily"},{label:t.value.recurrence_week,labelPlural:t.value.recurrence_weeks,value:"weekly"},{label:t.value.recurrence_month,labelPlural:t.value.recurrence_months,value:"monthly"}]),T=M([{label:t.value.recurrence_specific_date,value:0},{label:t.value.recurrence_first,value:1},{label:t.value.recurrence_second,value:2},{label:t.value.recurrence_third,value:3},{label:t.value.recurrence_fourth,value:4},{label:t.value.recurrence_last,value:5}]);let y=M(ve(e.startDate).format("dddd").toLowerCase()),b=M([{label:"Mon",labelFull:"Monday",value:"monday",selected:!1},{label:"Tue",labelFull:"Tuesday",value:"tuesday",selected:!1},{label:"Wed",labelFull:"Wednesday",value:"wednesday",selected:!1},{label:"Thu",labelFull:"Thursday",value:"thursday",selected:!1},{label:"Fri",labelFull:"Friday",value:"friday",selected:!1},{label:"Sat",labelFull:"Saturday",value:"saturday",selected:!1},{label:"Sun",labelFull:"Sunday",value:"sunday",selected:!1}]),L=_(()=>b.value.find(O=>O.value===ve(e.startDate,"YYYY-MM-DD").format("dddd").toLowerCase()).labelFull);function E(O){g.value=ve(O,"YYYY-MM-DD").toDate()}function C(O,A=!1){let D=b.value.find(V=>V.value===O);D.selected=A?!0:!D.selected,l.commit("recurring/setDays",{value:O,selected:D.selected})}Je(()=>{Gn&&(b.value=b.value.map((A,D)=>({...A,label:Vu[D],labelFull:Ru[D]})));let O=l.getters["recurring/getDays"].filter(A=>A.selected);O.length===0?C(b.value.find(A=>y.value&&A.value===y.value).value,!0):O.forEach(A=>{C(A.value,!0)}),e.service.recurringCycle!=="all"&&l.commit("recurring/setRepeatType",e.service.recurringCycle)});let h=F("amColors"),I=_(()=>({"--am-c-rs-text":h.value.colorMainText,"--am-c-rs-text-op60":W(h.value.colorMainText,.6),"--am-c-rs-bgr":h.value.colorMainBgr,"--am-c-rs-primary":h.value.colorPrimary,"--am-c-rs-inp-border":h.value.colorInpBorder}));return(O,A)=>(u(),x("div",{class:R(["am-fs__rs",[{"am-fs__rs-mobile":a(o)},a(e).globalClass]]),style:be(a(I))},[a(s)&&a(s).recurringStep&&a(s).recurringStep.options.heading.visibility?(u(),x(ee,{key:0},[d("p",null,w(a(t).recurrence),1),d("span",null,w(a(t).recurrence_choosing_time),1)],64)):N("",!0),d("p",null,w(a(t).repeat_every)+":",1),d("div",a2,[$(a(ht),{modelValue:a(c),"onUpdate:modelValue":A[0]||(A[0]=D=>ye(c)?c.value=D:c=D),min:1,max:100},null,8,["modelValue"]),$(a(We),{modelValue:a(r),"onUpdate:modelValue":A[1]||(A[1]=D=>ye(r)?r.value=D:r=D),disabled:a(e).service.recurringCycle!=="all"},{default:S(()=>[(u(!0),x(ee,null,pe(k.value,(D,V)=>(u(),q(a(Ve),{key:V,label:D.label,value:D.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),a(r)==="weekly"?(u(),x("div",s2,[d("p",null,w(`${a(t).recurrence_repeat_on}:`),1),d("div",n2,[(u(!0),x(ee,null,pe(a(b),(D,V)=>(u(),x("div",{key:V,class:R({"am-fs__rs-on-week-selected":a(b).find(z=>z.value===D.value).selected}),onClick:z=>C(D.value)},w(D.label),11,l2))),128))])])):N("",!0),a(r)==="monthly"?(u(),x("div",i2,[d("p",null,w(`${a(t).recurrence_repeat_on}:`),1),d("div",o2,[$(a(We),{modelValue:a(v),"onUpdate:modelValue":A[2]||(A[2]=D=>ye(v)?v.value=D:v=D)},{default:S(()=>[(u(!0),x(ee,null,pe(T.value,(D,V)=>(u(),q(a(Ve),{key:V,label:D.label+(V!==0?" "+a(L):""),value:D.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):N("",!0),d("p",null,w(`${a(t).recurrence_ends}:`),1),d("span",null,w(a(t).recurrence_choose_ends),1),d("div",r2,[d("div",c2,[$(a(fl),{modelValue:a(m),"onUpdate:modelValue":A[3]||(A[3]=D=>ye(m)?m.value=D:m=D)},{default:S(()=>[$(a(Oa),{label:"On"},{default:S(()=>[ie(w(a(t).recurrence_on),1)]),_:1}),$(a(Oa),{label:"After"},{default:S(()=>[ie(w(a(t).recurrence_after),1)]),_:1})]),_:1},8,["modelValue"])]),d("div",u2,[$(a(qu),{"calendar-minimum-date":a(e).startDate,disabled:a(m)!=="On","input-placeholder":a(t).recurrence_select_date,"calendar-maximum-date":a(e).maxDate,onSelectedDate:E},null,8,["calendar-minimum-date","disabled","input-placeholder","calendar-maximum-date"]),d("div",d2,[$(a(ht),{modelValue:a(f),"onUpdate:modelValue":A[4]||(A[4]=D=>ye(f)?f.value=D:f=D),disabled:a(m)!=="After",min:1,max:100},null,8,["modelValue","disabled"]),d("span",null,w(` ${a(t).occurrences}`),1)])])]),d("div",m2,[d("p",null,w(`${a(t).appointment_repeats}:`),1),d("p",null,[ie(w(`${a(t).recurrence_every} ${a(c)>1?a(c):""} ${k.value.find(D=>D.value===a(r))?k.value.find(D=>D.value===a(r)).label:""}`)+" ",1),a(r)==="weekly"?(u(),x("span",p2,w(`${a(t).repeats_on} ${a(b).filter(D=>D.selected).map(D=>D.labelFull).join(", ")}`),1)):N("",!0),a(r)==="monthly"?(u(),x("span",g2,[ie(w(` ${a(t).repeats_on} ${T.value[a(v)].label}`)+" ",1),a(v)!==0?(u(),x("span",f2,w(` ${a(L)}`),1)):N("",!0),h2])):N("",!0),d("span",null,w(` ${a(t).repeats_from} ${a(dt)(a(e).startDate)} ${a(t).repeats_at} ${a(sn)(a(e).startTime)}`),1)]),d("p",null,[a(m)==="After"?(u(),x("span",v2,w(a(t).number_of_recurrences)+" "+w(` ${a(f)}`),1)):a(g)?(u(),x("span",_2,w(a(t).ends_on)+" "+w(` ${a(dt)(a(Uu)(a(g)))}`),1)):N("",!0)])])],6))}});const k2={class:"am-capai-recurr__enable"},C2={key:0,class:"am-capai-recurr__content"},x2={key:1,class:"am-capai-recurr__list"},w2={class:"am-capai-recurr__list-heading"},T2={class:"am-capai-recurr__list-heading__text"},S2=d("span",{class:"am-icon-refresh"},null,-1),E2={class:"am-capai-recurr__table"},L2={key:2,class:"am-capai-recurr__actions"},A2={props:{responsiveClass:{type:String,default:""},maximumBookingStartDate:{type:String,required:!0},slotsLoading:{type:Boolean,required:!0},slotsProps:{type:Object,required:!0},freeSlots:{type:Object,required:!0},getFreeTimes:{type:Function,required:!0},isDisabledDate:{type:Function,required:!0},getSelectedDatesTimes:{type:Function,required:!0}},emits:["fetchSlots"],setup(n,{emit:e}){const t=n,s=Ie(),l=F("settings");let i=F("amLabels"),o=F("localLanguage"),r=_(()=>s.getters["appointment/getEmployeeService"]),c=M(!1),m=M(2),g=M(!1),f=F("recurringList"),v=M(!0);function k(){let A=s.getters["recurring/getOccurrenceType"]==="On"?at(s.getters["recurring/getOccurrenceDate"]).format("YYYY-MM-DD"):null,D=ju(t.maximumBookingStartDate,at(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),A,l.general.numberOfDaysAvailableForBooking,s.getters["recurring/getRepeatType"],s.getters["recurring/getRepeatInterval"],s.getters["recurring/getDays"],s.getters["recurring/getMonthly"]);m.value=s.getters["recurring/getOccurrenceType"]==="On"?Object.keys(D).length:s.getters["recurring/getOccurrenceCount"],g.value=!0;let V=zr(Object.keys(D));Yr(Object.assign({startDateTime:at(s.getters["appointment/getStartDate"]).startOf("month").subtract(6,"days").format("YYYY-MM-DD"),endDateTime:V.length?at(V[V.length-1]).endOf("month").add(11,"days").format("YYYY-MM-DD"):at().add(l.general.numberOfDaysAvailableForBooking,"days").format("YYYY-MM-DD")},t.slotsProps),null,z=>{let B=zu(r.value,z,D,at(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),s.getters["appointment/getStartTime"],A,s.getters["recurring/getOccurrenceType"]==="After"?s.getters["recurring/getOccurrenceCount"]:null);f.value=[],Object.keys(B).forEach(J=>{f.value.push(Object.assign({date:at(J).toDate(),editing:!1},B[J]))}),g.value=!1})}function T(){f.value=null}function y(A){let D=at(f.value[A].date).format("YYYY-MM-DD");f.value[A].times=Object.keys(t.freeSlots[D]);let V=t.getSelectedDatesTimes(A,!1);D in V&&f.value[A].time in V[D]&&(f.value[A].time="")}function b(A){f.value.splice(A,1)}function L(A){f.value[A].editing=!0}function E(A){f.value[A].editing=!1}let C=M(null);function h(A,D,V=!1){!A&&!C.value?A=at().toDate():!A&&C.value&&(A=C.value),C.value=A&&V?A:C.value,e("fetchSlots",A,D,V)}let I=F("amColors"),O=_(()=>({"--am-c-recurr-bgr-op05":W(I.value.colorPrimary,.05),"--am-c-warning-op10":W(I.value.colorWarning,.1),"--am-c-main-text-op10":W(I.value.colorMainText,.1)}));return rt(c,A=>{A||(f.value=null)}),(A,D)=>(u(),x("div",{class:"am-capai-recurr",style:be(a(O))},[d("div",k2,[$(ft,{modelValue:a(c),"onUpdate:modelValue":D[0]||(D[0]=V=>ye(c)?c.value=V:c=V),label:"Enable Recurring appointment"},null,8,["modelValue"])]),a(c)?(u(),x("div",C2,[!a(g)&&!a(f)?(u(),q(b2,{key:0,"start-date":a(at)(a(s).getters["appointment/getStartDate"]).format("YYYY-MM-DD"),"start-time":a(s).getters["appointment/getStartTime"],"max-date":a(t).maximumBookingStartDate,service:a(r)},null,8,["start-date","start-time","max-date","service"])):(u(),x(ee,{key:1},[a(f)?(u(),x("div",x2,[d("div",w2,[d("div",T2,[S2,d("div",null,w(`${a(f).length} appointments total`),1)]),d("div",{class:"am-capai-recurr__list-heading__action",onClick:D[1]||(D[1]=()=>{ye(v)?v.value=!a(v):v=!a(v)})},w(a(v)?a(i).show_less:a(i).show_more),1)]),a(v)?(u(),x(ee,{key:0},[a(f).filter(V=>V.isSubstituteDate||V.isSubstituteTime).length?(u(),q(du,{key:0,heading:a(i).recurring_unavailable_slots,text:a(i).recurring_sub_message1},null,8,["heading","text"])):N("",!0),d("div",E2,[(u(!0),x(ee,null,pe(a(f),(V,z)=>(u(),x("div",{key:z,class:R(["am-capai-recurr__row",[{"am-warn":V.isSubstituteDate||V.isSubstituteTime},a(t).responsiveClass]])},[d("div",{class:R(["am-capai-recurr__row-num",a(t).responsiveClass])},w(z+1),3),d("div",{class:R(["am-capai-recurr__row-date",[{"am-disable":!V.editing},a(t).responsiveClass]])},[$(Ht,{modelValue:V.date,"onUpdate:modelValue":B=>V.date=B,type:"date",format:a(Wt)(),placeholder:"Pick a day",size:"small",lang:a(o),"disabled-date":(B,J)=>a(t).isDisabledDate(B,V.editing,!1,J),"popper-class":a(t).slotsLoading?"slots-loader":"",onPanelChange:B=>{h(B,z,!0)},onChange:B=>y(z),onFocus:B=>h(V.date,z,!0)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date","popper-class","onPanelChange","onChange","onFocus"])],2),d("div",{class:R(["am-capai-recurr__row-time",[{"am-disable":!V.editing},a(t).responsiveClass]])},[$(We,{modelValue:V.time,"onUpdate:modelValue":B=>V.time=B,size:"small",placeholder:`${a(i).select_time}`,disabled:!V.date},{default:S(()=>[(u(!0),x(ee,null,pe(V.editing?a(t).getFreeTimes(z,a(f)[z],!1):a(f)[z].times,B=>(u(),q(Ve,{key:B,value:B,label:B},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])],2),d("div",{class:R(["am-capai-recurr__row-actions",a(t).responsiveClass])},[V.editing?(u(),q(ke,{key:1,category:"primary",size:"small",onClick:B=>E(z)},{default:S(()=>[ie(w(a(i).save),1)]),_:2},1032,["onClick"])):(u(),q(ka,{key:0,index:z,onRemove:b,onEdit:L},null,8,["index"]))],2)],2))),128))])],64)):N("",!0)])):(u(),q(Zt,{key:0,count:a(m)},null,8,["count"]))],64)),a(g)?N("",!0):(u(),x("div",L2,[a(f)?N("",!0):(u(),q(ke,{key:0,category:"primary",size:"medium",onClick:D[2]||(D[2]=V=>k())},{default:S(()=>[ie(w(a(i).recurring_list),1)]),_:1})),a(f)?(u(),q(ke,{key:1,category:"secondary",type:"plain",size:"medium",onClick:D[3]||(D[3]=V=>T())},{default:S(()=>[ie(w(a(i).recurring_settings),1)]),_:1})):N("",!0)]))])):N("",!0)],4))}};const $2=d("span",{class:"am-icon-email"},null,-1),I2=["href"],O2=d("span",{class:"am-icon-phone"},null,-1),P2=["href"],N2={class:"am-capai-linked__list"},D2={class:"am-capai-linked__list-index"},M2={class:"am-capai-linked__list-date"},B2=d("span",{class:"am-icon-calendar"},null,-1),F2={class:"am-capai-linked__list-action"},V2={props:{responsiveClass:{type:String,default:""},linkedAppointments:{type:Array,required:!0}},emits:["editLinkedAppointment"],setup(n,{emit:e}){const t=n;let s=Ie();const l=F("shortcodeData");let i=F("amCustomize"),o=M(null);function r(y){return t.linkedAppointments.filter(b=>b.bookings.filter(L=>parseInt(L.customer.id)===parseInt(y.customer.id)).length)}const{noShowData:c}=F("noShowData");let m=F("amLabels");function g(y){s.commit("appointment/resetAppointment",{providerId:s.getters["auth/getProfile"].id}),s.commit("customerInfo/setCustomers",[]),s.commit("customerInfo/setCustomersIds",[]),e("editLinkedAppointment",y)}let f=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),v=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),k=F("amColors"),T=_(()=>({"--am-c-linked-bgr-op05":W(k.value.colorMainText,.05)}));return Je(()=>{s.getters["appointment/getBookings"].filter(y=>y.status!=="canceled"&&y.status!=="rejected").length<2&&(o.value=0)}),(y,b)=>{const L=Is,E=Os;return u(),q(E,{modelValue:a(o),"onUpdate:modelValue":b[0]||(b[0]=C=>ye(o)?o.value=C:o=C),class:"am-capai-collapse am-capai-linked",accordion:"",style:be(a(T))},{default:S(()=>[(u(!0),x(ee,null,pe(a(s).getters["appointment/getBookings"],(C,h)=>(u(),x(ee,{key:h},[r(C).length?(u(),q(L,{key:0,name:h,class:"am-capai-collapse__item"},{title:S(()=>[d("div",{class:R(["am-capai-customer__name",[{"am-pb-16":!(C.customer.email&&a(v)||C.customer.phone&&a(f))},a(c)(C.customer.noShowCount).class]])},[a(c)(C.customer.noShowCount).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(c)(C.customer.noShowCount).icon}`)},null,2)):N("",!0),ie(" "+w(C.customer.firstName+" "+C.customer.lastName),1)],2)]),default:S(()=>[C.customer.email&&a(v)||C.customer.phone&&a(f)?(u(),x("div",{key:0,class:R(["am-capai-customer__data-wrapper",a(t).responsiveClass])},[C.customer.email&&a(v)?(u(),x("div",{key:0,class:R(["am-capai-customer__data",a(t).responsiveClass])},[$2,d("a",{href:`mailto:${C.customer.email}`},w(C.customer.email),9,I2)],2)):N("",!0),C.customer.phone&&a(f)?(u(),x("div",{key:1,class:R(["am-capai-customer__data",a(t).responsiveClass])},[O2,d("a",{href:`tel:${C.customer.phone}`},w(C.customer.phone),9,P2)],2)):N("",!0)],2)):N("",!0),d("div",N2,[(u(!0),x(ee,null,pe(r(C),(I,O)=>(u(),x("div",{key:C.id+"-"+O,class:R(["am-capai-linked__list-item",a(t).responsiveClass])},[d("div",D2,w(O+1),1),d("div",M2,[B2,ie(" "+w(a(Yu)(I.bookingStart)),1)]),d("div",F2,[$(ke,{category:"primary",size:"small",onClick:A=>g(I)},{default:S(()=>[ie(w(a(m).edit),1)]),_:2},1032,["onClick"])])],2))),128))])]),_:2},1032,["name"])):N("",!0)],64))),128))]),_:1},8,["modelValue","style"])}}},Ks=lt(window.wpAmeliaLabels);function pu(n){if(n.gateway==="onSite")return Ks.on_site;if(n.gateway==="wc")return n.gatewayTitle;if(n.gateway)return n.gateway.charAt(0).toUpperCase()+n.gateway.slice(1)}function Hi(n){switch(n){case"paid":return Ks.paid;case"pending":return Ks.pending;case"partiallyPaid":return Ks.partially_paid;case"refunded":return Ks.refunded}}function xs(n,e){switch(n){case"paid":return{icon:"am-icon-checkmark-circle",color:e.colorSuccess};case"pending":return{icon:"am-icon-refresh",color:e.colorWarning};case"partiallyPaid":return{icon:"am-icon-prepaid",color:e.colorPrimary};case"refunded":return{icon:"am-icon-refund",color:e.colorError}}}const R2={class:"am-capai-pay__heading-status"},q2={class:"am-capai-pay__heading-status__text"},U2=d("span",{class:"am-icon-email"},null,-1),j2=["href"],z2=d("span",{class:"am-icon-phone"},null,-1),Y2=["href"],W2={class:"am-capai-pay__row-label"},H2={class:"am-capai-pay__row-value"},Z2={class:"am-capai-pay__row-label"},G2={class:"am-capai-pay__row-value"},J2={class:"am-capai-pay__row-label"},X2={class:"am-capai-pay__row-value"},Q2={key:0,class:"am-divider"},K2={class:"am-capai-pay__row-label"},ew={class:"am-capai-pay__row-label"},tw={class:"am-capai-pay__row-label"},aw={class:"am-capai-pay__row-label"},sw={class:"am-capai-pay__row-label"},nw={class:"am-capai-pay__row-label"},lw={class:"am-capai-pay__row-label"},iw={class:"am-capai-pay__row-label"},ow={class:"am-capai-pay__row-label"},rw={props:{responsiveClass:{type:String,default:""}},setup(n){const e=n;let t=Ie();const s=F("shortcodeData");let l=F("amCustomize"),i=F("pageWidth"),o=F("amLabels"),r=_(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerPhone.visibility:!0),c=_(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerEmail.visibility:!0),m=M(null),g=_(()=>t.getters["appointment/getBookings"].filter(y=>"id"in y&&y.id&&y.status!=="canceled"&&y.status!=="rejected")),f=_(()=>{let y=[];return g.value.forEach((b,L)=>{y.push(pl(t,{price:b.price,persons:b.persons,aggregatedPrice:b.aggregatedPrice,extras:b.extras.filter(E=>"id"in E&&E.id),serviceId:t.getters["appointment/getServiceId"],tax:b.tax,coupon:b.coupon},!1)),y[L].deposit=b.payments.length?b.payments[0].amount:0,y[L].paid=b.payments.reduce((E,C)=>E+C.amount,0),y[L].status=b.payments.reduce((E,C)=>E+C.amount,0),b.payments.filter(E=>E.status!=="refunded").length===0?y[L].status="refunded":y[L].paid-(y[L].total-y[L].discount+y[L].tax)===0?y[L].status="paid":y[L].paid?y[L].status="partiallyPaid":y[L].status="pending"}),y});const{noShowData:v}=F("noShowData");let k=F("amColors"),T=_(()=>({"--am-c-pay-text-op03":W(k.value.colorMainText,.03)}));return Je(()=>{t.getters["appointment/getBookings"].filter(y=>y.status!=="canceled"&&y.status!=="rejected").length<2&&(m.value=0)}),(y,b)=>{const L=Is,E=Os;return u(),q(E,{modelValue:a(m),"onUpdate:modelValue":b[0]||(b[0]=C=>ye(m)?m.value=C:m=C),class:"am-capai-collapse am-capai-pay",accordion:"",style:be(a(T))},{default:S(()=>[(u(!0),x(ee,null,pe(a(g),(C,h)=>(u(),q(L,{key:h,name:h,class:"am-capai-collapse__item"},{title:S(()=>[d("div",{class:R(["am-capai-pay__heading",{"am-pb-16":!(C.customer.email&&a(c)||C.customer.phone&&a(r))}])},[d("div",{class:R(["am-capai-customer__name",a(v)(C.customer.noShowCount).class])},[a(v)(C.customer.noShowCount).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(v)(C.customer.noShowCount).icon}`)},null,2)):N("",!0),ie(" "+w(C.customer.firstName+" "+C.customer.lastName),1)],2),d("div",R2,[d("span",{class:R(a(xs)(a(f)[h].status,a(k)).icon),style:be({color:a(xs)(a(f)[h].status,a(k)).color})},null,6),d("div",q2,w(a(Hi)(a(f)[h].status)),1)])],2)]),default:S(()=>[C.customer.email&&a(c)||C.customer.phone&&a(r)?(u(),x("div",{key:0,class:R(["am-capai-customer__data-wrapper",a(e).responsiveClass])},[C.customer.email&&a(c)?(u(),x("div",{key:0,class:R(["am-capai-customer__data",a(e).responsiveClass])},[U2,d("a",{href:`mailto:${C.customer.email}`},w(C.customer.email),9,j2)],2)):N("",!0),C.customer.phone&&a(r)?(u(),x("div",{key:1,class:R(["am-capai-customer__data",a(e).responsiveClass])},[z2,d("a",{href:`tel:${C.customer.phone}`},w(C.customer.phone),9,Y2)],2)):N("",!0)],2)):N("",!0),d("div",{class:R(["am-capai-pay__content",a(e).responsiveClass])},[(u(!0),x(ee,null,pe(C.payments,(I,O)=>(u(),x(ee,{key:O},[d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",W2,w(a(o).date),1),d("div",H2,w(a(dt)(I.dateTime.split(" ")[0])),1)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",Z2,w(a(o).payment_method),1),d("div",G2,w(a(pu)(I)),1)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",J2,w(a(o).status),1),d("div",X2,[d("span",{class:R(a(xs)(a(f)[h].status,a(k)).icon),style:be({color:a(xs)(a(f)[h].status,a(k)).color})},null,6),ie(" "+w(a(Hi)(I.status)),1)])],2)],64))),128)),a(i)>480?(u(),x("div",Q2)):N("",!0),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",K2,w(a(o).price),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].bookable)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",ew,w(a(o).extras),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].total-a(f)[h].bookable)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",tw,w(a(o).subtotal),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].total)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",aw,w(a(o).discount_amount),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].discount)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",sw,w(a(o).tax),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].tax)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",nw,w(a(o).paid_deposit),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].deposit)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",lw,w(a(o).paid_remaining_amount),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].paid-a(f)[h].deposit)),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",iw,w(a(o).due),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].paid-(a(f)[h].total-a(f)[h].discount+a(f)[h].tax))),3)],2),d("div",{class:R(["am-capai-pay__row",a(e).responsiveClass])},[d("div",ow,w(a(o).total),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},w(a(nt)(a(f)[h].total-a(f)[h].discount+a(f)[h].tax)),3)],2)],2)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};const cw={class:"am-capai__footer"},uw={name:"CabinetAppointment"},dw=Object.assign(uw,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},linkedAppointments:{type:Array,default:()=>[]}},emits:["close","save","editLinkedAppointment"],setup(n,{emit:e}){const t=n;let s=Ie(),l=F("amLabels");const i=F("settings"),o=M("details"),r=M(null);let c=_(()=>s.getters["appointment/getEmployeeService"]),m=M(null),g=M(""),f=_(()=>s.getters["appointment/getBookings"].length?s.getters["appointment/getBookings"].filter(j=>j.status==="approved"||j.status==="pending").map(j=>j.persons).reduce((j,te)=>j+te,0):0),v=M(null),k=_(()=>s.getters["appointment/getCustomFields"]),T=M(null);Be("recurringList",T);function y(j,te){let de=ve(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),Z={};return s.getters["appointment/getStartDate"]&&s.getters["appointment/getStartTime"]&&!te&&(Z[de]={},Z[de][s.getters["appointment/getStartTime"]]=!0),T.value&&T.value.forEach((ce,fe)=>{if(ce.time&&(j!==null?fe!==j:!0)){let Ne=ve(ce.date).format("YYYY-MM-DD");Ne in Z||(Z[Ne]={}),Z[Ne][ce.time]=!0}}),Z}function b(j,te,de){if(te.date===null)return[];let Z=ve(te.date).format("YYYY-MM-DD"),ce=y(j,de),fe=te.time?qt(te.time):null;if(Z in ce){let Ne=te.times.filter(je=>!Object.keys(ce[Z]).includes(je)),Oe=[];return Ne.forEach(je=>{let _e=qt(je),Ce=!0;Object.keys(ce[Z]).map(Te=>qt(Te)).sort((Te,Me)=>Te-Me).forEach(Te=>{_e<Te?_e+c.value.duration+c.value.timeAfter>Te&&(Ce=!1):Te+c.value.duration+c.value.timeAfter>_e&&(Ce=!1)}),Ce&&(fe!==null&&_e>fe&&Oe.indexOf(te.time)===-1&&Oe.push(te.time),Oe.push(je))}),L(Z,ce,Oe)}return L(Z,ce,te.times)}function L(j,te,de){let Z=[],ce=!1,fe=ve(j,"YYYY-MM-DD").subtract(1,"days").format("YYYY-MM-DD");if(fe in te){let Oe=Object.keys(te[fe]).map(_e=>qt(_e)).sort((_e,Ce)=>_e-Ce),je=Oe[Oe.length-1]+c.value.duration+c.value.timeAfter;je>86400&&(de.forEach(_e=>{je-86400<=qt(_e)&&Z.push(_e)}),de=Z,ce=!0)}let Ne=ve(j,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");if(Ne in te){let Oe=Object.keys(te[Ne]).map(je=>qt(je)).sort((je,_e)=>je-_e);Oe[0]-c.value.duration-c.value.timeAfter<0&&(de.forEach(je=>{let _e=qt(je);(_e+c.value.duration+c.value.timeAfter<=86400||Oe[0]>=_e+c.value.duration+c.value.timeAfter-86400)&&Z.push(je)}),ce=!0)}return ce?Z:de}let E=M(""),C=M({}),h=M([]);function I(j){h.value=Object.keys(C.value[ve(j).format("YYYY-MM-DD")])}function O(j){let te=C.value[ve(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")][j][0][1];te&&s.commit("appointment/setLocationId",te)}function A(j,te,de,Z){let ce=ve(j).format("YYYY-MM-DD");return typeof Z>"u"&&!(ce in C.value&&(te?b(null,{date:j,times:Object.keys(C.value[ce])},de).length:!0))}let D=M(!1),V=_(()=>{let j={};return s.getters["appointment/getBookings"].filter(te=>te.status==="pending"||te.status==="approved").forEach(te=>{te.extras.forEach(de=>{de.quantity&&!(de.extraId in j)&&(j[de.extraId]={id:de.extraId,quantity:de.quantity})})}),{serviceId:s.getters["appointment/getServiceId"],serviceDuration:Math.max.apply(Math,s.getters["appointment/getBookings"].filter(te=>te.status!=="canceled"&&te.status!=="rejected").map(te=>te.duration)),providerIds:s.getters["appointment/getProviderId"]?[s.getters["appointment/getProviderId"]]:[],locationId:s.getters["appointment/getLocationId"],extras:JSON.stringify(Object.values(j)),persons:f.value?f.value:1,excludeAppointmentId:s.getters["appointment/getId"],group:1,timeZone:s.getters["cabinet/getTimeZone"],monthsLoad:1,page:"appointments"}});function z(j=!1){s.getters["appointment/getStartDate"]&&B(s.getters["appointment/getStartDate"],null,!1,j)}function B(j,te=null,de=!1,Z=!1){s.getters["appointment/getServiceId"]&&(D.value=!0,Yr(Object.assign({startDateTime:j?ve(j).startOf("month").subtract(6,"days").format("YYYY-MM-DD"):null,endDateTime:j?ve(j).endOf("month").add(6,"days").format("YYYY-MM-DD"):null},V.value),{},(ce,fe,Ne,Oe)=>{if(E.value=Oe,s.getters["appointment/getStartDate"]&&te===null&&!de){let je=ve(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD");je in ce?(s.getters["appointment/getStartTime"]&&!(s.getters["appointment/getStartTime"]in ce[je])&&!Z&&s.commit("appointment/setStartTime",null),h.value=Object.keys(ce[je]),C.value=ce):Z||(C.value={},s.commit("appointment/setStartTime",null),s.commit("appointment/setStartDate",null),s.commit("appointment/setTargetedDate",null),h.value=[])}else C.value=ce;D.value=!1},()=>{}))}function J(){C.value={},E.value=null,T.value=null}function G(j){if(j){if(j===1)return{class:"am-no-show-1",icon:"no-show-1"};if(j===2)return{class:"am-no-show-2",icon:"no-show-2"};if(j>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Be("noShowData",{noShowData:G});let X=M(!1),K=M("");function Q(){X.value=!1,K.value=""}let le=M(!1),H=M(null),se=M(!1);function ge(j,te){let de=0,Z=s.getters["entities/getEmployeeService"](s.getters["appointment/getProviderId"],s.getters["appointment/getServiceId"]);return te.filter(ce=>ce.status!=="canceled"&&ce.status!=="rejected").forEach(ce=>{let fe={id:"id"in ce?ce.id:null,price:"price"in ce?ce.price:Z.customPricing.durations[ce.duration].price,persons:ce.persons,aggregatedPrice:"aggregatedPrice"in ce?ce.aggregatedPrice:Z.aggregatedPrice,extras:ce.extras.filter(Oe=>"id"in Oe&&Oe.id),serviceId:j,coupon:ce.coupon};"tax"in ce&&(fe.tax=ce.tax);let Ne=pl(s,fe,!1);de+=Ne.total-Ne.discount+Ne.tax}),de}function $e(){let j=M(!0);if(v.value?.customFieldsFormRef.validate(Z=>{Z||(o.value="customFields",j.value=!1)}),m.value?.customersFormRef.validate(Z=>{(!Z||!s.getters["customerInfo/getCustomersIds"].length)&&(o.value="customers",j.value=!1)}),r.value?.detailsFormRef.validate(Z=>{!Z&&(!s.getters["appointment/getServiceId"]||!s.getters["appointment/getStartDate"]||!s.getters["appointment/getStartTime"])&&(o.value="details",j.value=!1)}),j.value===!1)return;if(g.value=s.getters["appointment/getBookings"].filter(Z=>Z.status!=="canceled"&&Z.status!=="rejected").map(Z=>Z.persons).reduce((Z,ce)=>Z+ce,0)>c.value.maxCapacity?l.value.select_max_customer_count_warning+" "+c.value.maxCapacity:"",g.value){o.value="customers";return}let te=i.payments.paymentLinks&&i.payments.paymentLinks.enabled,de=c.value.settings?JSON.parse(c.value.settings):null;de&&"payments"in de&&"paymentLinks"in de.payments&&(te=de.payments.paymentLinks.enabled),H.value&&te&&ge(s.getters["appointment/getServiceId"],s.getters["appointment/getBookings"])>ge(H.value.serviceId,H.value.bookings)?se.value=!0:ue(!1)}function ue(j){se.value=!1;let te=[];s.getters["appointment/getBookings"].forEach(fe=>{let Ne={};Object.keys(fe.customFields).forEach(Oe=>{Ne[Oe]=Object.assign({},fe.customFields[Oe],{value:fe.customFields[Oe].type==="datepicker"?fe.customFields[Oe].value?ve(fe.customFields[Oe].value).format("YYYY-MM-DD"):null:fe.customFields[Oe].value})}),te.push(Object.assign({},fe,{customerId:fe.customer.id,extras:fe.extras.filter(Oe=>Oe.quantity),customFields:Ne}))});let de=[];if(H.value){let fe=H.value.bookings.map(Oe=>"id"in Oe&&Oe.id),Ne=te.map(Oe=>"id"in Oe&&Oe.id);de=H.value.bookings.filter(Oe=>fe.filter(je=>!Ne.includes(je)).includes(Oe.id)).map(Oe=>new Object({id:Oe.id}))}let Z=s.getters["cabinet/getTimeZone"],ce={serviceId:s.getters["appointment/getServiceId"],providerId:s.getters["appointment/getProviderId"],locationId:s.getters["appointment/getLocationId"],bookings:te,removedBookings:de,bookingStart:ve(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")+" "+s.getters["appointment/getStartTime"],utc:Z==="UTC",timeZone:Z==="UTC"?null:Z,notifyParticipants:s.getters["appointment/getNotifyParticipants"]?1:0,internalNotes:s.getters["appointment/getInternalNotes"],id:s.getters["appointment/getId"],payment:{gateway:"onSite"},recurring:T.value?T.value.map(fe=>new Object({bookingStart:ve(fe.date).format("YYYY-MM-DD")+" "+fe.time,providerId:fe.slot[0][0],locationId:fe.slot[0][1]})):[],lessonSpace:s.getters["appointment/getLessonSpace"]?"https://www.thelessonspace.com/space/"+s.getters["appointment/getLessonSpace"]:null,createPaymentLinks:j};le.value=!0,Pe.post("/appointments"+(s.getters["appointment/getId"]?"/"+s.getters["appointment/getId"]:""),ce,Object.assign(Ue(s),{params:{source:"cabinet-provider"}})).then(fe=>{fe.data.data.appointment.id&&ae("save")}).catch(fe=>{K.value=l.value.error,"response"in fe&&"data"in fe.response&&"data"in fe.response.data&&("timeSlotUnavailable"in fe.response.data.data&&fe.response.data.data.timeSlotUnavailable===!0&&(K.value=l.value.time_slot_unavailable,o.value="details"),"customerAlreadyBooked"in fe.response.data.data&&fe.response.data.data.customerAlreadyBooked===!0&&(K.value=l.value.customer_already_booked,o.value="customers")),X.value=!0}).finally(()=>{le.value=!1})}function ae(j){s.commit("appointment/setActive",!1),e(j)}Je(()=>{if(s.commit("appointment/setActive",!0),s.getters["appointment/getId"]){H.value=JSON.parse(JSON.stringify(s.getters["appointment/getAppointmentData"]));let j=s.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null}),te=s.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null});s.getters["appointment/getId"]&&s.getters["appointment/getServiceId"]&&te.map(Z=>Z.id).indexOf(s.getters["appointment/getServiceId"])===-1||s.getters["appointment/getId"]&&s.getters["appointment/getLocationId"]&&j.map(Z=>Z.id).indexOf(s.getters["appointment/getLocationId"])===-1||z(!0)}s.getters["appointment/getServiceId"]&&(s.dispatch("appointment/updateEmployeeService",s.getters["appointment/getServiceId"]),s.dispatch("appointment/addAllCustomFieldsFormRules",{label:l.value.required_field}))});let me=F("amColors"),Y=_(()=>({"--am-c-capai-text":me.value.colorMainText,"--am-c-capai-text-op10":W(me.value.colorMainText,.1),"--am-c-capai-primary":me.value.colorPrimary,"--am-c-cust-no1":me.value.colorMainText,"--am-c-cust-no1-bgr":W(me.value.colorMainText,.1),"--am-c-cust-no2":me.value.colorWarning,"--am-c-cust-no2-bgr":W(me.value.colorWarning,.1),"--am-c-cust-no3":me.value.colorError,"--am-c-cust-no3-bgr":W(me.value.colorError,.1),"--am-c-cust-link":W(me.value.colorMainText,.5),"--am-c-cust-text":me.value.colorMainText}));return(j,te)=>{const de=Xa,Z=Qa;return a(le)?(u(),q(Zt,{key:1})):(u(),x("div",{key:0,class:R(["am-capai",[{"am-no-border":!0},a(t).responsiveClass]]),style:be(a(Y))},[a(X)?(u(),q($t,{key:0,class:"am-asi__top-message am-asi__top-message-error",type:"error","show-icon":!0,"show-border":!0,"close-after":5e3,onClose:Q,onTriggerClose:Q},{title:S(()=>[ie(w(a(K)),1)]),_:1})):N("",!0),$(Z,{modelValue:o.value,"onUpdate:modelValue":te[1]||(te[1]=ce=>o.value=ce)},{default:S(()=>[$(de,{label:a(l).details,name:"details"},{default:S(()=>[$(_x,{ref_key:"appointmentDetailsRef",ref:r,"slots-props":a(V),"slots-loading":a(D),"free-slots":a(C),"is-disabled-date":A,times:a(h),"get-free-times":b,onRemoveSlots:J,onFetchSlots:B,onSelectDate:I,onSelectTime:O},null,8,["slots-props","slots-loading","free-slots","times"])]),_:1},8,["label"]),a(c)?(u(),q(de,{key:0,label:a(l).customers,name:"customers"},{default:S(()=>[$(Vx,{ref_key:"appointmentCustomersRef",ref:m,"responsive-class":a(t).responsiveClass,"capacity-warning":a(g),"appointment-capacity":a(f),"saved-appointment":a(H),onChangedSlotCondition:z},null,8,["responsive-class","capacity-warning","appointment-capacity","saved-appointment"])]),_:1},8,["label"])):N("",!0),a(c)&&a(c).extras.length&&a(s).getters["appointment/getBookings"].length?(u(),q(de,{key:1,label:a(l).extras,name:"extras"},{default:S(()=>[$(t2,{"responsive-class":a(t).responsiveClass,onChangedSlotCondition:z},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(c)&&a(k).length&&a(s).getters["appointment/getBookings"].length?(u(),q(de,{key:2,label:a(l).custom_fields,name:"customFields"},{default:S(()=>[$(zx,{ref_key:"appointmentCustomFieldsRef",ref:v,"responsive-class":a(t).responsiveClass},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(s).getters["appointment/getId"]&&n.linkedAppointments.length?(u(),q(de,{key:3,label:a(l).linked,name:"linked"},{default:S(()=>[$(V2,{"linked-appointments":n.linkedAppointments,"responsive-class":a(t).responsiveClass,onEditLinkedAppointment:te[0]||(te[0]=ce=>a(e)("editLinkedAppointment",ce))},null,8,["linked-appointments","responsive-class"])]),_:1},8,["label"])):N("",!0),a(c)&&a(c).recurringCycle!=="disabled"&&a(s).getters["appointment/getStartDate"]&&a(s).getters["appointment/getStartTime"]&&!a(s).getters["appointment/getId"]&&!!a(s).getters["customerInfo/getCustomersIds"].length?(u(),q(de,{key:4,label:a(l).recurring,name:"recurring"},{default:S(()=>[$(A2,{"free-slots":a(C),"slots-props":a(V),"maximum-booking-start-date":a(E),"get-free-times":b,"get-selected-dates-times":y,"is-disabled-date":A,"slots-loading":a(D),"responsive-class":a(t).responsiveClass,onFetchSlots:B},null,8,["free-slots","slots-props","maximum-booking-start-date","slots-loading","responsive-class"])]),_:1},8,["label"])):N("",!0),a(s).getters["appointment/getId"]?(u(),q(de,{key:5,label:a(l).payment,name:"payment"},{default:S(()=>[$(rw,{"responsive-class":a(t).responsiveClass},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]),d("div",cw,[$(ke,{category:"secondary",size:"default",type:"plain",onClick:te[2]||(te[2]=()=>{a(e)("close")})},{default:S(()=>[ie(w(a(l).cancel),1)]),_:1}),$(ke,{size:"default",onClick:$e},{default:S(()=>[ie(w(a(l).save),1)]),_:1})]),$(Da,{visibility:a(se),title:a(l).confirm,description:a(l).price_changed_message,"close-btn-text":a(l).no,"confirm-btn-text":a(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:te[3]||(te[3]=ce=>ue(!1)),onConfirm:te[4]||(te[4]=ce=>ue(!0)),onClose:te[5]||(te[5]=ce=>ye(se)?se.value=!1:se=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],6))}}});const mw={key:0,class:"el-skeleton-item-wrapper-title"},pw={name:"AuthSkeleton"},Lo=Object.assign(pw,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const e=n;return(t,s)=>{const l=dl,i=ml;return u(),q(i,{animated:"",class:R(["am-asi-el-skeleton",[{"am-asi":a(e).mainClass}]])},{template:S(()=>[a(e).centerFirst?(u(),x("div",mw,[$(l,{variant:"rect"})])):N("",!0),(u(!0),x(ee,null,pe(new Array(a(e).count),o=>(u(),x("div",{key:o,class:"el-skeleton-item-wrapper"},[$(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});const gw=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),fw={key:2,class:"am-cap__actions"},hw={name:"CabinetAppointments",key:"appointments"},vw=Object.assign(hw,{props:{loadBookingsCounter:{type:Number,default:0},appointments:{type:Object,default:null}},setup(n){const e=n;let t=Ie();const s=F("settings");let l=F("amCustomize");const i=F("shortcodeData"),o=F("labels"),r=F("localLanguage");let c=_(()=>s.general.usedLanguages.includes(r.value)),m=_(()=>{let le=lt({...o}),H=l.value.appointments.translations;return H&&Object.keys(H).forEach(se=>{H[se][r.value]&&c.value?le[se]=H[se][r.value]:H[se].default&&(le[se]=H[se].default)}),le});Be("amLabels",m);const g=M(null),{width:f}=Ka(g);let v=_(()=>tt(f.value));Be("pageWidth",f);let k=M(null),T=M(!1),y=M("success"),b=M("");function L(){T.value=!1,t.commit("cabinet/setPaymentLinkError",{value:!1,type:"appointment"})}let E=F("cabinetType");t.commit("cabinetFilters/setDates",Xi(E.value));let C=_(()=>t.getters["cabinet/getAppointmentsLoading"]),h=_(()=>t.getters["entities/getReady"]),I=M(null),O=M(0),A=M(1);function D(le){A.value=le,V(null,le)}function V(le=null,H=1){t.commit("cabinet/setAppointmentsLoading",!0);let se=JSON.parse(JSON.stringify(t.getters["cabinetFilters/getAppointmentsFilters"])),ge=t.getters["cabinet/getTimeZone"];se.dates=se.dates.map(ue=>ve(ue).format("YYYY-MM-DD")),se.timeZone=ge,se.source="cabinet-"+E.value,se.page=H,t.commit("auth/setLoadingAppointmentsCounter",t.getters["auth/getLoadingAppointmentsCounter"]+1);let $e=t.getters["auth/getLoadingAppointmentsCounter"];Pe.get("/appointments",Object.assign(Ue(t),{params:vn(se)})).then(ue=>{$e===t.getters["auth/getLoadingAppointmentsCounter"]&&(O.value=ue.data.data.total,I.value=nu(ue.data.data.appointments,ge,E.value==="provider"))}).catch(ue=>{ue?.response?.data?.data?.reauthorize!==void 0&&ue.response.data.data.reauthorize&&t.dispatch("auth/logout"),console.log(ue)}).finally(()=>{$e===t.getters["auth/getLoadingAppointmentsCounter"]&&(t.commit("cabinet/setAppointmentsLoading",!1),le&&"message"in le&&(T.value=!0,b.value=le.message,g.value&&k.value&&setTimeout(function(){gt(g.value,k.value.$el,0,300)},500)))})}let z=M([]);function B(le){t.commit("cabinet/setAppointmentsLoading",!0),Pe.get("/appointments/"+le.id,Object.assign({params:{source:"cabinet-"+E.value,timeZone:t.getters["cabinet/getTimeZone"]}},Ue(t))).then(H=>{let se=H.data.data.appointment.bookingStart.split(" "),ge=t.getters["entities/getService"](H.data.data.appointment.serviceId),$e=[];H.data.data.appointment.bookings.forEach(ue=>{let ae=[];ge.extras.sort((Y,j)=>Y.position-j.position).forEach(Y=>{ae.push({extraId:Y.id,quantity:0});let j=ue.extras.find(te=>te.extraId===Y.id);typeof j<"u"&&(ae[ae.length-1]=j)});let me=ue.customFields?JSON.parse(ue.customFields):{};Object.keys(me).forEach(Y=>{me[Y]=Object.assign({},me[Y],{value:me[Y].type==="datepicker"?me[Y].value?ve(me[Y].value).toDate():"":me[Y].value})}),$e.push({id:ue.id,customer:le.bookings.find(Y=>Y.id===ue.id).customer,persons:ue.persons,status:ue.status,duration:ue.duration?ue.duration.toString():null,extras:ae,customFields:me,payments:ue.payments,price:ue.price,aggregatedPrice:ue.aggregatedPrice,tax:ue.tax,coupon:ue.coupon})}),t.commit("appointment/setAppointment",{id:H.data.data.appointment.id,categoryId:ge.categoryId,serviceId:H.data.data.appointment.serviceId,providerId:H.data.data.appointment.providerId,locationId:H.data.data.appointment.locationId,internalNotes:H.data.data.appointment.internalNotes,lessonSpace:H.data.data.appointment.lessonSpace!==null?H.data.data.appointment.lessonSpace.split("https://www.thelessonspace.com/space/")[1]:null,startDate:ve(se[0]).toDate(),startTime:se[1].substring(0,5),bookings:$e}),z.value=H.data.data.recurring,J.value=!0}).catch(H=>{console.log(H)}).finally(()=>{t.commit("cabinet/setAppointmentsLoading",!1)})}let J=M(!1);function G(){T.value=!0,b.value=m.value.appointment_saved,g.value&&k.value&&setTimeout(function(){gt(g.value,k.value.$el,0,300)},500),V(),K()}function X(){Q(),J.value=!0}function K(){J.value=!1,Q()}function Q(){t.commit("appointment/resetAppointment",{providerId:t.getters["auth/getProfile"].id}),t.commit("customerInfo/setCustomers",[]),t.commit("customerInfo/setCustomersIds",[])}return rt(()=>e.loadBookingsCounter,()=>{V()}),Je(()=>{V()}),(le,H)=>(u(),x("div",{ref_key:"pageContainer",ref:g,class:R(["am-cap am-capa-main",{"am-capai-main":a(J)}])},[d("div",{class:R(["am-capa-main__inner",a(v)])},[a(T)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:k,type:a(y),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:L,onTriggerClose:L},{title:S(()=>[gw,ie(" "+w(a(b)),1)]),_:1},8,["type"])):N("",!0),!a(J)&&a(h)?(u(),q(Eo,{key:1,"step-key":"appointments","responsive-class":a(v),empty:!1,onAddAppointment:X,onChangeFilters:V},null,8,["responsive-class"])):N("",!0),a(i).cabinetType==="employee"&&a(s).roles.allowWriteAppointments&&!a(J)&&a(h)?(u(),x("div",fw,[$(ke,{prefix:"plus",size:"small",category:"primary",type:a(l).appointments.options.newAppBtn.buttonType,onClick:X},{default:S(()=>[d("span",null,w(a(m).new_appointment),1)]),_:1},8,["type"])])):N("",!0),!a(C)&&a(h)?(u(),x(ee,{key:3},[!a(J)&&a(I)&&Object.keys(a(I)).length>0?(u(),q(cu,{key:0,"grouped-appointments":a(I),"page-width":a(f),"responsive-class":a(v),"step-key":"appointments",onCanceled:V,onBooked:V,onEditAppointment:B},null,8,["grouped-appointments","page-width","responsive-class"])):a(J)?N("",!0):(u(),q(Na,{key:1,heading:a(m).no_app_found,text:a(m).have_no_app},null,8,["heading","text"])),!a(J)&&a(I)&&Object.keys(a(I)).length>0&&a(O)>a(s).general.itemsPerPageBackEnd?(u(),q(tl,{key:2,"page-size":a(s).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(O),"current-page":a(A),onCurrentChange:D},null,8,["page-size","total","current-page"])):N("",!0),a(J)?(u(),q(dw,{key:3,"page-width":a(f),"responsive-class":a(v),"linked-appointments":a(z),onEditLinkedAppointment:B,onClose:K,onSave:G},null,8,["page-width","responsive-class","linked-appointments"])):N("",!0)],64)):(u(),q(Lo,{key:4}))],2)],2))}});function $s(n,e,t={},s={}){for(let l in e)l in n&&e[l]&&typeof e[l]=="object"?(l in s||(s[l]={}),$s(n[l],e[l],l in t?t[l]:n[l],s[l]),Object.keys(s[l]).length===0&&delete s[l]):l in t?s[l]=t[l]:l in n?s[l]=n[l]:s[l]=e[l];return s}function _w(n){ot.activation.stash&&Pe.post("/stash",{},Object.assign(Ue(n),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(()=>{})}function yw(n,e){let t=n.getters["event/getDefaultEvent"],s=[],l={};e.customTickets.length&&e.bookings.forEach(r=>{r.ticketsData.forEach(c=>{l[c.eventTicketId]=!0})}),e.customTickets.forEach(r=>{JSON.parse(r.dateRanges).forEach((c,m)=>{m in s||s.push({enabled:c.enabled,range:[ve(c.startDate,"YYYY-MM-DD").toDate(),ve(c.endDate,"YYYY-MM-DD").toDate()],tickets:[]}),s[m].tickets.push({price:c.price})}),r.booked=r.id in l});let i=!e.description||e.description.startsWith("<!-- Content -->")?"text":"html",o=e.description?e.description.replace("<!-- Content -->",""):"";return Object.assign({},e,{description:o,descriptionMode:i,tags:e.tags.map(r=>r.name),organizerId:e.organizerId,periods:e.periods.map(r=>new Object({id:r.id,eventId:r.eventId,appleCalendarEventId:r.appleCalendarEventId,googleCalendarEventId:r.googleCalendarEventId,googleMeetUrl:r.googleMeetUrl,outlookCalendarEventId:r.outlookCalendarEventId,startDate:ve(r.periodStart.split(" ")[0],"YYYY-MM-DD").toDate(),endDate:ve(r.periodEnd.split(" ")[0],"YYYY-MM-DD").toDate(),startTime:r.periodStart.split(" ")[1].substring(0,5),endTime:r.periodEnd.split(" ")[1].substring(0,5)})),bookingOpens:{disabled:e.bookingOpens===null,date:e.bookingOpens?ve(e.bookingOpens.split(" ")[0],"YYYY-MM-DD").toDate():null,time:e.bookingOpens?e.bookingOpens.split(" ")[1].substring(0,5):null},bookingOpensRec:e.bookingOpensRec==="same",bookingCloses:{disabled:e.bookingCloses===null,date:e.bookingCloses?ve(e.bookingCloses.split(" ")[0],"YYYY-MM-DD").toDate():null,time:e.bookingCloses?e.bookingCloses.split(" ")[1].substring(0,5):null},bookingClosesRec:e.bookingClosesRec==="same",recurringEnabled:e.recurring&&e.recurring.cycle!==null,recurring:e.recurring!==null?Object.assign({},e.recurring,{until:e.recurring.until?ve(e.recurring.until.split(" ")[0],"YYYY-MM-DD").toDate():null,monthDate:e.recurring.monthDate?ve(e.recurring.monthDate.split(" ")[0],"YYYY-MM-DD").toDate():null}):t.recurring,depositEnabled:e.depositPayment!=="disabled",depositPayment:e.depositPayment!=="disabled"?e.depositPayment:"percentage",customTicketsRangesEnabled:s.length>0,customTicketsRanges:s,maxCustomCapacity:e.maxCustomCapacity===null?1:e.maxCustomCapacity,maxCustomCapacityEnabled:e.maxCustomCapacity!==null,closeAfterMinEnabled:e.closeAfterMin>0,closeAfterMinBookings:e.closeAfterMinBookings?"on":"off",maxExtraPeopleEnabled:e.maxExtraPeopleEnabled!==null?e.maxExtraPeopleEnabled:!1,locationId:e.locationId===null&&e.customLocation?0:e.locationId,settings:$s(ot,t.settings,e.settings?JSON.parse(e.settings):{},{})})}function bw(n){let e=n.getters["event/getDefaultEvent"],t=[];n.getters["event/getCustomTickets"].forEach((l,i)=>{let o=[];n.getters["event/getCustomTicketsRanges"].filter(r=>r.range[0]&&r.range[1]).forEach(r=>{o.push({startDate:ve(r.range[0]).format("YYYY-MM-DD"),endDate:ve(r.range[1]).format("YYYY-MM-DD"),price:r.tickets[i].price})}),t.push(Object.assign({},l,{dateRanges:JSON.stringify(o)}))});let s=$s($s(ot,e.settings,{},{}),e.settings,n.getters["event/getSettings"],{});return Object.keys(n.getters["event/getSettings"]).forEach(l=>{Object.keys(n.getters["event/getSettings"][l]).forEach(i=>{n.getters["event/getSettings"][l][i]!==null&&typeof n.getters["event/getSettings"][l][i]=="object"?(Object.keys(n.getters["event/getSettings"][l][i]).forEach(o=>{(n.getters["event/getSettings"][l][i][o]===ot[l][i][o]||ot[l][i][o]&&(n.getters["event/getSettings"][l][i][o]===""||n.getters["event/getSettings"][l][i][o]===null))&&delete s[l][i][o]}),typeof s[l][i]=="object"&&Object.keys(s[l][i]).length===0&&delete s[l][i]):l in ot&&i in ot[l]&&(s[l][i]===ot[l][i]||ot[l][i]&&(n.getters["event/getSettings"][l][i]===""||n.getters["event/getSettings"][l][i]===null))&&delete s[l][i]}),Object.keys(s[l]).length===0&&delete s[l]}),{aggregatedPrice:n.getters["event/getAggregatedPrice"],bookMultipleTimes:n.getters["event/getBookMultipleTimes"],bookingCloses:!n.getters["event/getBookingClosesDisabled"]&&n.getters["event/getBookingClosesDate"]&&n.getters["event/getBookingClosesTime"]?ve(n.getters["event/getBookingClosesDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingClosesTime"]+":00":null,bookingClosesRec:n.getters["event/getBookingClosesRec"]?"same":"calculate",bookingOpens:!n.getters["event/getBookingOpensDisabled"]&&n.getters["event/getBookingOpensDate"]&&n.getters["event/getBookingOpensTime"]?ve(n.getters["event/getBookingOpensDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingOpensTime"]+":00":null,bookingOpensRec:n.getters["event/getBookingOpensRec"]?"same":"calculate",bringingAnyone:n.getters["event/getBringingAnyone"],closeAfterMin:n.getters["event/getCloseAfterMin"],closeAfterMinBookings:n.getters["event/getCloseAfterMinBookings"],color:n.getters["event/getColor"],customLocation:n.getters["event/getCustomLocation"],customPricing:n.getters["event/getCustomPricing"],customTickets:t,deposit:n.getters["event/getDeposit"],depositPayment:n.getters["event/getDepositEnabled"]?n.getters["event/getDepositPayment"]:"disabled",depositPerPerson:n.getters["event/getDepositPerPerson"],description:n.getters["event/getDescription"]&&n.getters["event/getDescriptionMode"]==="text"?"<!-- Content -->"+n.getters["event/getDescription"]:n.getters["event/getDescription"],fullPayment:n.getters["event/getFullPayment"],gallery:n.getters["event/getGallery"],id:n.getters["event/getId"],locationId:n.getters["event/getLocationId"]===0?null:n.getters["event/getLocationId"],maxCapacity:n.getters["event/getMaxCapacity"],maxCustomCapacity:n.getters["event/getMaxCustomCapacityEnabled"]?n.getters["event/getMaxCustomCapacity"]:null,maxExtraPeople:n.getters["event/getMaxExtraPeople"],name:n.getters["event/getName"],notifyParticipants:n.getters["event/getNotifyParticipants"],organizerId:n.getters["event/getOrganizerId"],parentId:n.getters["event/getParentId"],periods:gu(n),price:n.getters["event/getPrice"],providers:n.getters["event/getId"]?n.getters["event/getProviders"]:[{id:n.getters["auth/getProfile"].id,firstName:n.getters["auth/getProfile"].firstName,lastName:n.getters["auth/getProfile"].lastName,email:n.getters["auth/getProfile"].email,type:"provider"}],recurring:n.getters["event/getRecurringEnabled"]?Object.assign({},n.getters["event/getRecurring"],{until:ve(n.getters["event/getRecurringUntil"]).format("YYYY-MM-DD"),monthDate:n.getters["event/getRecurringMonthDate"]?ve(n.getters["event/getRecurringMonthDate"]).format("YYYY-MM-DD"):null}):null,settings:Object.keys(s).length?JSON.stringify(s):null,show:n.getters["event/getShow"],tags:n.getters["event/getTags"].map(l=>new Object({name:l})),timeZone:n.getters["cabinet/getTimeZone"],translations:n.getters["event/getTranslations"],utc:n.getters["cabinet/getTimeZone"]==="UTC",zoomUserId:n.getters["event/getZoomUserId"]}}function gu(n){return n.getters["event/getPeriods"].map(e=>new Object({id:e.id,eventId:e.eventId,appleCalendarEventId:e.appleCalendarEventId,googleCalendarEventId:e.googleCalendarEventId,googleMeetUrl:e.googleMeetUrl,outlookCalendarEventId:e.outlookCalendarEventId,microsoftTeamsUrl:e.microsoftTeamsUrl,periodStart:n.getters["cabinet/getTimeZone"]==="UTC"?ve(e.startDate).utc().format("YYYY-MM-DD")+" "+e.startTime+":00":ve(e.startDate).format("YYYY-MM-DD")+" "+e.startTime+":00",periodEnd:n.getters["cabinet/getTimeZone"]==="UTC"?ve(e.endDate).utc().format("YYYY-MM-DD")+" "+e.endTime+":00":ve(e.endDate).format("YYYY-MM-DD")+" "+e.endTime+":00"}))}const Zn=lt(window.wpAmeliaLabels);function Br(n,e={}){return Object.assign(e,{id:n.id,eventId:n.event.id,customer:n.customer,customerId:n.customer.id,persons:n.persons,customFields:n.customFields?JSON.parse(n.customFields):{},ticketsData:n.ticketsData,status:n.status,tax:n.tax,price:n.price,coupon:n.coupon,payments:n.payments})}function fu(n){let e={};return Object.keys(n.getters["attendee/getCustomFields"]).forEach(t=>{e[t]={label:n.getters["attendee/getCustomFields"][t].label,type:n.getters["attendee/getCustomFields"][t].type,value:n.getters["attendee/getCustomFields"][t].type==="datepicker"?n.getters["attendee/getCustomFields"][t].value?ve(n.getters["attendee/getCustomFields"][t].value).format("YYYY-MM-DD"):null:n.getters["attendee/getCustomFields"][t].value}}),{id:n.getters["attendee/getId"],type:"event",eventId:n.getters["attendee/getEventId"],bookings:[{customerId:n.getters["attendee/getCustomerId"],persons:n.getters["attendee/getPersons"],customFields:e,ticketsData:n.getters["attendee/getTickets"],status:n.getters["attendee/getStatus"],coupon:n.getters["attendee/getCoupon"]}],status:n.getters["attendee/getStatus"],validateCoupon:!1,isBackendOrCabinet:!0,createPaymentLinks:!1,payment:{gateway:"onSite"}}}function Es(n,e,t=null){let s=e.customFields,l=t&&t.customPricing?t.customTickets.map((i,o)=>new Object({eventTicketId:i.id,persons:o===0&&!Object.keys(e.ticketsData).length?1:0,price:i.price})):[];return t&&(n.getters["entities/getCustomFields"].filter(i=>i.allEvents||i.events.map(o=>o.id).indexOf(t.id)!==-1&&i.type!=="content"&&i.type!=="file").forEach(i=>{s[i.id]={type:i.type,label:i.label,value:i.id in s?s[i.id].value:i.type==="checkbox"||i.type==="file"?[]:"",width:i.width,options:i.options,id:i.id,required:i.required}}),t.customPricing&&Object.keys(e.ticketsData).forEach(i=>{let o=l.find(r=>r.eventTicketId===e.ticketsData[i].eventTicketId);o.id=e.ticketsData[i].id,o.persons=e.ticketsData[i].persons,o.price=e.ticketsData[i].price,o.customerBookingId=e.ticketsData[i].customerBookingId})),Object.assign({},e,{eventId:t?t.id:null,customFields:s,ticketsData:l})}function hu(){return[{label:Zn.approved,value:"approved",icon:"check",color:"var(--am-c-success)"},{label:Zn.waiting,value:"waiting",icon:"clock",color:"var(--am-c-warning)"},{label:Zn.canceled,value:"canceled",icon:"close",color:"var(--am-c-error)"},{label:Zn["no-show"],value:"no-show",icon:"clock",color:"var(--am-c-warning)"}]}function vu(n){let e=0;return n.getters["attendee/getTickets"].length?n.getters["attendee/getTickets"].forEach(t=>{t.persons&&(e+=n.getters["attendee/getAggregatedPrice"]?t.price*t.persons:t.price)}):e=n.getters["attendee/getAggregatedPrice"]?n.getters["attendee/getPrice"]*n.getters["attendee/getPersons"]:n.getters["attendee/getPrice"],Zi(null,n.getters["attendee/getCoupon"],n.getters["attendee/getTax"]&&n.getters["attendee/getTax"].length?n.getters["attendee/getTax"][0]:null,e,!1)}const kw=["innerHTML"],Cw=["innerHTML"],xw={setup(n,{expose:e}){let t=Ie(),s=F("amLabels"),l=F("licence");const i=F("settings");let o=M(t.getters["entities/getLocations"]),r=M(t.getters["entities/getTags"]),c=M(null),m=M({name:_({get:()=>t.getters["event/getName"],set:T=>{t.commit("event/setName",T)}}),locationId:_({get:()=>t.getters["event/getLocationId"],set:T=>{t.commit("event/setLocationId",T)}}),customLocation:_({get:()=>t.getters["event/getCustomLocation"],set:T=>{t.commit("event/setCustomLocation",T)}}),organizerId:_({get:()=>t.getters["event/getOrganizerId"],set:T=>{t.commit("event/setOrganizerId",T)}}),zoomUserId:_({get:()=>t.getters["event/getZoomUserId"],set:T=>{t.commit("event/setZoomUserId",T)}}),tags:_({get:()=>t.getters["event/getTags"],set:T=>{t.commit("event/setTags",T)}}),notifyParticipants:_({get:()=>t.getters["event/getNotifyParticipants"],set:T=>{t.commit("event/setNotifyParticipants",T)}}),description:_({get:()=>t.getters["event/getDescription"],set:T=>{t.commit("event/setDescription",T||"")}})}),g=_(()=>m.value.organizerId!==null);function f(T){t.commit("event/setOrganizerId",T?t.getters["auth/getProfile"].id:null)}let v=_(()=>({name:[{required:!0,message:s.value.please_enter_name,trigger:["submit","change"]}]})),k=_(()=>{let T=t.getters["auth/getZoomUsers"];return T.length?T.map(y=>({value:y.id,label:`${y.first_name} ${y.last_name} (${y.email})`})):[]});return e({detailsFormRef:c}),(T,y)=>{const b=xt,L=gl,E=et;return u(),q(E,{ref_key:"detailsFormRef",ref:c,model:a(m),rules:a(v),class:"am-capei-def"},{default:S(()=>[$(b,{prop:"name",label:`${a(s).name}:`,class:"am-capei-def__item"},{default:S(()=>[$(St,{modelValue:a(m).name,"onUpdate:modelValue":y[0]||(y[0]=C=>a(m).name=C),placeholder:a(s).enter_event_name},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),!a(l).isStarter&&a(o).length>1?(u(),q(b,{key:0,label:`${a(s).event_select_address}:`,class:"am-capei-def__item"},{default:S(()=>[$(We,{modelValue:a(m).locationId,"onUpdate:modelValue":y[1]||(y[1]=C=>a(m).locationId=C),placeholder:a(s).select},{default:S(()=>[(u(),q(Ve,{key:0,value:0,label:a(s).event_custom_address},null,8,["label"])),(u(!0),x(ee,null,pe(a(o),C=>(u(),q(Ve,{key:C.id,value:C.id,label:C.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),a(m).locationId?N("",!0):(u(),q(b,{key:1,label:`${a(s).event_custom_address}:`,class:"am-capei-def__item"},{default:S(()=>[$(St,{modelValue:a(m).customLocation,"onUpdate:modelValue":y[2]||(y[2]=C=>a(m).customLocation=C)},null,8,["modelValue"])]),_:1},8,["label"])),a(i).zoom.enabled?(u(),q(b,{key:2,label:`${a(s).zoom_user}:`,class:"am-capei-def__item"},{default:S(()=>[$(We,{modelValue:a(m).zoomUserId,"onUpdate:modelValue":y[3]||(y[3]=C=>a(m).zoomUserId=C),clearable:"",placeholder:a(s).zoom_user_placeholder},{default:S(()=>[(u(!0),x(ee,null,pe(a(k),C=>(u(),q(Ve,{key:C.value,value:C.value,label:C.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),!a(l).isStarter&&(a(i).googleCalendar.enabled||a(i).outlookCalendar.enabled||a(i).appleCalendar)&&(a(t).getters["employee/getGoogleCalendarId"]||a(t).getters["employee/getOutlookCalendarId"]||a(t).getters["employee/getAppleCalendarId"])?(u(),q(b,{key:3,class:"am-capei-def__item am-capei-def__item-tool"},{default:S(()=>[$(st,{modelValue:a(g),"onUpdate:modelValue":y[4]||(y[4]=C=>ye(g)?g.value=C:g=C),disabled:a(m).organizerId&&a(m).organizerId!==a(t).getters["auth/getProfile"].id,"active-text":a(s).event_organizer,onChange:f},null,8,["modelValue","disabled","active-text"]),$(L,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(s).event_organizer_tooltip},null,8,kw)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1})):N("",!0),$(b,{label:`${a(s).event_tags}:`,class:"am-capei-def__item"},{default:S(()=>[$(We,{modelValue:a(m).tags,"onUpdate:modelValue":y[5]||(y[5]=C=>a(m).tags=C),clearable:"",filterable:"",multiple:"","allow-create":!0,placeholder:a(s).event_tags_select_or_create},{default:S(()=>[(u(!0),x(ee,null,pe(a(r),(C,h)=>(u(),q(Ve,{key:h,value:C.name,label:C.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),$(b,{class:"am-capei-def__item am-capei-def__item-tool"},{default:S(()=>[$(st,{modelValue:a(m).notifyParticipants,"onUpdate:modelValue":y[6]||(y[6]=C=>a(m).notifyParticipants=C),"active-text":a(s).notify_attendees},null,8,["modelValue","active-text"]),$(L,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(s).notify_attendees_tooltip},null,8,Cw)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1}),$(b,{prop:"description",label:a(s).description_colon,class:"am-capei-def__item"},{default:S(()=>[$(tu,{modelValue:a(m).description,"onUpdate:modelValue":y[7]||(y[7]=C=>a(m).description=C),mode:a(t).getters["event/getDescriptionMode"],onSetMode:y[8]||(y[8]=C=>a(t).commit("event/setDescriptionMode",C))},null,8,["modelValue","mode"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};const ww={class:"am-capei-per__segment"},Tw={key:0,class:"am-capei-per__delete"},Sw={class:"am-capei-per__segment"},Ew=["innerHTML"],Lw={class:"am-capei-per__segment"},Aw=["innerHTML"],$w={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:e}){const t=n;let s=_(()=>tt(t.pageWidth));const l=Ie(),i=F("settings");let o=F("amLabels"),r=F("localLanguage"),c=M(at());function m(E,C){const h=at(E)<c.value;return(C?at(E)>at(C):!1)||h}function g(E,C){return C?at(E)<at(C):at(E)<c.value}function f(E){return at(E)<c.value}function v(){let E=!0;T.value.validate(C=>{C||(E=!1)}),E&&y.value.periods.push({eventId:l.getters["event/getId"]?l.getters["event/getId"]:null,startDate:null,endDate:null,startTime:null,endTime:null})}let k=_(()=>l.getters["event/getRecurringEnabled"]),T=M(null),y=M({periods:_({get:()=>l.getters["event/getPeriods"],set:E=>{l.commit("event/setPeriods",E)}}),bookingOpensDisabled:_({get:()=>l.getters["event/getBookingOpensDisabled"],set:E=>{l.commit("event/setBookingOpensDisabled",E)}}),bookingOpensDate:_({get:()=>l.getters["event/getBookingOpensDate"],set:E=>{l.commit("event/setBookingOpensDate",E)}}),bookingOpensTime:_({get:()=>l.getters["event/getBookingOpensTime"],set:E=>{l.commit("event/setBookingOpensTime",E)}}),bookingOpensRec:_({get:()=>l.getters["event/getBookingOpensRec"],set:E=>{l.commit("event/setBookingOpensRec",E)}}),bookingClosesDisabled:_({get:()=>l.getters["event/getBookingClosesDisabled"],set:E=>{l.commit("event/setBookingClosesDisabled",E)}}),bookingClosesDate:_({get:()=>l.getters["event/getBookingClosesDate"],set:E=>{l.commit("event/setBookingClosesDate",E)}}),bookingClosesTime:_({get:()=>l.getters["event/getBookingClosesTime"],set:E=>{l.commit("event/setBookingClosesTime",E)}}),bookingClosesRec:_({get:()=>l.getters["event/getBookingClosesRec"],set:E=>{l.commit("event/setBookingClosesRec",E)}})});e({periodsFormRef:T});let b=F("amColors"),L=_(()=>({"--am-c-capei-per-text":b.value.colorMainText,"--am-c-capei-per-text-op03":W(b.value.colorMainText,.03),"--am-c-capei-per-inp-bgr-op03":W(b.value.colorInpBgr,.03)}));return(E,C)=>{const h=xt,I=gl,O=et;return u(),q(O,{ref_key:"periodsFormRef",ref:T,model:a(y),"label-position":"top",class:"am-capei-per",style:be(a(L))},{default:S(()=>[d("div",ww,[(u(!0),x(ee,null,pe(a(y).periods,(A,D)=>(u(),x(ee,{key:D},[$(h,{prop:"periods."+D+".startDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},label:`${a(o).start_date}:`,class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Ht,{modelValue:A.startDate,"onUpdate:modelValue":V=>A.startDate=V,format:a(Wt)(),lang:a(r),"disabled-date":V=>m(V,A.endDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),$(h,{prop:"periods."+D+".endDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},label:`${a(o).end_date}:`,class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Ht,{modelValue:A.endDate,"onUpdate:modelValue":V=>A.endDate=V,format:a(Wt)(),lang:a(r),"disabled-date":V=>g(V,A.startDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),$(h,{prop:"periods."+D+".startTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},label:`${a(o).start_time}:`,class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Aa,{modelValue:A.startTime,"onUpdate:modelValue":V=>A.startTime=V,start:"00:00",end:a(Mt)(a(qt)("24:00")-a(i).general.timeSlotLength),"min-time":null,"max-time":A.endTime,step:a(Mt)(a(i).general.timeSlotLength),clearable:!1,placeholder:a(o).select_time},null,8,["modelValue","onUpdate:modelValue","end","max-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),$(h,{prop:"periods."+D+".endTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},label:`${a(o).end_time}:`,class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Aa,{modelValue:A.endTime,"onUpdate:modelValue":V=>A.endTime=V,disabled:!A.startTime,start:"00:00",end:"24:00","min-time":A.startTime,"max-time":null,step:a(Mt)(a(i).general.timeSlotLength),clearable:!1,placeholder:a(o).select_time},null,8,["modelValue","onUpdate:modelValue","disabled","min-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),a(y).periods.length>1?(u(),x("div",Tw,[$(ke,{size:"default",category:"danger",onClick:()=>a(y).periods.splice(D,1)},{default:S(()=>[ie(w(a(o).delete_period),1)]),_:2},1032,["onClick"])])):N("",!0)],64))),128)),$(ke,{size:"default",onClick:C[0]||(C[0]=A=>v())},{default:S(()=>[ie(w(a(o).add_period),1)]),_:1})]),d("div",Sw,[$(ft,{modelValue:a(y).bookingOpensDisabled,"onUpdate:modelValue":C[1]||(C[1]=A=>a(y).bookingOpensDisabled=A),label:a(o).event_booking_opens_now},null,8,["modelValue","label"]),a(y).bookingOpensDisabled?N("",!0):(u(),x(ee,{key:0},[$(h,{label:`${a(o).date}:`,prop:"bookingOpensDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Ht,{modelValue:a(y).bookingOpensDate,"onUpdate:modelValue":C[2]||(C[2]=A=>a(y).bookingOpensDate=A),format:a(Wt)(),lang:a(r),"disabled-date":f},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),$(h,{label:`${a(o).time}:`,prop:"bookingOpensTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Aa,{modelValue:a(y).bookingOpensTime,"onUpdate:modelValue":C[3]||(C[3]=A=>a(y).bookingOpensTime=A),placeholder:a(o).select_time,step:a(Mt)(a(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1},null,8,["modelValue","placeholder","step"])]),_:1},8,["label","rules","class"])],64)),a(k)?(u(),q(ft,{key:1,modelValue:a(y).bookingOpensRec,"onUpdate:modelValue":C[4]||(C[4]=A=>a(y).bookingOpensRec=A)},{default:S(()=>[ie(w(a(o).apply_to_all)+" ",1),$(I,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(o).event_booking_closes_apply},null,8,Ew)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),d("div",Lw,[$(ft,{modelValue:a(y).bookingClosesDisabled,"onUpdate:modelValue":C[5]||(C[5]=A=>a(y).bookingClosesDisabled=A),label:a(o).event_booking_closes_after},null,8,["modelValue","label"]),a(y).bookingClosesDisabled?N("",!0):(u(),x(ee,{key:0},[$(h,{label:`${a(o).date}:`,prop:"bookingClosesDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Ht,{modelValue:a(y).bookingClosesDate,"onUpdate:modelValue":C[6]||(C[6]=A=>a(y).bookingClosesDate=A),format:a(Wt)(),lang:a(r),"disabled-date":f},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),$(h,{label:`${a(o).time}:`,prop:"bookingClosesTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},class:R(["am-capei-per__item am-w-50",a(s)])},{default:S(()=>[$(Aa,{modelValue:a(y).bookingClosesTime,"onUpdate:modelValue":C[7]||(C[7]=A=>a(y).bookingClosesTime=A),step:a(Mt)(a(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1,placeholder:a(o).select_time},null,8,["modelValue","step","placeholder"])]),_:1},8,["label","rules","class"])],64)),a(k)?(u(),q(ft,{key:1,modelValue:a(y).bookingClosesRec,"onUpdate:modelValue":C[8]||(C[8]=A=>a(y).bookingClosesRec=A)},{default:S(()=>[ie(w(a(o).apply_to_all)+" ",1),$(I,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(o).event_booking_closes_apply},null,8,Aw)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):N("",!0)])]),_:1},8,["model","style"])}}};const Iw={class:"am-capei-recurr__header"},Ow={class:"am-capei-recurr__header-text"},Pw={props:{pageWidth:{type:Number,default:0},recurringUntil:{type:Object,default:null}},setup(n,{expose:e}){const t=n;let s=_(()=>tt(t.pageWidth));const l=Ie();let i=F("amLabels"),o=F("localLanguage"),r=M([{label:i.value.day,value:"daily"},{label:i.value.week,value:"weekly"},{label:i.value.month,value:"monthly"},{label:i.value.year,value:"yearly"}]),c=M([{label:i.value.recurring_date_first,value:"first"},{label:i.value.recurring_date_second,value:"second"},{label:i.value.recurring_date_third,value:"third"},{label:i.value.recurring_date_fourth,value:"fourth"},{label:i.value.recurring_date_fifth,value:"fifth"},{label:i.value.recurring_date_last,value:"last"}]),m=[{label:i.value.weekday_monday,value:"monday"},{label:i.value.weekday_tuesday,value:"tuesday"},{label:i.value.weekday_wednesday,value:"wednesday"},{label:i.value.weekday_thursday,value:"thursday"},{label:i.value.weekday_friday,value:"friday"},{label:i.value.weekday_saturday,value:"saturday"},{label:i.value.weekday_sunday,value:"sunday"}],g=M(null),f=M({enabled:_({get:()=>l.getters["event/getRecurringEnabled"],set:E=>{l.commit("event/setRecurringEnabled",E)}}),cycle:_({get:()=>l.getters["event/getRecurringCycle"],set:E=>{l.commit("event/setRecurringCycle",E)}}),cycleInterval:_({get:()=>l.getters["event/getRecurringCycleInterval"],set:E=>{l.commit("event/setRecurringCycleInterval",E)}}),monthDate:_({get:()=>l.getters["event/getRecurringMonthDate"],set:E=>{l.commit("event/setRecurringMonthDate",E)}}),monthlyOnDay:_({get:()=>l.getters["event/getRecurringMonthlyOnDay"],set:E=>{l.commit("event/setRecurringMonthlyOnDay",E)}}),monthlyOnRepeat:_({get:()=>l.getters["event/getRecurringMonthlyOnRepeat"],set:E=>{l.commit("event/setRecurringMonthlyOnRepeat",E)}}),monthlyRepeat:_({get:()=>l.getters["event/getRecurringMonthlyRepeat"],set:E=>{l.commit("event/setRecurringMonthlyRepeat",E)}}),order:_({get:()=>l.getters["event/getRecurringOrder"],set:E=>{l.commit("event/setRecurringOrder",E)}}),until:_({get:()=>l.getters["event/getRecurringUntil"],set:E=>{l.commit("event/setRecurringUntil",E)}})}),v=_(()=>({cycle:[{required:!0,message:i.value.select_cycle_warning,trigger:["submit","change"]}],until:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],monthDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}]})),k=_(()=>l.getters["event/getPeriods"]),T=_(()=>t.recurringUntil!==null?t.recurringUntil:k.value.length?at(k.value[0].startDate,"YYYY-MM-DD"):at());function y(E){return at(E)<=T.value}e({recurringFormRef:g});let b=F("amColors"),L=_(()=>({"--am-c-capei-recurr-text":b.value.colorMainText,"--am-c-capei-recurr-text-op03":W(b.value.colorMainText,.03),"--am-c-capei-recurr-inp-bgr-op03":W(b.value.colorInpBgr,.03),"--am-c-capei-recurr-bgr-op03":W(b.value.colorMainText,.03)}));return(E,C)=>{const h=xt,I=et;return u(),x("div",{class:"am-capei-recurr",style:be(a(L))},[d("div",Iw,[d("div",Ow,w(a(i).event_recurring_check),1),$(st,{modelValue:a(f).enabled,"onUpdate:modelValue":C[0]||(C[0]=O=>a(f).enabled=O),disabled:!a(k).length||!a(k)[0].startDate||!a(k)[0].endDate},null,8,["modelValue","disabled"])]),a(f).enabled&&a(k).length&&a(k)[0].startDate&&a(k)[0].endDate?(u(),q(I,{key:0,ref_key:"recurringFormRef",ref:g,rules:a(v),model:a(f),"label-position":"top",class:"am-capei-recurr__form"},{default:S(()=>[$(h,{label:`${a(i).repeat_every}`,class:R(["am-capei-recurr__form-item am-ws-150",a(s)])},{default:S(()=>[$(ht,{modelValue:a(f).cycleInterval,"onUpdate:modelValue":C[1]||(C[1]=O=>a(f).cycleInterval=O),min:1,disabled:a(t).recurringUntil!==null},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),$(h,{prop:"cycle",class:R(["am-capei-recurr__form-item am-inline-ws-150 am-align-end",a(s)])},{default:S(()=>[$(We,{modelValue:a(f).cycle,"onUpdate:modelValue":C[2]||(C[2]=O=>a(f).cycle=O),clearable:"",placeholder:a(i).select_repeat_period,disabled:a(t).recurringUntil!==null},{default:S(()=>[(u(!0),x(ee,null,pe(a(r),(O,A)=>(u(),q(Ve,{key:A,value:O.value,label:O.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["class"]),a(f).cycle==="monthly"?(u(),q(fl,{key:0,modelValue:a(f).monthlyRepeat,"onUpdate:modelValue":C[6]||(C[6]=O=>a(f).monthlyRepeat=O),class:"am-w-100",disabled:a(t).recurringUntil!==null},{default:S(()=>[$(h,{class:"am-capei-recurr__form-item"},{default:S(()=>[$(Oa,{label:"each",value:"each"},{default:S(()=>[ie(w(a(i).recurrence_each),1)]),_:1})]),_:1}),$(h,{prop:"monthDate",class:"am-capei-recurr__form-item"},{default:S(()=>[$(Ht,{modelValue:a(f).monthDate,"onUpdate:modelValue":C[3]||(C[3]=O=>a(f).monthDate=O),disabled:a(f).monthlyRepeat==="on"||a(t).recurringUntil!==null,format:a(Wt)(),lang:a(o)},null,8,["modelValue","disabled","format","lang"])]),_:1}),$(h,{prop:"on",class:"am-capei-recurr__form-item"},{default:S(()=>[$(Oa,{label:"on",value:"on"},{default:S(()=>[ie(w(a(i).recurrence_on),1)]),_:1})]),_:1}),$(h,{class:R(["am-capei-recurr__form-item am-w-50",a(s)])},{default:S(()=>[$(We,{modelValue:a(f).monthlyOnRepeat,"onUpdate:modelValue":C[4]||(C[4]=O=>a(f).monthlyOnRepeat=O),disabled:a(f).monthlyRepeat==="each"||a(t).recurringUntil!==null,placeholder:a(i).select_repeat_period},{default:S(()=>[(u(!0),x(ee,null,pe(a(c),(O,A)=>(u(),q(Ve,{key:A,value:O.value,label:O.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"]),$(h,{class:R(["am-capei-recurr__form-item am-w-50",a(s)])},{default:S(()=>[$(We,{modelValue:a(f).monthlyOnDay,"onUpdate:modelValue":C[5]||(C[5]=O=>a(f).monthlyOnDay=O),disabled:a(f).monthlyRepeat==="each",placeholder:a(i).select_repeat_period},{default:S(()=>[(u(!0),x(ee,null,pe(a(m),(O,A)=>(u(),q(Ve,{key:A,value:O.value,label:O.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"])]),_:1},8,["modelValue","disabled"])):N("",!0),$(h,{label:a(i).event_recurring_until,prop:"until",class:"am-capei-recurr__form-item"},{default:S(()=>[$(Ht,{modelValue:a(f).until,"onUpdate:modelValue":C[7]||(C[7]=O=>a(f).until=O),format:a(Wt)(),lang:a(o),"disabled-date":y},null,8,["modelValue","format","lang"])]),_:1},8,["label"])]),_:1},8,["rules","model"])):N("",!0)],4)}}};const Nw={class:"am-capei-price__heading"},Dw={key:0,class:"am-capei-price__segment"},Mw={key:0,class:"am-capei-price__block"},Bw={class:"am-capei-price__block-header"},Fw={class:"am-capei-price__block-header__text"},Vw={key:1,class:"am-capei-price__segment"},Rw={key:1,class:"am-capei-price__block"},qw={class:"am-capei-price__block-header"},Uw={class:"am-capei-price__block-header__text"},jw={key:0,class:"am-capei-price__block-heading am-pl-32 am-pr-44"},zw={class:"am-capei-price__block-heading__item am-custom-pricing am-w-40"},Yw={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},Ww={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},Hw={key:1,class:"am-separator am-order-6"},Zw=d("div",{class:"am-separator"},null,-1),Gw={class:"am-capei-price__part"},Jw=d("div",{class:"am-separator"},null,-1),Xw={class:"am-capei-price__block-header"},Qw={class:"am-capei-price__block-header__text"},Kw={key:1,class:"am-capei-price__block-segment"},eT={key:0,class:"am-capei-price__block-heading"},tT={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},aT={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},sT=d("div",{class:"am-separator"},null,-1),nT={key:2,class:"am-capei-price__block"},lT={class:"am-capei-price__block-header"},iT={class:"am-capei-price__block-header__text"},oT={key:0,class:"am-capei-price__part"},rT={key:3,class:"am-capei-price__block"},cT={class:"am-capei-price__block-header"},uT={class:"am-capei-price__block-header__text"},dT={key:0,class:"am-capei-price__part"},mT={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:e}){const t=n;let s=_(()=>tt(t.pageWidth)),l=Ie(),i=F("amLabels"),o=F("localLanguage"),r=F("licence"),c={components:{IconComponent:He},template:'<IconComponent icon="plus"/>'};function m(A){let D=ve(A),V=!1;if(h.value.customTicketsRanges.forEach(J=>{!V&&J.range[0]&&J.range[1]&&(V=ve(J.range[0])<=D&&ve(J.range[1])>=D)}),V)return!0;let z=l.getters["event/getBookingOpensDisabled"]?ve():ve(l.getters["event/getBookingOpensDate"]),B=l.getters["event/getBookingClosesDisabled"]?l.getters["event/getPeriods"][0].startDate?ve(l.getters["event/getPeriods"][0].startDate,"YYYY-MM-DD"):ve():ve(l.getters["event/getBookingClosesDate"]);return D<z||D>B}let g=_(()=>l.getters["event/getEvent"]),f=_(()=>h.value.customPricing?h.value.customTickets.reduce((A,D)=>A+D.spots,0)>1:h.value.maxCapacity>1),v=_(()=>h.value.customPricing?h.value.customTickets.reduce((A,D)=>A+D.spots,0):0),k=_(()=>h.value.customPricing&&h.value.maxCustomCapacityEnabled?h.value.maxCustomCapacity:h.value.customPricing?v.value:h.value.maxCapacity);function T(){h.value.customPricing&&h.value.customTickets.length===0&&b()}function y(A){h.value.customTickets.splice(A,1)}function b(){h.value.customTickets.push({enabled:!0,name:"",spots:1,waitingListSpots:0,price:0}),h.value.customTicketsRanges.forEach(A=>{A.tickets.push(new Object({price:0}))})}function L(A){h.value.customTicketsRanges.splice(A,1)}function E(){h.value.customTicketsRanges.push({range:["",""],tickets:h.value.customTickets.map(A=>new Object({price:A.price}))})}const C=M(null);let h=M({price:_({get:()=>l.getters["event/getPrice"],set:A=>{l.commit("event/setPrice",A)}}),maxCapacity:_({get:()=>l.getters["event/getMaxCapacity"],set:A=>{l.commit("event/setMaxCapacity",A)}}),bringingAnyone:_({get:()=>l.getters["event/getBringingAnyone"],set:A=>{l.commit("event/setBringingAnyone",A)}}),aggregatedPrice:_({get:()=>l.getters["event/getAggregatedPrice"],set:A=>{l.commit("event/setAggregatedPrice",A)}}),bookMultipleTimes:_({get:()=>l.getters["event/getBookMultipleTimes"],set:A=>{l.commit("event/setBookMultipleTimes",A)}}),depositEnabled:_({get:()=>l.getters["event/getDepositEnabled"],set:A=>{l.commit("event/setDepositEnabled",A)}}),deposit:_({get:()=>l.getters["event/getDeposit"],set:A=>{l.commit("event/setDeposit",A)}}),depositPayment:_({get:()=>l.getters["event/getDepositPayment"],set:A=>{l.commit("event/setDepositPayment",A)}}),depositPerPerson:_({get:()=>l.getters["event/getDepositPerPerson"],set:A=>{l.commit("event/setDepositPerPerson",A)}}),fullPayment:_({get:()=>l.getters["event/getFullPayment"],set:A=>{l.commit("event/setFullPayment",A)}}),customPricing:_({get:()=>l.getters["event/getCustomPricing"],set:A=>{l.commit("event/setCustomPricing",A)}}),customTickets:_({get:()=>l.getters["event/getCustomTickets"],set:A=>{l.commit("event/setCustomTickets",A)}}),customTicketsRangesEnabled:_({get:()=>l.getters["event/getCustomTicketsRangesEnabled"],set:A=>{l.commit("event/setCustomTicketsRangesEnabled",A)}}),customTicketsRanges:_({get:()=>l.getters["event/getCustomTicketsRanges"],set:A=>{l.commit("event/setCustomTicketsRanges",A)}}),maxCustomCapacityEnabled:_({get:()=>l.getters["event/getMaxCustomCapacityEnabled"],set:A=>{l.commit("event/setMaxCustomCapacityEnabled",A)}}),maxCustomCapacity:_({get:()=>l.getters["event/getMaxCustomCapacity"],set:A=>{l.commit("event/setMaxCustomCapacity",A)}}),closeAfterMinEnabled:_({get:()=>l.getters["event/getCloseAfterMinEnabled"],set:A=>{l.commit("event/setCloseAfterMinEnabled",A)}}),closeAfterMin:_({get:()=>l.getters["event/getCloseAfterMin"],set:A=>{l.commit("event/setCloseAfterMin",A)}}),closeAfterMinBookings:_({get:()=>l.getters["event/getCloseAfterMinBookings"],set:A=>{l.commit("event/setCloseAfterMinBookings",A)}}),maxExtraPeopleEnabled:_({get:()=>l.getters["event/getMaxExtraPeopleEnabled"],set:A=>{l.commit("event/setMaxExtraPeopleEnabled",A)}}),maxExtraPeople:_({get:()=>l.getters["event/getMaxExtraPeople"],set:A=>{l.commit("event/setMaxExtraPeople",A)}})});e({pricingFormRef:C});let I=F("amColors"),O=_(()=>({"--am-c-capei-price-text":I.value.colorMainText,"--am-c-capei-price-text-op03":W(I.value.colorMainText,.03),"--am-c-capei-price-inp-bgr-op03":W(I.value.colorInpBgr,.03)}));return(A,D)=>{const V=xt,z=et;return u(),q(z,{ref_key:"pricingFormRef",ref:C,model:a(h),style:be(a(O)),class:"am-capei-price"},{default:S(()=>[d("div",Nw,[$(V,{label:`${a(i).price}:`,class:R(["am-capei-price__item am-w-50",a(s)])},{default:S(()=>[$(St,{modelValue:a(h).price,"onUpdate:modelValue":D[0]||(D[0]=B=>a(h).price=B),disabled:a(h).customPricing,"is-money":!0},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),$(V,{label:`${a(i).event_max_capacity}:`,class:R(["am-capei-price__item am-w-50",a(s)])},{default:S(()=>[$(ht,{modelValue:a(h).maxCapacity,"onUpdate:modelValue":D[1]||(D[1]=B=>a(h).maxCapacity=B),disabled:a(h).customPricing,min:1},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),a(f)?(u(),x("div",Dw,[$(ft,{modelValue:a(h).bringingAnyone,"onUpdate:modelValue":D[2]||(D[2]=B=>a(h).bringingAnyone=B),label:a(i).event_bringing_anyone},null,8,["modelValue","label"]),a(h).bringingAnyone?(u(),q(ft,{key:0,modelValue:a(h).aggregatedPrice,"onUpdate:modelValue":D[3]||(D[3]=B=>a(h).aggregatedPrice=B),label:a(i).event_aggregated_price},null,8,["modelValue","label"])):N("",!0),$(ft,{modelValue:a(h).bookMultipleTimes,"onUpdate:modelValue":D[4]||(D[4]=B=>a(h).bookMultipleTimes=B),label:a(i).event_book_more_than_once},null,8,["modelValue","label"])])):N("",!0)]),a(r).isStarter?N("",!0):(u(),x("div",Mw,[d("div",Bw,[d("div",Fw,w(a(i).deposit_enabled),1),$(st,{modelValue:a(h).depositEnabled,"onUpdate:modelValue":D[5]||(D[5]=B=>a(h).depositEnabled=B)},null,8,["modelValue"])]),a(h).depositEnabled?(u(),x(ee,{key:0},[$(V,{label:`${a(i).deposit_payment}:`,class:R(["am-capei-price__item am-w-50",a(s)])},{default:S(()=>[$(We,{modelValue:a(h).depositPayment,"onUpdate:modelValue":D[6]||(D[6]=B=>a(h).depositPayment=B)},{default:S(()=>[$(Ve,{value:"percentage",label:a(i).amount_percentage},null,8,["label"]),$(Ve,{value:"fixed",label:a(i).amount_fixed},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label","class"]),a(h).depositPayment==="fixed"?(u(),q(V,{key:0,label:`${a(i).amount} (${a(Wu)()}):`,class:R(["am-capei-price__item am-w-50",a(s)])},{default:S(()=>[$(St,{modelValue:a(h).deposit,"onUpdate:modelValue":D[7]||(D[7]=B=>a(h).deposit=B),"is-money":!0},null,8,["modelValue"])]),_:1},8,["label","class"])):N("",!0),a(h).depositPayment==="percentage"?(u(),q(V,{key:1,label:`${a(i).amount} (%):`,class:R(["am-capei-price__item am-w-50",a(s)])},{default:S(()=>[$(ht,{modelValue:a(h).deposit,"onUpdate:modelValue":D[8]||(D[8]=B=>a(h).deposit=B),min:1,max:100},null,8,["modelValue"])]),_:1},8,["label","class"])):N("",!0)],64)):N("",!0),a(h).depositEnabled?(u(),x("div",Vw,[$(ft,{modelValue:a(h).depositPerPerson,"onUpdate:modelValue":D[9]||(D[9]=B=>a(h).depositPerPerson=B),label:a(i).deposit_per_person},null,8,["modelValue","label"]),$(ft,{modelValue:a(h).fullPayment,"onUpdate:modelValue":D[10]||(D[10]=B=>a(h).fullPayment=B),label:a(i).allow_total_event_amount},null,8,["modelValue","label"])])):N("",!0)])),a(r).isStarter?N("",!0):(u(),x("div",Rw,[d("div",qw,[d("div",Uw,w(a(i).custom_pricing_enabled),1),$(st,{modelValue:a(h).customPricing,"onUpdate:modelValue":D[11]||(D[11]=B=>a(h).customPricing=B),disabled:a(g).bookings&&a(g).bookings.length>0,onChange:T},null,8,["modelValue","disabled"])]),a(h).customPricing?(u(),x(ee,{key:0},[t.pageWidth>545?(u(),x("div",jw,[d("div",zw,w(a(i).name)+": ",1),d("div",Yw,w(a(i).price)+": ",1),d("div",Ww,w(a(i).spots)+": ",1)])):N("",!0),(u(!0),x(ee,null,pe(a(h).customTickets,(B,J)=>(u(),x("div",{key:J,class:"am-capei-price__block-segment am-custom-76"},[d("div",{class:R(["am-capei-price__block-inner am-ws-16",{"am-mt-22":t.pageWidth<546}])},[$(V,null,{default:S(()=>[$(ft,{modelValue:B.enabled,"onUpdate:modelValue":G=>B.enabled=G},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)],2),d("div",{class:R(["am-capei-price__block-inner",[{"am-we-40":t.pageWidth>545},{"am-we-100":t.pageWidth<546}]])},[$(V,{label:t.pageWidth<546?`${a(i).name}:`:""},{default:S(()=>[$(St,{modelValue:B.name,"onUpdate:modelValue":G=>B.name=G,disabled:!B.enabled},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])],2),d("div",{class:R(["am-capei-price__block-inner",[{"am-we-30":t.pageWidth>545},{"am-w-50 am-order-2":t.pageWidth<546},{"am-w-100":t.pageWidth<401}]])},[$(V,{label:t.pageWidth<546?a(i).price:""},{default:S(()=>[$(St,{modelValue:B.price,"onUpdate:modelValue":G=>B.price=G,disabled:!B.enabled,"is-money":!0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])],2),d("div",{class:R(["am-capei-price__block-inner",[{"am-we-30":t.pageWidth>545},{"am-w-50 am-order-3":t.pageWidth<546},{"am-w-100":t.pageWidth<401}]])},[$(V,{label:t.pageWidth<546?`${a(i).spots}:`:""},{default:S(()=>[$(ht,{modelValue:B.spots,"onUpdate:modelValue":G=>B.spots=G,min:1,disabled:!B.enabled||a(h).maxCustomCapacityEnabled},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])],2),!B.booked&&a(h).customTickets.length>1?(u(),x("div",{key:0,class:R(["am-capei-price__block-delete",{"am-order-1 am-mt-22":t.pageWidth<546}])},[$(ke,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:He},template:"<IconComponent icon='bucket'/>"},onClick:G=>y(J)},null,8,["icon","onClick"])],2)):N("",!0),t.pageWidth<546?(u(),x("div",Hw)):N("",!0)]))),128)),$(ke,{icon:a(c),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:b},{default:S(()=>[ie(w(a(i).add_ticket_category),1)]),_:1},8,["icon"]),Zw,d("div",Gw,[d("div",{class:R(["am-capei-price__part-item",[{"am-w-100":t.pageWidth<546},{"am-w-50":t.pageWidth>545}]])},[$(ft,{modelValue:a(h).maxCustomCapacityEnabled,"onUpdate:modelValue":D[12]||(D[12]=B=>a(h).maxCustomCapacityEnabled=B),label:`${a(i).event_max_capacity}:`},null,8,["modelValue","label"])],2),d("div",{class:R(["am-capei-price__part-item",[{"am-w-100":t.pageWidth<546},{"am-w-50":t.pageWidth>545}]])},[$(ht,{modelValue:a(h).maxCustomCapacity,"onUpdate:modelValue":D[13]||(D[13]=B=>a(h).maxCustomCapacity=B),min:1,disabled:!a(h).maxCustomCapacityEnabled},null,8,["modelValue","disabled"])],2)]),Jw,d("div",Xw,[d("div",Qw,w(a(i).pricing_by_date_enabled),1),$(st,{modelValue:a(h).customTicketsRangesEnabled,"onUpdate:modelValue":D[14]||(D[14]=B=>a(h).customTicketsRangesEnabled=B)},null,8,["modelValue"])]),a(h).customTicketsRangesEnabled?(u(),x("div",Kw,[(u(!0),x(ee,null,pe(a(h).customTicketsRanges,(B,J)=>(u(),x(ee,{key:J},[$(V,{label:`${a(i).event_date_range}:`,class:"am-capei-price__date-range"},{default:S(()=>[$(Ht,{modelValue:B.range,"onUpdate:modelValue":G=>B.range=G,type:"daterange",format:a(Wt)(),placeholder:"Pick a day",lang:a(o),"disabled-date":m},null,8,["modelValue","onUpdate:modelValue","format","lang"]),$(ke,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:He},template:"<IconComponent icon='bucket'/>"},onClick:G=>L(J)},null,8,["icon","onClick"])]),_:2},1032,["label"]),t.pageWidth>545?(u(),x("div",eT,[d("div",tT,w(a(i).name)+": ",1),d("div",aT,w(a(i).price)+": ",1)])):N("",!0),(u(!0),x(ee,null,pe(a(h).customTickets,(G,X)=>(u(),x(ee,{key:X},[d("div",{class:R(["am-capei-price__block-inner",[{"am-w-50":t.pageWidth>545},{"am-w-100":t.pageWidth<546}]])},[$(V,{label:t.pageWidth<546?`${a(i).name}:`:""},{default:S(()=>[$(St,{modelValue:G.name,"onUpdate:modelValue":K=>G.name=K,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])],2),d("div",{class:R(["am-capei-price__block-inner",[{"am-w-50":t.pageWidth>545},{"am-w-100":t.pageWidth<546}]])},[$(V,{label:t.pageWidth<546?`${a(i).price}:`:""},{default:S(()=>[$(St,{modelValue:B.tickets[X].price,"onUpdate:modelValue":K=>B.tickets[X].price=K,"is-money":!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])],2)],64))),128)),sT],64))),128)),$(ke,{icon:a(c),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:E},{default:S(()=>[ie(w(a(i).event_add_date_range),1)]),_:1},8,["icon"])])):N("",!0)],64)):N("",!0)])),a(h).maxCapacity>1||a(h).maxCustomCapacity>1||a(v)>1?(u(),x("div",nT,[d("div",lT,[d("div",iT,w(a(i).event_close_after_min),1),$(st,{modelValue:a(h).closeAfterMinEnabled,"onUpdate:modelValue":D[15]||(D[15]=B=>a(h).closeAfterMinEnabled=B)},null,8,["modelValue"])]),a(h).closeAfterMinEnabled&&(a(h).maxCapacity>1||a(h).maxCustomCapacity>1||a(v)>1)?(u(),x("div",oT,[$(fl,{modelValue:a(h).closeAfterMinBookings,"onUpdate:modelValue":D[16]||(D[16]=B=>a(h).closeAfterMinBookings=B),class:R(["am-capei-price__part-item",[{"am-w-100":t.pageWidth<546},{"am-w-50":t.pageWidth>545}]])},{default:S(()=>[$(Oa,{label:"off"},{default:S(()=>[ie(w(a(i).event_close_min_total),1)]),_:1}),$(Oa,{label:"on"},{default:S(()=>[ie(w(a(i).event_close_min_bookings),1)]),_:1})]),_:1},8,["modelValue","class"]),$(V,{class:R(["am-capei-price__part-item",[{"am-w-100":t.pageWidth<546},{"am-w-50":t.pageWidth>545}]])},{default:S(()=>[$(ht,{modelValue:a(h).closeAfterMin,"onUpdate:modelValue":D[17]||(D[17]=B=>a(h).closeAfterMin=B),min:1,max:a(k)},null,8,["modelValue","max"])]),_:1},8,["class"])])):N("",!0)])):N("",!0),a(h).maxCapacity>1||a(h).maxCustomCapacity>1||a(v)>1?(u(),x("div",rT,[d("div",cT,[d("div",uT,w(a(i).limit_extra_people),1),$(st,{modelValue:a(h).maxExtraPeopleEnabled,"onUpdate:modelValue":D[18]||(D[18]=B=>a(h).maxExtraPeopleEnabled=B)},null,8,["modelValue"])]),a(h).maxExtraPeopleEnabled&&(a(h).maxCapacity>1||a(h).maxCustomCapacity>1||a(v)>1)?(u(),x("div",dT,[$(V,{label:`${a(i).limit_extra_people_set}:`,class:"am-capei-price__part-item am-w-100"},{default:S(()=>[$(ht,{modelValue:a(h).maxExtraPeople,"onUpdate:modelValue":D[19]||(D[19]=B=>a(h).maxExtraPeople=B),min:0,max:a(k)-1},null,8,["modelValue","max"])]),_:1},8,["label"])])):N("",!0)])):N("",!0)]),_:1},8,["model","style"])}}};const pT={class:"am-capei-custef__heading"},gT={class:"am-capei-custef__colors"},fT=["onClick"],hT={key:0,class:"am-icon-check"},vT={setup(n){let e=Ie(),t=F("amLabels");const s=M(null);let l=M(1),i=M(["#1788FB","#4BBEC6","#FBC22D","#FA3C52","#D696B8","#689BCA","#26CC2B","#FD7E35","#E38587","#774DFB"]),o=M({color:_({get:()=>e.getters["event/getColor"],set:r=>{e.commit("event/setColor",r)}}),show:_({get:()=>e.getters["event/getShow"],set:r=>{e.commit("event/setShow",r)}})});return Je(()=>{let r=e.getters["event/getColor"];i.value.filter(m=>m===r).length>0?l.value=1:l.value=2}),(r,c)=>{const m=xt,g=Hu,f=et;return u(),q(f,{ref_key:"customizeFormRef",ref:s,model:a(o),class:"am-capei-custef"},{default:S(()=>[d("div",pT,w(a(t).event_colors),1),$(fl,{modelValue:a(l),"onUpdate:modelValue":c[2]||(c[2]=v=>ye(l)?l.value=v:l=v)},{default:S(()=>[$(m,{class:"am-capei-custef__item"},{default:S(()=>[$(Oa,{label:1},{default:S(()=>[ie(w(a(t).event_colors_preset)+": ",1)]),_:1}),d("div",gT,[(u(!0),x(ee,null,pe(a(i),v=>(u(),x("div",{key:v,class:R(["am-capei-custef__colors-item",{"am-disabled":a(l)===2}]),onClick:k=>a(e).commit("event/setColor",v)},[d("div",{class:"am-capei-custef__colors-item__inner",style:be({backgroundColor:v})},[v===a(o).color?(u(),x("span",hT)):N("",!0)],4)],10,fT))),128))])]),_:1}),$(m,{class:"am-capei-custef__item"},{default:S(()=>[$(Oa,{label:2},{default:S(()=>[ie(w(a(t).event_colors_custom)+": ",1)]),_:1}),$(g,{modelValue:a(o).color,"onUpdate:modelValue":c[0]||(c[0]=v=>a(o).color=v),disabled:a(l)===1},null,8,["modelValue","disabled"])]),_:1}),$(m,{class:"am-capei-custef__item"},{default:S(()=>[$(ft,{modelValue:a(o).show,"onUpdate:modelValue":c[1]||(c[1]=v=>a(o).show=v),label:a(t).event_show_on_site},null,8,["modelValue","label"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])}}};const _T={class:"am-capei-waiting__header"},yT={class:"am-capei-waiting__header-text"},bT={class:"am-capei-waiting__header"},kT={class:"am-capei-waiting__header-text"},CT={props:{pageWidth:{type:Number,default:0},waitingListUntil:{type:Object,default:null}},setup(n,{expose:e}){const t=n;let s=_(()=>tt(t.pageWidth));const l=Ie();let i=F("amLabels"),o=M(null),r=M({enabled:_({get:()=>l.getters["event/getWaitingListEnabled"],set:k=>{l.commit("event/setWaitingListEnabled",k)}}),maxCapacity:_({get:()=>l.getters["event/getWaitingListMaxCapacity"],set:k=>{l.commit("event/setWaitingListMaxCapacity",k)}}),maxExtraPeopleEnabled:_({get:()=>l.getters["event/getWaitingListMaxExtraPeopleEnabled"],set:k=>{l.commit("event/setWaitingListMaxExtraPeopleEnabled",k)}}),maxExtraPeople:_({get:()=>l.getters["event/getWaitingListMaxExtraPeople"],set:k=>{l.commit("event/setWaitingListMaxExtraPeople",k)}})}),c=_(()=>l.getters["event/getCustomTickets"]),m=_(()=>l.getters["event/getCustomPricing"]),g=_(()=>l.getters["event/getMaxCustomCapacityEnabled"]);e({waitingListFormRef:o});let f=F("amColors"),v=_(()=>({"--am-c-capei-waiting-text":f.value.colorMainText,"--am-c-capei-waiting-text-op03":W(f.value.colorMainText,.03),"--am-c-capei-waiting-inp-bgr-op03":W(f.value.colorInpBgr,.03),"--am-c-capei-waiting-bgr-op05":W(f.value.colorPrimary,.05)}));return(k,T)=>{const y=xt,b=et;return u(),x("div",{class:"am-capei-waiting",style:be(a(v))},[d("div",_T,[d("div",yT,w(a(i).events_show_waiting_list_booking_full),1),$(st,{modelValue:a(r).enabled,"onUpdate:modelValue":T[0]||(T[0]=L=>a(r).enabled=L)},null,8,["modelValue"])]),a(r).enabled?(u(),q(b,{key:0,ref_key:"waitingListFormRef",ref:o,model:a(r),"label-position":"top"},{default:S(()=>[!a(m)||a(g)?(u(),q(y,{key:0,label:`${a(i).maximum_capacity}`,class:R(["am-capei-waiting__item",a(s)])},{default:S(()=>[$(ht,{modelValue:a(r).maxCapacity,"onUpdate:modelValue":T[1]||(T[1]=L=>a(r).maxCapacity=L),min:1},null,8,["modelValue"])]),_:1},8,["label","class"])):N("",!0),a(m)?(u(!0),x(ee,{key:1},pe(a(c),(L,E)=>(u(),q(y,{key:E,label:L.name,class:R(["am-capei-waiting__item",a(s)])},{default:S(()=>[$(ht,{modelValue:L.waitingListSpots,"onUpdate:modelValue":C=>L.waitingListSpots=C,min:1,disabled:a(g)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128)):N("",!0),d("div",bT,[d("div",kT,w(a(i).limit_extra_people),1),$(st,{modelValue:a(r).maxExtraPeopleEnabled,"onUpdate:modelValue":T[2]||(T[2]=L=>a(r).maxExtraPeopleEnabled=L)},null,8,["modelValue"])]),a(r).maxExtraPeopleEnabled?(u(),q(y,{key:2,class:R(a(s))},{default:S(()=>[$(ht,{modelValue:a(r).maxExtraPeople,"onUpdate:modelValue":T[3]||(T[3]=L=>a(r).maxExtraPeople=L),min:0,disabled:!a(r).maxExtraPeopleEnabled},null,8,["modelValue","disabled"])]),_:1},8,["class"])):N("",!0)]),_:1},8,["model"])):N("",!0)],4)}}};const xT={class:"am-capei-sef__header"},wT=d("span",{class:"am-icon-options"},null,-1),TT={class:"am-capei-sef__header-text"},ST={class:"am-capei-sef__content"},ET=["innerHTML"],LT=["innerHTML"],AT={class:"am-capei-sef__header"},$T=d("span",{class:"am-icon-payments"},null,-1),IT={class:"am-capei-sef__header-text"},OT={class:"am-capei-sef__content"},PT={class:"am-capei-sef__segment"},NT={key:0,class:"am-capei-sef__heading"},DT={class:"am-capei-sef__heading-text"},MT=["innerHTML"],BT=["innerHTML"],FT={key:0,class:"am-capei-sef__heading"},VT={class:"am-capei-sef__heading-text"},RT={class:"am-capei-sef__segment"},qT={key:0,class:"am-capei-sef__heading"},UT={class:"am-capei-sef__heading-text"},jT={key:1,class:"am-capei-sef__heading"},zT=["src"],YT={key:2,class:"am-capei-sef__heading"},WT=["src"],HT={key:3,class:"am-capei-sef__heading"},ZT=["src"],GT={key:4,class:"am-capei-sef__heading"},JT=["src"],XT={key:5,class:"am-capei-sef__heading"},QT=["src"],KT={class:"am-capei-sef__header"},e8=d("span",{class:"am-icon-options"},null,-1),t8={class:"am-capei-sef__header-text"},a8={key:0,class:"am-capei-sef__heading"},s8={class:"am-capei-sef__heading-text"},n8={key:1,class:"am-capei-sef__heading"},l8={class:"am-capei-sef__heading-text"},i8={key:2,class:"am-capei-sef__heading"},o8={class:"am-capei-sef__heading-text"},r8={setup(n){let e=Ie(),t=F("licence"),s=F("amLabels");const l=F("settings"),i=F("baseUrls");let o=M([{label:s.value.disabled,value:0},{label:s.value.min10,value:600},{label:s.value.min12,value:720},{label:s.value.min15,value:900},{label:s.value.min30,value:1800},{label:s.value.min45,value:2700},{label:s.value.h1,value:3600},{label:s.value.h1min30,value:5400},{label:s.value.h2,value:7200},{label:s.value.h3,value:10800},{label:s.value.h4,value:14400},{label:s.value.h6,value:21600},{label:s.value.h8,value:28800},{label:s.value.h9,value:32400},{label:s.value.h10,value:36e3},{label:s.value.h11,value:39600},{label:s.value.h12,value:43200},{label:s.value.day1,value:86400},{label:s.value.days2,value:172800},{label:s.value.days3,value:259200},{label:s.value.days4,value:345600},{label:s.value.days5,value:432e3},{label:s.value.days6,value:518400},{label:s.value.week1,value:604800},{label:s.value.weeks2,value:1209600},{label:s.value.weeks3,value:1814400},{label:s.value.weeks4,value:2419200},{label:s.value.months3,value:7884e3},{label:s.value.months6,value:15768e3}]),r=M([]),c=M(!1),m=M(0),g=M(null),f=_(()=>{if(r.value.length){let h=r.value.find(I=>I.id===l.payments.wc.productId);return typeof h<"u"?h.name:s.value.select}return""});function v(){l.payments.wc.enabled&&k({id:L.value.paymentsWcProductId},h=>{r.value=h.length?h:[]})}function k(h,I){clearTimeout(g.value),c.value=!0,m.value++,g.value=setTimeout(()=>{let O=m.value;Pe.get("/payment/wc/products",{params:h}).then(A=>{O>=m.value&&I(A.data.data.products.sort((D,V)=>D.name.toLowerCase()>V.name.toLowerCase()?1:-1))}).finally(()=>{c.value=!1})},500)}function T(h){h&&k({name:h},I=>{r.value=I})}let y=M("");const b=M(null);let L=M({generalMinimumTimeRequirementPriorToCanceling:_({get:()=>e.getters["event/getSettingsGeneralMinimumTimeRequirementPriorToCanceling"],set:h=>{e.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",h)}}),generalRedirectUrlAfterAppointment:_({get:()=>e.getters["event/getSettingsGeneralRedirectUrlAfterAppointment"],set:h=>{e.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",h)}}),paymentsPaymentLinksEnabled:_({get:()=>e.getters["event/getSettingsPaymentsPaymentLinksEnabled"],set:h=>{e.commit("event/setSettingsPaymentsPaymentLinksEnabled",h)}}),paymentsPaymentLinksRedirectUrl:_({get:()=>e.getters["event/getSettingsPaymentsPaymentLinksRedirectUrl"],set:h=>{e.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",h)}}),paymentsOnSite:_({get:()=>e.getters["event/getSettingsPaymentsOnSite"],set:h=>{e.commit("event/setSettingsPaymentsOnSite",h)}}),paymentsWcEnabled:_({get:()=>e.getters["event/getSettingsPaymentsWcEnabled"],set:h=>{e.commit("event/setSettingsPaymentsWcEnabled",h)}}),paymentsWcProductId:_({get:()=>e.getters["event/getSettingsPaymentsWcProductId"],set:h=>{e.commit("event/setSettingsPaymentsWcProductId",h)}}),paymentsStripeEnabled:_({get:()=>e.getters["event/getSettingsPaymentsStripeEnabled"],set:h=>{e.commit("event/setSettingsPaymentsStripeEnabled",h)}}),paymentsPayPalEnabled:_({get:()=>e.getters["event/getSettingsPaymentsPayPalEnabled"],set:h=>{e.commit("event/setSettingsPaymentsPayPalEnabled",h)}}),paymentsMollieEnabled:_({get:()=>e.getters["event/getSettingsPaymentsMollieEnabled"],set:h=>{e.commit("event/setSettingsPaymentsMollieEnabled",h)}}),paymentsRazorpayEnabled:_({get:()=>e.getters["event/getSettingsPaymentsRazorpayEnabled"],set:h=>{e.commit("event/setSettingsPaymentsRazorpayEnabled",h)}}),paymentsSquareEnabled:_({get:()=>e.getters["event/getSettingsPaymentsSquareEnabled"],set:h=>{e.commit("event/setSettingsPaymentsSquareEnabled",h)}}),integrationsGoogleMeetEnabled:_({get:()=>e.getters["event/getSettingsIntegrationsGoogleMeetEnabled"],set:h=>{e.commit("event/setSettingsIntegrationsGoogleMeetEnabled",h)}}),integrationsMicrosoftTeamsEnabled:_({get:()=>e.getters["event/getSettingsIntegrationsMicrosoftTeamsEnabled"],set:h=>{e.commit("event/setSettingsIntegrationsMicrosoftTeamsEnabled",h)}}),integrationsLessonSpaceEnabled:_({get:()=>e.getters["event/getSettingsIntegrationsLessonSpaceEnabled"],set:h=>{e.commit("event/setSettingsIntegrationsLessonSpaceEnabled",h)}})});Je(()=>{L.value.generalMinimumTimeRequirementPriorToCanceling===l.general.minimumTimeRequirementPriorToCanceling&&e.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",""),L.value.generalRedirectUrlAfterAppointment===l.general.redirectUrlAfterAppointment&&e.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",""),L.value.paymentsPaymentLinksRedirectUrl===l.payments.paymentLinks.redirectUrl&&e.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",""),v()});let E=F("amColors"),C=_(()=>({"--am-c-capei-sef-primary":E.value.colorPrimary,"--am-c-capei-sef-text":E.value.colorMainText,"--am-c-capei-sef-text-op03":W(E.value.colorMainText,.03),"--am-c-capei-sef-bgr":E.value.colorMainBgr}));return(h,I)=>{const O=gl,A=xt,D=Is,V=Os,z=et;return u(),q(z,{ref_key:"settingsFormRef",ref:b,model:a(L),class:"am-capei-sef",style:be(a(C))},{default:S(()=>[$(V,{modelValue:a(y),"onUpdate:modelValue":I[15]||(I[15]=B=>ye(y)?y.value=B:y=B),accordion:"",class:"am-capei-sef__collapse"},{default:S(()=>[$(D,{name:"general",class:"am-capei-sef__collapse-item"},{title:S(()=>[d("div",xT,[wT,d("div",TT,w(a(s).general),1)])]),default:S(()=>[d("div",ST,[$(A,null,{label:S(()=>[ie(w(a(s).minimum_time_before_canceling)+" ",1),$(O,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(s).minimum_time_before_canceling_tooltip},null,8,ET)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:S(()=>[$(We,{modelValue:a(L).generalMinimumTimeRequirementPriorToCanceling,"onUpdate:modelValue":I[0]||(I[0]=B=>a(L).generalMinimumTimeRequirementPriorToCanceling=B),placeholder:a(o).find(B=>B.value===a(l).general.minimumTimeRequirementPriorToCanceling).label,clearable:""},{default:S(()=>[(u(!0),x(ee,null,pe(a(o),(B,J)=>(u(),q(Ve,{key:J,value:B.value,label:B.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),$(A,null,{label:S(()=>[ie(w(a(s).redirect_url_after_appointment)+" ",1),$(O,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(s).redirect_url_after_appointment_tooltip},null,8,LT)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:S(()=>[$(St,{modelValue:a(L).generalRedirectUrlAfterAppointment,"onUpdate:modelValue":I[1]||(I[1]=B=>a(L).generalRedirectUrlAfterAppointment=B),placeholder:a(l).general.redirectUrlAfterAppointment},null,8,["modelValue","placeholder"])]),_:1})])]),_:1}),$(D,{name:"payment",class:"am-capei-sef__collapse-item"},{title:S(()=>[d("div",AT,[$T,d("div",IT,w(a(s).payments),1)])]),default:S(()=>[d("div",OT,[d("div",PT,[a(t).isStarter?N("",!0):(u(),x("div",NT,[d("div",DT,[ie(w(a(s).payment_links_enable)+" ",1),$(O,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(s).payment_links_enable_tooltip},null,8,MT)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),$(st,{modelValue:a(L).paymentsPaymentLinksEnabled,"onUpdate:modelValue":I[2]||(I[2]=B=>a(L).paymentsPaymentLinksEnabled=B)},null,8,["modelValue"])])),a(L).paymentsPaymentLinksEnabled&&!a(t).isStarter?(u(),q(A,{key:1,label:a(s).redirect_url_after_appointment},{label:S(()=>[ie(w(a(s).redirect_url_after_appointment)+" ",1),$(O,{effect:"dark",placement:"top"},{content:S(()=>[d("div",{innerHTML:a(t).isPro||a(t).isDeveloper?a(s).redirect_url_after_app_or_package_tt:a(s).redirect_url_after_appointment_tooltip},null,8,BT)]),default:S(()=>[$(He,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:S(()=>[$(St,{modelValue:a(L).paymentsPaymentLinksRedirectUrl,"onUpdate:modelValue":I[3]||(I[3]=B=>a(L).paymentsPaymentLinksRedirectUrl=B),placeholder:a(l).payments.paymentLinks.redirectUrl},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0)]),a(l).payments.onSite?(u(),x("div",FT,[d("div",VT,w(a(s).on_site),1),$(st,{modelValue:a(L).paymentsOnSite,"onUpdate:modelValue":I[4]||(I[4]=B=>a(L).paymentsOnSite=B)},null,8,["modelValue"])])):N("",!0),d("div",RT,[a(l).payments.wc.enabled?(u(),x("div",qT,[d("div",UT,w(a(s).wc_service),1),$(st,{modelValue:a(L).paymentsWcEnabled,"onUpdate:modelValue":I[5]||(I[5]=B=>a(L).paymentsWcEnabled=B)},null,8,["modelValue"])])):N("",!0),a(L).paymentsWcEnabled?(u(),q(A,{key:1},{default:S(()=>[$(We,{modelValue:a(L).paymentsWcProductId,"onUpdate:modelValue":I[6]||(I[6]=B=>a(L).paymentsWcProductId=B),clearable:"",filterable:"",remote:"",placeholder:a(f),loading:a(c),"remote-method":T},{default:S(()=>[(u(!0),x(ee,null,pe(a(r),(B,J)=>(u(),q(Ve,{key:J,value:B.id,label:B.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","loading"])]),_:1})):N("",!0)]),a(l).payments.payPal.enabled?(u(),x("div",jT,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/paypal-light.svg",alt:"PayPal"},null,8,zT),$(st,{modelValue:a(L).paymentsPayPalEnabled,"onUpdate:modelValue":I[7]||(I[7]=B=>a(L).paymentsPayPalEnabled=B)},null,8,["modelValue"])])):N("",!0),a(l).payments.stripe.enabled?(u(),x("div",YT,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/stripe.svg",alt:"Stripe"},null,8,WT),$(st,{modelValue:a(L).paymentsStripeEnabled,"onUpdate:modelValue":I[8]||(I[8]=B=>a(L).paymentsStripeEnabled=B)},null,8,["modelValue"])])):N("",!0),a(l).payments.mollie.enabled?(u(),x("div",HT,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/mollie.svg",alt:"Mollie"},null,8,ZT),$(st,{modelValue:a(L).paymentsMollieEnabled,"onUpdate:modelValue":I[9]||(I[9]=B=>a(L).paymentsMollieEnabled=B)},null,8,["modelValue"])])):N("",!0),a(l).payments.square.enabled?(u(),x("div",GT,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/square.svg",alt:"Square"},null,8,JT),$(st,{modelValue:a(L).paymentsSquareEnabled,"onUpdate:modelValue":I[10]||(I[10]=B=>a(L).paymentsSquareEnabled=B)},null,8,["modelValue"])])):N("",!0),a(l).payments.razorpay.enabled?(u(),x("div",XT,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/razorpay.svg",alt:"Razorpay"},null,8,QT),$(st,{modelValue:a(L).paymentsRazorpayEnabled,"onUpdate:modelValue":I[11]||(I[11]=B=>a(L).paymentsRazorpayEnabled=B)},null,8,["modelValue"])])):N("",!0)])]),_:1}),a(l).googleCalendar.enabled&&a(l).googleMeet.enabled||a(l).outlookCalendar.enabled&&a(l).microsoftTeams.enabled||a(l).lessonSpace.enabled?(u(),q(D,{key:0,name:"integrations",class:"am-capei-sef__collapse-item"},{title:S(()=>[d("div",KT,[e8,d("div",t8,w(a(s).integrations_settings),1)])]),default:S(()=>[a(l).googleCalendar.enabled&&a(l).googleMeet.enabled?(u(),x("div",a8,[d("div",s8,w(a(s).enable_google_meet),1),$(st,{modelValue:a(L).integrationsGoogleMeetEnabled,"onUpdate:modelValue":I[12]||(I[12]=B=>a(L).integrationsGoogleMeetEnabled=B)},null,8,["modelValue"])])):N("",!0),a(l).outlookCalendar.enabled&&a(l).microsoftTeams.enabled?(u(),x("div",n8,[d("div",l8,w(a(s).enable_microsoft_teams),1),$(st,{modelValue:a(L).integrationsMicrosoftTeamsEnabled,"onUpdate:modelValue":I[13]||(I[13]=B=>a(L).integrationsMicrosoftTeamsEnabled=B)},null,8,["modelValue"])])):N("",!0),a(l).lessonSpace.enabled?(u(),x("div",i8,[d("div",o8,w(a(s).lesson_space),1),$(st,{modelValue:a(L).integrationsLessonSpaceEnabled,"onUpdate:modelValue":I[14]||(I[14]=B=>a(L).integrationsLessonSpaceEnabled=B)},null,8,["modelValue"])])):N("",!0)]),_:1})):N("",!0)]),_:1},8,["modelValue"])]),_:1},8,["model","style"])}}};const c8={class:"am-capei__footer-actions"},u8={name:"CabinetEvent"},d8=Object.assign(u8,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["close","save","duplicate"],setup(n,{emit:e}){const t=n;let s=Ie(),l=F("amLabels");const i=F("settings");let o=F("licence");const r=M("details");let c=M(null),m=M(null),g=M(null),f=M(null),v=M(null),k=M(!0),T=M(!1),y=M(!1);function b(){e("duplicate",Object.assign(JSON.parse(JSON.stringify(s.getters["event/getEvent"])),{id:null,bookings:[]}))}function L(){let D=!0;c.value?.detailsFormRef.validate(V=>{V||(r.value="details",D=!1)}),D&&(m.value?.periodsFormRef.validate(V=>{V||(r.value="periods",D=!1)}),D&&(s.getters["event/getRecurringEnabled"]&&g.value?.recurringFormRef.validate(V=>{V||(r.value="recurring",D=!1)}),D&&h(V=>{V?y.value=!0:C()})))}function E(D){k.value=!0,Pe.post("/events"+(s.getters["event/getId"]?"/"+s.getters["event/getId"]:""),Object.assign(bw(s),{applyGlobally:D}),Object.assign(Ue(s),{params:{source:"cabinet-provider"}})).then(()=>{_w(s),I("save")}).catch(V=>{console.log(V)}).finally(()=>{k.value=!1})}function C(){v.value?(k.value=!1,y.value=!1,T.value=!0):E(!1)}function h(D){let V=s.getters["event/getOrganizerId"]?s.getters["employee/getEmployee"]:null;if(V&&(V.googleCalendar||V.outlookCalendar)){k.value=!0;let z=s.getters["event/getProviders"].map(B=>new Object({id:B.id}));Pe.post("/events/calendar",{providers:s.getters["event/getProviders"].map(B=>B.id).indexOf(V.id)===-1?z.concat([{id:V.id}]):z,periods:gu(s),eventIds:[s.getters["event/getId"],s.getters["event/getParentId"]],recurring:s.getters["event/getRecurring"]},Object.assign(Ue(s),{params:{source:"cabinet-provider"}})).then(()=>{D(!1)}).catch(()=>{D(!0),k.value=!1})}else D(!1)}function I(D){s.commit("event/setActive",!1),e(D)}Je(()=>{s.getters["event/getId"]&&s.getters["event/getRecurringUntil"]&&(v.value=at(s.getters["event/getRecurringUntil"].toISOString().split("T")[0])),s.commit("event/setActive",!0),k.value=!1});let O=F("amColors"),A=_(()=>({"--am-c-capei-text":O.value.colorMainText,"--am-c-capei-text-op10":W(O.value.colorMainText,.1),"--am-c-capei-primary":O.value.colorPrimary,"--am-c-cust-no1":O.value.colorMainText,"--am-c-cust-no1-bgr":W(O.value.colorMainText,.1),"--am-c-cust-no2":O.value.colorWarning,"--am-c-cust-no2-bgr":W(O.value.colorWarning,.1),"--am-c-cust-no3":O.value.colorError,"--am-c-cust-no3-bgr":W(O.value.colorError,.1),"--am-c-cust-link":W(O.value.colorMainText,.5),"--am-c-cust-text":O.value.colorMainText}));return(D,V)=>{const z=Xa,B=Qa;return u(),x(ee,null,[a(k)?(u(),q(Zt,{key:1})):(u(),x("div",{key:0,class:R(["am-capei",a(t).responsiveClass]),style:be(a(A))},[$(B,{modelValue:r.value,"onUpdate:modelValue":V[0]||(V[0]=J=>r.value=J),class:"am-ap__tabs"},{default:S(()=>[$(z,{label:a(l).details,name:"details"},{default:S(()=>[$(xw,{ref_key:"eventDetailsRef",ref:c},null,512)]),_:1},8,["label"]),$(z,{label:a(l).periods,name:"periods"},{default:S(()=>[$($w,{ref_key:"eventPeriodsRef",ref:m,"page-width":a(t).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),a(o).isStarter?N("",!0):(u(),q(z,{key:0,label:a(l).recurring,name:"recurring"},{default:S(()=>[$(Pw,{ref_key:"eventRecurringRef",ref:g,"page-width":a(t).pageWidth,"recurring-until":a(v)},null,8,["page-width","recurring-until"])]),_:1},8,["label"])),$(z,{label:a(l).pricing,name:"pricing"},{default:S(()=>[$(mT,{ref_key:"eventPricingRef",ref:f,"page-width":a(t).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),$(z,{label:a(l).customize,name:"customize"},{default:S(()=>[$(vT)]),_:1},8,["label"]),a(i).appointments.waitingListEvents.enabled&&!a(o).isStarter&&!a(o).isBasic?(u(),q(z,{key:1,label:a(l).waiting_list,name:"waitingList"},{default:S(()=>[$(CT,{"page-width":a(t).pageWidth},null,8,["page-width"])]),_:1},8,["label"])):N("",!0),$(z,{label:a(l).settings,name:"settings"},{default:S(()=>[$(r8)]),_:1},8,["label"])]),_:1},8,["modelValue"]),d("div",{class:R(["am-capei__footer",[{"am-capei__footer_new":!a(s).getters["event/getId"]},a(t).responsiveClass]])},[a(s).getters["event/getId"]?(u(),q(ke,{key:0,class:"am-capei__footer-duplicate","icon-only":!0,icon:"duplicate",type:"plain",category:"secondary",onClick:b})):N("",!0),d("div",c8,[$(ke,{category:"secondary",size:"default",type:"plain",onClick:V[1]||(V[1]=()=>{a(e)("close")})},{default:S(()=>[ie(w(a(l).cancel),1)]),_:1}),$(ke,{size:"default",onClick:L},{default:S(()=>[ie(w(a(l).save),1)]),_:1})])],2)],6)),$(Da,{visibility:a(T)&&a(v)!==null,title:a(l).confirm,description:a(l).confirm_save_following,"close-btn-text":a(l).save_single,"confirm-btn-text":a(l).update_following,"customized-options":{cancelBtn:{type:"plain"},confirmBtn:{type:""}},onDecline:V[2]||(V[2]=J=>E(!1)),onConfirm:V[3]||(V[3]=J=>E(!0)),onClose:V[4]||(V[4]=J=>ye(T)?T.value=!1:T=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),$(Da,{visibility:a(y),title:a(l).confirm,description:a(l).confirm_save_conflict,"close-btn-text":a(l).cancel,"confirm-btn-text":a(l).confirm,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:V[5]||(V[5]=J=>ye(y)?y.value=!1:y=!1),onConfirm:C,onClose:V[6]||(V[6]=J=>ye(y)?y.value=!1:y=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],64)}}});const m8={class:"am-cap__att"},p8={class:"am-cap-customers"},g8={class:"am-cap__cust-option"},f8={class:"am-cap__cust-option__heading"},h8={key:0,class:"am-cap__cust-option__inner"},v8={key:1,class:"am-cap__cust-option__inner"},_8={key:0,class:"am-cap-cust__data-wrapper"},y8={key:0,class:"am-cap-cust__data"},b8=d("span",{class:"am-icon-phone"},null,-1),k8=["href"],C8={key:1,class:"am-cap-cust__data"},x8=d("span",{class:"am-icon-email"},null,-1),w8=["href"],T8={class:"am-cap__att-heading"},S8={props:{event:{type:Object,default:()=>{}},isNew:{type:Boolean,default:!1},pageWidth:{type:Number,required:!0}},setup(n,{expose:e}){const t=n;let s=_(()=>tt(t.pageWidth)),l=Ie(),i=F("amLabels");const o=F("settings"),r=F("shortcodeData");let c=F("amCustomize"),m=_(()=>r.value.cabinetType==="employee"?c.value.events.options.customerPhone.visibility:!0),g=_(()=>r.value.cabinetType==="employee"?c.value.events.options.customerEmail.visibility:!0),f=M(null),v=M({customerId:_({get:()=>l.getters["attendee/getCustomerId"],set:z=>l.commit("attendee/setCustomerId",z)}),status:_({get:()=>l.getters["attendee/getStatus"],set:z=>l.commit("attendee/setStatus",z)}),persons:_({get:()=>l.getters["attendee/getPersons"],set:z=>l.commit("attendee/setPersons",z)}),tickets:_({get:()=>l.getters["attendee/getTickets"],set:z=>l.commit("attendee/setTickets",z)})}),k=M({customerId:[{required:!0,message:i.value.select_customer,trigger:["submit","change"]}]}),T=_(()=>t.event.settings?JSON.parse(t.event.settings):null),y=M(hu().filter(z=>z.value!=="canceled"&&(!o.appointments.waitingListEvents.enabled||(T.value?"waitingList"in T.value&&!T.value.waitingList.enabled:!0)?z.value!=="waiting":!0)&&z.value!=="no-show")),b=_(()=>l.getters["customerInfo/getLoading"]),L=_(()=>l.getters["customerInfo/getCustomers"]),E=_(()=>v.value.customerId?L.value.find(z=>z.id===v.value.customerId):null);function C(z){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),h.value=!0,Pe.get("/users/customers/"+z,Object.assign({params:{source:"cabinet-provider"}},Ue(l))).then(B=>{l.commit("customerInfo/setCustomer",uu(l,B.data.data.user))}).catch(B=>{console.log(B)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}let h=M(!1);function I(){l.dispatch("customerInfo/resetCustomer"),h.value=!0}function O(z){l.commit("customerInfo/setCustomers",[z]),l.commit("attendee/setCustomerId",z.id)}Je(()=>{l.getters["attendee/getId"]||l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),e({detailsFormRef:f});function A(z){if(z){if(z===1)return{class:"am-no-show-1",icon:"no-show-1"};if(z===2)return{class:"am-no-show-2",icon:"no-show-2"};if(z>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}let D=F("amColors"),V=_(()=>({"--am-c-cust-no1":D.value.colorMainText,"--am-c-cust-no1-bgr":W(D.value.colorMainText,.1),"--am-c-cust-no2":D.value.colorWarning,"--am-c-cust-no2-bgr":W(D.value.colorWarning,.1),"--am-c-cust-no3":D.value.colorError,"--am-c-cust-no3-bgr":W(D.value.colorError,.1),"--am-c-cust-text":D.value.colorMainText,"--am-c-cust-link":W(D.value.colorMainText,.5)}));return(z,B)=>{const J=xt,G=et;return u(),x("div",m8,[$(G,{ref_key:"detailsFormRef",ref:f,model:a(v),rules:a(k),class:"am-cap__att-form"},{default:S(()=>[d("div",p8,[t.isNew?(u(),q(J,{key:0,prop:"customerId",class:"am-cap__att-form__item am-w-100"},{default:S(()=>[$(We,{modelValue:a(v).customerId,"onUpdate:modelValue":B[0]||(B[0]=X=>a(v).customerId=X),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-inp-text)","popper-class":"am-cap-cust__popper",placeholder:a(i).event_attendees_search,"remote-method":X=>{a(pn)(a(l),X)},loading:a(b),onFocus:B[1]||(B[1]=X=>a(So)(a(l)))},{default:S(()=>[(u(!0),x(ee,null,pe(a(L),X=>(u(),q(Ve,{key:X.id,value:X.id,label:X.email?X.email:X.firstName+" "+X.lastName},{default:S(()=>[d("div",g8,[d("div",f8,w(X.firstName+" "+X.lastName),1),X.email&&a(g)?(u(),x("div",h8,w(X.email),1)):N("",!0),X.phone&&a(m)?(u(),x("div",v8,w(X.phone),1)):N("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})):N("",!0),!a(l).getters["attendee/getId"]&&a(o).roles.allowWriteCustomers?(u(),q(ke,{key:1,class:R(["am-capai-cuf__heading-add",t.responsiveClass]),size:"default",disabled:!!a(v).customerId,prefix:"plus",icon:"plus","icon-only":t.pageWidth<=420,onClick:I},{default:S(()=>[ie(w(a(i).new_customer),1)]),_:1},8,["class","disabled","icon-only"])):N("",!0)]),a(E)?(u(),x("div",{key:0,class:R(["am-cap-attendee",a(s)])},[d("div",{class:R(["am-cap-cust",a(s)]),style:be(a(V))},[d("div",{class:R(["am-cap-cust__name",A(0).class])},[A(0).icon?(u(),x("span",{key:0,class:R(`am-icon-${A(0).icon}`)},null,2)):N("",!0),ie(" "+w(a(E).firstName+" "+a(E).lastName),1)],2),a(E).phone&&a(m)||a(E).email&&a(g)?(u(),x("div",_8,[a(E).phone&&a(m)?(u(),x("div",y8,[b8,d("a",{href:`tel:${a(E).phone}`},w(a(E).phone),9,k8)])):N("",!0),a(E).email&&a(g)?(u(),x("div",C8,[x8,d("a",{href:`mailto:${a(E).email}`},w(a(E).email),9,w8)])):N("",!0)])):N("",!0)],6),$(J,{prop:"status",class:R(["am-cap__att-form__item",a(s)])},{default:S(()=>[$(We,{modelValue:a(v).status,"onUpdate:modelValue":B[2]||(B[2]=X=>a(v).status=X),disabled:!t.isNew,placeholder:a(i).select,"prefix-icon":a(y).find(X=>X.value===a(v).status).icon,"prefix-icon-color":a(y).find(X=>X.value===a(v).status).color,"popper-class":"am-capei-att__popper"},{default:S(()=>[(u(!0),x(ee,null,pe(a(y),X=>(u(),q(Ve,{key:X.value,value:X.value,label:X.label},{default:S(()=>[d("span",{class:R(`am-icon-${X.icon}`),style:be({color:X.color})},null,6),ie(" "+w(X.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder","prefix-icon","prefix-icon-color"])]),_:1},8,["class"]),a(o).roles.allowWriteCustomers?(u(),q(ka,{key:0,"have-delete":!1,"reference-class":a(s),onEdit:B[3]||(B[3]=X=>C(a(E).id))},null,8,["reference-class"])):N("",!0)],2)):N("",!0),a(E)?(u(),x(ee,{key:1},[t.event.customPricing?(u(),x(ee,{key:1},[d("div",T8,w(`${a(i).event_book_tickets}:`),1),(u(!0),x(ee,null,pe(a(v).tickets,(X,K)=>(u(),q(J,{key:K,label:t.event.customTickets.find(Q=>Q.id===X.eventTicketId).name,class:R(["am-cap__att-form__item",a(s)])},{default:S(()=>[$(ht,{modelValue:X.persons,"onUpdate:modelValue":Q=>X.persons=Q,min:0,disabled:!a(o).roles.allowWriteEvents},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128))],64)):(u(),q(J,{key:0,prop:"persons",label:`${a(i).event_book_persons}:`,class:R(["am-cap__att-form__item",a(s)])},{default:S(()=>[$(ht,{modelValue:a(v).persons,"onUpdate:modelValue":B[4]||(B[4]=X=>a(v).persons=X),min:1,disabled:!a(o).roles.allowWriteEvents},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]))],64)):N("",!0),a(E)?N("",!0):(u(),q(Na,{key:2,heading:a(i).no_attendees_yet},null,8,["heading"]))]),_:1},8,["model","rules"]),a(h)?(u(),q(mu,{key:0,visibility:a(h),"responsive-class":t.responsiveClass,"onUpdate:visibility":B[5]||(B[5]=X=>ye(h)?h.value=X:h=X),onAddedCustomer:O},null,8,["visibility","responsive-class"])):N("",!0)])}}};const E8={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:e}){const t=n;let s=Ie();const l=F("settings");let i=F("amLabels"),o=M(null),r=M({}),c=M({}),m=M({}),g=_(()=>s.getters["attendee/getCustomFields"]);function f(T,y){let b=s.getters["attendee/getId"];(T.type!=="file"||b)&&(r.value[y]=_({get:()=>{let L=s.getters["attendee/getCustomFields"][y]?.value;return L||""},set:L=>s.commit("attendee/setCustomFields",{id:y,value:L})}))}function v(T,y){let b=s.getters["attendee/getId"];(T.type!=="file"||b)&&(m.value[y]={template:Ye[T.type],props:{id:y,itemName:y.toString(),label:T.label,options:T.options,class:`am-capei-att-cf__item am-cf-width-${T.width}`}}),T.type==="text-area"&&(m.value[y].props={...m.value[y].props,itemType:"textarea"}),T.type==="file"&&b&&(m.value[y].props={...m.value[y].props,btnLabel:i.value.upload_file_here,isUpload:!1,bookingId:b}),T.type==="datepicker"&&(m.value[y].props={...m.value[y].props,weekStartsFromDay:l.wordpress.startOfWeek})}function k(T){let y=s.getters["attendee/getId"];(T.type!=="file"||y)&&(c.value[T.id]=[{message:i.value.required_field,required:T.required,trigger:["submit","change"]}])}return Je(()=>{r.value={},m.value={};for(let T in g.value)f(g.value[T],T),v(g.value[T],T),k(g.value[T])}),e({customFieldsFormRef:o}),(T,y)=>{const b=et;return u(),q(b,{ref_key:"customFieldsFormRef",ref:o,model:a(r),rules:a(c),"label-position":"top",class:R(["am-capei-att-cf__form",t.responsiveClass])},{default:S(()=>[(u(!0),x(ee,null,pe(Object.keys(a(g)),L=>(u(),x(ee,{key:L},[L in a(r)?(u(),q(Ct(a(m)[L].template),Nt({key:0,modelValue:a(r)[L],"onUpdate:modelValue":E=>a(r)[L]=E},a(m)[L].props),null,16,["modelValue","onUpdate:modelValue"])):N("",!0)],64))),128))]),_:1},8,["model","rules","class"])}}};const L8={class:"am-capai-pay__row-label"},A8={class:"am-capai-pay__row-value"},$8={class:"am-capai-pay__row-label"},I8={class:"am-capai-pay__row-value"},O8={class:"am-capai-pay__row-label"},P8={class:"am-capai-pay__row-value"},N8={key:0,class:"am-divider"},D8={class:"am-capai-pay__row-label"},M8={class:"am-capai-pay__row-label"},B8={class:"am-capai-pay__row-label"},F8={class:"am-capai-pay__row-label"},V8={class:"am-capai-pay__row-label"},R8={class:"am-capai-pay__row-label"},q8={class:"am-capai-pay__row-label"},U8={props:{event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},setup(n){const e=n;let t=Ie(),s=F("amLabels"),l=_(()=>t.getters["attendee/getPayments"]),i=_(()=>Object.assign(vu(t),{deposit:l.value[0].amount,paid:l.value.reduce((c,m)=>c+m.amount,0)})),o=F("amColors"),r=_(()=>({"--am-c-pay-text-op03":W(o.value.colorMainText,.03)}));return(c,m)=>(u(),x("div",{class:R(["am-capai-pay__content",e.responsiveClass]),style:be(a(r))},[(u(!0),x(ee,null,pe(a(l),(g,f)=>(u(),x(ee,{key:f},[d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",L8,w(a(s).date),1),d("div",A8,w(a(dt)(g.dateTime.split(" ")[0])),1)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",$8,w(a(s).payment_method),1),d("div",I8,w(a(pu)(g)),1)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",O8,w(a(s).status),1),d("div",P8,[d("span",{class:R(a(xs)(g.status,a(o)).icon),style:be({color:a(xs)(g.status,a(o)).color})},null,6),ie(" "+w(a(Hi)(g.status)),1)])],2)],64))),128)),e.pageWidth>480?(u(),x("div",N8)):N("",!0),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",D8,w(a(s).price),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).price)),3)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",M8,w(a(s).discount_amount),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).discount)),3)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",B8,w(a(s).tax),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).tax)),3)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",F8,w(a(s).paid_deposit),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).deposit)),3)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",V8,w(a(s).paid_remaining_amount),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).paid-a(i).deposit)),3)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",R8,w(a(s).due),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).paid-(a(i).price-a(i).discount+a(i).tax))),3)],2),d("div",{class:R(["am-capai-pay__row",e.responsiveClass])},[d("div",q8,w(a(s).total),1),d("div",{class:R(["am-capai-pay__row-value",{"am-pl-34":e.pageWidth>480}])},w(a(nt)(a(i).price-a(i).discount+a(i).tax)),3)],2)],6))}};const j8=d("span",{class:"am-icon-clearable"},null,-1),z8={class:"am-capei-atti__footer"},Y8={name:"CabinetEventAttendee"},_u=Object.assign(Y8,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},isNew:{type:Boolean,default:!1},event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},emits:["close","save"],setup(n,{emit:e}){const t=n;let s=Ie(),l=F("amLabels");const i=F("settings");let o=M(!1),r=_(()=>s.getters["attendee/getCustomFields"]);const c=M("details");let m=M(null),g=M(null),f=M(!1),v=M(null),k=M("");function T(){f.value=!1,k.value=""}let y=M(!1),b=M();Be("formWrapper",b);function L(){let D=vu(s);return D.price-D.discount+D.tax}function E(){let D=!0;if(g.value?.customFieldsFormRef.validate(B=>{B||(c.value="customFields",D=!1)}),m.value?.detailsFormRef.validate(B=>{B||(c.value="details",D=!1)}),!D)return;let V=i.payments.paymentLinks&&i.payments.paymentLinks.enabled,z=t.event.settings?JSON.parse(t.event.settings):null;z&&"payments"in z&&"paymentLinks"in z.payments&&(V=z.payments.paymentLinks.enabled),V&&s.getters["attendee/getId"]&&L()>h.value?y.value=!0:C(!1)}function C(D){o.value=!0,Pe.post(s.getters["attendee/getId"]?"/events/bookings/"+s.getters["attendee/getId"]:"/bookings",Object.assign(fu(s),{runInstantPostBookingActions:!0,createPaymentLinks:D}),Object.assign(Ue(s),{params:{source:"cabinet-provider"}})).then(()=>{e("save"),s.commit("attendee/setActive",!1)}).catch(V=>{console.log(V)}).finally(()=>{o.value=!1})}let h=M(0);function I(){s.commit("attendee/setActive",!1),e("close")}Je(()=>{s.commit("attendee/setActive",!0),s.getters["attendee/getId"]&&(h.value=L())});let O=F("amColors"),A=_(()=>({"--am-c-capai-text":O.value.colorMainText,"--am-c-capai-text-op10":W(O.value.colorMainText,.1),"--am-c-capai-primary":O.value.colorPrimary,"--am-c-cust-no1":O.value.colorMainText,"--am-c-cust-no1-bgr":W(O.value.colorMainText,.1),"--am-c-cust-no2":O.value.colorWarning,"--am-c-cust-no2-bgr":W(O.value.colorWarning,.1),"--am-c-cust-no3":O.value.colorError,"--am-c-cust-no3-bgr":W(O.value.colorError,.1),"--am-c-cust-link":W(O.value.colorMainText,.5),"--am-c-cust-text":O.value.colorMainText}));return(D,V)=>{const z=Xa,B=Qa;return a(o)?(u(),q(Zt,{key:1})):(u(),x("div",{key:0,class:R(["am-capei-atti",[{"am-no-border":!0},a(t).responsiveClass]]),style:be(a(A))},[a(f)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:v,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:T,onTriggerClose:T},{title:S(()=>[j8,ie(" "+w(a(k)),1)]),_:1},512)):N("",!0),$(B,{modelValue:c.value,"onUpdate:modelValue":V[0]||(V[0]=J=>c.value=J)},{default:S(()=>[$(z,{label:a(l).details,name:"details"},{default:S(()=>[$(a(S8),{ref_key:"attendeeDetailsRef",ref:m,event:a(t).event,"is-new":a(t).isNew,"page-width":a(t).pageWidth},null,8,["event","is-new","page-width"])]),_:1},8,["label"]),Object.keys(a(r)).length?(u(),q(z,{key:0,label:a(l).custom_fields,name:"customFields"},{default:S(()=>[$(a(E8),{ref_key:"attendeeCustomFieldsRef",ref:g,event:a(t).event},null,8,["event"])]),_:1},8,["label"])):N("",!0),a(s).getters["attendee/getId"]?(u(),q(z,{key:1,label:a(l).payment,name:"payment"},{default:S(()=>[$(a(U8),{event:a(t).event,"page-width":a(t).pageWidth},null,8,["event","page-width"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]),d("div",z8,[$(ke,{category:"secondary",size:"default",type:"plain",onClick:I},{default:S(()=>[ie(w(a(i).roles.allowWriteEvents?a(l).cancel:a(l).close),1)]),_:1}),a(i).roles.allowWriteEvents?(u(),q(ke,{key:0,size:"default",onClick:E},{default:S(()=>[ie(w(a(l).save),1)]),_:1})):N("",!0)]),$(Da,{visibility:a(y),title:a(l).confirm,description:a(l).price_changed_message,"close-btn-text":a(l).no,"confirm-btn-text":a(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:V[1]||(V[1]=J=>C(!1)),onConfirm:V[2]||(V[2]=J=>C(!0)),onClose:V[3]||(V[3]=J=>ye(y)?y.value=!1:y=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],6))}}});const W8=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),H8={key:1,class:"am-capei-att__top"},Z8={class:"am-capei-att__top-heading"},G8={class:"am-capei-att__top-text"},J8={key:0,class:"am-capei-att__top-places"},X8={class:"am-cap__cust-option"},Q8={class:"am-cap__cust-option__heading"},K8={key:0,class:"am-cap__cust-option__inner"},eS={key:1,class:"am-cap__cust-option__inner"},tS={key:0,class:"am-capei-att__card-wrapper"},aS={key:0,class:"am-capei-customer__data-wrapper"},sS={key:0,class:"am-capei-customer__data"},nS=d("span",{class:"am-icon-phone"},null,-1),lS=["href"],iS={key:1,class:"am-capei-customer__data"},oS=d("span",{class:"am-icon-email"},null,-1),rS=["href"],cS={key:0,class:"am-capei-att__card-tickets"},uS={class:"am-capei-att__card-label"},dS={class:"am-capei-att__card-tickets__inner"},mS={key:1,class:"am-capei-att__card-persons"},pS={class:"am-capei-att__card-label"},gS={class:"am-capei-att__card-person"},fS={key:0,class:"am-capei-att__card-wrapper"},hS={key:0,class:"am-capei-customer__data-wrapper"},vS={key:0,class:"am-capei-customer__data"},_S=d("span",{class:"am-icon-phone"},null,-1),yS=["href"],bS={key:1,class:"am-capei-customer__data"},kS=d("span",{class:"am-icon-email"},null,-1),CS=["href"],xS={key:0,class:"am-capei-att__card-tickets"},wS={class:"am-capei-att__card-label"},TS={class:"am-capei-att__card-tickets__inner"},SS={key:1,class:"am-capei-att__card-persons"},ES={class:"am-capei-att__card-label"},LS={class:"am-capei-att__card-person"},AS={name:"CabinetEventAttendees"},$S=Object.assign(AS,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},event:{type:Object,default:()=>{}}},emits:["close","openAttendee"],setup(n,{emit:e}){const t=n;let s=Ie(),l=F("amLabels");const i=F("settings"),o=F("shortcodeData");let r=F("amCustomize"),c=_(()=>o.value.cabinetType==="employee"?r.value.events.options.customerPhone.visibility:!0),m=_(()=>o.value.cabinetType==="employee"?r.value.events.options.customerEmail.visibility:!0),g=M(null),f=M(!1),v=M("success"),k=M("");function T(){f.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let y=M(!1),b=M(!1),L=M(!1),E=M([]),C=M(0),h=M(1),I=M(!1),O=M([]),A=M(0),D=M(1),V=_(()=>t.event.settings?JSON.parse(t.event.settings):null);const{noShowData:z}=F("noShowData");let B=M(!1),J=M(null),G=M(!1);function X(){J.value=null,B.value=!1}function K(Te,Me){J.value=Te,G.value=Me,B.value=!0}let Q=M(null);function le(){s.commit("attendee/setActive",!1),f.value=!0,k.value=l.value.event_attendee_saved,Q.value&&g.value&&setTimeout(function(){gt(Q.value,g.value.$el,0,300)},500),j($e.value==="approved"?["approved","canceled"]:["waiting"]),H()}function H(){y.value=!1,b.value=!1,e("openAttendee",!1)}function se(){s.commit("attendee/setAttendee",Es(s,s.getters["attendee/getDefaultAttendee"],t.event)),y.value=!0,e("openAttendee",!0)}function ge(Te){let Me=s.getters["customerInfo/getCustomers"],Ee=s.getters["customerInfo/getCustomersIds"];Me.filter(Xe=>Xe.id===Te.customer.id).length===0&&(Me.push(Te.customer),s.commit("customerInfo/setCustomers",Me)),Ee.indexOf(Te.customer.id)===-1&&(Ee.push(Te.customer.id),s.commit("customerInfo/setCustomersIds",Ee)),s.commit("attendee/setAttendee",Es(s,Te,t.event)),b.value=!0,y.value=!0,e("openAttendee",!0)}const $e=M("approved");function ue(){switch($e.value){case"approved":h.value=1;break;case"waiting":D.value=1;break}j($e.value==="approved"?["approved","canceled"]:["waiting"])}let ae=M(null),me=_(()=>s.getters["customerInfo/getLoading"]),Y=_(()=>s.getters["customerInfo/getCustomers"]);function j(Te,Me=1){Te[0]==="approved"?L.value=!0:I.value=!0,Pe.get("/bookings/events",Object.assign(Ue(s),{params:vn({source:"cabinet-provider",status:Te,page:Me,limit:parseInt(i.general.itemsPerPageBackEnd),events:[t.event.id],customers:ae.value?[ae.value]:[]})})).then(Ee=>{Te[0]==="approved"?(fe.value=Ee.data.data.attendeeCount,Ne.value=Ee.data.data.maxCapacity,E.value=Ee.data.data.bookings.filter(Xe=>Xe.status==="approved"||Xe.status==="canceled").reduce((Xe,re)=>(Xe.push(Es(s,Br(re,s.getters["attendee/getAttendee"]),t.event)),Xe),[]),C.value=Ee.data.data.filteredCount):(fe.value=Ee.data.data.waitingCount,Ne.value=Ee.data.data.waitingCapacity,O.value=Ee.data.data.bookings.filter(Xe=>Xe.status==="waiting").reduce((Xe,re)=>(Xe.push(Br(re)),Xe),[]),A.value=Ee.data.data.filteredCount)}).catch(Ee=>{console.log(Ee)}).finally(()=>{L.value=!1,I.value=!1})}function te(Te,Me){Pe.post("/events/bookings/"+Te,{status:Me,bookings:[{status:Me}]},Object.assign(Ue(s),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(Ee=>{console.log(Ee)}).finally(()=>{})}function de(Te){let Me=$e.value==="approved"?["approved","canceled"]:["waiting"];Me[0]==="approved"?h.value=Te:D.value=Te,j(Me,Te)}function Z(){B.value=!1,G.value?I.value=!0:L.value=!0,Pe.post("/events/bookings/delete/"+J.value.id,fu(s),Object.assign(Ue(s),{params:{source:"cabinet-provider"}})).then(()=>{de(h.value)}).catch(()=>{I.value=!1,L.value=!1})}let ce=M(hu().filter(Te=>(!i.appointments.waitingListEvents.enabled||(V.value?"waitingList"in V.value&&!V.value.waitingList.enabled:!0)?Te.value!=="waiting":!0)&&(i.roles.enableNoShowTag?!0:Te.value!=="no-show"))),fe=M(0),Ne=M(0),Oe=_(()=>`${fe.value}/${Ne.value}`),je=_(()=>fe.value===1?l.value.attendee:l.value.attendees);Je(()=>{j(["approved","canceled"]),s.commit("customerInfo/setCustomers",s.getters["auth/getPreloadedCustomers"])});let _e=F("amColors"),Ce=_(()=>({"--am-c-capei-att-primary":_e.value.colorPrimary,"--am-c-capei-att-text":_e.value.colorMainText,"--am-c-capei-att-text-op90":W(_e.value.colorMainText,.9),"--am-c-capei-att-text-op10":W(_e.value.colorMainText,.1)}));return(Te,Me)=>{const Ee=Xa,Xe=Qa;return u(),x("div",{ref_key:"attendeesContainer",ref:Q,class:"am-capei-att",style:be(a(Ce))},[a(f)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:g,type:a(v),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:T,onTriggerClose:T},{title:S(()=>[W8,ie(" "+w(a(k)),1)]),_:1},8,["type"])):N("",!0),a(y)?N("",!0):(u(),x("div",H8,[d("div",Z8,[d("div",G8,w(a(t).event.name),1),a(Ne)?(u(),x("div",J8,w(a(Oe))+" "+w(a(je)),1)):N("",!0)]),$(ke,{category:"secondary",type:"plain",size:"small",class:"am-capei-att__back",onClick:Me[0]||(Me[0]=re=>a(e)("close"))},{default:S(()=>[ie(w(a(l).back),1)]),_:1})])),a(y)?N("",!0):(u(),x("div",{key:2,class:R(["am-capei-att__header",a(t).responsiveClass])},[$(We,{modelValue:a(ae),"onUpdate:modelValue":Me[1]||(Me[1]=re=>ye(ae)?ae.value=re:ae=re),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-capei-att-text)","popper-class":"am-cap-cust__popper",placeholder:a(l).event_attendees_search,"remote-method":re=>{a(pn)(a(s),re)},loading:a(me),onFocus:Me[2]||(Me[2]=re=>a(So)(a(s))),onChange:Me[3]||(Me[3]=re=>j($e.value==="approved"?["approved","canceled"]:["waiting"],1))},{default:S(()=>[(u(!0),x(ee,null,pe(a(Y),re=>(u(),q(Ve,{key:re.id,value:re.id,label:`${re.firstName} ${re.lastName}`},{default:S(()=>[d("div",X8,[d("div",Q8,w(re.firstName+" "+re.lastName),1),a(m)?(u(),x("div",K8,w(re.email),1)):N("",!0),a(c)?(u(),x("div",eS,w(re.phone),1)):N("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"]),a(i).roles.allowWriteEvents?(u(),q(ke,{key:0,prefix:"plus",icon:"plus","icon-only":a(t).pageWidth<540,onClick:se},{default:S(()=>[ie(w(a(l).event_add_attendee),1)]),_:1},8,["icon-only"])):N("",!0)],2)),a(y)?N("",!0):(u(),q(Xe,{key:3,modelValue:$e.value,"onUpdate:modelValue":Me[4]||(Me[4]=re=>$e.value=re),onTabClick:ue},{default:S(()=>[$(Ee,{label:a(l).attendees,name:"approved"},{default:S(()=>[a(L)?(u(),q(Zt,{key:1})):(u(),x("div",tS,[a(E).length?(u(),x(ee,{key:0},[(u(!0),x(ee,null,pe(a(E),(re,Fe)=>(u(),x("div",{key:Fe,class:R(["am-capei-att__card",a(t).responsiveClass])},[d("div",{class:R(["am-capei-att__card-inner",a(t).responsiveClass])},[d("div",{class:R(["am-capei-att__info",a(t).responsiveClass])},[d("div",{class:R(["am-capei-customer__name",a(z)(0).class])},[a(z)(0).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(z)(0).icon}`)},null,2)):N("",!0),ie(" "+w(re.customer.firstName+" "+re.customer.lastName),1)],2),re.customer.phone&&a(c)||re.customer.email&&a(m)?(u(),x("div",aS,[re.customer.phone&&a(c)?(u(),x("div",sS,[nS,d("a",{href:`tel:${re.customer.phone}`},w(re.customer.phone),9,lS)])):N("",!0),re.customer.email&&a(m)?(u(),x("div",iS,[oS,d("a",{href:`mailto:${re.customer.email}`},w(re.customer.email),9,rS)])):N("",!0)])):N("",!0)],2),$(We,{modelValue:re.status,"onUpdate:modelValue":he=>re.status=he,placeholder:a(l).select,disabled:!a(i).roles.allowWriteEvents,"prefix-icon":a(ce).find(he=>he.value===re.status).icon,"prefix-icon-color":a(ce).find(he=>he.value===re.status).color,"popper-class":"am-capei-att__popper","parent-class":a(t).responsiveClass,onChange:he=>{te(re.id,he)}},{default:S(()=>[(u(!0),x(ee,null,pe(a(ce),he=>(u(),q(Ve,{key:he.value,value:he.value,label:he.label},{default:S(()=>[d("span",{class:R(`am-icon-${he.icon}`),style:be({color:he.color})},null,6),ie(" "+w(he.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","parent-class","onChange"])],2),re.ticketsData.length?(u(),x("div",cS,[d("div",uS,w(a(l).event_book_tickets)+": ",1),d("div",dS,[(u(!0),x(ee,null,pe(re.ticketsData,(he,Re)=>(u(),x("div",{key:Re,class:"am-capei-att__card-ticket"},w(he.persons)+" x "+w(a(t).event.customTickets.find(Ae=>Ae.id===he.eventTicketId).name),1))),128))])])):(u(),x("div",mS,[d("div",pS,w(a(l).event_book_persons)+": ",1),d("div",gS,w(re.persons),1)])),a(i).roles.allowWriteEvents?(u(),q(ka,{key:2,index:Fe,"reference-class":a(t).responsiveClass,onEdit:he=>ge(re),onRemove:he=>K(re,!1)},null,8,["index","reference-class","onEdit","onRemove"])):N("",!0)],2))),128)),a(C)>a(i).general.itemsPerPageBackEnd?(u(),q(tl,{key:0,"page-size":a(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(C),"current-page":a(h),onCurrentChange:de},null,8,["page-size","total","current-page"])):N("",!0)],64)):(u(),q(Na,{key:1,heading:a(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"]),a(i).appointments.waitingListEvents.enabled&&a(V)!==null&&"waitingList"in a(V)&&a(V).waitingList.enabled?(u(),q(Ee,{key:0,label:a(l).waiting_list,name:"waiting"},{default:S(()=>[a(I)?(u(),q(Zt,{key:1})):(u(),x("div",fS,[a(O).length?(u(),x(ee,{key:0},[(u(!0),x(ee,null,pe(a(O),(re,Fe)=>(u(),x("div",{key:Fe,class:"am-capei-att__card"},[d("div",{class:R(["am-capei-att__card-inner",a(t).responsiveClass])},[d("div",{class:R(["am-capei-att__info",a(t).responsiveClass])},[d("div",{class:R(["am-capei-customer__name",a(z)(0).class])},[a(z)(0).icon?(u(),x("span",{key:0,class:R(`am-icon-${a(z)(0).icon}`)},null,2)):N("",!0),ie(" "+w(re.customer.firstName+" "+re.customer.lastName),1)],2),re.customer.phone&&a(c)||re.customer.email&&a(m)?(u(),x("div",hS,[re.customer.phone&&a(c)?(u(),x("div",vS,[_S,d("a",{href:`tel:${re.customer.phone}`},w(re.customer.phone),9,yS)])):N("",!0),re.customer.email&&a(m)?(u(),x("div",bS,[kS,d("a",{href:`mailto:${re.customer.email}`},w(re.customer.email),9,CS)])):N("",!0)])):N("",!0)],2),$(We,{modelValue:re.status,"onUpdate:modelValue":he=>re.status=he,placeholder:a(l).select,disabled:!a(i).roles.allowWriteEvents,"prefix-icon":a(ce).find(he=>he.value===re.status).icon,"prefix-icon-color":a(ce).find(he=>he.value===re.status).color,"popper-class":"am-capei-att__popper",onChange:he=>{te(re.id,he)}},{default:S(()=>[(u(!0),x(ee,null,pe(a(ce),he=>(u(),q(Ve,{key:he.value,value:he.value,label:he.label},{default:S(()=>[d("span",{class:R(`am-icon-${he.icon}`),style:be({color:he.color})},null,6),ie(" "+w(he.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","onChange"])],2),Object.keys(re.ticketsData).length?(u(),x("div",xS,[d("div",wS,w(a(l).event_book_tickets)+": ",1),d("div",TS,[(u(!0),x(ee,null,pe(re.ticketsData,(he,Re)=>(u(),x("div",{key:Re,class:"am-capei-att__card-ticket"},w(he.persons)+" x "+w(a(t).event.customTickets.find(Ae=>Ae.id===he.eventTicketId).name),1))),128))])])):(u(),x("div",SS,[d("div",ES,w(a(l).event_book_persons)+": ",1),d("div",LS,w(re.persons),1)])),a(i).roles.allowWriteEvents?(u(),q(ka,{key:2,index:Fe,"reference-class":a(t).responsiveClass,onEdit:he=>ge(re),onRemove:he=>K(re,!0)},null,8,["index","reference-class","onEdit","onRemove"])):N("",!0)]))),128)),a(A)>a(i).general.itemsPerPageBackEnd?(u(),q(tl,{key:0,"page-size":a(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(A),"current-page":a(D),onCurrentChange:de},null,8,["page-size","total","current-page"])):N("",!0)],64)):(u(),q(Na,{key:1,heading:a(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"])),$(Da,{visibility:a(B),title:a(l).confirm,description:a(l).event_attendee_remove,"close-btn-text":a(l).no,"confirm-btn-text":a(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:X,onConfirm:Z,onClose:X},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),a(y)?(u(),q(_u,{key:4,visibility:a(y),title:a(b)?a(l).event_edit_attendee:a(l).event_add_attendee,event:a(t).event,"page-width":a(t).pageWidth,"is-new":!a(b),onSave:le,onClose:H},null,8,["visibility","title","event","page-width","is-new"])):N("",!0)],4)}}});const IS=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),OS={key:2,class:"am-cap__actions"},PS={name:"CabinetEvents",key:"events"},NS=Object.assign(PS,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const e=n;let t=Ie(),s=M(null),{width:l}=Ka(s),i=_(()=>tt(l.value)),o={components:{IconComponent:He},template:'<IconComponent icon="plus"/>'};const r=F("settings");let c=F("originKey"),m=F("amCustomize");const g=F("shortcodeData"),f=F("labels"),v=F("localLanguage");let k=_(()=>r.general.usedLanguages.includes(v.value)),T=_(()=>{let re=lt({...f}),Fe=m.value.events.translations;return Fe&&Object.keys(Fe).forEach(he=>{Fe[he][v.value]&&k.value?re[he]=Fe[he][v.value]:Fe[he].default&&(re[he]=Fe[he].default)}),re});Be("amLabels",T);let y=M(null),b=M(!1),L=M("success"),E=M("");function C(){b.value=!1,t.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}function h(re){let Fe=lt({...f}),he=m.value[re].translations;return he&&Object.keys(he).forEach(Re=>{he[Re][v.value]&&k.value?Fe[Re]=he[Re][v.value]:he[Re].default&&(Fe[Re]=he[Re].default)}),Fe}function I(re){return m.value[re].options}let O=_(()=>t.getters["entities/getReady"]),A=F("cabinetType");t.commit("cabinetFilters/setDates",Xi(A.value));let D=_(()=>t.getters["cabinet/getEventsLoading"]),V=M(!1),z=M(null),B=M(null),J=M(0),G=M(1);function X(re){G.value=re,K(re)}function K(re=1){z.value=null,t.commit("cabinet/setEventsLoading",!0);let Fe=t.getters["cabinet/getTimeZone"],he=JSON.parse(JSON.stringify(t.getters["cabinetFilters/getEventsFilters"]));he.dates=he.dates.map(Ae=>ve(Ae).format("YYYY-MM-DD")),he.timeZone=Fe,he.source="cabinet-"+A.value,he.id=he.events,he.group=!0,he.page=re,he.limit=r.general.itemsPerPageBackEnd,he.customers&&(he.customerId=he.customers),t.commit("auth/setLoadingEventsCounter",t.getters["auth/getLoadingEventsCounter"]+1);let Re=t.getters["auth/getLoadingEventsCounter"];Pe.get("/events",Object.assign(Ue(t),{params:vn(he)})).then(Ae=>{Re===t.getters["auth/getLoadingEventsCounter"]&&(t.dispatch("cabinetFilters/injectEventsOptions",Ae.data.data.events),t.commit("auth/setPreloadedEvents",Ae.data.data.events),J.value=Ae.data.data.count,t.commit("eventEntities/setEvents",Ae.data.data.events),B.value=pd(Ae.data.data.events,t.getters["cabinet/getTimeZone"],t))}).catch(Ae=>{Ae?.response?.data?.data?.reauthorize!==void 0&&Ae.response.data.data.reauthorize&&t.dispatch("auth/logout"),console.log(Ae)}).finally(()=>{Re===t.getters["auth/getLoadingEventsCounter"]&&t.commit("cabinet/setEventsLoading",!1)})}function Q(re){t.commit("cabinet/setEventsLoading",!0),Pe.get("/events/"+re.id,Object.assign({params:{source:"cabinet-"+A.value,timeZone:t.getters["cabinet/getTimeZone"]}},Ue(t))).then(Fe=>{t.commit("event/setEvent",yw(t,Fe.data.data.event)),le.value=!0}).catch(Fe=>{console.log(Fe)}).finally(()=>{t.commit("cabinet/setEventsLoading",!1)})}let le=M(!1),H=M(!1),se=M(!1),ge=M(!1),$e=M(!1),ue=M(null);function ae(re){t.commit("cabinet/setEventsLoading",!0),le.value=!1,setTimeout(()=>{t.commit("event/setEvent",re),le.value=!0,t.commit("cabinet/setEventsLoading",!1)},500)}function me(){b.value=!0,E.value=T.value.event_saved,s.value&&y.value&&setTimeout(function(){gt(s.value,y.value.$el,0,300)},500),K(),Oe()}function Y(){je(),le.value=!0}function j(re){ue.value=re,Ne(Es(t,t.getters["attendee/getDefaultAttendee"],re)),se.value=!0}function te(){K(G.value),de()}function de(){se.value=!1,ge.value=!1}function Z(re){ue.value=re,H.value=!0}function ce(){ue.value=null,K(G.value),Ne(Es(t,t.getters["attendee/getDefaultAttendee"])),H.value=!1,$e.value=!1}function fe(re){$e.value=re}function Ne(re={}){t.commit("attendee/setAttendee",re)}function Oe(){le.value=!1,je()}function je(){t.commit("event/setEvent",{bookings:[],settings:$s(r,t.getters["event/getSettings"],{},{})})}let _e=M(!1);function Ce(){_e.value=!0,Pe.post("/bookings/cancel/"+z.value.id,{type:"event",source:"cabinet-"+A.value},Object.assign(Ue(t),{params:{source:"cabinet-"+A.value}})).then(()=>{z.value=null,K(),b.value=!0,E.value=T.value.event_canceled,s.value&&y.value&&setTimeout(function(){gt(s.value,y.value.$el,0,300)},500)}).catch(re=>{!("data"in re.response.data)&&"message"in re.response.data&&(b.value=!0,E.value=re.response.data.message,s.value&&y.value&&setTimeout(function(){gt(s.value,y.value.$el,0,300)},500))}).finally(()=>{_e.value=!1})}rt(()=>e.loadBookingsCounter,()=>{K()}),Je(()=>{K()});function Te(re){let Fe=[],he=t.getters["entities/getEmployees"];if(re.organizerId&&he.find(Re=>Re.id===re.organizerId)){let Re={...he.find(Ae=>Ae.id===re.organizerId),rank:"organizer"};if(!re.providers.length)return Re;Fe.push(Re)}return re.providers.length&&re.providers.forEach(Re=>{Re.id!==re.organizerId&&he.find(Ae=>Ae.id===Re.id)&&Fe.push(he.find(Ae=>Ae.id===Re.id))}),Fe}function Me(re){if(re){if(re===1)return{class:"am-no-show-1",icon:"no-show-1"};if(re===2)return{class:"am-no-show-2",icon:"no-show-2"};if(re>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Be("noShowData",{noShowData:Me});let Ee=F("amColors"),Xe=_(()=>({"--am-c-cape-bgr":Ee.value.colorMainBgr,"--am-c-cape-text":Ee.value.colorMainText,"--am-c-cape-text-op70":W(Ee.value.colorMainText,.7),"--am-c-cape-text-op25":W(Ee.value.colorMainText,.25),"--am-c-cape-primary":Ee.value.colorPrimary,"--am-c-cust-no1":Ee.value.colorMainText,"--am-c-cust-no1-bgr":W(Ee.value.colorMainText,.1),"--am-c-cust-no2":Ee.value.colorWarning,"--am-c-cust-no2-bgr":W(Ee.value.colorWarning,.1),"--am-c-cust-no3":Ee.value.colorError,"--am-c-cust-no3-bgr":W(Ee.value.colorError,.1),"--am-c-cust-text":Ee.value.colorMainText,"--am-c-cust-link":W(Ee.value.colorMainText,.5)}));return(re,Fe)=>(u(),x("div",{ref_key:"pageContainer",ref:s,class:R(["am-cap am-cape-main",{"am-capei-main":a(le)||a(se)||a($e)}]),style:be(a(Xe))},[d("div",{class:R(["am-cape-main__inner",a(i)])},[a(b)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:y,type:a(L),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:C,onTriggerClose:C},{title:S(()=>[IS,ie(" "+w(a(E)),1)]),_:1},8,["type"])):N("",!0),!a(se)&&!a(le)&&!a(H)&&a(O)?(u(),q(Eo,{key:1,"step-key":"events",empty:a(V),"responsive-class":a(i),onChangeFilters:K},null,8,["empty","responsive-class"])):N("",!0),a(g).cabinetType==="employee"&&a(r).roles.allowWriteEvents&&!a(se)&&!a(le)&&!a(H)&&a(O)?(u(),x("div",OS,[$(ke,{icon:a(o),prefix:"plus",size:"small",category:"primary",type:a(m).events.options.newEvtBtn.buttonType,onClick:Y},{default:S(()=>[d("span",null,w(a(T).new_event),1)]),_:1},8,["icon","type"])])):N("",!0),!a(D)&&a(O)?(u(),x(ee,{key:3},[!a(se)&&!a(le)&&!a(H)&&a(B)&&Object.keys(a(B)).length>0?(u(),x("div",{key:0,class:R(["am-cape__wrapper",[{"am-no-border":a(B)&&Object.keys(a(B)).length===1},a(i)]])},[(u(!0),x(ee,null,pe(a(B),(he,Re)=>(u(),x("div",{key:Re,class:"am-cape"},[d("div",{class:R(["am-cape__date",[{"am-today":a(dt)(Re)===a(dt)(a(ve)().format("YYYY-MM-DD"))},{"am-no-flag":a(B)&&Object.keys(a(B)).length===1},a(i)]])},w(a(dt)(Re)),3),(u(!0),x(ee,null,pe(he.events,(Ae,Ds)=>(u(),q(ou,{key:Ds,start:a(sn)(Ae.periods[0].periodStart.split(" ")[1].slice(0,5)),name:Ae.name,employee:Te(Ae),customers:Ae.bookings.filter(wt=>wt.status!=="rejected"&&wt.status!=="canceled").map(wt=>wt.customer),price:a(Wr)(Ae),duration:null,periods:(re.periods=a(gd)(Ae.periods))?re.periods:[],extras:[],tickets:a(fd)(Ae),"custom-fields":a(lu)(Ae.bookings,a(g).cabinetType),location:a(hd)(a(t),Ae),"google-meet-link":Ae.periods.length===1&&Ae.periods[0].googleMeetUrl?Ae.periods[0].googleMeetUrl:"","microsoft-teams-link":Ae.periods.length===1&&Ae.periods[0].microsoftTeamsUrl?Ae.periods[0].microsoftTeamsUrl:"","zoom-link":Ae.periods.length===1&&Ae.periods[0].zoomMeeting?Ae.periods[0].zoomMeeting.joinUrl:"","lesson-space-link":Ae.periods.length===1&&Ae.periods[0].lessonSpace?Ae.periods[0].lessonSpace:"",bookable:Ae,reservation:Ae,booking:Ae.bookings[0],"responsive-class":a(i),"parent-width":a(l),"customized-options":I("events"),onEditEvent:Q,onAddEventAttendee:j,onListEventAttendees:Z,onCancelBooking:Fe[0]||(Fe[0]=wt=>{ye(z)?z.value=wt:z=wt})},null,8,["start","name","employee","customers","price","periods","tickets","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","responsive-class","parent-width","customized-options"]))),128))]))),128))],2)):N("",!0),!a(se)&&!a(le)&&!a(H)&&(a(B)===null||Object.keys(a(B)).length===0)?(u(),q(Na,{key:1,heading:a(T).no_evt_found,text:a(T).have_no_evt},null,8,["heading","text"])):N("",!0),!a(se)&&!a(le)&&!a(H)&&a(B)&&Object.keys(a(B)).length>0&&a(J)>a(r).general.itemsPerPageBackEnd?(u(),q(tl,{key:2,"page-size":a(r).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(J),"current-page":a(G),onCurrentChange:X},null,8,["page-size","total","current-page"])):N("",!0),a(le)?(u(),q(d8,{key:3,"page-width":a(l),"responsive-class":a(i),onClose:Oe,onSave:me,onDuplicate:ae},null,8,["page-width","responsive-class"])):N("",!0),!a(se)&&a(H)?(u(),q($S,{key:4,event:a(ue),"page-width":a(l),"responsive-class":a(i),onClose:ce,onOpenAttendee:fe},null,8,["event","page-width","responsive-class"])):N("",!0),a(se)?(u(),q(_u,{key:5,visibility:a(se),title:a(ge)?a(T).event_edit_attendee:a(T).event_add_attendee,event:a(ue),"page-width":a(l),"is-new":!a(ge),onSave:te,onClose:de},null,8,["visibility","title","event","page-width","is-new"])):N("",!0),a(c)==="capc"?(u(),q(Da,{key:6,visibility:a(z)!==null,title:h("cancelEvent").cancel_event,description:h("cancelEvent").confirm_cancel_event,"close-btn-text":h("cancelEvent").close,"confirm-btn-text":h("cancelEvent").confirm,"customized-options":I("cancelEvent"),loading:a(_e),onClose:Fe[1]||(Fe[1]=he=>ye(z)?z.value=null:z=null),onDecline:Fe[2]||(Fe[2]=he=>ye(z)?z.value=null:z=null),onConfirm:Ce},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):N("",!0)],64)):(u(),q(Lo,{key:4}))],2)],6))}});const DS={class:"am-sc__top-left"},MS={class:"am-sc__name"},BS={key:0,class:"am-sc__date"},FS={key:1,class:"am-sc__date"},VS=["onClick"],RS={class:"am-sc__capacity"},qS=d("div",{class:"am-sc__btn"},[d("span",{class:"am-icon-arrow-right"})],-1),US={key:0,class:"am-sc__bottom"},jS={class:"am-sc__expiration"},zS=d("span",{class:"am-icon-triangle-info"},null,-1),YS={name:"CabinetPackagesList"},WS=Object.assign(YS,{props:{packages:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""}},emits:["click"],setup(n,{emit:e}){const t=n;function s(b){return ve(b,"YYYY-MM-DD").diff(ve(),"days")}function l(b){e("click",b)}function i(b,L,E){let C=0;return Object.keys(b).forEach(h=>{(L===null||parseInt(L)===parseInt(h))&&(C+=b[h].purchaseData[E])}),C}function o(b){return b===1?k.value.appointment_booked:k.value.appointments_booked}function r(b){let L=b.packageData.sharedCapacity?b.packageData.sharedCount:i(b.services,null,"count"),E=b.packageData.sharedCapacity?b.packageData.sharedTotal:i(b.services,null,"total");return`${E-L}/${E} ${o(E-L)}`}const c=F("settings");let m=F("amCustomize");const g=F("labels"),f=F("localLanguage");let v=_(()=>c.general.usedLanguages.includes(f.value)),k=_(()=>{let b=lt({...g}),L=m.value.packagesList.translations;return L&&Object.keys(L).forEach(E=>{L[E][f.value]&&v.value?b[E]=L[E][f.value]:L[E].default&&(b[E]=L[E].default)}),b}),T=F("amColors"),y=_(()=>({"--am-c-sc-bgr":T.value.colorMainBgr,"--am-c-sc-bgr-op15":W(T.value.colorMainText,.15),"--am-c-sc-text":T.value.colorMainText,"--am-c-sc-text-op80":W(T.value.colorMainText,.8),"--am-c-sc-text-op60":W(T.value.colorMainText,.6),"--am-c-sc-warning-op50":W(T.value.colorWarning,.5)}));return(b,L)=>a(t).packages.length?(u(!0),x(ee,{key:0},pe(a(t).packages,E=>(u(),x("div",{key:E[0],style:be(a(y)),class:R(["am-sc",{"am-sc__canceled":E[1].packageData.status==="canceled"}])},[d("div",{class:R(["am-sc__top",n.responsiveClass])},[d("div",DS,[d("div",MS,w(E[1].packageData.name),1),E[1].packageData.end?(u(),x("div",BS,w(a(k).package_book_expire)+" "+w(a(dt)(E[1].packageData.end.split(" ")[0])),1)):(u(),x("div",FS,w(`${a(k).package_book_expiration} ${a(k).package_book_unlimited}`),1))]),d("div",{class:R(["am-sc__top-right",n.responsiveClass]),onClick:C=>l(E[0])},[d("div",RS,w(r(E[1])),1),qS],10,VS)],2),E[1].packageData.end&&E[1].packageData.status!=="canceled"?(u(),x(ee,{key:0},[s(E[1].packageData.end.split(" ")[0])>0?(u(),x("div",US,[d("span",jS,[zS,ie(" "+w(`${a(k).package_deal_expire_in} ${s(E[1].packageData.end.split(" ")[0])} ${a(k).expires_days}, ${a(k).appointments_deal_expire}`),1)])])):N("",!0)],64)):N("",!0)],6))),128)):(u(),q(Na,{key:1,heading:a(k).no_pack_found,text:a(k).have_no_pack},null,8,["heading","text"]))}});const HS=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),ZS={class:"am-cappa__back"},GS={class:"am-cappa__heading-left"},JS={key:0,class:"am-cappa__img-name"},XS={class:"am-cappa__info"},QS={class:"am-cappa__name"},KS={key:0,class:"am-cappa__date"},eE={key:1,class:"am-cappa__date"},tE={key:2,class:"am-cappa__capacity"},aE={class:"am-cappa__service-heading"},sE={class:"am-cappa__service-right"},nE={key:0,class:"am-cappa__service-img__name"},lE={class:"am-cappa__service-info"},iE={class:"am-cappa__service-name"},oE={key:0,class:"am-cappa__service-capacity"},rE={name:"CabinetPackageAppointmentsList",key:"packagesList"},cE=Object.assign(rE,{props:{data:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["goBack","booked","canceled","cancelError"],setup(n,{emit:e}){const t=n;let s=Ie(),l=_(()=>s.getters.getSettings),i=jr({components:{IconComponent:He},template:'<IconComponent icon="arrow-left"></IconComponent>'}),{selectedPackageCustomerId:o}=F("packageSelection"),r=_(()=>s.getters["entities/getPackage"](t.data.packageData.id)),c=_(()=>r.value.bookable.find(Y=>parseInt(Y.service.id)===parseInt(y.value))),m=M(null),g=M(null),f=_(()=>{let Y=s.getters["entities/getEntitiesRelations"],j=s.getters["entities/getUnfilteredEmployees"],te=[];if(c.value){if(g.value)Object.keys(Y).forEach(Z=>{b.value&&b.value.serviceId in Y[Z]&&Y[Z][parseInt(b.value.serviceId)].indexOf(g.value)!==-1&&te.push(parseInt(Z))});else{let Z=[];if(c.value.locations.length)Z=c.value.locations.map(ce=>ce.id);else for(let ce in Y)c.value.service.id in Y[ce]&&(Z=Z.concat(Y[ce][c.value.service.id]));for(let ce in Y)c.value.service.id in Y[ce]&&Z.forEach(fe=>{Y[ce][c.value.service.id].indexOf(fe)!==-1&&te.push(parseInt(ce))})}let de=c.value.providers.length?c.value.providers.map(Z=>Z.id):j.map(Z=>Z.id);return j.filter(Z=>de.indexOf(Z.id)!==-1&&te.indexOf(Z.id)!==-1&&(s.getters["entities/getShowHidden"]||Z.status==="visible"))}return[]}),v=_(()=>{let Y=s.getters["entities/getEntitiesRelations"],j=s.getters["entities/getUnfilteredLocations"],te=[];if(c.value){if(m.value)te=Y[m.value][c.value.service.id];else{let Z=[];if(c.value.providers.length)Z=c.value.providers.map(ce=>ce.id);else for(let ce in Y)c.value.service.id in Y[ce]&&Z.push(parseInt(ce));for(let ce in Y)c.value.service.id in Y[ce]&&Z.indexOf(parseInt(ce))!==-1&&(te=te.concat(Y[ce][c.value.service.id]))}let de=c.value.locations.length?c.value.locations.map(Z=>Z.id):j.map(Z=>Z.id);return j.filter(Z=>de.indexOf(Z.id)!==-1&&te.indexOf(Z.id)!==-1&&(s.getters["entities/getShowHidden"]||Z.status==="visible"))}return[]}),k=_(()=>{let Y=[];return Object.keys(t.data.services).forEach(j=>{Object.keys(t.data.services[j].appointments).forEach(te=>{t.data.services[j].appointments[te].appointments.forEach(de=>{Y.push(de)})})}),{type:"package",package:r.value,booking:null,bookable:r.value,paymentId:t.data.packageData.payments.length?t.data.packageData.payments[0].id:null,customer:s.getters["auth/getProfile"],packageCustomerId:parseInt(o.value),packageReservations:Y,payments:t.data.packageData.payments,price:t.data.packageData.price,tax:t.data.packageData.tax,coupon:t.data.packageData.coupon,discount:t.data.packageData.discount,end:t.data.packageData.end}}),T=M(!1),y=M(null),b=M(null),L=M(null);Je(()=>{y.value=Object.keys(t.data.services)[0]});function E(Y,j,te){let de=0;return Object.keys(Y).forEach(Z=>{(j===null||parseInt(j)===parseInt(Z))&&(de+=Y[Z].purchaseData[te])}),de}function C(Y){return Y===1?Q.value.appointment_booked:Q.value.appointments_booked}function h(Y,j=null){let te=Y.packageData.sharedCapacity?Y.packageData.sharedCount:E(Y.services,j,"count"),de=Y.packageData.sharedCapacity?Y.packageData.sharedTotal:E(Y.services,j,"total");return`${de-te}/${de} ${C(de-te)}`}function I(Y){y.value=Y.paneName}function O(){let Y=s.getters["auth/getProfile"],j=s.getters["cabinet/getTimeZone"]?s.getters["cabinet/getTimeZone"]:"UTC",te={serviceId:parseInt(y.value),group:1,timeZone:s.getters["cabinet/getTimeZone"],page:"cabinet"},de=r.value.bookable.find(Z=>parseInt(Z.service.id)===parseInt(y.value)).providers.map(Z=>Z.id);de.length&&(te.providerIds=de),te.locationId=null,L.value=te,b.value={type:"appointment",bookings:[{packageCustomerService:{id:t.data.services[y.value].purchaseData.packageCustomerServiceId},customer:{id:Y.id,firstName:Y.firstName,lastName:Y.lastName,email:Y.email,phone:Y.phone,countryPhoneIso:Y.countryPhoneIso,externalId:Y.externalId},customerId:Y.id,customFields:null,persons:1,extras:[],deposit:0}],serviceId:y.value,locationId:t.data.services[y.value].purchaseData.locitionId,providerId:t.data.services[y.value].purchaseData.employeeId,isGroup:!0,notifyParticipants:l.value.notifications.notifyCustomers?1:0,payment:null,recurring:[],package:[],timeZone:j===""?Intl.DateTimeFormat().resolvedOptions().timeZone:j,utc:j==="",locale:window.localeLanguage[0]}}function A(Y){b.value=null,e("booked",Y)}let D=M(!1);function V(){D.value=!0,Pe.post("/packages/customers/"+parseInt(o.value),{status:"canceled"},Ue(s)).then(()=>{T.value=!1,e("canceled",{message:Q.value.package_purchase_canceled})}).catch(Y=>{Y.response&&e("cancelError",Y.response.data)}).finally(()=>{D.value=!1})}function z(Y){e("booked",Y)}function B(){e("goBack")}let J=F("amCustomize");const G=F("labels"),X=F("localLanguage");let K=_(()=>l.value.general.usedLanguages.includes(X.value)),Q=_(()=>{let Y=lt({...G}),j=J.value.packageAppointmentsList.translations;return j&&Object.keys(j).forEach(te=>{j[te][X.value]&&K.value?Y[te]=j[te][X.value]:j[te].default&&(Y[te]=j[te].default)}),Y});Be("amLabels",Q);let le=_(()=>s.getters["cabinet/getPaymentLinkError"].package),H=M("error"),se=M(Q.value.payment_link_error);function ge(){le.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"package"})}function $e(Y){let j=lt({...G}),te=J.value[Y].translations;return te&&Object.keys(te).forEach(de=>{te[de][X.value]&&K.value?j[de]=te[de][X.value]:te[de].default&&(j[de]=te[de].default)}),j}function ue(Y){return J.value[Y].options}let ae=F("amColors"),me=_(()=>({"--am-c-cappa-text":ae.value.colorMainText,"--am-c-cappa-bgr":ae.value.colorMainBgr,"--am-c-cappa-text-op80":W(ae.value.colorMainText,.8),"--am-c-cappa-text-op70":W(ae.value.colorMainText,.7),"--am-c-cappa-text-op20":W(ae.value.colorMainText,.2),"--am-c-cappa-primary":ae.value.colorPrimary}));return(Y,j)=>{const te=Xa,de=Qa;return u(),x("div",{class:"am-cappa",style:be(a(me))},[a(le)?(u(),q($t,{key:0,ref:"alertContainer",type:a(H),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:ge,onTriggerClose:ge},{title:S(()=>[HS,ie(" "+w(a(se)),1)]),_:1},8,["type"])):N("",!0),d("div",ZS,[$(ke,{"custom-class":"am-cappa__back-btn",icon:a(i),type:a(J).packageAppointmentsList.options.backBtn.buttonType,size:"micro",category:"secondary","icon-only":"",onClick:B},null,8,["icon","type"]),d("span",null,w(a(Q).back_btn),1)]),d("div",{class:R(["am-cappa__heading",n.responsiveClass])},[d("div",GS,[d("div",{class:"am-cappa__img",style:be(a(t).data.packageData.pictureThumbPath?{backgroundImage:`url(${a(t).data.packageData.pictureThumbPath})`}:{})},[a(t).data.packageData.pictureThumbPath?N("",!0):(u(),x("span",JS,w(a(No)(a(t).data.packageData.name)),1)),d("span",{class:"am-cappa__img-color",style:be({backgroundColor:a(t).data.packageData.color})},null,4)],4),d("div",XS,[d("div",QS,w(a(t).data.packageData.name),1),a(t).data.packageData.end?(u(),x("div",KS,w(a(Q).package_book_expire)+" "+w(a(dt)(a(t).data.packageData.end.split(" ")[0])),1)):(u(),x("div",eE,w(`${a(Q).package_book_expiration} ${a(Q).package_book_unlimited}`),1)),Object.keys(a(t).data.services).length>1?(u(),x("div",tE,w(h(a(t).data)),1)):N("",!0)])]),d("div",{class:R(["am-cappa__heading-right",n.responsiveClass])},[a(l).roles.allowCustomerCancelPackages&&a(t).data.packageData.status!=="canceled"?(u(),q(ke,{key:0,category:"danger",size:"small",class:R(["am-cappa__actions",n.responsiveClass]),type:a(J).packageAppointmentsList.options.cancelBtn.buttonType,onClick:j[0]||(j[0]=()=>{ye(T)?T.value=!0:T=!0})},{default:S(()=>[ie(w(a(Q).cancel),1)]),_:1},8,["class","type"])):N("",!0),a(t).data.packageData.status==="approved"&&a(t).data.packageData.price>0?(u(),q(iu,{key:1,"btn-size":"small",class:R(`am-cappa__actions ${n.responsiveClass}`),type:a(J).packageAppointmentsList.options.payBtn.buttonType,reservation:a(k),bookable:a(r)},null,8,["class","type","reservation","bookable"])):N("",!0)],2)],2),$(de,{modelValue:a(y),"onUpdate:modelValue":j[1]||(j[1]=Z=>ye(y)?y.value=Z:y=Z),class:"am-cappa__service",onTabClick:I},{default:S(()=>[(u(!0),x(ee,null,pe(Object.keys(a(t).data.services),Z=>(u(),q(te,{key:Z,name:Z},{label:S(()=>[d("div",aE,w(a(t).data.services[Z].purchaseData.name),1)]),default:S(()=>[a(y)===Z?(u(),x(ee,{key:0},[d("div",{class:R(["am-cappa__service-top",n.responsiveClass])},[d("div",sE,[d("div",{class:"am-cappa__service-img",style:be(a(t).data.services[a(y)].purchaseData.pictureThumbPath?{backgroundImage:`url(${a(t).data.services[a(y)].purchaseData.pictureThumbPath})`}:{})},[a(t).data.services[a(y)].purchaseData.pictureThumbPath?N("",!0):(u(),x("span",nE,w(a(No)(a(t).data.services[a(y)].purchaseData.name)),1)),d("span",{class:"am-cappa__service-img__color",style:be({backgroundColor:a(t).data.services[a(y)].purchaseData.color})},null,4)],4),d("div",lE,[d("div",iE,w(a(t).data.services[a(y)].purchaseData.name),1),a(t).data.packageData.sharedCapacity?N("",!0):(u(),x("div",oE,w(h(a(t).data,a(y))),1))])]),a(t).data.packageData.status!=="canceled"?(u(),q(ke,{key:0,class:R(["am-cappa__service-book",n.responsiveClass]),size:"small",type:a(J).packageAppointmentsList.options.bookBtn.buttonType,disabled:E(a(t).data.services,a(y),"count")===0,onClick:O},{default:S(()=>[ie(w(a(Q).book_now),1)]),_:1},8,["class","type","disabled"])):N("",!0)],2),$(cu,{"grouped-appointments":a(t).data.services[a(y)].appointments,"page-width":n.pageWidth,"responsive-class":n.responsiveClass,"is-package-booking":!0,"step-key":"packageAppointmentsList",onCanceled:z,onBooked:z},null,8,["grouped-appointments","page-width","responsive-class"])],64)):N("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),$(Da,{loading:a(D),visibility:a(T),title:$e("cancelPackage").cancel_package,description:$e("cancelPackage").confirm_cancel_package,"close-btn-text":$e("cancelPackage").close,"confirm-btn-text":$e("cancelPackage").confirm,"customized-options":ue("cancelPackage"),onClose:j[2]||(j[2]=()=>{ye(T)?T.value=!1:T=!1}),onDecline:j[3]||(j[3]=()=>{ye(T)?T.value=!1:T=!1}),onConfirm:V},null,8,["loading","visibility","title","description","close-btn-text","confirm-btn-text","customized-options"]),$(ru,{visibility:a(b)!==null&&!a(b).id,appointment:a(b),employees:a(f),locations:a(v),"slots-params":a(L),labels:$e("bookAppointment"),"customized-options":ue("bookAppointment"),onClose:j[4]||(j[4]=Z=>ye(b)?b.value=null:b=null),onSuccess:A,onError:j[5]||(j[5]=()=>{}),onEmployeeSelection:j[6]||(j[6]=Z=>ye(m)?m.value=Z:m=Z),onLocationSelection:j[7]||(j[7]=Z=>ye(g)?g.value=Z:g=Z)},null,8,["visibility","appointment","employees","locations","slots-params","labels","customized-options"])],4)}}});const uE=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),dE={name:"CabinetPackages",key:"packages"},mE=Object.assign(dE,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const e=n;let t=Ie(),s=M(null),l=M(0),i=F("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}rt(i,J=>{J?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{Gi(()=>{l.value=s.value.offsetWidth})});let c=_(()=>tt(l.value)),m=M(null),g=M(!1),f=M("success"),v=M("");function k(){g.value=!1,v.value=""}let T=F("cabinetType");t.commit("cabinetFilters/setDates",Xi(T.value));let y=_(()=>t.getters["cabinet/getPackageLoading"]),b=M([]),L=M(null);function E(){let J=t.getters["cabinetFilters/getPackages"],G=t.getters["cabinetFilters/getServices"],X=t.getters["cabinetFilters/getProviders"],K=t.getters["cabinetFilters/getLocations"];b.value=A.value.filter(Q=>{let le=t.getters["entities/getPackageEntities"](Q[1].packageData.id);return(G.length===0||G.filter(H=>le.services.includes(H)).length>0)&&(X.length===0||X.filter(H=>le.providers.includes(H)).length>0)&&(K.length===0||K.filter(H=>le.locations.includes(H)).length>0)&&(J.length===0||J.filter(H=>le.packages.includes(H)).length>0)})}function C(J,G,X){let K=0;return Object.keys(J).forEach(Q=>{(G===null||parseInt(G)===parseInt(Q))&&(K+=J[Q].purchaseData[X])}),K}function h(J){let G=C(J.services,null,"count"),X=C(J.services,null,"total");return X-G===X}function I(J){t.commit("cabinet/setPackageLoading",!0);let G=t.getters["cabinet/getTimeZone"],X=JSON.parse(JSON.stringify(t.getters["cabinetFilters/getPackagesFilters"]));X.timeZone=G,X.source="cabinet-"+T.value,X.activePackages=0,Pe.get("/appointments",vn(Object.assign(Ue(t),{params:X}))).then(K=>{let Q={};K.data.data.availablePackageBookings.forEach(ae=>{ae.packages.forEach(me=>{me.services.forEach(Y=>{Y.bookings.forEach(j=>{let te=t.getters["entities/getPackage"](me.packageId);if(te&&(j.packageCustomerId in Q||(Q[j.packageCustomerId]={packageData:{id:te.id,name:te.name,start:j.start,end:j.end,price:j.price,tax:j.tax,coupon:j.coupon,status:j.status,type:"package",payments:j.payments,sharedCapacity:j.sharedCapacity,sharedTotal:j.total,sharedCount:j.count,discount:0,color:te.color,pictureFullPath:te.pictureFullPath,pictureThumbPath:te.pictureThumbPath},services:{}}),!(Y.serviceId in Q[j.packageCustomerId].services))){let de=t.getters["entities/getService"](Y.serviceId);Q[j.packageCustomerId].services[Y.serviceId]={appointments:{},purchaseData:{packageCustomerServiceId:j.id,total:j.total,count:j.count,employeeId:j.employeeId,locationId:j.locationId,name:de.name,color:de.color,pictureThumbPath:de.pictureThumbPath}}}})})})});let le=nu(K.data.data.appointments,G,T.value==="provider");Object.keys(le).forEach(ae=>{le[ae].appointments.forEach(me=>{me.bookings.forEach(Y=>{let j=Y.packageCustomerService.packageCustomer.id;j in Q&&(ae in Q[j].services[me.serviceId].appointments||(Q[j].services[me.serviceId].appointments[ae]={date:ae,appointments:[]}),Q[j].services[me.serviceId].appointments[ae].appointments.push(me))})})});let H=Object.entries(Q).filter(ae=>ae[1].packageData.status==="canceled"),se=Object.entries(Q).filter(ae=>ae[1].packageData.status!=="canceled"&&h(ae[1])),ge=Object.entries(Q).filter(ae=>ae[1].packageData.status!=="canceled"&&!h(ae[1])&&ae[1].packageData.end===null),$e=Object.entries(Q).filter(ae=>ae[1].packageData.status!=="canceled"&&!h(ae[1])&&ae[1].packageData.end!==null).sort((ae,me)=>ve(ae[1].packageData.end,"YYYY-MM-DD HH:mm:ss").diff(ve(me[1].packageData.end,"YYYY-MM-DD HH:mm:ss"),"minutes"));if(b.value=[...$e,...ge,...se,...H],A.value=[...$e,...ge,...se,...H],!(X.packages.length||X.services.length||X.providers.length||X.locations.length)){let ae=[],me=[],Y=[],j=[];b.value.forEach(te=>{let de=t.getters["entities/getPackageEntities"](te[1].packageData.id);ae=ae.concat(de.services),me=me.concat(de.providers),Y=Y.concat(de.locations),j=j.concat(de.packages)}),t.dispatch("cabinetFilters/injectServiceOptions",ae.filter((te,de,Z)=>Z.indexOf(te)===de)),t.dispatch("cabinetFilters/injectProviderOptions",me.filter((te,de,Z)=>Z.indexOf(te)===de)),t.dispatch("cabinetFilters/injectLocationOptions",Y.filter((te,de,Z)=>Z.indexOf(te)===de)),t.dispatch("cabinetFilters/injectPackagesOptions",j.filter((te,de,Z)=>Z.indexOf(te)===de))}}).catch(K=>{console.log(K)}).finally(()=>{t.commit("cabinet/setPackageLoading",!1),J&&"message"in J&&(g.value=!0,v.value=J.message,s.value&&m.value&&setTimeout(function(){gt(s.value,m.value.$el,0,300)},500))})}function O(J){g.value=!0,v.value=J.message,f.value="error",s.value&&m.value&&setTimeout(function(){gt(s.value,m.value.$el,0,300)},500)}Be("packageSelection",{selectedPackageCustomerId:L});let A=M([]);rt(()=>e.loadBookingsCounter,()=>{I()}),Je(()=>{I()});let D=_(()=>({list:{template:Ge(WS),props:{packages:b.value,responsiveClass:c.value},handlers:{click:z}},item:{template:Ge(cE),props:{data:L.value?b.value.find(J=>J[0]===L.value)[1]:{},responsiveClass:c.value,pageWidth:l.value},handlers:{goBack:B,booked:I,canceled:I,cancelError:O}}})),V=M("list");function z(J){L.value=J,V.value="item"}function B(){L.value=null,V.value="list"}return(J,G)=>(u(),x("div",{ref_key:"pageContainer",ref:s,class:"am-cap"},[a(g)?(u(),q($t,{key:0,ref_key:"alertContainer",ref:m,type:a(f),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:k,onTriggerClose:k},{title:S(()=>[uE,ie(" "+w(a(v)),1)]),_:1},8,["type"])):N("",!0),Yt($(Eo,{"step-key":"packages","responsive-class":a(c),onChangeFilters:E},null,8,["responsive-class"]),[[Ur,a(V)==="list"]]),a(y)?(u(),q(Lo,{key:2})):(u(),q(Ct(a(D)[a(V)].template),Nt({key:1},a(D)[a(V)].props,Ji(a(D)[a(V)].handlers)),null,16))],512))}});const pE=d("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),gE=d("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),fE=["href"],hE={class:"am-fs-sb__page-wrapper am-fs-sb__page-wrapper__cabinet"},vE=["onClick"],_E={class:"am-fs-sb__page-icon"},yE=d("span",{class:"am-icon-arrow-big-right"},null,-1),bE=[yE],kE={key:1,class:"am-fs-sb__page-divider"},CE={class:"am-fs-sb__page-inner"},xE=d("div",{class:"am-fs-sb__page-icon"},[d("span",{class:"am-icon-dashboard"})],-1),wE=d("div",{class:"am-fs-sb__page-divider"},null,-1),TE={class:"am-fs-sb__page-inner"},SE=d("div",{class:"am-fs-sb__page-icon"},[d("span",{class:"am-icon-logout"})],-1),EE={class:"am-caph"},LE={class:"am-caph__text"},AE=d("span",{class:"am-icon-menu"},null,-1),$E=[AE],IE={name:"CustomerPanel"},OE=Object.assign(IE,{setup(n){const e=ul().cookies,t=Ie(),s=F("shortcodeData");let l=_(()=>t.getters["auth/getAuthenticated"]);rt(l,Z=>{Z&&(t.commit("auth/setNewPassword",""),t.commit("auth/setConfirmPassword",""))});let i=M(s.value.cabinetType==="employee"?"provider":"customer");Be("cabinetType",i);let o=F("licence"),r=_(()=>i.value==="provider"?"cape":"capc");Be("originKey",r);let c=M(null),{width:m}=Ka(c);Be("containerWidth",m);const g=F("settings"),f=_(()=>g.customizedData&&r.value in g.customizedData?g.customizedData[r.value]:el[r.value]);Be("amCustomize",f);const v=M(g.customizedData?g.customizedData.fonts:el.fonts);Be("amFonts",v);const k=F("labels");Be("amLabels",k);const T=F("localLanguage");let y=_(()=>g.general.usedLanguages.includes(T.value)),b=_(()=>{let Z=lt({...k});return g.customizedData&&Object.keys(f.value).forEach(ce=>{if(ce!=="colors"&&f.value[ce].translations){let fe=f.value[ce].translations;Object.keys(fe).forEach(Ne=>{fe[Ne][T.value]&&y.value?Z[Ne]=fe[Ne][T.value]:fe[Ne].default&&(Z[Ne]=fe[Ne].default)})}}),Z});function L(){let Z=document.head||document.getElementsByTagName("head")[0];Z.querySelector("#amCustomFont")&&Z.querySelector("#amCustomFont").remove();let ce="@font-face {font-family: 'comic'; src: url(http://localhost/amelia-test/wp-content/uploads/amelia/fonts/comic.woff);}",fe=document.createElement("style");Z.appendChild(fe),fe.setAttribute("type","text/css"),fe.setAttribute("id","amCustomFont"),fe.appendChild(document.createTextNode(ce))}v.value.customFontSelected&&L();let E=_(()=>X.value==="packages"?f.value.packagesList.options:f.value[X.value].options),C=M(!1),h=M(!1);Be("sidebarCollapsed",Zu(h));let I=M("");rt(h,Z=>{Z?setTimeout(()=>{I.value="am-collapsed"},1e3):I.value=""});let O=M(null),A=M(0),D=_(()=>m.value>480);Je(()=>{O.value&&setTimeout(()=>{A.value=O.value.offsetHeight},200),setTimeout(()=>{h.value=m.value<=600?!0:f.value.sidebar.options.toggle.visibility},1300)});const V=()=>{m.value<=600?h.value=!0:h.value=f.value.sidebar.options.toggle.visibility};window.addEventListener("resize",V),rt(m,Z=>{C.value=Z>481?!1:C.value});const z=_(()=>t.getters["entities/getReady"]);rt(z,Z=>{if(Z){if(s.value.cabinetType==="employee"&&t.getters["employee/getId"]){let ce=t.getters["employee/getEmployee"];t.commit("employee/setServiceList",Vr(t,ce.serviceList)),t.commit("entities/setEmployees",[t.getters["entities/getEmployee"](t.getters["employee/getId"])])}t.dispatch("cabinetFilters/injectServiceOptions",t.getters["entities/getServices"].map(ce=>ce.id)),t.dispatch("cabinetFilters/injectProviderOptions",i.value==="customer"?t.getters["entities/getEmployees"].map(ce=>ce.id):[]),t.dispatch("cabinetFilters/injectLocationOptions",t.getters["entities/getLocations"].map(ce=>ce.id))}});const B=F("baseUrls");let J=["employees","categories","locations","packages","entitiesRelations","customFields"];s.value.cabinetType==="employee"&&(J=J.concat(["taxes","spaces","tags","settings"])),t.dispatch("entities/getEntities",{types:J,licence:"basic",loadEntities:!0,showHidden:!0,isPanel:!0});let G=_(()=>t.getters.getReady),X=M(s.value.appointments||!s.value.events?"appointments":"events"),K=M({profile:Ge(s.value.cabinetType==="employee"?F0:Dm)});(s.value.appointments||!s.value.events)&&(K.value.appointments=Ge(vw)),(s.value.events||!s.value.appointments)&&(K.value.events=Ge(NS)),(s.value.appointments||!s.value.events)&&(o.isPro||o.isDeveloper)&&(K.value.packages=Ge(mE));const Q=M([{key:"profile",icon:"user",pageLabel:b.value.my_profile,label:_(()=>r.value==="cape"?`${t.getters["auth/getProfile"].firstName} ${t.getters["auth/getProfile"].lastName}`:f.value.profile.options.lastName.visibility?`${t.getters["auth/getProfile"].firstName} ${t.getters["auth/getProfile"].lastName}`:`${t.getters["auth/getProfile"].firstName}`)}]);(s.value.appointments||!s.value.events)&&Q.value.push({key:"appointments",icon:"service",label:b.value.appointments}),(s.value.events||!s.value.appointments)&&Q.value.push({key:"events",icon:"star-outline",label:b.value.events}),s.value.cabinetType==="customer"&&(s.value.appointments||!s.value.events)&&(o.isPro||o.isDeveloper)&&Q.value.push({key:"packages",icon:"shipment",label:b.value.packages}),Be("sidebarSteps",Q),Je(()=>{le.value=Q.value.findIndex(Z=>Z.key===X.value)});let le=M(0);function H(Z,ce){s.value.cabinetType==="employee"&&(Z.key!=="appointments"&&(t.commit("appointment/resetAppointment",{providerId:t.getters["auth/getProfile"].id,categoryId:null,serviceId:null,locationId:null}),t.commit("customerInfo/setCustomers",[]),t.commit("customerInfo/setCustomersIds",[])),Z.key!=="events"&&(t.commit("event/setEvent",{settings:$s(g,t.getters["event/getSettings"],{},{})}),t.commit("attendee/setAttendee",Es(t,t.getters["attendee/getDefaultAttendee"])))),X.value=Z.key,le.value=ce,t.commit("cabinetFilters/setResetFilters")}function se(Z){s.value.cabinetType==="employee"&&s.value.profile&&Z.step.key==="profile"||(H(Z.step,Z.index),t.commit("cabinetFilters/setResetFilters"))}function ge(){t.dispatch("auth/logout")}function $e(){C.value=!1,ge()}let ue=M(0);function ae(){ue.value++}let me=_(()=>{switch(Q.value[le.value].key){case"profile":return Q.value[le.value].pageLabel;case"appointments":return t.getters["appointment/getActive"]&&!t.getters["appointment/getId"]?b.value.new_appointment:t.getters["appointment/getActive"]&&t.getters["appointment/getId"]?b.value.edit_appointment:Q.value[le.value].label;case"events":return t.getters["attendee/getActive"]&&!t.getters["attendee/getId"]?b.value.event_add_attendee:t.getters["attendee/getActive"]&&t.getters["attendee/getId"]?b.value.event_edit_attendee:t.getters["event/getActive"]&&!t.getters["event/getId"]?b.value.new_event:t.getters["event/getActive"]&&t.getters["event/getId"]?b.value.edit_event:Q.value[le.value].label;default:return Q.value[le.value].label}});Be("bookingsCounterChanger",{bookingsCounterChanger:ae});const Y=F("timeZone");gn(()=>{if(!g.general.showClientTimeZone){let Z=Y.value;e.get("ameliaUserTimeZone")&&(Z=e.get("ameliaUserTimeZone")),t.commit("cabinet/setTimeZone",Z)}t.getters["cabinet/getTimeZone"]||t.commit("cabinet/setTimeZone",an())});let j=_(()=>f.value.colors);Be("amColors",j);let te=_(()=>({"--am-c-primary":j.value.colorPrimary,"--am-c-success":j.value.colorSuccess,"--am-c-error":j.value.colorError,"--am-c-warning":j.value.colorWarning,"--am-c-main-bgr":j.value.colorMainBgr,"--am-c-main-heading-text":j.value.colorMainHeadingText,"--am-c-main-text":j.value.colorMainText,"--am-c-sb-bgr":j.value.colorSbBgr,"--am-c-sb-text":j.value.colorSbText,"--am-c-inp-bgr":j.value.colorInpBgr,"--am-c-inp-border":j.value.colorInpBorder,"--am-c-inp-text":j.value.colorInpText,"--am-c-inp-placeholder":j.value.colorInpPlaceHolder,"--am-c-drop-bgr":j.value.colorDropBgr,"--am-c-drop-text":j.value.colorDropText,"--am-c-btn-prim":j.value.colorBtnPrim,"--am-c-btn-prim-text":j.value.colorBtnPrimText,"--am-c-btn-sec":j.value.colorBtnSec,"--am-c-btn-sec-text":j.value.colorBtnSecText,"--am-c-btn-danger":j.value.colorBtnDanger,"--am-c-btn-danger-text":j.value.colorBtnDangerText,"--am-c-skeleton-op20":W(j.value.colorMainText,.2),"--am-c-skeleton-op60":W(j.value.colorMainText,.6),"--am-c-skeleton-sb-op20":W(j.value.colorSbText,.2),"--am-c-skeleton-sb-op60":W(j.value.colorSbText,.6),"--am-c-scroll-op30":W(j.value.colorPrimary,.3),"--am-c-scroll-op10":W(j.value.colorPrimary,.1),"--am-font-family":v.value.fontFamily,"--am-rad-input":"6px","--am-fs-input":"15px","--am-mw-main":D.value?h.value?"858px":"1024px":"520px","--am-brad-main":D.value?"0 0.5rem 0.5rem 0":"0.5rem"})),de=_(()=>({"--am-c-msd-bgr":j.value.colorSbBgr,"--am-c-msd-text":j.value.colorSbText,"--am-c-msd-text-op05":W(j.value.colorSbText,.05),"--am-c-msd-text-op10":W(j.value.colorSbText,.1),"--am-c-msd-text-op60":W(j.value.colorSbText,.6)}));return(Z,ce)=>(u(),x(ee,null,[v.value.customFontSelected?N("",!0):(u(),x(ee,{key:0},[pE,gE,d("link",{rel:"stylesheet",type:"text/css",href:`${a(B).wpAmeliaPluginURL}v3/src/assets/scss/common/fonts/font.css`,media:"all"},null,8,fE)],64)),d("div",{id:"amelia-container",ref_key:"ameliaContainer",ref:c,class:R(["am-cap__wrapper",[{"am-collapsed":a(h)},{"am-auth":!a(l)}]]),style:be(a(te))},[a(l)?N("",!0):(u(),q(wm,{key:0})),a(l)?(u(),x(ee,{key:1},[a(D)?(u(),q(Gu,{key:0,class:R(["am-fs-sb",{"am-collapsed":a(h)}]),style:be({width:a(h)?"72px":"240px",paddingBottom:`${a(A)+16}px`})},{"step-list":S(()=>[d("div",hE,[(u(!0),x(ee,null,pe(Q.value,(fe,Ne)=>(u(),x(ee,{key:fe.key},[fe.key!=="packages"||a(t).getters["entities/getPackages"].length?(u(),x("div",{key:0,class:R(["am-fs-sb__page",{selected:a(X)===fe.key}]),style:be({"pointer-events":a(s).cabinetType==="employee"&&a(s).profile&&fe.key==="profile"?"none":""}),onClick:()=>{a(s).cabinetType==="employee"&&a(s).profile&&fe.key==="profile"||H(fe,Ne)}},[d("div",{class:R(["am-fs-sb__page-inner",{"am-collapsed":a(h)}])},[d("div",_E,[d("span",{class:R(`am-icon-${fe.icon}`)},null,2)]),$(_a,{name:"fade"},{default:S(()=>[a(h)?N("",!0):(u(),x("p",{key:0,class:R(["am-fs-sb__page-heading",a(I)])},w(fe.label),3))]),_:2},1024),$(_a,{name:"fade"},{default:S(()=>[a(h)?N("",!0):(u(),x("div",{key:0,class:R(["am-fs-sb__page-indicator",a(I)])},bE,2))]),_:1})],2)],14,vE)):N("",!0),Ne===0&&Q.value[0].key==="profile"?(u(),x("div",kE)):N("",!0)],64))),128))])]),"support-info":S(()=>[d("div",{ref_key:"sidebarFooterRef",ref:O,class:"am-fs-sb__footer"},[d("div",{class:"am-fs-sb__page",onClick:ce[0]||(ce[0]=fe=>ye(h)?h.value=!a(h):h=!a(h))},[d("div",CE,[xE,$(_a,{name:"fade"},{default:S(()=>[a(h)?N("",!0):(u(),x("p",{key:0,class:R(["am-fs-sb__page-heading",a(I)])},w(a(b).toggle_sidebar),3))]),_:1})])]),wE,d("div",{class:"am-fs-sb__page",onClick:ge},[d("div",TE,[SE,$(_a,{name:"fade"},{default:S(()=>[a(h)?N("",!0):(u(),x("p",{key:0,class:R(["am-fs-sb__page-heading",a(I)])},w(a(b).log_out),3))]),_:1})])])],512)]),_:1},8,["class","style"])):N("",!0),$(Ju,{"max-width":786,"old-responsive":!1},{header:S(()=>[$(ad,{ready:a(G)},{default:S(()=>[d("div",EE,[d("div",LE,w(a(me)),1),a(D)?N("",!0):(u(),x("div",{key:0,class:"am-caph__menu",onClick:ce[1]||(ce[1]=()=>ye(C)?C.value=!a(C):C=!a(C))},$E)),a(z)&&a(D)&&(a(s).cabinetType==="customer"?a(X)!=="profile"&&a(E).timeZone.visibility:!0)?(u(),q(Ti,{key:1})):N("",!0),$($d,{"menu-items":Q.value,monitor:a(X),visibility:a(C),"custom-css":a(de),"customized-labels":a(b),position:"right",width:240,"onUpdate:visibility":ce[2]||(ce[2]=fe=>ye(C)?C.value=fe:C=fe),onClick:se,onLogout:$e},null,8,["menu-items","monitor","visibility","custom-css","customized-labels"])])]),_:1},8,["ready"])]),step:S(()=>[(u(),q(Ct(a(K)[a(X)]),{class:"am-fs__main-content","load-bookings-counter":a(ue)},null,8,["load-bookings-counter"]))]),_:1})],64)):N("",!0)],6)],64))}});var UE=Object.freeze(Object.defineProperty({__proto__:null,default:OE},Symbol.toStringTag,{value:"Module"}));export{UE as C,st as _,od as a,Ht as b,gd as c,ad as d,$d as e,BE as f,ME as g,Rt as h,oa as i,Ku as j,Wr as u};
