import{g as wl,a as Sl}from"./chunks/_commonjsHelpers-DcgyVupF.js";var $n,Jr,Cn,vr,Yt,Wr,gr,ke,Nn;(function(s){s.POST_MESSAGE="postMessage"})($n||($n={})),(function(s){s.POST_MESSAGE="postMessage"})(Jr||(Jr={})),(function(s){s.STREAMABLE_HTTP="streamableHttp",s.SSE="sse"})(Cn||(Cn={})),(function(s){s.LOCAL="local",s.REMOTE="remote"})(vr||(vr={})),(function(s){s.SDK_ANGIE_READY_PING="sdk-angie-ready-ping",s.SDK_ANGIE_REFRESH_PING="sdk-angie-refresh-ping",s.SDK_REQUEST_CLIENT_CREATION="sdk-request-client-creation",s.SDK_REQUEST_INIT_SERVER="sdk-request-init-server",s.SDK_TRIGGER_ANGIE="sdk-trigger-angie",s.SDK_TRIGGER_ANGIE_RESPONSE="sdk-trigger-angie-response"})(Yt||(Yt={})),(function(s){s.SET="ANGIE_SET_LOCALSTORAGE",s.GET="ANGIE_GET_LOCALSTORAGE"})(Wr||(Wr={})),(function(s){s.RESET_HASH="reset-hash",s.HOST_READY="host/ready",s.ANGIE_LOADED="angie/loaded",s.ANGIE_READY="angie/ready"})(gr||(gr={}));class El{isAngieReady=!1;readyPromise;readyResolve;constructor(){if(this.readyPromise=new Promise(a=>{this.readyResolve=a}),typeof window>"u")return;let e=0;const r=()=>{if(this.isAngieReady||e>=500)return void(!this.isAngieReady&&e>=500&&this.handleDetectionTimeout());const a=new MessageChannel;a.port1.onmessage=n=>{this.handleAngieReady(n.data),a.port1.close(),a.port2.close()};const t={type:Yt.SDK_ANGIE_READY_PING,timestamp:Date.now()};window.postMessage(t,window.location.origin,[a.port2]),e++,setTimeout(r,500)};r()}handleAngieReady(e){this.isAngieReady=!0;const r={isReady:!0,version:e.version,capabilities:e.capabilities};this.readyResolve&&this.readyResolve(r)}handleDetectionTimeout(){this.readyResolve&&this.readyResolve({isReady:!1}),console.warn("AngieMcpSdk: AngieDetector: Detection timeout - Angie may not be available")}isReady(){return this.isAngieReady}async waitForReady(){return this.readyPromise}}class Pl{queue=[];isProcessing=!1;add(e){const r={id:this.generateId(e),config:e,timestamp:Date.now(),status:"pending"};return this.queue.push(r),console.log(`RegistrationQueue: Added server "${e.name}" to queue`),r}getAll(){return[...this.queue]}getPending(){return this.queue.filter(e=>e.status==="pending")}updateStatus(e,r,a){const t=this.queue.find(n=>n.id===e);t&&(t.status=r,a?t.error=a:r!=="pending"&&r!=="registered"||delete t.error,console.log(`RegistrationQueue: Updated server ${e} status to ${r}`))}async processQueue(e){if(this.isProcessing)return void console.log("RegistrationQueue: Already processing queue");this.isProcessing=!0;const r=this.getPending();console.log(`RegistrationQueue: Processing ${r.length} pending registrations`);try{for(const a of r)try{await e(a),this.updateStatus(a.id,"registered")}catch(t){const n=t instanceof Error?t.message:String(t);this.updateStatus(a.id,"failed",n),console.error(`RegistrationQueue: Failed to process registration ${a.id}:`,n)}}finally{this.isProcessing=!1}}clear(){this.queue=[],console.log("RegistrationQueue: Cleared all registrations")}resetAllToPending(){if(this.isProcessing)return console.log("RegistrationQueue: Cannot reset to pending - processing in progress"),!1;const e=this.queue.filter(a=>a.status==="registered").length,r=this.queue.filter(a=>a.status==="failed").length;return this.queue.forEach(a=>{a.status!=="pending"&&(a.status="pending",delete a.error)}),console.log(`RegistrationQueue: Reset ${e+r} registrations to pending`),!0}remove(e){const r=this.queue.findIndex(a=>a.id===e);return r!==-1&&(this.queue.splice(r,1),console.log(`RegistrationQueue: Removed registration ${e}`),!0)}generateId(e){return`reg_${e.name}_${e.version}_${Date.now()}`}}class xl{async requestClientCreation(e){const{config:r}=e,a={serverId:e.id,serverName:r.name,serverVersion:r.version,description:r.description,transport:r.transport||Jr.POST_MESSAGE,capabilities:r.capabilities,instanceId:e.instanceId};return"type"in r&&r.type==="remote"&&(a.remote={url:r.url}),new Promise((t,n)=>{const i=new MessageChannel,o=setTimeout(()=>{n(new Error("Client creation request timed out after 15000ms"))},15e3);i.port1.onmessage=c=>{clearTimeout(o),t(c.data)};const l={type:Yt.SDK_REQUEST_CLIENT_CREATION,payload:a,timestamp:Date.now()};window.postMessage(l,window.location.origin,[i.port2])})}}(function(s){s.assertEqual=e=>{},s.assertIs=function(e){},s.assertNever=function(e){throw new Error},s.arrayToEnum=e=>{const r={};for(const a of e)r[a]=a;return r},s.getValidEnumValues=e=>{const r=s.objectKeys(e).filter(t=>typeof e[e[t]]!="number"),a={};for(const t of r)a[t]=e[t];return s.objectValues(a)},s.objectValues=e=>s.objectKeys(e).map(function(r){return e[r]}),s.objectKeys=typeof Object.keys=="function"?e=>Object.keys(e):e=>{const r=[];for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.push(a);return r},s.find=(e,r)=>{for(const a of e)if(r(a))return a},s.isInteger=typeof Number.isInteger=="function"?e=>Number.isInteger(e):e=>typeof e=="number"&&Number.isFinite(e)&&Math.floor(e)===e,s.joinValues=function(e,r=" | "){return e.map(a=>typeof a=="string"?`'${a}'`:a).join(r)},s.jsonStringifyReplacer=(e,r)=>typeof r=="bigint"?r.toString():r})(ke||(ke={})),(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(Nn||(Nn={}));const J=ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jt=s=>{switch(typeof s){case"undefined":return J.undefined;case"string":return J.string;case"number":return Number.isNaN(s)?J.nan:J.number;case"boolean":return J.boolean;case"function":return J.function;case"bigint":return J.bigint;case"symbol":return J.symbol;case"object":return Array.isArray(s)?J.array:s===null?J.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?J.promise:typeof Map<"u"&&s instanceof Map?J.map:typeof Set<"u"&&s instanceof Set?J.set:typeof Date<"u"&&s instanceof Date?J.date:J.object;default:return J.unknown}},F=ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Bt extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof Bt))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ke.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},a=[];for(const t of this.issues)if(t.path.length>0){const n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}Bt.create=s=>new Bt(s);const xs=(s,e)=>{let r;switch(s.code){case F.invalid_type:r=s.received===J.undefined?"Required":`Expected ${s.expected}, received ${s.received}`;break;case F.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,ke.jsonStringifyReplacer)}`;break;case F.unrecognized_keys:r=`Unrecognized key(s) in object: ${ke.joinValues(s.keys,", ")}`;break;case F.invalid_union:r="Invalid input";break;case F.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ke.joinValues(s.options)}`;break;case F.invalid_enum_value:r=`Invalid enum value. Expected ${ke.joinValues(s.options)}, received '${s.received}'`;break;case F.invalid_arguments:r="Invalid function arguments";break;case F.invalid_return_type:r="Invalid function return type";break;case F.invalid_date:r="Invalid date";break;case F.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:ke.assertNever(s.validation):r=s.validation!=="regex"?`Invalid ${s.validation}`:"Invalid";break;case F.too_small:r=s.type==="array"?`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"||s.type==="bigint"?`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:"Invalid input";break;case F.too_big:r=s.type==="array"?`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:"Invalid input";break;case F.custom:r="Invalid input";break;case F.invalid_intersection_types:r="Intersection results could not be merged";break;case F.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case F.not_finite:r="Number must be finite";break;default:r=e.defaultError,ke.assertNever(s)}return{message:r}};let Rl=xs;var X;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(X||(X={}));function B(s,e){const r=Rl,a=(t=>{const{data:n,path:i,errorMaps:o,issueData:l}=t,c=[...i,...l.path||[]],h={...l,path:c};if(l.message!==void 0)return{...l,path:c,message:l.message};let p="";const y=o.filter(u=>!!u).slice().reverse();for(const u of y)p=u(h,{data:n,defaultError:p}).message;return{...l,path:c,message:p}})({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===xs?void 0:xs].filter(t=>!!t)});s.common.issues.push(a)}class ot{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const a=[];for(const t of r){if(t.status==="aborted")return ne;t.status==="dirty"&&e.dirty(),a.push(t.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){const a=[];for(const t of r){const n=await t.key,i=await t.value;a.push({key:n,value:i})}return ot.mergeObjectSync(e,a)}static mergeObjectSync(e,r){const a={};for(const t of r){const{key:n,value:i}=t;if(n.status==="aborted"||i.status==="aborted")return ne;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value==="__proto__"||i.value===void 0&&!t.alwaysSet||(a[n.value]=i.value)}return{status:e.value,value:a}}}const ne=Object.freeze({status:"aborted"}),Rs=s=>({status:"dirty",value:s}),yt=s=>({status:"valid",value:s}),Dn=s=>s.status==="aborted",jn=s=>s.status==="dirty",_r=s=>s.status==="valid",Yr=s=>typeof Promise<"u"&&s instanceof Promise;class Nt{constructor(e,r,a,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=t}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ln=(s,e)=>{if(_r(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Bt(s.common.issues);return this._error=r,this._error}}};function ye(s){if(!s)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(n,i)=>{const{message:o}=s;return n.code==="invalid_enum_value"?{message:o??i.defaultError}:i.data===void 0?{message:o??a??i.defaultError}:n.code!=="invalid_type"?{message:i.defaultError}:{message:o??r??i.defaultError}},description:t}}class xe{get description(){return this._def.description}_getType(e){return Jt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Jt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ot,ctx:{common:e.parent.common,data:e.data,parsedType:Jt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Yr(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){const a={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jt(e)},t=this._parseSync({data:e,path:a.path,parent:a});return Ln(a,t)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jt(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:r});return _r(a)?{value:a.value}:{issues:r.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>_r(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,r){const a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){const a={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jt(e)},t=this._parse({data:e,path:a.path,parent:a}),n=await(Yr(t)?t:Promise.resolve(t));return Ln(a,n)}refine(e,r){const a=t=>typeof r=="string"||r===void 0?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{const i=e(t),o=()=>n.addIssue({code:F.custom,...a(t)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>!!l||(o(),!1)):!!i||(o(),!1)})}refinement(e,r){return this._refinement((a,t)=>!!e(a)||(t.addIssue(typeof r=="function"?r(a,t):r),!1))}_refinement(e){return new ar({schema:this,typeName:oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Vt.create(this,this._def)}nullable(){return ir.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return $t.create(this)}promise(){return aa.create(this,this._def)}or(e){return ea.create([this,e],this._def)}and(e){return ta.create(this,e,this._def)}transform(e){return new ar({...ye(this._def),schema:this,typeName:oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new sa({...ye(this._def),innerType:this,defaultValue:r,typeName:oe.ZodDefault})}brand(){return new vo({typeName:oe.ZodBranded,type:this,...ye(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new na({...ye(this._def),innerType:this,catchValue:r,typeName:oe.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return en.create(this,e)}readonly(){return ia.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const kl=/^c[^\s-]{8,}$/i,Il=/^[0-9a-z]+$/,Al=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Tl=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ol=/^[a-z0-9_-]{21}$/i,$l=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Cl=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Nl=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Ta;const Dl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,jl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ll=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ml=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ql=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Zl=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,fo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Fl=new RegExp(`^${fo}$`);function po(s){let e="[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),`([01]\\d|2[0-3]):[0-5]\\d(:${e})${s.precision?"+":"?"}`}function zl(s){return new RegExp(`^${po(s)}$`)}function Ul(s){let e=`${fo}T${po(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Vl(s,e){return!(e!=="v4"&&e||!Dl.test(s))||!(e!=="v6"&&e||!Ll.test(s))}function Hl(s,e){if(!$l.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(a));return!(typeof t!="object"||t===null||"typ"in t&&t?.typ!=="JWT"||!t.alg||e&&t.alg!==e)}catch{return!1}}function Bl(s,e){return!(e!=="v4"&&e||!jl.test(s))||!(e!=="v6"&&e||!Ml.test(s))}class zt extends xe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==J.string){const t=this._getOrReturnCtx(e);return B(t,{code:F.invalid_type,expected:J.string,received:t.parsedType}),ne}const r=new ot;let a;for(const t of this._def.checks)if(t.kind==="min")e.data.length<t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:F.too_small,minimum:t.value,type:"string",inclusive:!0,exact:!1,message:t.message}),r.dirty());else if(t.kind==="max")e.data.length>t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:F.too_big,maximum:t.value,type:"string",inclusive:!0,exact:!1,message:t.message}),r.dirty());else if(t.kind==="length"){const n=e.data.length>t.value,i=e.data.length<t.value;(n||i)&&(a=this._getOrReturnCtx(e,a),n?B(a,{code:F.too_big,maximum:t.value,type:"string",inclusive:!0,exact:!0,message:t.message}):i&&B(a,{code:F.too_small,minimum:t.value,type:"string",inclusive:!0,exact:!0,message:t.message}),r.dirty())}else if(t.kind==="email")Nl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"email",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="emoji")Ta||(Ta=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ta.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"emoji",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="uuid")Tl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"uuid",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="nanoid")Ol.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"nanoid",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="cuid")kl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"cuid",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="cuid2")Il.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"cuid2",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="ulid")Al.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"ulid",code:F.invalid_string,message:t.message}),r.dirty());else if(t.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),B(a,{validation:"url",code:F.invalid_string,message:t.message}),r.dirty()}else t.kind==="regex"?(t.regex.lastIndex=0,t.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"regex",code:F.invalid_string,message:t.message}),r.dirty())):t.kind==="trim"?e.data=e.data.trim():t.kind==="includes"?e.data.includes(t.value,t.position)||(a=this._getOrReturnCtx(e,a),B(a,{code:F.invalid_string,validation:{includes:t.value,position:t.position},message:t.message}),r.dirty()):t.kind==="toLowerCase"?e.data=e.data.toLowerCase():t.kind==="toUpperCase"?e.data=e.data.toUpperCase():t.kind==="startsWith"?e.data.startsWith(t.value)||(a=this._getOrReturnCtx(e,a),B(a,{code:F.invalid_string,validation:{startsWith:t.value},message:t.message}),r.dirty()):t.kind==="endsWith"?e.data.endsWith(t.value)||(a=this._getOrReturnCtx(e,a),B(a,{code:F.invalid_string,validation:{endsWith:t.value},message:t.message}),r.dirty()):t.kind==="datetime"?Ul(t).test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:F.invalid_string,validation:"datetime",message:t.message}),r.dirty()):t.kind==="date"?Fl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:F.invalid_string,validation:"date",message:t.message}),r.dirty()):t.kind==="time"?zl(t).test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:F.invalid_string,validation:"time",message:t.message}),r.dirty()):t.kind==="duration"?Cl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"duration",code:F.invalid_string,message:t.message}),r.dirty()):t.kind==="ip"?Vl(e.data,t.version)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"ip",code:F.invalid_string,message:t.message}),r.dirty()):t.kind==="jwt"?Hl(e.data,t.alg)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"jwt",code:F.invalid_string,message:t.message}),r.dirty()):t.kind==="cidr"?Bl(e.data,t.version)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"cidr",code:F.invalid_string,message:t.message}),r.dirty()):t.kind==="base64"?ql.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"base64",code:F.invalid_string,message:t.message}),r.dirty()):t.kind==="base64url"?Zl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"base64url",code:F.invalid_string,message:t.message}),r.dirty()):ke.assertNever(t);return{status:r.value,value:e.data}}_regex(e,r,a){return this.refinement(t=>e.test(t),{validation:r,code:F.invalid_string,...X.errToObj(a)})}_addCheck(e){return new zt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...X.errToObj(e)})}url(e){return this._addCheck({kind:"url",...X.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...X.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...X.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...X.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...X.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...X.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...X.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...X.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...X.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...X.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...X.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...X.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:e?.precision===void 0?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...X.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:e?.precision===void 0?null:e?.precision,...X.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...X.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...X.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...X.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...X.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...X.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...X.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...X.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...X.errToObj(r)})}nonempty(e){return this.min(1,X.errToObj(e))}trim(){return new zt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new zt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new zt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}function Gl(s,e){const r=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,t=r>a?r:a;return Number.parseInt(s.toFixed(t).replace(".",""))%Number.parseInt(e.toFixed(t).replace(".",""))/10**t}zt.create=s=>new zt({checks:[],typeName:oe.ZodString,coerce:s?.coerce??!1,...ye(s)});class br extends xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==J.number){const t=this._getOrReturnCtx(e);return B(t,{code:F.invalid_type,expected:J.number,received:t.parsedType}),ne}let r;const a=new ot;for(const t of this._def.checks)t.kind==="int"?ke.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:F.invalid_type,expected:"integer",received:"float",message:t.message}),a.dirty()):t.kind==="min"?(t.inclusive?e.data<t.value:e.data<=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:F.too_small,minimum:t.value,type:"number",inclusive:t.inclusive,exact:!1,message:t.message}),a.dirty()):t.kind==="max"?(t.inclusive?e.data>t.value:e.data>=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:F.too_big,maximum:t.value,type:"number",inclusive:t.inclusive,exact:!1,message:t.message}),a.dirty()):t.kind==="multipleOf"?Gl(e.data,t.value)!==0&&(r=this._getOrReturnCtx(e,r),B(r,{code:F.not_multiple_of,multipleOf:t.value,message:t.message}),a.dirty()):t.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:F.not_finite,message:t.message}),a.dirty()):ke.assertNever(t);return{status:a.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,X.toString(r))}gt(e,r){return this.setLimit("min",e,!1,X.toString(r))}lte(e,r){return this.setLimit("max",e,!0,X.toString(r))}lt(e,r){return this.setLimit("max",e,!1,X.toString(r))}setLimit(e,r,a,t){return new br({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:X.toString(t)}]})}_addCheck(e){return new br({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:X.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:X.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:X.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:X.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:X.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:X.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:X.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:X.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:X.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ke.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}}br.create=s=>new br({checks:[],typeName:oe.ZodNumber,coerce:s?.coerce||!1,...ye(s)});class Tr extends xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==J.bigint)return this._getInvalidInput(e);let r;const a=new ot;for(const t of this._def.checks)t.kind==="min"?(t.inclusive?e.data<t.value:e.data<=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:F.too_small,type:"bigint",minimum:t.value,inclusive:t.inclusive,message:t.message}),a.dirty()):t.kind==="max"?(t.inclusive?e.data>t.value:e.data>=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:F.too_big,type:"bigint",maximum:t.value,inclusive:t.inclusive,message:t.message}),a.dirty()):t.kind==="multipleOf"?e.data%t.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),B(r,{code:F.not_multiple_of,multipleOf:t.value,message:t.message}),a.dirty()):ke.assertNever(t);return{status:a.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.bigint,received:r.parsedType}),ne}gte(e,r){return this.setLimit("min",e,!0,X.toString(r))}gt(e,r){return this.setLimit("min",e,!1,X.toString(r))}lte(e,r){return this.setLimit("max",e,!0,X.toString(r))}lt(e,r){return this.setLimit("max",e,!1,X.toString(r))}setLimit(e,r,a,t){return new Tr({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:X.toString(t)}]})}_addCheck(e){return new Tr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:X.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:X.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:X.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:X.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:X.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Tr.create=s=>new Tr({checks:[],typeName:oe.ZodBigInt,coerce:s?.coerce??!1,...ye(s)});class ks extends xe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==J.boolean){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.boolean,received:r.parsedType}),ne}return yt(e.data)}}ks.create=s=>new ks({typeName:oe.ZodBoolean,coerce:s?.coerce||!1,...ye(s)});class Xr extends xe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==J.date){const t=this._getOrReturnCtx(e);return B(t,{code:F.invalid_type,expected:J.date,received:t.parsedType}),ne}if(Number.isNaN(e.data.getTime()))return B(this._getOrReturnCtx(e),{code:F.invalid_date}),ne;const r=new ot;let a;for(const t of this._def.checks)t.kind==="min"?e.data.getTime()<t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:F.too_small,message:t.message,inclusive:!0,exact:!1,minimum:t.value,type:"date"}),r.dirty()):t.kind==="max"?e.data.getTime()>t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:F.too_big,message:t.message,inclusive:!0,exact:!1,maximum:t.value,type:"date"}),r.dirty()):ke.assertNever(t);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Xr({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:X.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:X.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Xr.create=s=>new Xr({checks:[],coerce:s?.coerce||!1,typeName:oe.ZodDate,...ye(s)});class Mn extends xe{_parse(e){if(this._getType(e)!==J.symbol){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.symbol,received:r.parsedType}),ne}return yt(e.data)}}Mn.create=s=>new Mn({typeName:oe.ZodSymbol,...ye(s)});class Is extends xe{_parse(e){if(this._getType(e)!==J.undefined){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.undefined,received:r.parsedType}),ne}return yt(e.data)}}Is.create=s=>new Is({typeName:oe.ZodUndefined,...ye(s)});class As extends xe{_parse(e){if(this._getType(e)!==J.null){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.null,received:r.parsedType}),ne}return yt(e.data)}}As.create=s=>new As({typeName:oe.ZodNull,...ye(s)});class qn extends xe{constructor(){super(...arguments),this._any=!0}_parse(e){return yt(e.data)}}qn.create=s=>new qn({typeName:oe.ZodAny,...ye(s)});class Ts extends xe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return yt(e.data)}}Ts.create=s=>new Ts({typeName:oe.ZodUnknown,...ye(s)});class Xt extends xe{_parse(e){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.never,received:r.parsedType}),ne}}Xt.create=s=>new Xt({typeName:oe.ZodNever,...ye(s)});class Zn extends xe{_parse(e){if(this._getType(e)!==J.undefined){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.void,received:r.parsedType}),ne}return yt(e.data)}}Zn.create=s=>new Zn({typeName:oe.ZodVoid,...ye(s)});class $t extends xe{_parse(e){const{ctx:r,status:a}=this._processInputParams(e),t=this._def;if(r.parsedType!==J.array)return B(r,{code:F.invalid_type,expected:J.array,received:r.parsedType}),ne;if(t.exactLength!==null){const i=r.data.length>t.exactLength.value,o=r.data.length<t.exactLength.value;(i||o)&&(B(r,{code:i?F.too_big:F.too_small,minimum:o?t.exactLength.value:void 0,maximum:i?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),a.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&(B(r,{code:F.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),a.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&(B(r,{code:F.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((i,o)=>t.type._parseAsync(new Nt(r,i,r.path,o)))).then(i=>ot.mergeArray(a,i));const n=[...r.data].map((i,o)=>t.type._parseSync(new Nt(r,i,r.path,o)));return ot.mergeArray(a,n)}get element(){return this._def.type}min(e,r){return new $t({...this._def,minLength:{value:e,message:X.toString(r)}})}max(e,r){return new $t({...this._def,maxLength:{value:e,message:X.toString(r)}})}length(e,r){return new $t({...this._def,exactLength:{value:e,message:X.toString(r)}})}nonempty(e){return this.min(1,e)}}function pr(s){if(s instanceof Qe){const e={};for(const r in s.shape){const a=s.shape[r];e[r]=Vt.create(pr(a))}return new Qe({...s._def,shape:()=>e})}return s instanceof $t?new $t({...s._def,type:pr(s.element)}):s instanceof Vt?Vt.create(pr(s.unwrap())):s instanceof ir?ir.create(pr(s.unwrap())):s instanceof sr?sr.create(s.items.map(e=>pr(e))):s}$t.create=(s,e)=>new $t({type:s,minLength:null,maxLength:null,exactLength:null,typeName:oe.ZodArray,...ye(e)});class Qe extends xe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=ke.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==J.object){const l=this._getOrReturnCtx(e);return B(l,{code:F.invalid_type,expected:J.object,received:l.parsedType}),ne}const{status:r,ctx:a}=this._processInputParams(e),{shape:t,keys:n}=this._getCached(),i=[];if(!(this._def.catchall instanceof Xt&&this._def.unknownKeys==="strip"))for(const l in a.data)n.includes(l)||i.push(l);const o=[];for(const l of n){const c=t[l],h=a.data[l];o.push({key:{status:"valid",value:l},value:c._parse(new Nt(a,h,a.path,l)),alwaysSet:l in a.data})}if(this._def.catchall instanceof Xt){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of i)o.push({key:{status:"valid",value:c},value:{status:"valid",value:a.data[c]}});else if(l==="strict")i.length>0&&(B(a,{code:F.unrecognized_keys,keys:i}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of i){const h=a.data[c];o.push({key:{status:"valid",value:c},value:l._parse(new Nt(a,h,a.path,c)),alwaysSet:c in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of o){const h=await c.key,p=await c.value;l.push({key:h,value:p,alwaysSet:c.alwaysSet})}return l}).then(l=>ot.mergeObjectSync(r,l)):ot.mergeObjectSync(r,o)}get shape(){return this._def.shape()}strict(e){return X.errToObj,new Qe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{const t=this._def.errorMap?.(r,a).message??a.defaultError;return r.code==="unrecognized_keys"?{message:X.errToObj(e).message??t}:{message:t}}}:{}})}strip(){return new Qe({...this._def,unknownKeys:"strip"})}passthrough(){return new Qe({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:oe.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Qe({...this._def,catchall:e})}pick(e){const r={};for(const a of ke.objectKeys(e))e[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new Qe({...this._def,shape:()=>r})}omit(e){const r={};for(const a of ke.objectKeys(this.shape))e[a]||(r[a]=this.shape[a]);return new Qe({...this._def,shape:()=>r})}deepPartial(){return pr(this)}partial(e){const r={};for(const a of ke.objectKeys(this.shape)){const t=this.shape[a];e&&!e[a]?r[a]=t:r[a]=t.optional()}return new Qe({...this._def,shape:()=>r})}required(e){const r={};for(const a of ke.objectKeys(this.shape))if(e&&!e[a])r[a]=this.shape[a];else{let t=this.shape[a];for(;t instanceof Vt;)t=t._def.innerType;r[a]=t}return new Qe({...this._def,shape:()=>r})}keyof(){return mo(ke.objectKeys(this.shape))}}Qe.create=(s,e)=>new Qe({shape:()=>s,unknownKeys:"strip",catchall:Xt.create(),typeName:oe.ZodObject,...ye(e)}),Qe.strictCreate=(s,e)=>new Qe({shape:()=>s,unknownKeys:"strict",catchall:Xt.create(),typeName:oe.ZodObject,...ye(e)}),Qe.lazycreate=(s,e)=>new Qe({shape:s,unknownKeys:"strip",catchall:Xt.create(),typeName:oe.ZodObject,...ye(e)});class ea extends xe{_parse(e){const{ctx:r}=this._processInputParams(e),a=this._def.options;if(r.common.async)return Promise.all(a.map(async t=>{const n={...r,common:{...r.common,issues:[]},parent:null};return{result:await t._parseAsync({data:r.data,path:r.path,parent:n}),ctx:n}})).then(function(t){for(const i of t)if(i.result.status==="valid")return i.result;for(const i of t)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const n=t.map(i=>new Bt(i.ctx.common.issues));return B(r,{code:F.invalid_union,unionErrors:n}),ne});{let t;const n=[];for(const o of a){const l={...r,common:{...r.common,issues:[]},parent:null},c=o._parseSync({data:r.data,path:r.path,parent:l});if(c.status==="valid")return c;c.status!=="dirty"||t||(t={result:c,ctx:l}),l.common.issues.length&&n.push(l.common.issues)}if(t)return r.common.issues.push(...t.ctx.common.issues),t.result;const i=n.map(o=>new Bt(o));return B(r,{code:F.invalid_union,unionErrors:i}),ne}}get options(){return this._def.options}}ea.create=(s,e)=>new ea({options:s,typeName:oe.ZodUnion,...ye(e)});const Kt=s=>s instanceof $s?Kt(s.schema):s instanceof ar?Kt(s.innerType()):s instanceof ra?[s.value]:s instanceof nr?s.options:s instanceof Cs?ke.objectValues(s.enum):s instanceof sa?Kt(s._def.innerType):s instanceof Is?[void 0]:s instanceof As?[null]:s instanceof Vt?[void 0,...Kt(s.unwrap())]:s instanceof ir?[null,...Kt(s.unwrap())]:s instanceof vo||s instanceof ia?Kt(s.unwrap()):s instanceof na?Kt(s._def.innerType):[];class Ys extends xe{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.object)return B(r,{code:F.invalid_type,expected:J.object,received:r.parsedType}),ne;const a=this.discriminator,t=r.data[a],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):(B(r,{code:F.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),ne)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){const t=new Map;for(const n of r){const i=Kt(n.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(t.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);t.set(o,n)}}return new Ys({typeName:oe.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,...ye(a)})}}function Os(s,e){const r=Jt(s),a=Jt(e);if(s===e)return{valid:!0,data:s};if(r===J.object&&a===J.object){const t=ke.objectKeys(e),n=ke.objectKeys(s).filter(o=>t.indexOf(o)!==-1),i={...s,...e};for(const o of n){const l=Os(s[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}if(r===J.array&&a===J.array){if(s.length!==e.length)return{valid:!1};const t=[];for(let n=0;n<s.length;n++){const i=Os(s[n],e[n]);if(!i.valid)return{valid:!1};t.push(i.data)}return{valid:!0,data:t}}return r===J.date&&a===J.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class ta extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=(n,i)=>{if(Dn(n)||Dn(i))return ne;const o=Os(n.value,i.value);return o.valid?((jn(n)||jn(i))&&r.dirty(),{status:r.value,value:o.data}):(B(a,{code:F.invalid_intersection_types}),ne)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,i])=>t(n,i)):t(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}ta.create=(s,e,r)=>new ta({left:s,right:e,typeName:oe.ZodIntersection,...ye(r)});class sr extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.array)return B(a,{code:F.invalid_type,expected:J.array,received:a.parsedType}),ne;if(a.data.length<this._def.items.length)return B(a,{code:F.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ne;!this._def.rest&&a.data.length>this._def.items.length&&(B(a,{code:F.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const t=[...a.data].map((n,i)=>{const o=this._def.items[i]||this._def.rest;return o?o._parse(new Nt(a,n,a.path,i)):null}).filter(n=>!!n);return a.common.async?Promise.all(t).then(n=>ot.mergeArray(r,n)):ot.mergeArray(r,t)}get items(){return this._def.items}rest(e){return new sr({...this._def,rest:e})}}sr.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new sr({items:s,typeName:oe.ZodTuple,rest:null,...ye(e)})};class Xs extends xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.object)return B(a,{code:F.invalid_type,expected:J.object,received:a.parsedType}),ne;const t=[],n=this._def.keyType,i=this._def.valueType;for(const o in a.data)t.push({key:n._parse(new Nt(a,o,a.path,o)),value:i._parse(new Nt(a,a.data[o],a.path,o)),alwaysSet:o in a.data});return a.common.async?ot.mergeObjectAsync(r,t):ot.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,a){return new Xs(r instanceof xe?{keyType:e,valueType:r,typeName:oe.ZodRecord,...ye(a)}:{keyType:zt.create(),valueType:e,typeName:oe.ZodRecord,...ye(r)})}}class Fn extends xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.map)return B(a,{code:F.invalid_type,expected:J.map,received:a.parsedType}),ne;const t=this._def.keyType,n=this._def.valueType,i=[...a.data.entries()].map(([o,l],c)=>({key:t._parse(new Nt(a,o,a.path,[c,"key"])),value:n._parse(new Nt(a,l,a.path,[c,"value"]))}));if(a.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return ne;c.status!=="dirty"&&h.status!=="dirty"||r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}})}{const o=new Map;for(const l of i){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return ne;c.status!=="dirty"&&h.status!=="dirty"||r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}}}}Fn.create=(s,e,r)=>new Fn({valueType:e,keyType:s,typeName:oe.ZodMap,...ye(r)});class Or extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.set)return B(a,{code:F.invalid_type,expected:J.set,received:a.parsedType}),ne;const t=this._def;t.minSize!==null&&a.data.size<t.minSize.value&&(B(a,{code:F.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&a.data.size>t.maxSize.value&&(B(a,{code:F.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());const n=this._def.valueType;function i(l){const c=new Set;for(const h of l){if(h.status==="aborted")return ne;h.status==="dirty"&&r.dirty(),c.add(h.value)}return{status:r.value,value:c}}const o=[...a.data.values()].map((l,c)=>n._parse(new Nt(a,l,a.path,c)));return a.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,r){return new Or({...this._def,minSize:{value:e,message:X.toString(r)}})}max(e,r){return new Or({...this._def,maxSize:{value:e,message:X.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Or.create=(s,e)=>new Or({valueType:s,minSize:null,maxSize:null,typeName:oe.ZodSet,...ye(e)});class $s extends xe{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}$s.create=(s,e)=>new $s({getter:s,typeName:oe.ZodLazy,...ye(e)});class ra extends xe{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return B(r,{received:r.data,code:F.invalid_literal,expected:this._def.value}),ne}return{status:"valid",value:e.data}}get value(){return this._def.value}}function mo(s,e){return new nr({values:s,typeName:oe.ZodEnum,...ye(e)})}ra.create=(s,e)=>new ra({value:s,typeName:oe.ZodLiteral,...ye(e)});class nr extends xe{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),a=this._def.values;return B(r,{expected:ke.joinValues(a),received:r.parsedType,code:F.invalid_type}),ne}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),a=this._def.values;return B(r,{received:r.data,code:F.invalid_enum_value,options:a}),ne}return yt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return nr.create(e,{...this._def,...r})}exclude(e,r=this._def){return nr.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}}nr.create=mo;class Cs extends xe{_parse(e){const r=ke.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==J.string&&a.parsedType!==J.number){const t=ke.objectValues(r);return B(a,{expected:ke.joinValues(t),received:a.parsedType,code:F.invalid_type}),ne}if(this._cache||(this._cache=new Set(ke.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const t=ke.objectValues(r);return B(a,{received:a.data,code:F.invalid_enum_value,options:t}),ne}return yt(e.data)}get enum(){return this._def.values}}Cs.create=(s,e)=>new Cs({values:s,typeName:oe.ZodNativeEnum,...ye(e)});class aa extends xe{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.promise&&r.common.async===!1)return B(r,{code:F.invalid_type,expected:J.promise,received:r.parsedType}),ne;const a=r.parsedType===J.promise?r.data:Promise.resolve(r.data);return yt(a.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}}aa.create=(s,e)=>new aa({type:s,typeName:oe.ZodPromise,...ye(e)});class ar extends xe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:i=>{B(a,i),i.fatal?r.abort():r.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){const i=t.transform(a.data,n);if(a.common.async)return Promise.resolve(i).then(async o=>{if(r.value==="aborted")return ne;const l=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return l.status==="aborted"?ne:l.status==="dirty"||r.value==="dirty"?Rs(l.value):l});{if(r.value==="aborted")return ne;const o=this._def.schema._parseSync({data:i,path:a.path,parent:a});return o.status==="aborted"?ne:o.status==="dirty"||r.value==="dirty"?Rs(o.value):o}}if(t.type==="refinement"){const i=o=>{const l=t.refinement(o,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?ne:(o.status==="dirty"&&r.dirty(),i(o.value),{status:r.value,value:o.value})}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?ne:(o.status==="dirty"&&r.dirty(),i(o.value).then(()=>({status:r.value,value:o.value}))))}if(t.type==="transform"){if(a.common.async===!1){const i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!_r(i))return ne;const o=t.transform(i.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>_r(i)?Promise.resolve(t.transform(i.value,n)).then(o=>({status:r.value,value:o})):ne)}ke.assertNever(t)}}ar.create=(s,e,r)=>new ar({schema:s,typeName:oe.ZodEffects,effect:e,...ye(r)}),ar.createWithPreprocess=(s,e,r)=>new ar({schema:e,effect:{type:"preprocess",transform:s},typeName:oe.ZodEffects,...ye(r)});class Vt extends xe{_parse(e){return this._getType(e)===J.undefined?yt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Vt.create=(s,e)=>new Vt({innerType:s,typeName:oe.ZodOptional,...ye(e)});class ir extends xe{_parse(e){return this._getType(e)===J.null?yt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ir.create=(s,e)=>new ir({innerType:s,typeName:oe.ZodNullable,...ye(e)});class sa extends xe{_parse(e){const{ctx:r}=this._processInputParams(e);let a=r.data;return r.parsedType===J.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}sa.create=(s,e)=>new sa({innerType:s,typeName:oe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ye(e)});class na extends xe{_parse(e){const{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Yr(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Bt(a.common.issues)},input:a.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new Bt(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}na.create=(s,e)=>new na({innerType:s,typeName:oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ye(e)});class zn extends xe{_parse(e){if(this._getType(e)!==J.nan){const r=this._getOrReturnCtx(e);return B(r,{code:F.invalid_type,expected:J.nan,received:r.parsedType}),ne}return{status:"valid",value:e.data}}}zn.create=s=>new zn({typeName:oe.ZodNaN,...ye(s)});class vo extends xe{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class en extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{const t=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?ne:t.status==="dirty"?(r.dirty(),Rs(t.value)):this._def.out._parseAsync({data:t.value,path:a.path,parent:a})})();{const t=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?ne:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:a.path,parent:a})}}static create(e,r){return new en({in:e,out:r,typeName:oe.ZodPipeline})}}class ia extends xe{_parse(e){const r=this._def.innerType._parse(e),a=t=>(_r(t)&&(t.value=Object.freeze(t.value)),t);return Yr(r)?r.then(t=>a(t)):a(r)}unwrap(){return this._def.innerType}}var oe;ia.create=(s,e)=>new ia({innerType:s,typeName:oe.ZodReadonly,...ye(e)}),(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(oe||(oe={}));const Q=zt.create,it=br.create,pt=ks.create,$r=Ts.create,We=(Xt.create,$t.create),Y=Qe.create,nt=ea.create,Ql=Ys.create,jr=(ta.create,sr.create,Xs.create),me=ra.create,Gt=nr.create,L=(aa.create,Vt.create),_a=(ir.create,"2.0"),go=nt([Q(),it().int()]),yo=Q(),Kl=Y({progressToken:L(go)}).passthrough(),_t=Y({_meta:L(Kl)}).passthrough(),ht=Y({method:Q(),params:L(_t)}),Lr=Y({_meta:L(Y({}).passthrough())}).passthrough(),Lt=Y({method:Q(),params:L(Lr)}),bt=Y({_meta:L(Y({}).passthrough())}).passthrough(),ba=nt([Q(),it().int()]),Jl=Y({jsonrpc:me(_a),id:ba}).merge(ht).strict(),Wl=Y({jsonrpc:me(_a)}).merge(Lt).strict(),Yl=Y({jsonrpc:me(_a),id:ba,result:bt}).strict();var Un;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(Un||(Un={}));const Xl=nt([Jl,Wl,Yl,Y({jsonrpc:me(_a),id:ba,error:Y({code:it().int(),message:Q(),data:L($r())})}).strict()]),Vn=bt.strict(),Hn=Lt.extend({method:me("notifications/cancelled"),params:Lr.extend({requestId:ba,reason:Q().optional()})}),Mr=Y({name:Q(),title:L(Q())}).passthrough(),_o=Mr.extend({version:Q()}),ec=Y({experimental:L(Y({}).passthrough()),sampling:L(Y({}).passthrough()),elicitation:L(Y({}).passthrough()),roots:L(Y({listChanged:L(pt())}).passthrough())}).passthrough(),tc=ht.extend({method:me("initialize"),params:_t.extend({protocolVersion:Q(),capabilities:ec,clientInfo:_o})}),rc=Y({experimental:L(Y({}).passthrough()),logging:L(Y({}).passthrough()),completions:L(Y({}).passthrough()),prompts:L(Y({listChanged:L(pt())}).passthrough()),resources:L(Y({subscribe:L(pt()),listChanged:L(pt())}).passthrough()),tools:L(Y({listChanged:L(pt())}).passthrough())}).passthrough(),ac=bt.extend({protocolVersion:Q(),capabilities:rc,serverInfo:_o,instructions:L(Q())}),sc=Lt.extend({method:me("notifications/initialized")}),Bn=ht.extend({method:me("ping")}),nc=Y({progress:it(),total:L(it()),message:L(Q())}).passthrough(),Gn=Lt.extend({method:me("notifications/progress"),params:Lr.merge(nc).extend({progressToken:go})}),wa=ht.extend({params:_t.extend({cursor:L(yo)}).optional()}),Sa=bt.extend({nextCursor:L(yo)}),bo=Y({uri:Q(),mimeType:L(Q()),_meta:L(Y({}).passthrough())}).passthrough(),wo=bo.extend({text:Q()}),tn=Q().refine(s=>{try{return atob(s),!0}catch{return!1}},{message:"Invalid Base64 string"}),So=bo.extend({blob:tn}),Eo=Mr.extend({uri:Q(),description:L(Q()),mimeType:L(Q()),_meta:L(Y({}).passthrough())}),ic=Mr.extend({uriTemplate:Q(),description:L(Q()),mimeType:L(Q()),_meta:L(Y({}).passthrough())}),oc=wa.extend({method:me("resources/list")}),lc=Sa.extend({resources:We(Eo)}),cc=wa.extend({method:me("resources/templates/list")}),uc=Sa.extend({resourceTemplates:We(ic)}),dc=ht.extend({method:me("resources/read"),params:_t.extend({uri:Q()})}),hc=bt.extend({contents:We(nt([wo,So]))}),fc=Lt.extend({method:me("notifications/resources/list_changed")}),pc=ht.extend({method:me("resources/subscribe"),params:_t.extend({uri:Q()})}),mc=ht.extend({method:me("resources/unsubscribe"),params:_t.extend({uri:Q()})}),vc=Lt.extend({method:me("notifications/resources/updated"),params:Lr.extend({uri:Q()})}),gc=Y({name:Q(),description:L(Q()),required:L(pt())}).passthrough(),yc=Mr.extend({description:L(Q()),arguments:L(We(gc)),_meta:L(Y({}).passthrough())}),_c=wa.extend({method:me("prompts/list")}),bc=Sa.extend({prompts:We(yc)}),wc=ht.extend({method:me("prompts/get"),params:_t.extend({name:Q(),arguments:L(jr(Q()))})}),rn=Y({type:me("text"),text:Q(),_meta:L(Y({}).passthrough())}).passthrough(),an=Y({type:me("image"),data:tn,mimeType:Q(),_meta:L(Y({}).passthrough())}).passthrough(),sn=Y({type:me("audio"),data:tn,mimeType:Q(),_meta:L(Y({}).passthrough())}).passthrough(),Sc=Y({type:me("resource"),resource:nt([wo,So]),_meta:L(Y({}).passthrough())}).passthrough(),Po=nt([rn,an,sn,Eo.extend({type:me("resource_link")}),Sc]),Ec=Y({role:Gt(["user","assistant"]),content:Po}).passthrough(),Pc=bt.extend({description:L(Q()),messages:We(Ec)}),xc=Lt.extend({method:me("notifications/prompts/list_changed")}),Rc=Y({title:L(Q()),readOnlyHint:L(pt()),destructiveHint:L(pt()),idempotentHint:L(pt()),openWorldHint:L(pt())}).passthrough(),kc=Mr.extend({description:L(Q()),inputSchema:Y({type:me("object"),properties:L(Y({}).passthrough()),required:L(We(Q()))}).passthrough(),outputSchema:L(Y({type:me("object"),properties:L(Y({}).passthrough()),required:L(We(Q()))}).passthrough()),annotations:L(Rc),_meta:L(Y({}).passthrough())}),Ic=wa.extend({method:me("tools/list")}),Ac=Sa.extend({tools:We(kc)}),xo=bt.extend({content:We(Po).default([]),structuredContent:Y({}).passthrough().optional(),isError:L(pt())}),Tc=(xo.or(bt.extend({toolResult:$r()})),ht.extend({method:me("tools/call"),params:_t.extend({name:Q(),arguments:L(jr($r()))})})),Oc=Lt.extend({method:me("notifications/tools/list_changed")}),Ro=Gt(["debug","info","notice","warning","error","critical","alert","emergency"]),$c=ht.extend({method:me("logging/setLevel"),params:_t.extend({level:Ro})}),Cc=Lt.extend({method:me("notifications/message"),params:Lr.extend({level:Ro,logger:L(Q()),data:$r()})}),Nc=Y({name:Q().optional()}).passthrough(),Dc=Y({hints:L(We(Nc)),costPriority:L(it().min(0).max(1)),speedPriority:L(it().min(0).max(1)),intelligencePriority:L(it().min(0).max(1))}).passthrough(),jc=Y({role:Gt(["user","assistant"]),content:nt([rn,an,sn])}).passthrough(),Lc=ht.extend({method:me("sampling/createMessage"),params:_t.extend({messages:We(jc),systemPrompt:L(Q()),includeContext:L(Gt(["none","thisServer","allServers"])),temperature:L(it()),maxTokens:it().int(),stopSequences:L(We(Q())),metadata:L(Y({}).passthrough()),modelPreferences:L(Dc)})}),Mc=bt.extend({model:Q(),stopReason:L(Gt(["endTurn","stopSequence","maxTokens"]).or(Q())),role:Gt(["user","assistant"]),content:Ql("type",[rn,an,sn])}),qc=nt([Y({type:me("boolean"),title:L(Q()),description:L(Q()),default:L(pt())}).passthrough(),Y({type:me("string"),title:L(Q()),description:L(Q()),minLength:L(it()),maxLength:L(it()),format:L(Gt(["email","uri","date","date-time"]))}).passthrough(),Y({type:Gt(["number","integer"]),title:L(Q()),description:L(Q()),minimum:L(it()),maximum:L(it())}).passthrough(),Y({type:me("string"),title:L(Q()),description:L(Q()),enum:We(Q()),enumNames:L(We(Q()))}).passthrough()]),Zc=ht.extend({method:me("elicitation/create"),params:_t.extend({message:Q(),requestedSchema:Y({type:me("object"),properties:jr(Q(),qc),required:L(We(Q()))}).passthrough()})}),Fc=bt.extend({action:Gt(["accept","decline","cancel"]),content:L(jr(Q(),$r()))}),zc=Y({type:me("ref/resource"),uri:Q()}).passthrough(),Uc=Y({type:me("ref/prompt"),name:Q()}).passthrough(),Vc=ht.extend({method:me("completion/complete"),params:_t.extend({ref:nt([Uc,zc]),argument:Y({name:Q(),value:Q()}).passthrough(),context:L(Y({arguments:L(jr(Q(),Q()))}))})}),Hc=bt.extend({completion:Y({values:We(Q()).max(100),total:L(it().int()),hasMore:L(pt())}).passthrough()}),Bc=Y({uri:Q().startsWith("file://"),name:L(Q()),_meta:L(Y({}).passthrough())}).passthrough(),Gc=ht.extend({method:me("roots/list")}),Qc=bt.extend({roots:We(Bc)}),Kc=Lt.extend({method:me("notifications/roots/list_changed")});nt([Bn,tc,Vc,$c,wc,_c,oc,cc,dc,pc,mc,Tc,Ic]),nt([Hn,Gn,sc,Kc]),nt([Vn,Mc,Fc,Qc]),nt([Bn,Lc,Zc,Gc]),nt([Hn,Gn,Cc,vc,fc,Oc,xc]),nt([Vn,ac,Hc,Pc,bc,lc,uc,hc,xo,Ac]);class nn{sessionId;onmessage;onerror;onclose;_port;_started=!1;_closed=!1;constructor(e,r){if(!e)throw new Error("MessagePort is required");this._port=e,this.sessionId=r||this.generateId(),this._port.onmessage=a=>{try{const t=Xl.parse(a.data);this.onmessage?.(t)}catch(t){const n=new Error(`Failed to parse message: ${t}`);this.onerror?.(n)}},this._port.onmessageerror=a=>{const t=new Error(`MessagePort error: ${JSON.stringify(a)}`);this.onerror?.(t)}}static generateSessionId(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,10)}`}async start(){if(this._started)throw new Error("BrowserContextTransport already started! If using Client or Server class, note that connect() calls start() automatically.");if(this._closed)throw new Error("Cannot start a closed BrowserContextTransport");this._started=!0,this._port.start()}async send(e){if(this._closed)throw new Error("Cannot send on a closed BrowserContextTransport");return new Promise((r,a)=>{try{this._port.postMessage(e),r()}catch(t){const n=t instanceof Error?t:new Error(String(t));this.onerror?.(n),a(n)}})}async close(){this._closed||(this._closed=!0,this._port.close(),this.onclose?.())}generateId(){return nn.generateSessionId()}}let Gr=null;const Qn=()=>(Gr&&document.contains(Gr)||(Gr=document.querySelector('iframe[src*="angie/"]')),Gr),Kn=(s,e)=>{console.log("postMessageToAngieIframe",s,e);const r=Qn();if(!r?.contentWindow)return!1;const a=(()=>{const t=Qn();if(!t)return null;try{return new URL(t.src).origin}catch(n){return console.error("Error parsing iframe URL:",n),null}})();return a?(r.contentWindow.postMessage(s,a),!0):(console.error("Could not determine target origin for Angie iframe"),!1)};let Oa=!1;const Jc="open",Wc="closed";function Yc(){if(typeof window>"u")return 370;try{const s=window.localStorage.getItem("angie_sidebar_width");if(s){const e=parseInt(s,10);if(e>=350&&e<=590)return e}}catch{console.warn("localStorage not available")}return 370}function Xc(s){(function(){if(typeof document>"u"||Oa)return;const e="angie-sidebar-styles";if(document.getElementById(e))return void(Oa=!0);const r=document.createElement("style");r.id=e,r.textContent=`/* Angie Sidebar - CSS Variables */
:root {
    --angie-sidebar-z-index: 1200; /* below MUI popups, elementor popups and media library modal */
    --angie-sidebar-width: 330px;
    --angie-sidebar-transition: margin 0.3s ease-in-out, transform 0.3s ease-in-out;
    /* Direction-aware transform values for sidebar positioning */
    --angie-sidebar-hide-transform: translateX(-100%); /* LTR: hide to the left */
    --angie-sidebar-show-transform: translateX(0);
}

/* RTL-specific transform values */
[dir="rtl"] {
    --angie-sidebar-hide-transform: translateX(100%); /* RTL: hide to the right */
}

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
    :root {
        --angie-sidebar-transition: none;
    }
}

/* Apply transitions only when user is actively toggling */
body.angie-sidebar-transitioning {
    transition: var(--angie-sidebar-transition) !important;
}

body.angie-sidebar-transitioning #angie-sidebar-container {
    transition: var(--angie-sidebar-transition) !important;
}

/* LTR Layout (default) - Push content to the right */
@media (min-width: 768px) {
    body.angie-sidebar-active {
        padding-inline-start: var(--angie-sidebar-width) !important;
    }

    body.angie-sidebar-active #angie-body-top-padding {
        width: 100%;
        height: 8px;
    }

    /* Push WordPress Admin Bar - LTR */
    body.angie-sidebar-active #wpadminbar {
        inset-inline-start: var(--angie-sidebar-width) !important;
        inset-inline-end: 8px !important;
        width: calc(100% - 8px - var(--angie-sidebar-width)) !important;
        margin-top: 8px;
    }

    /* Sidebar container - LTR */
    #angie-sidebar-container {
        position: fixed;
        top: 0;
        inset-inline-start: 0;
        width: var(--angie-sidebar-width);
        height: 100vh;
        z-index: var(--angie-sidebar-z-index) !important; /* below elementor popups and media library modal */
        background: #FCFCFC;
        transform: var(--angie-sidebar-hide-transform);
        outline: none;
        overflow: hidden;
        /* No default transition - only when transitioning */
    }

    /* Resize handle */
    #angie-sidebar-container::after {
        content: '';
        position: absolute;
        top: 0;
        inset-inline-end: 0;
        width: 4px;
        height: 100%;
        cursor: ew-resize;
        background: transparent;
        z-index: 1000001;
    }

    /* Pink border during resize */
    #angie-sidebar-container.angie-resizing {
        border-inline-end-color: #ff69b4 !important;
        border-inline-end-width: 2px !important;
    }

    /* Disable iframe pointer events during resize */
    #angie-sidebar-container.angie-resizing iframe#angie-iframe {
        pointer-events: none !important;
    }
}

/* Active states */
body.angie-sidebar-active #angie-sidebar-container {
    transform: var(--angie-sidebar-show-transform);
}

/* Studio mode - sidebar takes full width */
@media (min-width: 768px) {
    html.angie-studio-active body.angie-sidebar-active #angie-sidebar-container {
        width: 100%;
    }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    #angie-sidebar-container {
        border-color: #000;
        box-shadow: none;
    }
}

/* Screen reader only class */
.angie-sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Plugin conflict resolution */
body.angie-sidebar-active {
    /* Reset common conflicting styles */
    box-sizing: border-box !important;
    position: relative !important;
}

#angie-sidebar-toggle {
    z-index: 99999 !important;
}
`;const a=document.head||document.getElementsByTagName("head")[0];a.insertBefore(r,a.firstChild),Oa=!0})(),typeof window<"u"&&(window.toggleAngieSidebar=(function(e){return function(r,a){const t=document.body,n=document.getElementById("angie-sidebar-container");if(!n)return void console.warn("Angie Sidebar: Required elements not found!");const i=t.classList.contains("angie-sidebar-active"),o=r!==void 0?r:!i;a||(t.classList.add("angie-sidebar-transitioning"),setTimeout(function(){t.classList.remove("angie-sidebar-transitioning")},300)),o?t.classList.add("angie-sidebar-active"):t.classList.remove("angie-sidebar-active"),o&&setTimeout(function(){Kn({type:"focusInput"})},a?0:300),(function(c){try{localStorage.setItem("angie_sidebar_state",c)}catch{console.warn("localStorage not available")}})(o?Jc:Wc);const l=new CustomEvent("angieSidebarToggle",{detail:{isOpen:o,sidebar:n,skipTransition:a}});document.dispatchEvent(l),Kn({type:st.ANGIE_SIDEBAR_TOGGLED,payload:{state:o?"opened":"closed"}})}})(),window.addEventListener("message",function(e){if(e.data&&e.data.type==="toggleAngieSidebar"){const{force:r,skipTransition:a}=e.data.payload||{};window.toggleAngieSidebar&&window.toggleAngieSidebar(r,a)}}))}const Jn=(s,e)=>{const r=document.getElementById("angie-sidebar-container");r&&r.setAttribute("aria-hidden",e?"false":"true"),e?s.removeAttribute("tabindex"):s.setAttribute("tabindex","-1")},yr=(s,e)=>{s.postMessage({status:"success",payload:e})},$a=(s,e)=>{s.postMessage({status:"error",payload:e})};var Wn;(Wn||(Wn={})).POST_MESSAGE="postMessage";const Ot={open:!1,iframe:null,iframeUrlObject:null};function Yn(){const s=new URL(window.location.href);s.searchParams.set("start-oauth","1"),console.log("OAuth: Redirecting to wp-admin with OAuth:",s.toString()),window.location.href=s.toString()}const eu=()=>{window.addEventListener("message",s=>{if(s.origin===Ot.iframeUrlObject?.origin)switch(s.data.type){case"OAUTH_GET_CODE_AND_STATE":(e=>{const r=new URLSearchParams(window.location.search),a=r.get("oauth_code"),t=r.get("oauth_state");if(a&&t)yr(e,{code:a,state:t});else{const n=r.get("oauth_error");if(n){$a(e,{message:n,code:a||null,state:t||null});const i=new URL(window.location.href);i.searchParams.delete("oauth_error"),history.replaceState({},"",i.toString())}else yr(e,{message:"No OAuth error found"})}})(s.ports[0]);break;case"OAUTH_GET_TOP_URL":console.log("OAuth: Iframe requested top window URL via MessageChannel"),yr(s.ports[0],{topUrl:window.location.href});break;case"OAUTH_REDIRECT_TOP_WINDOW":console.log("OAuth: Iframe requested top window redirect to:",s.data.payload.url),window.location.href=s.data.payload.url;break;case"OAUTH_UPDATE_URL":console.log("OAuth: Iframe requested URL update to:",s.data.payload.url),(function(e,r){if(!history?.replaceState)return console.warn("history.replaceState not supported in this browser"),void $a(r,{message:"URL update not supported in this browser"});try{const a=window.location.href;history.replaceState({},"",e),(function(t,n){const i=new URL(n),o=new URL(t),l=i.searchParams,c=o.searchParams,h=["oauth_code","oauth_state","start-oauth"];return h.some(p=>c?.has(p))&&!h.some(p=>l?.has(p))})(a,e)&&(function(){console.log("OAuth parameters cleaned, opening sidebar");try{localStorage.setItem("angie_sidebar_state","open")}catch{console.warn("localStorage not available")}setTimeout(()=>{window.toggleAngieSidebar(!0)},500)})(),yr(r,{message:"URL updated successfully"})}catch(a){console.warn("Failed to update URL via history.replaceState:",a),$a(r,{message:"URL update failed: "+(a instanceof Error?a.message:"Unknown error")})}})(s.data.payload.url,s.ports[0]);break;case"ANGIE_REDIRECT_TO_WP_ADMIN_WITH_OAUTH":Yn();break;case"ANGIE_REDIRECT_TO_AUTH_ORIGIN_LOGOUT":try{Yn()}catch(e){console.error("OAuth: Auth origin logout fallback failed:",e),window.location.reload()}}})};var st;(function(s){s.SDK_ANGIE_ALL_SERVERS_REGISTERED="sdk-angie-all-servers-registered",s.SDK_ANGIE_READY_PING="sdk-angie-ready-ping",s.SDK_REQUEST_CLIENT_CREATION="sdk-request-client-creation",s.SDK_TRIGGER_ANGIE="sdk-trigger-angie",s.SDK_TRIGGER_ANGIE_RESPONSE="sdk-trigger-angie-response",s.ANGIE_SIDEBAR_RESIZED="angie-sidebar-resized",s.ANGIE_SIDEBAR_TOGGLED="angie-sidebar-toggled",s.ANGIE_CHAT_TOGGLE="angie-chat-toggle",s.ANGIE_STUDIO_TOGGLE="angie-studio-toggle",s.ANGIE_NAVIGATE_TO_URL="angie/navigate-to-url",s.ANGIE_PAGE_RELOAD="angie/page-reload"})(st||(st={}));class tu{angieDetector;registrationQueue;clientManager;isInitialized=!1;instanceId;constructor(){this.instanceId=Math.random().toString(36).substring(2,8),console.log(`AngieMcpSdk: Constructor called - initializing SDK (Instance: ${this.instanceId})`),this.angieDetector=new El,this.registrationQueue=new Pl,this.clientManager=new xl,console.log(`AngieMcpSdk: Setting up event handlers (Instance: ${this.instanceId})`),this.setupAngieReadyHandler(),this.setupServerInitHandler(),this.setupReRegistrationHandler(),console.log(`AngieMcpSdk: SDK initialization complete (Instance: ${this.instanceId})`)}async loadSidebar(e){Xc(),await(async r=>{if(window.screen.availWidth<=768)return void console.log("Angie: Mobile detected, skipping iframe injection");let a=document.getElementById("angie-sidebar-container");if(!a){const i=performance.now();if(console.log(" Waiting for sidebar container..."),await new Promise(o=>{let l=0;const c=setInterval(()=>{a=document.getElementById("angie-sidebar-container"),l++,(a||l>20)&&(clearInterval(c),a&&o())},100);setTimeout(()=>{if(clearInterval(c),a)return void o();const h=new MutationObserver(()=>{a=document.getElementById("angie-sidebar-container"),a&&(h.disconnect(),o())});h.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{h.disconnect(),o()},8e3)},2e3)}),console.log(` Sidebar container detection took: ${(performance.now()-i).toFixed(2)}ms`),!a)return void console.error("Angie: Sidebar container not found")}const{iframe:t,iframeUrlObject:n}=await(async i=>{const o=i.origin,l=new URL(i.path,o),c=l.pathname.slice(1).replace(/\//,"--")+"-"+Math.random().toString(36).substring(7);return new Promise(h=>{const p=new URL(o);p.pathname=l.pathname;const y=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(p.searchParams.append("colorScheme",i.uiTheme||y||"light"),p.searchParams.append("sdkVersion",i.sdkVersion),p.searchParams.append("instanceId",c),p.searchParams.append("origin",window.location.origin),i.isRTL&&p.searchParams.append("isRTL",i.isRTL?"true":"false"),window.location.hostname==="localhost"&&window.location.search.includes("debug_error")){const v=new URLSearchParams(window.location.search).get("debug_error");v&&p.searchParams.append("debug_error",v)}l.searchParams.forEach((v,w)=>{p.searchParams.set(w,v)}),p.searchParams.set("ver",new Date().getTime().toString());const u=i.parent||document,f=u.createElement("iframe"),_={"background-color":"transparent","color-scheme":"normal",...i.css};window.addEventListener("message",async v=>{if(v.origin===p.origin)switch(v.data.type){case gr.ANGIE_READY:h({iframe:f,iframeUrlObject:p});break;case gr.ANGIE_LOADED:f.contentWindow?.postMessage({type:gr.HOST_READY,instanceId:c},p.origin)}}),f.setAttribute("src",p.href),f.id="angie-iframe",f.setAttribute("frameborder","0"),f.setAttribute("scrolling","no"),f.setAttribute("style",Object.entries(_).map(([v,w])=>`${v}: ${w}`).join("; ")),f.setAttribute("allow","clipboard-write; clipboard-read"),i.insertCallback?i.insertCallback(f):u.body.appendChild(f)})})({origin:r.origin||"https://angie.elementor.com",path:"angie/wp-admin",insertCallback:i=>{console.log("Injecting Angie iframe into sidebar container"),i.setAttribute("title","Angie AI Assistant"),i.setAttribute("role","application"),i.setAttribute("aria-label","Angie AI Assistant Interface");const o=document.getElementById("angie-sidebar-loading");o&&(o.textContent=""),a?.appendChild(i),Jn(i,!0),i.addEventListener("load",()=>{i.focus()})},css:{width:"100%",height:"100%",border:"none",outline:"none"},uiTheme:r.uiTheme,isRTL:r.isRTL,sdkVersion:"1.0.3"});Ot.iframe=t,Ot.iframeUrlObject=n,window.addEventListener("message",i=>{if(i.origin===Ot.iframeUrlObject?.origin)switch(i.data.type){case Wr.SET:window.localStorage.setItem(i.data.key,i.data.value);break;case Wr.GET:const o=i.ports[0],l=window.localStorage.getItem(i.data.key);o.postMessage({value:l})}}),(i=>{window.addEventListener("message",async o=>{const l=o.origin===window.location.origin,c=o.origin===i.iframeUrlObject?.origin;if(l||c)switch(o?.data?.type){case st.SDK_ANGIE_ALL_SERVERS_REGISTERED:break;case st.SDK_ANGIE_READY_PING:const h=o.ports[0];console.log("Angie is ready",o),yr(h,{message:"Angie is ready"});break;case st.SDK_REQUEST_CLIENT_CREATION:const p=o.data.payload;try{const y=o.ports[0],u=new MessageChannel;u.port1.onmessage=_=>{y.postMessage({success:!0,data:_.data})};const f={type:st.SDK_REQUEST_CLIENT_CREATION,payload:{success:!0,...p,clientId:`dynamic-client-${p.serverName}-${p.serverVersion}-${Date.now()}`,requestId:o.data.payload.requestId},timestamp:Date.now()};if(!i.iframe)throw new Error("Iframe not found");i.iframe.contentWindow?.postMessage(f,i.iframeUrlObject?.origin||"",[u.port2])}catch(y){console.error(`AngieMcpSdk:Failed to create client for SDK server "${p.serverName}":`,y)}break;case st.SDK_TRIGGER_ANGIE:console.log("SDK Trigger Angie received",o.data);try{const{requestId:y,prompt:u,context:f}=o.data.payload;if(!i.iframe)throw new Error("Iframe not found");i.iframe.contentWindow?.postMessage({type:st.SDK_TRIGGER_ANGIE,payload:{requestId:y,prompt:u,context:f}},i.iframeUrlObject?.origin||""),window.postMessage({type:st.SDK_TRIGGER_ANGIE_RESPONSE,payload:{success:!0,requestId:y,response:"Angie triggered successfully"}},window.location.origin)}catch(y){console.error("Failed to trigger Angie:",y),window.postMessage({type:st.SDK_TRIGGER_ANGIE_RESPONSE,payload:{success:!1,requestId:o.data.payload?.requestId,error:y instanceof Error?y.message:"Unknown error"}},window.location.origin)}}})})(Ot),eu(),window.addEventListener("message",async i=>{if([window.location.origin,r.origin||"https://angie.elementor.com"].includes(i.origin))if(i?.data?.type===st.ANGIE_CHAT_TOGGLE)Ot.open=i.data.open,Ot.iframe&&Jn(Ot.iframe,Ot.open);else if(i?.data?.type===st.ANGIE_STUDIO_TOGGLE){const o=i.data.isStudioOpen;if(!Ot.iframe)return;if(o)document.documentElement.classList.add("angie-studio-active");else{const l=Yc();document.documentElement.style.setProperty("--angie-sidebar-width",`${l}px`),document.documentElement.classList.remove("angie-studio-active")}}else if(i?.data?.type===st.ANGIE_NAVIGATE_TO_URL){const{url:o=""}=i.data;if(!((l,c=[])=>{const h=c.length===0&&typeof window<"u"?[window.location.origin]:c;if(!l.startsWith("http"))return!1;try{const p=new URL(l);return h.includes(p.origin)}catch{return!1}})(o))throw new Error("Angie: Invalid URL - navigation blocked for security reasons");window.location.assign(o)}else i?.data?.type===st.ANGIE_PAGE_RELOAD?(console.log("Angie requested page reload - database operations completed"),window.location.reload()):i?.data?.type===gr.RESET_HASH&&(window.location.hash="",yr(i.ports[0],{message:"Hash reset successfully"}))})})({origin:e?.origin||"https://angie.elementor.com",uiTheme:e?.uiTheme||"light",isRTL:e?.isRTL||!1,...e}),this.setupPromptHashDetection()}setupReRegistrationHandler(){window.addEventListener("message",e=>{if(e.data?.type===Yt.SDK_ANGIE_REFRESH_PING)if(console.log(`AngieMcpSdk: Angie refresh ping received (Instance: ${this.instanceId})`),this.registrationQueue.resetAllToPending()){const r=this.registrationQueue.getPending().length;console.log(`AngieMcpSdk: Successfully reset ${r} registrations, processing queue (Instance: ${this.instanceId})`),this.handleAngieReady()}else console.log(`AngieMcpSdk: Skipping queue reset - processing already in progress (Instance: ${this.instanceId})`)})}setupAngieReadyHandler(){this.angieDetector.waitForReady().then(e=>{e.isReady?this.handleAngieReady():console.warn("AngieMcpSdk: Angie not detected - servers will remain queued")}).catch(e=>{console.error("AngieMcpSdk: Error waiting for Angie:",e)})}async handleAngieReady(){console.log(`AngieMcpSdk: Angie is ready, processing queued registrations (Instance: ${this.instanceId})`);try{await this.registrationQueue.processQueue(async e=>{console.log(`AngieMcpSdk: processQueue callback called for "${e.config.name}" (Instance: ${this.instanceId})`),await this.processRegistration(e)}),this.isInitialized=!0,console.log(`AngieMcpSdk: Initialization complete (Instance: ${this.instanceId})`)}catch(e){console.error(`AngieMcpSdk: Error processing registration queue (Instance: ${this.instanceId}):`,e)}}async processRegistration(e){console.log(`AngieMcpSdk: Processing registration for server "${e.config.name}" (ID: ${e.id}) (Instance: ${this.instanceId})`);try{console.log(`AngieMcpSdk: Calling clientManager.requestClientCreation for "${e.config.name}" (Instance: ${this.instanceId})`);const r={...e,instanceId:this.instanceId};await this.clientManager.requestClientCreation(r),console.log(`AngieMcpSdk: Successfully registered server "${e.config.name}" (Instance: ${this.instanceId})`)}catch(r){throw console.error(`AngieMcpSdk: Failed to register server "${e.config.name}" (Instance: ${this.instanceId}):`,r),r}}registerLocalServer(e){return e.type=vr.LOCAL,e.transport=Jr.POST_MESSAGE,this.registerServer(e)}registerRemoteServer(e){return e.type=vr.REMOTE,this.registerServer(e)}isLocalServerConfig(e){return e.type===vr.LOCAL||!e.type&&"server"in e}isRemoteServerConfig(e){return e.type===vr.REMOTE&&"url"in e}async registerServer(e){if(!e.type)return console.warn("AngieMcpSdk: for a local server, please use registerLocalServer instead of registerServer"),void this.registerLocalServer(e);if(console.log(`AngieMcpSdk: registerServer called for "${e.name}" (Instance: ${this.instanceId})`),!e.name)throw new Error("Server name is required");if(!e.description)throw new Error("Server description is required");if(this.isLocalServerConfig(e)&&!e.server)throw new Error("Server instance is required for local servers");console.log(`AngieMcpSdk: Registering server "${e.name}" (Instance: ${this.instanceId})`);const r=this.registrationQueue.add(e);if(console.log(`AngieMcpSdk: Added registration to queue: ${r.id} (Instance: ${this.instanceId})`),this.angieDetector.isReady())try{await this.processRegistration(r),this.registrationQueue.updateStatus(r.id,"registered"),console.log(`AngieMcpSdk: Server "${e.name}" registered successfully (Instance: ${this.instanceId})`)}catch(a){const t=a instanceof Error?a.message:String(a);throw this.registrationQueue.updateStatus(r.id,"failed",t),a}else console.log(`AngieMcpSdk: Server "${e.name}" queued until Angie is ready (Instance: ${this.instanceId})`)}getRegistrations(){return this.registrationQueue.getAll()}getPendingRegistrations(){return this.registrationQueue.getPending()}isAngieReady(){return this.angieDetector.isReady()}isReady(){return this.isInitialized}async waitForReady(){if(!(await this.angieDetector.waitForReady()).isReady)throw new Error("Angie is not available");for(;!this.isInitialized;)await new Promise(e=>setTimeout(e,100))}async triggerAngie(e){if(!this.isAngieReady())throw new Error("Angie is not ready. Please wait for Angie to be available before triggering.");const r=this.generateRequestId(),a=e.options?.timeout||3e4;return new Promise((t,n)=>{const i=setTimeout(()=>{n(new Error("Angie trigger request timed out"))},a),o=c=>{c.data?.type===Yt.SDK_TRIGGER_ANGIE_RESPONSE&&c.data?.payload?.requestId===r&&(clearTimeout(i),window.removeEventListener("message",o),t(c.data.payload))};window.addEventListener("message",o);const l={type:Yt.SDK_TRIGGER_ANGIE,payload:{requestId:r,prompt:e.prompt,options:e.options,context:{pageUrl:window.location.href,pageTitle:document.title,...e.context}},timestamp:Date.now()};console.log(`AngieMcpSdk: Triggering Angie with prompt (Request ID: ${r}, Instance: ${this.instanceId})`),window.postMessage(l,window.location.origin)})}destroy(){this.registrationQueue.clear(),console.log(`AngieMcpSdk: SDK destroyed (Instance: ${this.instanceId})`)}setupServerInitHandler(){window.addEventListener("message",e=>{e.data?.type===Yt.SDK_REQUEST_INIT_SERVER&&(console.log(`AngieMcpSdk: Server init request received (Instance: ${this.instanceId})`),this.handleServerInitRequest(e))})}handleServerInitRequest(e){const{clientId:r,serverId:a,instanceId:t}=e.data.payload||{};if(r&&a)if(console.log(`AngieMcpSdk: Server init request received - Request instanceId: ${t}, This instanceId: ${this.instanceId} (Instance: ${this.instanceId})`),t&&t!==this.instanceId)console.log(`AngieMcpSdk: Ignoring server init request for different instance. Request instanceId: ${t}, this instanceId: ${this.instanceId}`);else{console.log(`AngieMcpSdk: Handling server init request for clientId: ${r}, serverId: ${a} (Instance: ${this.instanceId})`);try{const n=this.registrationQueue.getAll().find(c=>c.id===a);if(!n)return void console.error(`AngieMcpSdk: No registration found for serverId: ${a} (Instance: ${this.instanceId})`);if("type"in n.config&&n.config.type==="remote")return void console.log(`AngieMcpSdk: Remote server registration detected; skipping local connect (Instance: ${this.instanceId})`);const i=e.ports[0];if(!i)return void console.error(`AngieMcpSdk: No port provided in server init request (Instance: ${this.instanceId})`);const o=n.config.server,l=new nn(i);o.connect(l),console.log(`AngieMcpSdk: Server "${n.config.name}" initialized successfully (Instance: ${this.instanceId})`)}catch(n){console.error(`AngieMcpSdk: Error initializing server for clientId ${r} (Instance: ${this.instanceId}):`,n)}}else console.error(`AngieMcpSdk: Invalid server init request - missing clientId or serverId (Instance: ${this.instanceId})`)}generateRequestId(){return`${this.instanceId}-${Date.now()}-${Math.random().toString(36).substring(2,8)}`}async handlePromptHash(){const e=window.location.hash;if(e.startsWith("#angie-prompt="))try{const r=e.replace("#angie-prompt=",""),a=decodeURIComponent(r);if(!a)return void console.warn("AngieMcpSdk: Empty prompt detected in hash");console.log("AngieMcpSdk: Detected prompt in hash:",a),await this.waitForReady();const t=await this.triggerAngie({prompt:a,context:{source:"hash-parameter",pageUrl:window.location.href,timestamp:new Date().toISOString()}});console.log("AngieMcpSdk: Triggered successfully from hash:",t),window.location.hash=""}catch(r){console.error("AngieMcpSdk: Failed to trigger from hash:",r)}}setupPromptHashDetection(){this.handlePromptHash(),window.addEventListener("hashchange",()=>this.handlePromptHash())}}var Ie;(function(s){s.assertEqual=t=>{};function e(t){}s.assertIs=e;function r(t){throw new Error}s.assertNever=r,s.arrayToEnum=t=>{const n={};for(const i of t)n[i]=i;return n},s.getValidEnumValues=t=>{const n=s.objectKeys(t).filter(o=>typeof t[t[o]]!="number"),i={};for(const o of n)i[o]=t[o];return s.objectValues(i)},s.objectValues=t=>s.objectKeys(t).map(function(n){return t[n]}),s.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{const n=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(i);return n},s.find=(t,n)=>{for(const i of t)if(n(i))return i},s.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&Number.isFinite(t)&&Math.floor(t)===t;function a(t,n=" | "){return t.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(Ie||(Ie={}));var Xn;(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(Xn||(Xn={}));const W=Ie.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Wt=s=>{switch(typeof s){case"undefined":return W.undefined;case"string":return W.string;case"number":return Number.isNaN(s)?W.nan:W.number;case"boolean":return W.boolean;case"function":return W.function;case"bigint":return W.bigint;case"symbol":return W.symbol;case"object":return Array.isArray(s)?W.array:s===null?W.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?W.promise:typeof Map<"u"&&s instanceof Map?W.map:typeof Set<"u"&&s instanceof Set?W.set:typeof Date<"u"&&s instanceof Date?W.date:W.object;default:return W.unknown}},z=Ie.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);let or=class ko extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof ko))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ie.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},a=[];for(const t of this.issues)if(t.path.length>0){const n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}};or.create=s=>new or(s);const Ns=(s,e)=>{let r;switch(s.code){case z.invalid_type:s.received===W.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case z.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,Ie.jsonStringifyReplacer)}`;break;case z.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ie.joinValues(s.keys,", ")}`;break;case z.invalid_union:r="Invalid input";break;case z.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ie.joinValues(s.options)}`;break;case z.invalid_enum_value:r=`Invalid enum value. Expected ${Ie.joinValues(s.options)}, received '${s.received}'`;break;case z.invalid_arguments:r="Invalid function arguments";break;case z.invalid_return_type:r="Invalid function return type";break;case z.invalid_date:r="Invalid date";break;case z.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:Ie.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case z.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case z.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case z.custom:r="Invalid input";break;case z.invalid_intersection_types:r="Intersection results could not be merged";break;case z.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case z.not_finite:r="Number must be finite";break;default:r=e.defaultError,Ie.assertNever(s)}return{message:r}};let ru=Ns;function au(){return ru}const su=s=>{const{data:e,path:r,errorMaps:a,issueData:t}=s,n=[...r,...t.path||[]],i={...t,path:n};if(t.message!==void 0)return{...t,path:n,message:t.message};let o="";const l=a.filter(c=>!!c).slice().reverse();for(const c of l)o=c(i,{data:e,defaultError:o}).message;return{...t,path:n,message:o}};function G(s,e){const r=au(),a=su({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===Ns?void 0:Ns].filter(t=>!!t)});s.common.issues.push(a)}class lt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const a=[];for(const t of r){if(t.status==="aborted")return ie;t.status==="dirty"&&e.dirty(),a.push(t.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){const a=[];for(const t of r){const n=await t.key,i=await t.value;a.push({key:n,value:i})}return lt.mergeObjectSync(e,a)}static mergeObjectSync(e,r){const a={};for(const t of r){const{key:n,value:i}=t;if(n.status==="aborted"||i.status==="aborted")return ie;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof i.value<"u"||t.alwaysSet)&&(a[n.value]=i.value)}return{status:e.value,value:a}}}const ie=Object.freeze({status:"aborted"}),Ir=s=>({status:"dirty",value:s}),wt=s=>({status:"valid",value:s}),ei=s=>s.status==="aborted",ti=s=>s.status==="dirty",wr=s=>s.status==="valid",oa=s=>typeof Promise<"u"&&s instanceof Promise;var ee;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(ee||(ee={}));class Dt{constructor(e,r,a,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=t}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ri=(s,e)=>{if(wr(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new or(s.common.issues);return this._error=r,this._error}}};function _e(s){if(!s)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(i,o)=>{const{message:l}=s;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??a??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??r??o.defaultError}},description:t}}class Se{get description(){return this._def.description}_getType(e){return Wt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new lt,ctx:{common:e.parent.common,data:e.data,parsedType:Wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(oa(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){const a={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wt(e)},t=this._parseSync({data:e,path:a.path,parent:a});return ri(a,t)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wt(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:r});return wr(a)?{value:a.value}:{issues:r.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>wr(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,r){const a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){const a={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wt(e)},t=this._parse({data:e,path:a.path,parent:a}),n=await(oa(t)?t:Promise.resolve(t));return ri(a,n)}refine(e,r){const a=t=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{const i=e(t),o=()=>n.addIssue({code:z.custom,...a(t)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,r){return this._refinement((a,t)=>e(a)?!0:(t.addIssue(typeof r=="function"?r(a,t):r),!1))}_refinement(e){return new ur({schema:this,typeName:le.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ht.create(this,this._def)}nullable(){return dr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ct.create(this)}promise(){return fa.create(this,this._def)}or(e){return ca.create([this,e],this._def)}and(e){return ua.create(this,e,this._def)}transform(e){return new ur({..._e(this._def),schema:this,typeName:le.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new pa({..._e(this._def),innerType:this,defaultValue:r,typeName:le.ZodDefault})}brand(){return new Oo({typeName:le.ZodBranded,type:this,..._e(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new ma({..._e(this._def),innerType:this,catchValue:r,typeName:le.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ln.create(this,e)}readonly(){return va.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const nu=/^c[^\s-]{8,}$/i,iu=/^[0-9a-z]+$/,ou=/^[0-9A-HJKMNP-TV-Z]{26}$/i,lu=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,cu=/^[a-z0-9_-]{21}$/i,uu=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,du=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,hu=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,fu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ca;const pu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,mu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,vu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,gu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,yu=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,_u=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Io="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",bu=new RegExp(`^${Io}$`);function Ao(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);const r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function wu(s){return new RegExp(`^${Ao(s)}$`)}function Su(s){let e=`${Io}T${Ao(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Eu(s,e){return!!((e==="v4"||!e)&&pu.test(s)||(e==="v6"||!e)&&vu.test(s))}function Pu(s,e){if(!uu.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(a));return!(typeof t!="object"||t===null||"typ"in t&&t?.typ!=="JWT"||!t.alg||e&&t.alg!==e)}catch{return!1}}function xu(s,e){return!!((e==="v4"||!e)&&mu.test(s)||(e==="v6"||!e)&&gu.test(s))}class Ut extends Se{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==W.string){const n=this._getOrReturnCtx(e);return G(n,{code:z.invalid_type,expected:W.string,received:n.parsedType}),ie}const a=new lt;let t;for(const n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:z.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:z.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){const i=e.data.length>n.value,o=e.data.length<n.value;(i||o)&&(t=this._getOrReturnCtx(e,t),i?G(t,{code:z.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&G(t,{code:z.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")hu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"email",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Ca||(Ca=new RegExp(fu,"u")),Ca.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"emoji",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")lu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"uuid",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")cu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"nanoid",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")nu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"cuid",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")iu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"cuid2",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")ou.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"ulid",code:z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),G(t,{validation:"url",code:z.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"regex",code:z.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(t=this._getOrReturnCtx(e,t),G(t,{code:z.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(t=this._getOrReturnCtx(e,t),G(t,{code:z.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(t=this._getOrReturnCtx(e,t),G(t,{code:z.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?Su(n).test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{code:z.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?bu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{code:z.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?wu(n).test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{code:z.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?du.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"duration",code:z.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?Eu(e.data,n.version)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"ip",code:z.invalid_string,message:n.message}),a.dirty()):n.kind==="jwt"?Pu(e.data,n.alg)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"jwt",code:z.invalid_string,message:n.message}),a.dirty()):n.kind==="cidr"?xu(e.data,n.version)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"cidr",code:z.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?yu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"base64",code:z.invalid_string,message:n.message}),a.dirty()):n.kind==="base64url"?_u.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"base64url",code:z.invalid_string,message:n.message}),a.dirty()):Ie.assertNever(n);return{status:a.value,value:e.data}}_regex(e,r,a){return this.refinement(t=>e.test(t),{validation:r,code:z.invalid_string,...ee.errToObj(a)})}_addCheck(e){return new Ut({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ee.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ee.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ee.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ee.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ee.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ee.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ee.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ee.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ee.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ee.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ee.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ee.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ee.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...ee.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ee.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ee.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...ee.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...ee.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...ee.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...ee.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...ee.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...ee.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...ee.errToObj(r)})}nonempty(e){return this.min(1,ee.errToObj(e))}trim(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Ut.create=s=>new Ut({checks:[],typeName:le.ZodString,coerce:s?.coerce??!1,..._e(s)});function Ru(s,e){const r=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,t=r>a?r:a,n=Number.parseInt(s.toFixed(t).replace(".","")),i=Number.parseInt(e.toFixed(t).replace(".",""));return n%i/10**t}class Sr extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==W.number){const n=this._getOrReturnCtx(e);return G(n,{code:z.invalid_type,expected:W.number,received:n.parsedType}),ie}let a;const t=new lt;for(const n of this._def.checks)n.kind==="int"?Ie.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:z.invalid_type,expected:"integer",received:"float",message:n.message}),t.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="multipleOf"?Ru(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:z.not_finite,message:n.message}),t.dirty()):Ie.assertNever(n);return{status:t.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,ee.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ee.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ee.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ee.toString(r))}setLimit(e,r,a,t){return new Sr({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:ee.toString(t)}]})}_addCheck(e){return new Sr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ee.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ee.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ee.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ee.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ee.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ee.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:ee.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ee.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ee.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ie.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Sr.create=s=>new Sr({checks:[],typeName:le.ZodNumber,coerce:s?.coerce||!1,..._e(s)});class Cr extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==W.bigint)return this._getInvalidInput(e);let a;const t=new lt;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):Ie.assertNever(n);return{status:t.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return G(r,{code:z.invalid_type,expected:W.bigint,received:r.parsedType}),ie}gte(e,r){return this.setLimit("min",e,!0,ee.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ee.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ee.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ee.toString(r))}setLimit(e,r,a,t){return new Cr({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:ee.toString(t)}]})}_addCheck(e){return new Cr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ee.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ee.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ee.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ee.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ee.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Cr.create=s=>new Cr({checks:[],typeName:le.ZodBigInt,coerce:s?.coerce??!1,..._e(s)});class Ds extends Se{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==W.boolean){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:W.boolean,received:a.parsedType}),ie}return wt(e.data)}}Ds.create=s=>new Ds({typeName:le.ZodBoolean,coerce:s?.coerce||!1,..._e(s)});class la extends Se{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==W.date){const n=this._getOrReturnCtx(e);return G(n,{code:z.invalid_type,expected:W.date,received:n.parsedType}),ie}if(Number.isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return G(n,{code:z.invalid_date}),ie}const a=new lt;let t;for(const n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:z.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:z.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Ie.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new la({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:ee.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:ee.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}la.create=s=>new la({checks:[],coerce:s?.coerce||!1,typeName:le.ZodDate,..._e(s)});class ai extends Se{_parse(e){if(this._getType(e)!==W.symbol){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:W.symbol,received:a.parsedType}),ie}return wt(e.data)}}ai.create=s=>new ai({typeName:le.ZodSymbol,..._e(s)});class js extends Se{_parse(e){if(this._getType(e)!==W.undefined){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:W.undefined,received:a.parsedType}),ie}return wt(e.data)}}js.create=s=>new js({typeName:le.ZodUndefined,..._e(s)});class Ls extends Se{_parse(e){if(this._getType(e)!==W.null){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:W.null,received:a.parsedType}),ie}return wt(e.data)}}Ls.create=s=>new Ls({typeName:le.ZodNull,..._e(s)});class si extends Se{constructor(){super(...arguments),this._any=!0}_parse(e){return wt(e.data)}}si.create=s=>new si({typeName:le.ZodAny,..._e(s)});class Ms extends Se{constructor(){super(...arguments),this._unknown=!0}_parse(e){return wt(e.data)}}Ms.create=s=>new Ms({typeName:le.ZodUnknown,..._e(s)});class er extends Se{_parse(e){const r=this._getOrReturnCtx(e);return G(r,{code:z.invalid_type,expected:W.never,received:r.parsedType}),ie}}er.create=s=>new er({typeName:le.ZodNever,..._e(s)});class ni extends Se{_parse(e){if(this._getType(e)!==W.undefined){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:W.void,received:a.parsedType}),ie}return wt(e.data)}}ni.create=s=>new ni({typeName:le.ZodVoid,..._e(s)});class Ct extends Se{_parse(e){const{ctx:r,status:a}=this._processInputParams(e),t=this._def;if(r.parsedType!==W.array)return G(r,{code:z.invalid_type,expected:W.array,received:r.parsedType}),ie;if(t.exactLength!==null){const i=r.data.length>t.exactLength.value,o=r.data.length<t.exactLength.value;(i||o)&&(G(r,{code:i?z.too_big:z.too_small,minimum:o?t.exactLength.value:void 0,maximum:i?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),a.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&(G(r,{code:z.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),a.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&(G(r,{code:z.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((i,o)=>t.type._parseAsync(new Dt(r,i,r.path,o)))).then(i=>lt.mergeArray(a,i));const n=[...r.data].map((i,o)=>t.type._parseSync(new Dt(r,i,r.path,o)));return lt.mergeArray(a,n)}get element(){return this._def.type}min(e,r){return new Ct({...this._def,minLength:{value:e,message:ee.toString(r)}})}max(e,r){return new Ct({...this._def,maxLength:{value:e,message:ee.toString(r)}})}length(e,r){return new Ct({...this._def,exactLength:{value:e,message:ee.toString(r)}})}nonempty(e){return this.min(1,e)}}Ct.create=(s,e)=>new Ct({type:s,minLength:null,maxLength:null,exactLength:null,typeName:le.ZodArray,..._e(e)});function mr(s){if(s instanceof Ke){const e={};for(const r in s.shape){const a=s.shape[r];e[r]=Ht.create(mr(a))}return new Ke({...s._def,shape:()=>e})}else return s instanceof Ct?new Ct({...s._def,type:mr(s.element)}):s instanceof Ht?Ht.create(mr(s.unwrap())):s instanceof dr?dr.create(mr(s.unwrap())):s instanceof lr?lr.create(s.items.map(e=>mr(e))):s}class Ke extends Se{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Ie.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==W.object){const c=this._getOrReturnCtx(e);return G(c,{code:z.invalid_type,expected:W.object,received:c.parsedType}),ie}const{status:a,ctx:t}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof er&&this._def.unknownKeys==="strip"))for(const c in t.data)i.includes(c)||o.push(c);const l=[];for(const c of i){const h=n[c],p=t.data[c];l.push({key:{status:"valid",value:c},value:h._parse(new Dt(t,p,t.path,c)),alwaysSet:c in t.data})}if(this._def.catchall instanceof er){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of o)l.push({key:{status:"valid",value:h},value:{status:"valid",value:t.data[h]}});else if(c==="strict")o.length>0&&(G(t,{code:z.unrecognized_keys,keys:o}),a.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of o){const p=t.data[h];l.push({key:{status:"valid",value:h},value:c._parse(new Dt(t,p,t.path,h)),alwaysSet:h in t.data})}}return t.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of l){const p=await h.key,y=await h.value;c.push({key:p,value:y,alwaysSet:h.alwaysSet})}return c}).then(c=>lt.mergeObjectSync(a,c)):lt.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return ee.errToObj,new Ke({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{const t=this._def.errorMap?.(r,a).message??a.defaultError;return r.code==="unrecognized_keys"?{message:ee.errToObj(e).message??t}:{message:t}}}:{}})}strip(){return new Ke({...this._def,unknownKeys:"strip"})}passthrough(){return new Ke({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ke({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ke({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:le.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Ke({...this._def,catchall:e})}pick(e){const r={};for(const a of Ie.objectKeys(e))e[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new Ke({...this._def,shape:()=>r})}omit(e){const r={};for(const a of Ie.objectKeys(this.shape))e[a]||(r[a]=this.shape[a]);return new Ke({...this._def,shape:()=>r})}deepPartial(){return mr(this)}partial(e){const r={};for(const a of Ie.objectKeys(this.shape)){const t=this.shape[a];e&&!e[a]?r[a]=t:r[a]=t.optional()}return new Ke({...this._def,shape:()=>r})}required(e){const r={};for(const a of Ie.objectKeys(this.shape))if(e&&!e[a])r[a]=this.shape[a];else{let n=this.shape[a];for(;n instanceof Ht;)n=n._def.innerType;r[a]=n}return new Ke({...this._def,shape:()=>r})}keyof(){return To(Ie.objectKeys(this.shape))}}Ke.create=(s,e)=>new Ke({shape:()=>s,unknownKeys:"strip",catchall:er.create(),typeName:le.ZodObject,..._e(e)});Ke.strictCreate=(s,e)=>new Ke({shape:()=>s,unknownKeys:"strict",catchall:er.create(),typeName:le.ZodObject,..._e(e)});Ke.lazycreate=(s,e)=>new Ke({shape:s,unknownKeys:"strip",catchall:er.create(),typeName:le.ZodObject,..._e(e)});class ca extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a=this._def.options;function t(n){for(const o of n)if(o.result.status==="valid")return o.result;for(const o of n)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const i=n.map(o=>new or(o.ctx.common.issues));return G(r,{code:z.invalid_union,unionErrors:i}),ie}if(r.common.async)return Promise.all(a.map(async n=>{const i={...r,common:{...r.common,issues:[]},parent:null};return{result:await n._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(t);{let n;const i=[];for(const l of a){const c={...r,common:{...r.common,issues:[]},parent:null},h=l._parseSync({data:r.data,path:r.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!n&&(n={result:h,ctx:c}),c.common.issues.length&&i.push(c.common.issues)}if(n)return r.common.issues.push(...n.ctx.common.issues),n.result;const o=i.map(l=>new or(l));return G(r,{code:z.invalid_union,unionErrors:o}),ie}}get options(){return this._def.options}}ca.create=(s,e)=>new ca({options:s,typeName:le.ZodUnion,..._e(e)});const Ft=s=>s instanceof Zs?Ft(s.schema):s instanceof ur?Ft(s.innerType()):s instanceof ha?[s.value]:s instanceof cr?s.options:s instanceof Fs?Ie.objectValues(s.enum):s instanceof pa?Ft(s._def.innerType):s instanceof js?[void 0]:s instanceof Ls?[null]:s instanceof Ht?[void 0,...Ft(s.unwrap())]:s instanceof dr?[null,...Ft(s.unwrap())]:s instanceof Oo||s instanceof va?Ft(s.unwrap()):s instanceof ma?Ft(s._def.innerType):[];class on extends Se{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.object)return G(r,{code:z.invalid_type,expected:W.object,received:r.parsedType}),ie;const a=this.discriminator,t=r.data[a],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):(G(r,{code:z.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),ie)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){const t=new Map;for(const n of r){const i=Ft(n.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(t.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);t.set(o,n)}}return new on({typeName:le.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,..._e(a)})}}function qs(s,e){const r=Wt(s),a=Wt(e);if(s===e)return{valid:!0,data:s};if(r===W.object&&a===W.object){const t=Ie.objectKeys(e),n=Ie.objectKeys(s).filter(o=>t.indexOf(o)!==-1),i={...s,...e};for(const o of n){const l=qs(s[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(r===W.array&&a===W.array){if(s.length!==e.length)return{valid:!1};const t=[];for(let n=0;n<s.length;n++){const i=s[n],o=e[n],l=qs(i,o);if(!l.valid)return{valid:!1};t.push(l.data)}return{valid:!0,data:t}}else return r===W.date&&a===W.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class ua extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=(n,i)=>{if(ei(n)||ei(i))return ie;const o=qs(n.value,i.value);return o.valid?((ti(n)||ti(i))&&r.dirty(),{status:r.value,value:o.data}):(G(a,{code:z.invalid_intersection_types}),ie)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,i])=>t(n,i)):t(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}ua.create=(s,e,r)=>new ua({left:s,right:e,typeName:le.ZodIntersection,..._e(r)});class lr extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.array)return G(a,{code:z.invalid_type,expected:W.array,received:a.parsedType}),ie;if(a.data.length<this._def.items.length)return G(a,{code:z.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ie;!this._def.rest&&a.data.length>this._def.items.length&&(G(a,{code:z.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const n=[...a.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Dt(a,i,a.path,o)):null}).filter(i=>!!i);return a.common.async?Promise.all(n).then(i=>lt.mergeArray(r,i)):lt.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new lr({...this._def,rest:e})}}lr.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new lr({items:s,typeName:le.ZodTuple,rest:null,..._e(e)})};class da extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.object)return G(a,{code:z.invalid_type,expected:W.object,received:a.parsedType}),ie;const t=[],n=this._def.keyType,i=this._def.valueType;for(const o in a.data)t.push({key:n._parse(new Dt(a,o,a.path,o)),value:i._parse(new Dt(a,a.data[o],a.path,o)),alwaysSet:o in a.data});return a.common.async?lt.mergeObjectAsync(r,t):lt.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,a){return r instanceof Se?new da({keyType:e,valueType:r,typeName:le.ZodRecord,..._e(a)}):new da({keyType:Ut.create(),valueType:e,typeName:le.ZodRecord,..._e(r)})}}class ii extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.map)return G(a,{code:z.invalid_type,expected:W.map,received:a.parsedType}),ie;const t=this._def.keyType,n=this._def.valueType,i=[...a.data.entries()].map(([o,l],c)=>({key:t._parse(new Dt(a,o,a.path,[c,"key"])),value:n._parse(new Dt(a,l,a.path,[c,"value"]))}));if(a.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return ie;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of i){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return ie;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}}}}ii.create=(s,e,r)=>new ii({valueType:e,keyType:s,typeName:le.ZodMap,..._e(r)});class Nr extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.set)return G(a,{code:z.invalid_type,expected:W.set,received:a.parsedType}),ie;const t=this._def;t.minSize!==null&&a.data.size<t.minSize.value&&(G(a,{code:z.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&a.data.size>t.maxSize.value&&(G(a,{code:z.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());const n=this._def.valueType;function i(l){const c=new Set;for(const h of l){if(h.status==="aborted")return ie;h.status==="dirty"&&r.dirty(),c.add(h.value)}return{status:r.value,value:c}}const o=[...a.data.values()].map((l,c)=>n._parse(new Dt(a,l,a.path,c)));return a.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,r){return new Nr({...this._def,minSize:{value:e,message:ee.toString(r)}})}max(e,r){return new Nr({...this._def,maxSize:{value:e,message:ee.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Nr.create=(s,e)=>new Nr({valueType:s,minSize:null,maxSize:null,typeName:le.ZodSet,..._e(e)});class Zs extends Se{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Zs.create=(s,e)=>new Zs({getter:s,typeName:le.ZodLazy,..._e(e)});class ha extends Se{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return G(r,{received:r.data,code:z.invalid_literal,expected:this._def.value}),ie}return{status:"valid",value:e.data}}get value(){return this._def.value}}ha.create=(s,e)=>new ha({value:s,typeName:le.ZodLiteral,..._e(e)});function To(s,e){return new cr({values:s,typeName:le.ZodEnum,..._e(e)})}class cr extends Se{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),a=this._def.values;return G(r,{expected:Ie.joinValues(a),received:r.parsedType,code:z.invalid_type}),ie}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),a=this._def.values;return G(r,{received:r.data,code:z.invalid_enum_value,options:a}),ie}return wt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return cr.create(e,{...this._def,...r})}exclude(e,r=this._def){return cr.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}}cr.create=To;class Fs extends Se{_parse(e){const r=Ie.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==W.string&&a.parsedType!==W.number){const t=Ie.objectValues(r);return G(a,{expected:Ie.joinValues(t),received:a.parsedType,code:z.invalid_type}),ie}if(this._cache||(this._cache=new Set(Ie.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const t=Ie.objectValues(r);return G(a,{received:a.data,code:z.invalid_enum_value,options:t}),ie}return wt(e.data)}get enum(){return this._def.values}}Fs.create=(s,e)=>new Fs({values:s,typeName:le.ZodNativeEnum,..._e(e)});class fa extends Se{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.promise&&r.common.async===!1)return G(r,{code:z.invalid_type,expected:W.promise,received:r.parsedType}),ie;const a=r.parsedType===W.promise?r.data:Promise.resolve(r.data);return wt(a.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}}fa.create=(s,e)=>new fa({type:s,typeName:le.ZodPromise,..._e(e)});class ur extends Se{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===le.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:i=>{G(a,i),i.fatal?r.abort():r.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){const i=t.transform(a.data,n);if(a.common.async)return Promise.resolve(i).then(async o=>{if(r.value==="aborted")return ie;const l=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return l.status==="aborted"?ie:l.status==="dirty"||r.value==="dirty"?Ir(l.value):l});{if(r.value==="aborted")return ie;const o=this._def.schema._parseSync({data:i,path:a.path,parent:a});return o.status==="aborted"?ie:o.status==="dirty"||r.value==="dirty"?Ir(o.value):o}}if(t.type==="refinement"){const i=o=>{const l=t.refinement(o,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?ie:(o.status==="dirty"&&r.dirty(),i(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?ie:(o.status==="dirty"&&r.dirty(),i(o.value).then(()=>({status:r.value,value:o.value}))))}if(t.type==="transform")if(a.common.async===!1){const i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!wr(i))return ie;const o=t.transform(i.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>wr(i)?Promise.resolve(t.transform(i.value,n)).then(o=>({status:r.value,value:o})):ie);Ie.assertNever(t)}}ur.create=(s,e,r)=>new ur({schema:s,typeName:le.ZodEffects,effect:e,..._e(r)});ur.createWithPreprocess=(s,e,r)=>new ur({schema:e,effect:{type:"preprocess",transform:s},typeName:le.ZodEffects,..._e(r)});class Ht extends Se{_parse(e){return this._getType(e)===W.undefined?wt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ht.create=(s,e)=>new Ht({innerType:s,typeName:le.ZodOptional,..._e(e)});class dr extends Se{_parse(e){return this._getType(e)===W.null?wt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}dr.create=(s,e)=>new dr({innerType:s,typeName:le.ZodNullable,..._e(e)});class pa extends Se{_parse(e){const{ctx:r}=this._processInputParams(e);let a=r.data;return r.parsedType===W.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}pa.create=(s,e)=>new pa({innerType:s,typeName:le.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,..._e(e)});class ma extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return oa(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new or(a.common.issues)},input:a.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new or(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}ma.create=(s,e)=>new ma({innerType:s,typeName:le.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,..._e(e)});class oi extends Se{_parse(e){if(this._getType(e)!==W.nan){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:W.nan,received:a.parsedType}),ie}return{status:"valid",value:e.data}}}oi.create=s=>new oi({typeName:le.ZodNaN,..._e(s)});class Oo extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class ln extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?ie:n.status==="dirty"?(r.dirty(),Ir(n.value)):this._def.out._parseAsync({data:n.value,path:a.path,parent:a})})();{const t=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?ie:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:a.path,parent:a})}}static create(e,r){return new ln({in:e,out:r,typeName:le.ZodPipeline})}}class va extends Se{_parse(e){const r=this._def.innerType._parse(e),a=t=>(wr(t)&&(t.value=Object.freeze(t.value)),t);return oa(r)?r.then(t=>a(t)):a(r)}unwrap(){return this._def.innerType}}va.create=(s,e)=>new va({innerType:s,typeName:le.ZodReadonly,..._e(e)});var le;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(le||(le={}));const V=Ut.create,Me=Sr.create,mt=Ds.create,qr=Ms.create;er.create;const Ye=Ct.create,K=Ke.create,ct=ca.create,ku=on.create;ua.create;lr.create;const Zr=da.create,ve=ha.create,jt=cr.create;fa.create;const M=Ht.create;dr.create;const $o="2025-06-18",Iu=[$o,"2025-03-26","2024-11-05","2024-10-07"],Ea="2.0",Co=ct([V(),Me().int()]),No=V(),Au=K({progressToken:M(Co)}).passthrough(),St=K({_meta:M(Au)}).passthrough(),ft=K({method:V(),params:M(St)}),Fr=K({_meta:M(K({}).passthrough())}).passthrough(),Mt=K({method:V(),params:M(Fr)}),Et=K({_meta:M(K({}).passthrough())}).passthrough(),Pa=ct([V(),Me().int()]),Do=K({jsonrpc:ve(Ea),id:Pa}).merge(ft).strict(),Tu=s=>Do.safeParse(s).success,jo=K({jsonrpc:ve(Ea)}).merge(Mt).strict(),Ou=s=>jo.safeParse(s).success,Lo=K({jsonrpc:ve(Ea),id:Pa,result:Et}).strict(),li=s=>Lo.safeParse(s).success;var Ze;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(Ze||(Ze={}));const Mo=K({jsonrpc:ve(Ea),id:Pa,error:K({code:Me().int(),message:V(),data:M(qr())})}).strict(),$u=s=>Mo.safeParse(s).success;ct([Do,jo,Lo,Mo]);const cn=Et.strict(),un=Mt.extend({method:ve("notifications/cancelled"),params:Fr.extend({requestId:Pa,reason:V().optional()})}),zr=K({name:V(),title:M(V())}).passthrough(),qo=zr.extend({version:V()}),Cu=K({experimental:M(K({}).passthrough()),sampling:M(K({}).passthrough()),elicitation:M(K({}).passthrough()),roots:M(K({listChanged:M(mt())}).passthrough())}).passthrough(),Zo=ft.extend({method:ve("initialize"),params:St.extend({protocolVersion:V(),capabilities:Cu,clientInfo:qo})}),Nu=K({experimental:M(K({}).passthrough()),logging:M(K({}).passthrough()),completions:M(K({}).passthrough()),prompts:M(K({listChanged:M(mt())}).passthrough()),resources:M(K({subscribe:M(mt()),listChanged:M(mt())}).passthrough()),tools:M(K({listChanged:M(mt())}).passthrough())}).passthrough(),Du=Et.extend({protocolVersion:V(),capabilities:Nu,serverInfo:qo,instructions:M(V())}),Fo=Mt.extend({method:ve("notifications/initialized")}),dn=ft.extend({method:ve("ping")}),ju=K({progress:Me(),total:M(Me()),message:M(V())}).passthrough(),hn=Mt.extend({method:ve("notifications/progress"),params:Fr.merge(ju).extend({progressToken:Co})}),xa=ft.extend({params:St.extend({cursor:M(No)}).optional()}),Ra=Et.extend({nextCursor:M(No)}),zo=K({uri:V(),mimeType:M(V()),_meta:M(K({}).passthrough())}).passthrough(),Uo=zo.extend({text:V()}),fn=V().refine(s=>{try{return atob(s),!0}catch{return!1}},{message:"Invalid Base64 string"}),Vo=zo.extend({blob:fn}),Ho=zr.extend({uri:V(),description:M(V()),mimeType:M(V()),_meta:M(K({}).passthrough())}),Lu=zr.extend({uriTemplate:V(),description:M(V()),mimeType:M(V()),_meta:M(K({}).passthrough())}),zs=xa.extend({method:ve("resources/list")}),Mu=Ra.extend({resources:Ye(Ho)}),Us=xa.extend({method:ve("resources/templates/list")}),qu=Ra.extend({resourceTemplates:Ye(Lu)}),Vs=ft.extend({method:ve("resources/read"),params:St.extend({uri:V()})}),Zu=Et.extend({contents:Ye(ct([Uo,Vo]))}),Fu=Mt.extend({method:ve("notifications/resources/list_changed")}),zu=ft.extend({method:ve("resources/subscribe"),params:St.extend({uri:V()})}),Uu=ft.extend({method:ve("resources/unsubscribe"),params:St.extend({uri:V()})}),Vu=Mt.extend({method:ve("notifications/resources/updated"),params:Fr.extend({uri:V()})}),Hu=K({name:V(),description:M(V()),required:M(mt())}).passthrough(),Bu=zr.extend({description:M(V()),arguments:M(Ye(Hu)),_meta:M(K({}).passthrough())}),Hs=xa.extend({method:ve("prompts/list")}),Gu=Ra.extend({prompts:Ye(Bu)}),Bs=ft.extend({method:ve("prompts/get"),params:St.extend({name:V(),arguments:M(Zr(V()))})}),pn=K({type:ve("text"),text:V(),_meta:M(K({}).passthrough())}).passthrough(),mn=K({type:ve("image"),data:fn,mimeType:V(),_meta:M(K({}).passthrough())}).passthrough(),vn=K({type:ve("audio"),data:fn,mimeType:V(),_meta:M(K({}).passthrough())}).passthrough(),Qu=K({type:ve("resource"),resource:ct([Uo,Vo]),_meta:M(K({}).passthrough())}).passthrough(),Ku=Ho.extend({type:ve("resource_link")}),Bo=ct([pn,mn,vn,Ku,Qu]),Ju=K({role:jt(["user","assistant"]),content:Bo}).passthrough(),Wu=Et.extend({description:M(V()),messages:Ye(Ju)}),Yu=Mt.extend({method:ve("notifications/prompts/list_changed")}),Xu=K({title:M(V()),readOnlyHint:M(mt()),destructiveHint:M(mt()),idempotentHint:M(mt()),openWorldHint:M(mt())}).passthrough(),ed=zr.extend({description:M(V()),inputSchema:K({type:ve("object"),properties:M(K({}).passthrough()),required:M(Ye(V()))}).passthrough(),outputSchema:M(K({type:ve("object"),properties:M(K({}).passthrough()),required:M(Ye(V()))}).passthrough()),annotations:M(Xu),_meta:M(K({}).passthrough())}),Gs=xa.extend({method:ve("tools/list")}),td=Ra.extend({tools:Ye(ed)}),Go=Et.extend({content:Ye(Bo).default([]),structuredContent:K({}).passthrough().optional(),isError:M(mt())});Go.or(Et.extend({toolResult:qr()}));const Qs=ft.extend({method:ve("tools/call"),params:St.extend({name:V(),arguments:M(Zr(qr()))})}),rd=Mt.extend({method:ve("notifications/tools/list_changed")}),Qo=jt(["debug","info","notice","warning","error","critical","alert","emergency"]),ad=ft.extend({method:ve("logging/setLevel"),params:St.extend({level:Qo})}),sd=Mt.extend({method:ve("notifications/message"),params:Fr.extend({level:Qo,logger:M(V()),data:qr()})}),nd=K({name:V().optional()}).passthrough(),id=K({hints:M(Ye(nd)),costPriority:M(Me().min(0).max(1)),speedPriority:M(Me().min(0).max(1)),intelligencePriority:M(Me().min(0).max(1))}).passthrough(),od=K({role:jt(["user","assistant"]),content:ct([pn,mn,vn])}).passthrough(),ld=ft.extend({method:ve("sampling/createMessage"),params:St.extend({messages:Ye(od),systemPrompt:M(V()),includeContext:M(jt(["none","thisServer","allServers"])),temperature:M(Me()),maxTokens:Me().int(),stopSequences:M(Ye(V())),metadata:M(K({}).passthrough()),modelPreferences:M(id)})}),Ko=Et.extend({model:V(),stopReason:M(jt(["endTurn","stopSequence","maxTokens"]).or(V())),role:jt(["user","assistant"]),content:ku("type",[pn,mn,vn])}),cd=K({type:ve("boolean"),title:M(V()),description:M(V()),default:M(mt())}).passthrough(),ud=K({type:ve("string"),title:M(V()),description:M(V()),minLength:M(Me()),maxLength:M(Me()),format:M(jt(["email","uri","date","date-time"]))}).passthrough(),dd=K({type:jt(["number","integer"]),title:M(V()),description:M(V()),minimum:M(Me()),maximum:M(Me())}).passthrough(),hd=K({type:ve("string"),title:M(V()),description:M(V()),enum:Ye(V()),enumNames:M(Ye(V()))}).passthrough(),fd=ct([cd,ud,dd,hd]),pd=ft.extend({method:ve("elicitation/create"),params:St.extend({message:V(),requestedSchema:K({type:ve("object"),properties:Zr(V(),fd),required:M(Ye(V()))}).passthrough()})}),Jo=Et.extend({action:jt(["accept","decline","cancel"]),content:M(Zr(V(),qr()))}),md=K({type:ve("ref/resource"),uri:V()}).passthrough(),vd=K({type:ve("ref/prompt"),name:V()}).passthrough(),Ks=ft.extend({method:ve("completion/complete"),params:St.extend({ref:ct([vd,md]),argument:K({name:V(),value:V()}).passthrough(),context:M(K({arguments:M(Zr(V(),V()))}))})}),gd=Et.extend({completion:K({values:Ye(V()).max(100),total:M(Me().int()),hasMore:M(mt())}).passthrough()}),yd=K({uri:V().startsWith("file://"),name:M(V()),_meta:M(K({}).passthrough())}).passthrough(),_d=ft.extend({method:ve("roots/list")}),Wo=Et.extend({roots:Ye(yd)}),bd=Mt.extend({method:ve("notifications/roots/list_changed")});ct([dn,Zo,Ks,ad,Bs,Hs,zs,Us,Vs,zu,Uu,Qs,Gs]);ct([un,hn,Fo,bd]);ct([cn,Ko,Jo,Wo]);ct([dn,ld,pd,_d]);ct([un,hn,sd,Vu,Fu,rd,Yu]);ct([cn,Du,gd,Wu,Gu,Mu,qu,Zu,Go,td]);class Be extends Error{constructor(e,r,a){super(`MCP error ${e}: ${r}`),this.code=e,this.data=a,this.name="McpError"}}const wd=6e4;class Sd{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(un,r=>{const a=this._requestHandlerAbortControllers.get(r.params.requestId);a?.abort(r.params.reason)}),this.setNotificationHandler(hn,r=>{this._onprogress(r)}),this.setRequestHandler(dn,r=>({}))}_setupTimeout(e,r,a,t,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(t,r),startTime:Date.now(),timeout:r,maxTotalTimeout:a,resetTimeoutOnProgress:n,onTimeout:t})}_resetTimeout(e){const r=this._timeoutInfo.get(e);if(!r)return!1;const a=Date.now()-r.startTime;if(r.maxTotalTimeout&&a>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),new Be(Ze.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:a});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){const r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,a,t;this._transport=e;const n=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};const i=(a=this.transport)===null||a===void 0?void 0:a.onerror;this._transport.onerror=l=>{i?.(l),this._onerror(l)};const o=(t=this._transport)===null||t===void 0?void 0:t.onmessage;this._transport.onmessage=(l,c)=>{o?.(l,c),li(l)||$u(l)?this._onresponse(l):Tu(l)?this._onrequest(l,c):Ou(l)?this._onnotification(l):this._onerror(new Error(`Unknown message type: ${JSON.stringify(l)}`))},await this._transport.start()}_onclose(){var e;const r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);const a=new Be(Ze.ConnectionClosed,"Connection closed");for(const t of r.values())t(a)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;const a=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;a!==void 0&&Promise.resolve().then(()=>a(e)).catch(t=>this._onerror(new Error(`Uncaught error in notification handler: ${t}`)))}_onrequest(e,r){var a,t;const n=(a=this._requestHandlers.get(e.method))!==null&&a!==void 0?a:this.fallbackRequestHandler,i=this._transport;if(n===void 0){i?.send({jsonrpc:"2.0",id:e.id,error:{code:Ze.MethodNotFound,message:"Method not found"}}).catch(c=>this._onerror(new Error(`Failed to send an error response: ${c}`)));return}const o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);const l={signal:o.signal,sessionId:i?.sessionId,_meta:(t=e.params)===null||t===void 0?void 0:t._meta,sendNotification:c=>this.notification(c,{relatedRequestId:e.id}),sendRequest:(c,h,p)=>this.request(c,h,{...p,relatedRequestId:e.id}),authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo};Promise.resolve().then(()=>n(e,l)).then(c=>{if(!o.signal.aborted)return i?.send({result:c,jsonrpc:"2.0",id:e.id})},c=>{var h;if(!o.signal.aborted)return i?.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(c.code)?c.code:Ze.InternalError,message:(h=c.message)!==null&&h!==void 0?h:"Internal error"}})}).catch(c=>this._onerror(new Error(`Failed to send response: ${c}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:r,...a}=e.params,t=Number(r),n=this._progressHandlers.get(t);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}const i=this._responseHandlers.get(t),o=this._timeoutInfo.get(t);if(o&&i&&o.resetTimeoutOnProgress)try{this._resetTimeout(t)}catch(l){i(l);return}n(a)}_onresponse(e){const r=Number(e.id),a=this._responseHandlers.get(r);if(a===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(r),this._progressHandlers.delete(r),this._cleanupTimeout(r),li(e))a(e);else{const t=new Be(e.error.code,e.error.message,e.error.data);a(t)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,a){const{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}=a??{};return new Promise((o,l)=>{var c,h,p,y,u,f;if(!this._transport){l(new Error("Not connected"));return}((c=this._options)===null||c===void 0?void 0:c.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(h=a?.signal)===null||h===void 0||h.throwIfAborted();const _=this._requestMessageId++,v={...e,jsonrpc:"2.0",id:_};a?.onprogress&&(this._progressHandlers.set(_,a.onprogress),v.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:_}});const w=b=>{var P;this._responseHandlers.delete(_),this._progressHandlers.delete(_),this._cleanupTimeout(_),(P=this._transport)===null||P===void 0||P.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:_,reason:String(b)}},{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}).catch(I=>this._onerror(new Error(`Failed to send cancellation: ${I}`))),l(b)};this._responseHandlers.set(_,b=>{var P;if(!(!((P=a?.signal)===null||P===void 0)&&P.aborted)){if(b instanceof Error)return l(b);try{const I=r.parse(b.result);o(I)}catch(I){l(I)}}}),(y=a?.signal)===null||y===void 0||y.addEventListener("abort",()=>{var b;w((b=a?.signal)===null||b===void 0?void 0:b.reason)});const C=(u=a?.timeout)!==null&&u!==void 0?u:wd,A=()=>w(new Be(Ze.RequestTimeout,"Request timed out",{timeout:C}));this._setupTimeout(_,C,a?.maxTotalTimeout,A,(f=a?.resetTimeoutOnProgress)!==null&&f!==void 0?f:!1),this._transport.send(v,{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}).catch(b=>{this._cleanupTimeout(_),l(b)})})}async notification(e,r){var a,t;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((t=(a=this._options)===null||a===void 0?void 0:a.debouncedNotificationMethods)!==null&&t!==void 0?t:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var l;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;const c={...e,jsonrpc:"2.0"};(l=this._transport)===null||l===void 0||l.send(c,r).catch(h=>this._onerror(h))});return}const o={...e,jsonrpc:"2.0"};await this._transport.send(o,r)}setRequestHandler(e,r){const a=e.shape.method.value;this.assertRequestHandlerCapability(a),this._requestHandlers.set(a,(t,n)=>Promise.resolve(r(e.parse(t),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,a=>Promise.resolve(r(e.parse(a))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}}function Ed(s,e){return Object.entries(e).reduce((r,[a,t])=>(t&&typeof t=="object"?r[a]=r[a]?{...r[a],...t}:t:r[a]=t,r),{...s})}var Ar={exports:{}};var Pd=Ar.exports,ci;function xd(){return ci||(ci=1,(function(s,e){(function(r,a){a(e)})(Pd,(function(r){function a(){for(var m=arguments.length,d=Array(m),g=0;g<m;g++)d[g]=arguments[g];if(d.length>1){d[0]=d[0].slice(0,-1);for(var k=d.length-1,R=1;R<k;++R)d[R]=d[R].slice(1,-1);return d[k]=d[k].slice(1),d.join("")}else return d[0]}function t(m){return"(?:"+m+")"}function n(m){return m===void 0?"undefined":m===null?"null":Object.prototype.toString.call(m).split(" ").pop().split("]").shift().toLowerCase()}function i(m){return m.toUpperCase()}function o(m){return m!=null?m instanceof Array?m:typeof m.length!="number"||m.split||m.setInterval||m.call?[m]:Array.prototype.slice.call(m):[]}function l(m,d){var g=m;if(d)for(var k in d)g[k]=d[k];return g}function c(m){var d="[A-Za-z]",g="[0-9]",k=a(g,"[A-Fa-f]"),R=t(t("%[EFef]"+k+"%"+k+k+"%"+k+k)+"|"+t("%[89A-Fa-f]"+k+"%"+k+k)+"|"+t("%"+k+k)),re="[\\:\\/\\?\\#\\[\\]\\@]",ae="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Re=a(re,ae),Ne=m?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Ve=m?"[\\uE000-\\uF8FF]":"[]",Pe=a(d,g,"[\\-\\.\\_\\~]",Ne);t(d+a(d,g,"[\\+\\-\\.]")+"*"),t(t(R+"|"+a(Pe,ae,"[\\:]"))+"*");var Ce=t(t("25[0-5]")+"|"+t("2[0-4]"+g)+"|"+t("1"+g+g)+"|"+t("0?[1-9]"+g)+"|0?0?"+g),He=t(Ce+"\\."+Ce+"\\."+Ce+"\\."+Ce),he=t(k+"{1,4}"),je=t(t(he+"\\:"+he)+"|"+He),Ge=t(t(he+"\\:")+"{6}"+je),Le=t("\\:\\:"+t(he+"\\:")+"{5}"+je),Qt=t(t(he)+"?\\:\\:"+t(he+"\\:")+"{4}"+je),It=t(t(t(he+"\\:")+"{0,1}"+he)+"?\\:\\:"+t(he+"\\:")+"{3}"+je),At=t(t(t(he+"\\:")+"{0,2}"+he)+"?\\:\\:"+t(he+"\\:")+"{2}"+je),fr=t(t(t(he+"\\:")+"{0,3}"+he)+"?\\:\\:"+he+"\\:"+je),tr=t(t(t(he+"\\:")+"{0,4}"+he)+"?\\:\\:"+je),gt=t(t(t(he+"\\:")+"{0,5}"+he)+"?\\:\\:"+he),Tt=t(t(t(he+"\\:")+"{0,6}"+he)+"?\\:\\:"),rr=t([Ge,Le,Qt,It,At,fr,tr,gt,Tt].join("|")),Zt=t(t(Pe+"|"+R)+"+");t("[vV]"+k+"+\\."+a(Pe,ae,"[\\:]")+"+"),t(t(R+"|"+a(Pe,ae))+"*");var Rr=t(R+"|"+a(Pe,ae,"[\\:\\@]"));return t(t(R+"|"+a(Pe,ae,"[\\@]"))+"+"),t(t(Rr+"|"+a("[\\/\\?]",Ve))+"*"),{NOT_SCHEME:new RegExp(a("[^]",d,g,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(a("[^\\%\\:]",Pe,ae),"g"),NOT_HOST:new RegExp(a("[^\\%\\[\\]\\:]",Pe,ae),"g"),NOT_PATH:new RegExp(a("[^\\%\\/\\:\\@]",Pe,ae),"g"),NOT_PATH_NOSCHEME:new RegExp(a("[^\\%\\/\\@]",Pe,ae),"g"),NOT_QUERY:new RegExp(a("[^\\%]",Pe,ae,"[\\:\\@\\/\\?]",Ve),"g"),NOT_FRAGMENT:new RegExp(a("[^\\%]",Pe,ae,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(a("[^]",Pe,ae),"g"),UNRESERVED:new RegExp(Pe,"g"),OTHER_CHARS:new RegExp(a("[^\\%]",Pe,Re),"g"),PCT_ENCODED:new RegExp(R,"g"),IPV4ADDRESS:new RegExp("^("+He+")$"),IPV6ADDRESS:new RegExp("^\\[?("+rr+")"+t(t("\\%25|\\%(?!"+k+"{2})")+"("+Zt+")")+"?\\]?$")}}var h=c(!1),p=c(!0),y=(function(){function m(d,g){var k=[],R=!0,re=!1,ae=void 0;try{for(var Re=d[Symbol.iterator](),Ne;!(R=(Ne=Re.next()).done)&&(k.push(Ne.value),!(g&&k.length===g));R=!0);}catch(Ve){re=!0,ae=Ve}finally{try{!R&&Re.return&&Re.return()}finally{if(re)throw ae}}return k}return function(d,g){if(Array.isArray(d))return d;if(Symbol.iterator in Object(d))return m(d,g);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),u=function(m){if(Array.isArray(m)){for(var d=0,g=Array(m.length);d<m.length;d++)g[d]=m[d];return g}else return Array.from(m)},f=2147483647,_=36,v=1,w=26,C=38,A=700,b=72,P=128,I="-",T=/^xn--/,O=/[^\0-\x7E]/,$=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=_-v,N=Math.floor,q=String.fromCharCode;function Z(m){throw new RangeError(S[m])}function te(m,d){for(var g=[],k=m.length;k--;)g[k]=d(m[k]);return g}function pe(m,d){var g=m.split("@"),k="";g.length>1&&(k=g[0]+"@",m=g[1]),m=m.replace($,".");var R=m.split("."),re=te(R,d).join(".");return k+re}function se(m){for(var d=[],g=0,k=m.length;g<k;){var R=m.charCodeAt(g++);if(R>=55296&&R<=56319&&g<k){var re=m.charCodeAt(g++);(re&64512)==56320?d.push(((R&1023)<<10)+(re&1023)+65536):(d.push(R),g--)}else d.push(R)}return d}var be=function(d){return String.fromCodePoint.apply(String,u(d))},ue=function(d){return d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:_},de=function(d,g){return d+22+75*(d<26)-((g!=0)<<5)},tt=function(d,g,k){var R=0;for(d=k?N(d/A):d>>1,d+=N(d/g);d>x*w>>1;R+=_)d=N(d/x);return N(R+(x+1)*d/(d+C))},Xe=function(d){var g=[],k=d.length,R=0,re=P,ae=b,Re=d.lastIndexOf(I);Re<0&&(Re=0);for(var Ne=0;Ne<Re;++Ne)d.charCodeAt(Ne)>=128&&Z("not-basic"),g.push(d.charCodeAt(Ne));for(var Ve=Re>0?Re+1:0;Ve<k;){for(var Pe=R,Ce=1,He=_;;He+=_){Ve>=k&&Z("invalid-input");var he=ue(d.charCodeAt(Ve++));(he>=_||he>N((f-R)/Ce))&&Z("overflow"),R+=he*Ce;var je=He<=ae?v:He>=ae+w?w:He-ae;if(he<je)break;var Ge=_-je;Ce>N(f/Ge)&&Z("overflow"),Ce*=Ge}var Le=g.length+1;ae=tt(R-Pe,Le,Pe==0),N(R/Le)>f-re&&Z("overflow"),re+=N(R/Le),R%=Le,g.splice(R++,0,re)}return String.fromCodePoint.apply(String,g)},Je=function(d){var g=[];d=se(d);var k=d.length,R=P,re=0,ae=b,Re=!0,Ne=!1,Ve=void 0;try{for(var Pe=d[Symbol.iterator](),Ce;!(Re=(Ce=Pe.next()).done);Re=!0){var He=Ce.value;He<128&&g.push(q(He))}}catch(kr){Ne=!0,Ve=kr}finally{try{!Re&&Pe.return&&Pe.return()}finally{if(Ne)throw Ve}}var he=g.length,je=he;for(he&&g.push(I);je<k;){var Ge=f,Le=!0,Qt=!1,It=void 0;try{for(var At=d[Symbol.iterator](),fr;!(Le=(fr=At.next()).done);Le=!0){var tr=fr.value;tr>=R&&tr<Ge&&(Ge=tr)}}catch(kr){Qt=!0,It=kr}finally{try{!Le&&At.return&&At.return()}finally{if(Qt)throw It}}var gt=je+1;Ge-R>N((f-re)/gt)&&Z("overflow"),re+=(Ge-R)*gt,R=Ge;var Tt=!0,rr=!1,Zt=void 0;try{for(var Rr=d[Symbol.iterator](),In;!(Tt=(In=Rr.next()).done);Tt=!0){var An=In.value;if(An<R&&++re>f&&Z("overflow"),An==R){for(var Vr=re,Hr=_;;Hr+=_){var Br=Hr<=ae?v:Hr>=ae+w?w:Hr-ae;if(Vr<Br)break;var Tn=Vr-Br,On=_-Br;g.push(q(de(Br+Tn%On,0))),Vr=N(Tn/On)}g.push(q(de(Vr,0))),ae=tt(re,gt,je==he),re=0,++je}}}catch(kr){rr=!0,Zt=kr}finally{try{!Tt&&Rr.return&&Rr.return()}finally{if(rr)throw Zt}}++re,++R}return g.join("")},ze=function(d){return pe(d,function(g){return T.test(g)?Xe(g.slice(4).toLowerCase()):g})},vt=function(d){return pe(d,function(g){return O.test(g)?"xn--"+Je(g):g})},E={version:"2.1.0",ucs2:{decode:se,encode:be},decode:Xe,encode:Je,toASCII:vt,toUnicode:ze},D={};function H(m){var d=m.charCodeAt(0),g=void 0;return d<16?g="%0"+d.toString(16).toUpperCase():d<128?g="%"+d.toString(16).toUpperCase():d<2048?g="%"+(d>>6|192).toString(16).toUpperCase()+"%"+(d&63|128).toString(16).toUpperCase():g="%"+(d>>12|224).toString(16).toUpperCase()+"%"+(d>>6&63|128).toString(16).toUpperCase()+"%"+(d&63|128).toString(16).toUpperCase(),g}function ce(m){for(var d="",g=0,k=m.length;g<k;){var R=parseInt(m.substr(g+1,2),16);if(R<128)d+=String.fromCharCode(R),g+=3;else if(R>=194&&R<224){if(k-g>=6){var re=parseInt(m.substr(g+4,2),16);d+=String.fromCharCode((R&31)<<6|re&63)}else d+=m.substr(g,6);g+=6}else if(R>=224){if(k-g>=9){var ae=parseInt(m.substr(g+4,2),16),Re=parseInt(m.substr(g+7,2),16);d+=String.fromCharCode((R&15)<<12|(ae&63)<<6|Re&63)}else d+=m.substr(g,9);g+=9}else d+=m.substr(g,3),g+=3}return d}function j(m,d){function g(k){var R=ce(k);return R.match(d.UNRESERVED)?R:k}return m.scheme&&(m.scheme=String(m.scheme).replace(d.PCT_ENCODED,g).toLowerCase().replace(d.NOT_SCHEME,"")),m.userinfo!==void 0&&(m.userinfo=String(m.userinfo).replace(d.PCT_ENCODED,g).replace(d.NOT_USERINFO,H).replace(d.PCT_ENCODED,i)),m.host!==void 0&&(m.host=String(m.host).replace(d.PCT_ENCODED,g).toLowerCase().replace(d.NOT_HOST,H).replace(d.PCT_ENCODED,i)),m.path!==void 0&&(m.path=String(m.path).replace(d.PCT_ENCODED,g).replace(m.scheme?d.NOT_PATH:d.NOT_PATH_NOSCHEME,H).replace(d.PCT_ENCODED,i)),m.query!==void 0&&(m.query=String(m.query).replace(d.PCT_ENCODED,g).replace(d.NOT_QUERY,H).replace(d.PCT_ENCODED,i)),m.fragment!==void 0&&(m.fragment=String(m.fragment).replace(d.PCT_ENCODED,g).replace(d.NOT_FRAGMENT,H).replace(d.PCT_ENCODED,i)),m}function U(m){return m.replace(/^0*(.*)/,"$1")||"0"}function ge(m,d){var g=m.match(d.IPV4ADDRESS)||[],k=y(g,2),R=k[1];return R?R.split(".").map(U).join("."):m}function Ee(m,d){var g=m.match(d.IPV6ADDRESS)||[],k=y(g,3),R=k[1],re=k[2];if(R){for(var ae=R.toLowerCase().split("::").reverse(),Re=y(ae,2),Ne=Re[0],Ve=Re[1],Pe=Ve?Ve.split(":").map(U):[],Ce=Ne.split(":").map(U),He=d.IPV4ADDRESS.test(Ce[Ce.length-1]),he=He?7:8,je=Ce.length-he,Ge=Array(he),Le=0;Le<he;++Le)Ge[Le]=Pe[Le]||Ce[je+Le]||"";He&&(Ge[he-1]=ge(Ge[he-1],d));var Qt=Ge.reduce(function(gt,Tt,rr){if(!Tt||Tt==="0"){var Zt=gt[gt.length-1];Zt&&Zt.index+Zt.length===rr?Zt.length++:gt.push({index:rr,length:1})}return gt},[]),It=Qt.sort(function(gt,Tt){return Tt.length-gt.length})[0],At=void 0;if(It&&It.length>1){var fr=Ge.slice(0,It.index),tr=Ge.slice(It.index+It.length);At=fr.join(":")+"::"+tr.join(":")}else At=Ge.join(":");return re&&(At+="%"+re),At}else return m}var we=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,De="".match(/(){0}/)[1]===void 0;function Ae(m){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g={},k=d.iri!==!1?p:h;d.reference==="suffix"&&(m=(d.scheme?d.scheme+":":"")+"//"+m);var R=m.match(we);if(R){De?(g.scheme=R[1],g.userinfo=R[3],g.host=R[4],g.port=parseInt(R[5],10),g.path=R[6]||"",g.query=R[7],g.fragment=R[8],isNaN(g.port)&&(g.port=R[5])):(g.scheme=R[1]||void 0,g.userinfo=m.indexOf("@")!==-1?R[3]:void 0,g.host=m.indexOf("//")!==-1?R[4]:void 0,g.port=parseInt(R[5],10),g.path=R[6]||"",g.query=m.indexOf("?")!==-1?R[7]:void 0,g.fragment=m.indexOf("#")!==-1?R[8]:void 0,isNaN(g.port)&&(g.port=m.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?R[4]:void 0)),g.host&&(g.host=Ee(ge(g.host,k),k)),g.scheme===void 0&&g.userinfo===void 0&&g.host===void 0&&g.port===void 0&&!g.path&&g.query===void 0?g.reference="same-document":g.scheme===void 0?g.reference="relative":g.fragment===void 0?g.reference="absolute":g.reference="uri",d.reference&&d.reference!=="suffix"&&d.reference!==g.reference&&(g.error=g.error||"URI is not a "+d.reference+" reference.");var re=D[(d.scheme||g.scheme||"").toLowerCase()];if(!d.unicodeSupport&&(!re||!re.unicodeSupport)){if(g.host&&(d.domainHost||re&&re.domainHost))try{g.host=E.toASCII(g.host.replace(k.PCT_ENCODED,ce).toLowerCase())}catch(ae){g.error=g.error||"Host's domain name can not be converted to ASCII via punycode: "+ae}j(g,h)}else j(g,k);re&&re.parse&&re.parse(g,d)}else g.error=g.error||"URI can not be parsed.";return g}function Te(m,d){var g=d.iri!==!1?p:h,k=[];return m.userinfo!==void 0&&(k.push(m.userinfo),k.push("@")),m.host!==void 0&&k.push(Ee(ge(String(m.host),g),g).replace(g.IPV6ADDRESS,function(R,re,ae){return"["+re+(ae?"%25"+ae:"")+"]"})),(typeof m.port=="number"||typeof m.port=="string")&&(k.push(":"),k.push(String(m.port))),k.length?k.join(""):void 0}var et=/^\.\.?\//,qe=/^\/\.(\/|$)/,Pt=/^\/\.\.(\/|$)/,rt=/^\/?(?:.|\n)*?(?=\/|$)/;function Fe(m){for(var d=[];m.length;)if(m.match(et))m=m.replace(et,"");else if(m.match(qe))m=m.replace(qe,"/");else if(m.match(Pt))m=m.replace(Pt,"/"),d.pop();else if(m==="."||m==="..")m="";else{var g=m.match(rt);if(g){var k=g[0];m=m.slice(k.length),d.push(k)}else throw new Error("Unexpected dot segment condition")}return d.join("")}function Ue(m){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.iri?p:h,k=[],R=D[(d.scheme||m.scheme||"").toLowerCase()];if(R&&R.serialize&&R.serialize(m,d),m.host&&!g.IPV6ADDRESS.test(m.host)){if(d.domainHost||R&&R.domainHost)try{m.host=d.iri?E.toUnicode(m.host):E.toASCII(m.host.replace(g.PCT_ENCODED,ce).toLowerCase())}catch(Re){m.error=m.error||"Host's domain name can not be converted to "+(d.iri?"Unicode":"ASCII")+" via punycode: "+Re}}j(m,g),d.reference!=="suffix"&&m.scheme&&(k.push(m.scheme),k.push(":"));var re=Te(m,d);if(re!==void 0&&(d.reference!=="suffix"&&k.push("//"),k.push(re),m.path&&m.path.charAt(0)!=="/"&&k.push("/")),m.path!==void 0){var ae=m.path;!d.absolutePath&&(!R||!R.absolutePath)&&(ae=Fe(ae)),re===void 0&&(ae=ae.replace(/^\/\//,"/%2F")),k.push(ae)}return m.query!==void 0&&(k.push("?"),k.push(m.query)),m.fragment!==void 0&&(k.push("#"),k.push(m.fragment)),k.join("")}function ut(m,d){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},k=arguments[3],R={};return k||(m=Ae(Ue(m,g),g),d=Ae(Ue(d,g),g)),g=g||{},!g.tolerant&&d.scheme?(R.scheme=d.scheme,R.userinfo=d.userinfo,R.host=d.host,R.port=d.port,R.path=Fe(d.path||""),R.query=d.query):(d.userinfo!==void 0||d.host!==void 0||d.port!==void 0?(R.userinfo=d.userinfo,R.host=d.host,R.port=d.port,R.path=Fe(d.path||""),R.query=d.query):(d.path?(d.path.charAt(0)==="/"?R.path=Fe(d.path):((m.userinfo!==void 0||m.host!==void 0||m.port!==void 0)&&!m.path?R.path="/"+d.path:m.path?R.path=m.path.slice(0,m.path.lastIndexOf("/")+1)+d.path:R.path=d.path,R.path=Fe(R.path)),R.query=d.query):(R.path=m.path,d.query!==void 0?R.query=d.query:R.query=m.query),R.userinfo=m.userinfo,R.host=m.host,R.port=m.port),R.scheme=m.scheme),R.fragment=d.fragment,R}function Ur(m,d,g){var k=l({scheme:"null"},g);return Ue(ut(Ae(m,k),Ae(d,k),k,!0),k)}function ka(m,d){return typeof m=="string"?m=Ue(Ae(m,d),d):n(m)==="object"&&(m=Ae(Ue(m,d),d)),m}function Ia(m,d,g){return typeof m=="string"?m=Ue(Ae(m,g),g):n(m)==="object"&&(m=Ue(m,g)),typeof d=="string"?d=Ue(Ae(d,g),g):n(d)==="object"&&(d=Ue(d,g)),m===d}function cl(m,d){return m&&m.toString().replace(!d||!d.iri?h.ESCAPE:p.ESCAPE,H)}function qt(m,d){return m&&m.toString().replace(!d||!d.iri?h.PCT_ENCODED:p.PCT_ENCODED,ce)}var Pr={scheme:"http",domainHost:!0,parse:function(d,g){return d.host||(d.error=d.error||"HTTP URIs must have a host."),d},serialize:function(d,g){var k=String(d.scheme).toLowerCase()==="https";return(d.port===(k?443:80)||d.port==="")&&(d.port=void 0),d.path||(d.path="/"),d}},bn={scheme:"https",domainHost:Pr.domainHost,parse:Pr.parse,serialize:Pr.serialize};function wn(m){return typeof m.secure=="boolean"?m.secure:String(m.scheme).toLowerCase()==="wss"}var xr={scheme:"ws",domainHost:!0,parse:function(d,g){var k=d;return k.secure=wn(k),k.resourceName=(k.path||"/")+(k.query?"?"+k.query:""),k.path=void 0,k.query=void 0,k},serialize:function(d,g){if((d.port===(wn(d)?443:80)||d.port==="")&&(d.port=void 0),typeof d.secure=="boolean"&&(d.scheme=d.secure?"wss":"ws",d.secure=void 0),d.resourceName){var k=d.resourceName.split("?"),R=y(k,2),re=R[0],ae=R[1];d.path=re&&re!=="/"?re:void 0,d.query=ae,d.resourceName=void 0}return d.fragment=void 0,d}},Sn={scheme:"wss",domainHost:xr.domainHost,parse:xr.parse,serialize:xr.serialize},ul={},En="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",kt="[0-9A-Fa-f]",dl=t(t("%[EFef]"+kt+"%"+kt+kt+"%"+kt+kt)+"|"+t("%[89A-Fa-f]"+kt+"%"+kt+kt)+"|"+t("%"+kt+kt)),hl="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",fl="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",pl=a(fl,'[\\"\\\\]'),ml="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",vl=new RegExp(En,"g"),hr=new RegExp(dl,"g"),gl=new RegExp(a("[^]",hl,"[\\.]",'[\\"]',pl),"g"),Pn=new RegExp(a("[^]",En,ml),"g"),yl=Pn;function Aa(m){var d=ce(m);return d.match(vl)?d:m}var xn={scheme:"mailto",parse:function(d,g){var k=d,R=k.to=k.path?k.path.split(","):[];if(k.path=void 0,k.query){for(var re=!1,ae={},Re=k.query.split("&"),Ne=0,Ve=Re.length;Ne<Ve;++Ne){var Pe=Re[Ne].split("=");switch(Pe[0]){case"to":for(var Ce=Pe[1].split(","),He=0,he=Ce.length;He<he;++He)R.push(Ce[He]);break;case"subject":k.subject=qt(Pe[1],g);break;case"body":k.body=qt(Pe[1],g);break;default:re=!0,ae[qt(Pe[0],g)]=qt(Pe[1],g);break}}re&&(k.headers=ae)}k.query=void 0;for(var je=0,Ge=R.length;je<Ge;++je){var Le=R[je].split("@");if(Le[0]=qt(Le[0]),g.unicodeSupport)Le[1]=qt(Le[1],g).toLowerCase();else try{Le[1]=E.toASCII(qt(Le[1],g).toLowerCase())}catch(Qt){k.error=k.error||"Email address's domain name can not be converted to ASCII via punycode: "+Qt}R[je]=Le.join("@")}return k},serialize:function(d,g){var k=d,R=o(d.to);if(R){for(var re=0,ae=R.length;re<ae;++re){var Re=String(R[re]),Ne=Re.lastIndexOf("@"),Ve=Re.slice(0,Ne).replace(hr,Aa).replace(hr,i).replace(gl,H),Pe=Re.slice(Ne+1);try{Pe=g.iri?E.toUnicode(Pe):E.toASCII(qt(Pe,g).toLowerCase())}catch(je){k.error=k.error||"Email address's domain name can not be converted to "+(g.iri?"Unicode":"ASCII")+" via punycode: "+je}R[re]=Ve+"@"+Pe}k.path=R.join(",")}var Ce=d.headers=d.headers||{};d.subject&&(Ce.subject=d.subject),d.body&&(Ce.body=d.body);var He=[];for(var he in Ce)Ce[he]!==ul[he]&&He.push(he.replace(hr,Aa).replace(hr,i).replace(Pn,H)+"="+Ce[he].replace(hr,Aa).replace(hr,i).replace(yl,H));return He.length&&(k.query=He.join("&")),k}},_l=/^([^\:]+)\:(.*)/,Rn={scheme:"urn",parse:function(d,g){var k=d.path&&d.path.match(_l),R=d;if(k){var re=g.scheme||R.scheme||"urn",ae=k[1].toLowerCase(),Re=k[2],Ne=re+":"+(g.nid||ae),Ve=D[Ne];R.nid=ae,R.nss=Re,R.path=void 0,Ve&&(R=Ve.parse(R,g))}else R.error=R.error||"URN can not be parsed.";return R},serialize:function(d,g){var k=g.scheme||d.scheme||"urn",R=d.nid,re=k+":"+(g.nid||R),ae=D[re];ae&&(d=ae.serialize(d,g));var Re=d,Ne=d.nss;return Re.path=(R||g.nid)+":"+Ne,Re}},bl=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,kn={scheme:"urn:uuid",parse:function(d,g){var k=d;return k.uuid=k.nss,k.nss=void 0,!g.tolerant&&(!k.uuid||!k.uuid.match(bl))&&(k.error=k.error||"UUID is not valid."),k},serialize:function(d,g){var k=d;return k.nss=(d.uuid||"").toLowerCase(),k}};D[Pr.scheme]=Pr,D[bn.scheme]=bn,D[xr.scheme]=xr,D[Sn.scheme]=Sn,D[xn.scheme]=xn,D[Rn.scheme]=Rn,D[kn.scheme]=kn,r.SCHEMES=D,r.pctEncChar=H,r.pctDecChars=ce,r.parse=Ae,r.removeDotSegments=Fe,r.serialize=Ue,r.resolveComponents=ut,r.resolve=Ur,r.normalize=ka,r.equal=Ia,r.escapeComponent=cl,r.unescapeComponent=qt,Object.defineProperty(r,"__esModule",{value:!0})}))})(Ar,Ar.exports)),Ar.exports}var Na,ui;function gn(){return ui||(ui=1,Na=function s(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var a,t,n;if(Array.isArray(e)){if(a=e.length,a!=r.length)return!1;for(t=a;t--!==0;)if(!s(e[t],r[t]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(n=Object.keys(e),a=n.length,a!==Object.keys(r).length)return!1;for(t=a;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,n[t]))return!1;for(t=a;t--!==0;){var i=n[t];if(!s(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}),Na}var Da,di;function Rd(){return di||(di=1,Da=function(e){for(var r=0,a=e.length,t=0,n;t<a;)r++,n=e.charCodeAt(t++),n>=55296&&n<=56319&&t<a&&(n=e.charCodeAt(t),(n&64512)==56320&&t++);return r}),Da}var ja,hi;function Er(){if(hi)return ja;hi=1,ja={copy:s,checkDataType:e,checkDataTypes:r,coerceToTypes:t,toHash:n,getProperty:l,escapeQuotes:c,equal:gn(),ucs2length:Rd(),varOccurences:h,varReplace:p,schemaHasRules:y,schemaHasRulesExcept:u,schemaUnknownRules:f,toQuotedString:_,getPathExpr:v,getPath:w,getData:b,unescapeFragment:I,unescapeJsonPointer:$,escapeFragment:T,escapeJsonPointer:O};function s(S,x){x=x||{};for(var N in S)x[N]=S[N];return x}function e(S,x,N,q){var Z=q?" !== ":" === ",te=q?" || ":" && ",pe=q?"!":"",se=q?"":"!";switch(S){case"null":return x+Z+"null";case"array":return pe+"Array.isArray("+x+")";case"object":return"("+pe+x+te+"typeof "+x+Z+'"object"'+te+se+"Array.isArray("+x+"))";case"integer":return"(typeof "+x+Z+'"number"'+te+se+"("+x+" % 1)"+te+x+Z+x+(N?te+pe+"isFinite("+x+")":"")+")";case"number":return"(typeof "+x+Z+'"'+S+'"'+(N?te+pe+"isFinite("+x+")":"")+")";default:return"typeof "+x+Z+'"'+S+'"'}}function r(S,x,N){switch(S.length){case 1:return e(S[0],x,N,!0);default:var q="",Z=n(S);Z.array&&Z.object&&(q=Z.null?"(":"(!"+x+" || ",q+="typeof "+x+' !== "object")',delete Z.null,delete Z.array,delete Z.object),Z.number&&delete Z.integer;for(var te in Z)q+=(q?" && ":"")+e(te,x,N,!0);return q}}var a=n(["string","number","integer","boolean","null"]);function t(S,x){if(Array.isArray(x)){for(var N=[],q=0;q<x.length;q++){var Z=x[q];(a[Z]||S==="array"&&Z==="array")&&(N[N.length]=Z)}if(N.length)return N}else{if(a[x])return[x];if(S==="array"&&x==="array")return["array"]}}function n(S){for(var x={},N=0;N<S.length;N++)x[S[N]]=!0;return x}var i=/^[a-z$_][a-z$_0-9]*$/i,o=/'|\\/g;function l(S){return typeof S=="number"?"["+S+"]":i.test(S)?"."+S:"['"+c(S)+"']"}function c(S){return S.replace(o,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function h(S,x){x+="[^0-9]";var N=S.match(new RegExp(x,"g"));return N?N.length:0}function p(S,x,N){return x+="([^0-9])",N=N.replace(/\$/g,"$$$$"),S.replace(new RegExp(x,"g"),N+"$1")}function y(S,x){if(typeof S=="boolean")return!S;for(var N in S)if(x[N])return!0}function u(S,x,N){if(typeof S=="boolean")return!S&&N!="not";for(var q in S)if(q!=N&&x[q])return!0}function f(S,x){if(typeof S!="boolean"){for(var N in S)if(!x[N])return N}}function _(S){return"'"+c(S)+"'"}function v(S,x,N,q){var Z=N?"'/' + "+x+(q?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):q?"'[' + "+x+" + ']'":"'[\\'' + "+x+" + '\\']'";return P(S,Z)}function w(S,x,N){var q=_(N?"/"+O(x):l(x));return P(S,q)}var C=/^\/(?:[^~]|~0|~1)*$/,A=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function b(S,x,N){var q,Z,te,pe;if(S==="")return"rootData";if(S[0]=="/"){if(!C.test(S))throw new Error("Invalid JSON-pointer: "+S);Z=S,te="rootData"}else{if(pe=S.match(A),!pe)throw new Error("Invalid JSON-pointer: "+S);if(q=+pe[1],Z=pe[2],Z=="#"){if(q>=x)throw new Error("Cannot access property/index "+q+" levels up, current level is "+x);return N[x-q]}if(q>x)throw new Error("Cannot access data "+q+" levels up, current level is "+x);if(te="data"+(x-q||""),!Z)return te}for(var se=te,be=Z.split("/"),ue=0;ue<be.length;ue++){var de=be[ue];de&&(te+=l($(de)),se+=" && "+te)}return se}function P(S,x){return S=='""'?x:(S+" + "+x).replace(/([^\\])' \+ '/g,"$1")}function I(S){return $(decodeURIComponent(S))}function T(S){return encodeURIComponent(O(S))}function O(S){return S.replace(/~/g,"~0").replace(/\//g,"~1")}function $(S){return S.replace(/~1/g,"/").replace(/~0/g,"~")}return ja}var La,fi;function Yo(){if(fi)return La;fi=1;var s=Er();La=e;function e(r){s.copy(r,this)}return La}var Ma={exports:{}},pi;function kd(){if(pi)return Ma.exports;pi=1;var s=Ma.exports=function(a,t,n){typeof t=="function"&&(n=t,t={}),n=t.cb||n;var i=typeof n=="function"?n:n.pre||function(){},o=n.post||function(){};e(t,i,o,a,"",a)};s.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},s.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},s.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},s.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(a,t,n,i,o,l,c,h,p,y){if(i&&typeof i=="object"&&!Array.isArray(i)){t(i,o,l,c,h,p,y);for(var u in i){var f=i[u];if(Array.isArray(f)){if(u in s.arrayKeywords)for(var _=0;_<f.length;_++)e(a,t,n,f[_],o+"/"+u+"/"+_,l,o,u,i,_)}else if(u in s.propsKeywords){if(f&&typeof f=="object")for(var v in f)e(a,t,n,f[v],o+"/"+u+"/"+r(v),l,o,u,i,v)}else(u in s.keywords||a.allKeys&&!(u in s.skipKeywords))&&e(a,t,n,f,o+"/"+u,l,o,u,i)}n(i,o,l,c,h,p,y)}}function r(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}return Ma.exports}var qa,mi;function yn(){if(mi)return qa;mi=1;var s=xd(),e=gn(),r=Er(),a=Yo(),t=kd();qa=n,n.normalizeId=w,n.fullPath=f,n.url=C,n.ids=A,n.inlineRef=p,n.schema=i;function n(b,P,I){var T=this._refs[I];if(typeof T=="string")if(this._refs[T])T=this._refs[T];else return n.call(this,b,P,T);if(T=T||this._schemas[I],T instanceof a)return p(T.schema,this._opts.inlineRefs)?T.schema:T.validate||this._compile(T);var O=i.call(this,P,I),$,S,x;return O&&($=O.schema,P=O.root,x=O.baseId),$ instanceof a?S=$.validate||b.call(this,$.schema,P,void 0,x):$!==void 0&&(S=p($,this._opts.inlineRefs)?$:b.call(this,$,P,void 0,x)),S}function i(b,P){var I=s.parse(P),T=_(I),O=f(this._getId(b.schema));if(Object.keys(b.schema).length===0||T!==O){var $=w(T),S=this._refs[$];if(typeof S=="string")return o.call(this,b,S,I);if(S instanceof a)S.validate||this._compile(S),b=S;else if(S=this._schemas[$],S instanceof a){if(S.validate||this._compile(S),$==w(P))return{schema:S,root:b,baseId:O};b=S}else return;if(!b.schema)return;O=f(this._getId(b.schema))}return c.call(this,I,O,b.schema,b)}function o(b,P,I){var T=i.call(this,b,P);if(T){var O=T.schema,$=T.baseId;b=T.root;var S=this._getId(O);return S&&($=C($,S)),c.call(this,I,$,O,b)}}var l=r.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function c(b,P,I,T){if(b.fragment=b.fragment||"",b.fragment.slice(0,1)=="/"){for(var O=b.fragment.split("/"),$=1;$<O.length;$++){var S=O[$];if(S){if(S=r.unescapeFragment(S),I=I[S],I===void 0)break;var x;if(!l[S]&&(x=this._getId(I),x&&(P=C(P,x)),I.$ref)){var N=C(P,I.$ref),q=i.call(this,T,N);q&&(I=q.schema,T=q.root,P=q.baseId)}}}if(I!==void 0&&I!==T.schema)return{schema:I,root:T,baseId:P}}}var h=r.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function p(b,P){if(P===!1)return!1;if(P===void 0||P===!0)return y(b);if(P)return u(b)<=P}function y(b){var P;if(Array.isArray(b)){for(var I=0;I<b.length;I++)if(P=b[I],typeof P=="object"&&!y(P))return!1}else for(var T in b)if(T=="$ref"||(P=b[T],typeof P=="object"&&!y(P)))return!1;return!0}function u(b){var P=0,I;if(Array.isArray(b)){for(var T=0;T<b.length;T++)if(I=b[T],typeof I=="object"&&(P+=u(I)),P==1/0)return 1/0}else for(var O in b){if(O=="$ref")return 1/0;if(h[O])P++;else if(I=b[O],typeof I=="object"&&(P+=u(I)+1),P==1/0)return 1/0}return P}function f(b,P){P!==!1&&(b=w(b));var I=s.parse(b);return _(I)}function _(b){return s.serialize(b).split("#")[0]+"#"}var v=/#\/?$/;function w(b){return b?b.replace(v,""):""}function C(b,P){return P=w(P),s.resolve(b,P)}function A(b){var P=w(this._getId(b)),I={"":P},T={"":f(P,!1)},O={},$=this;return t(b,{allKeys:!0},function(S,x,N,q,Z,te,pe){if(x!==""){var se=$._getId(S),be=I[q],ue=T[q]+"/"+Z;if(pe!==void 0&&(ue+="/"+(typeof pe=="number"?pe:r.escapeFragment(pe))),typeof se=="string"){se=be=w(be?s.resolve(be,se):se);var de=$._refs[se];if(typeof de=="string"&&(de=$._refs[de]),de&&de.schema){if(!e(S,de.schema))throw new Error('id "'+se+'" resolves to more than one schema')}else if(se!=w(ue))if(se[0]=="#"){if(O[se]&&!e(S,O[se]))throw new Error('id "'+se+'" resolves to more than one schema');O[se]=S}else $._refs[se]=ue}I[x]=be,T[x]=ue}}),O}return qa}var Za,vi;function _n(){if(vi)return Za;vi=1;var s=yn();Za={Validation:a(e),MissingRef:a(r)};function e(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}r.message=function(t,n){return"can't resolve reference "+n+" from id "+t};function r(t,n,i){this.message=i||r.message(t,n),this.missingRef=s.url(t,n),this.missingSchema=s.normalizeId(s.fullPath(this.missingRef))}function a(t){return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}return Za}var Fa,gi;function Xo(){return gi||(gi=1,Fa=function(s,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,a=e.cmp&&(function(n){return function(i){return function(o,l){var c={key:o,value:i[o]},h={key:l,value:i[l]};return n(c,h)}}})(e.cmp),t=[];return(function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i!==void 0){if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);var o,l;if(Array.isArray(i)){for(l="[",o=0;o<i.length;o++)o&&(l+=","),l+=n(i[o])||"null";return l+"]"}if(i===null)return"null";if(t.indexOf(i)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var c=t.push(i)-1,h=Object.keys(i).sort(a&&a(i));for(l="",o=0;o<h.length;o++){var p=h[o],y=n(i[p]);y&&(l&&(l+=","),l+=JSON.stringify(p)+":"+y)}return t.splice(c,1),"{"+l+"}"}})(s)}),Fa}var za,yi;function el(){return yi||(yi=1,za=function(e,r,a){var t="",n=e.schema.$async===!0,i=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var c="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(c);else throw new Error(c)}}if(e.isTop&&(t+=" var validate = ",n&&(e.async=!0,t+="async "),t+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(t+=" "+("/*# sourceURL="+o+" */")+" ")),typeof e.schema=="boolean"||!(i||e.schema.$ref)){var r="false schema",h=e.level,p=e.dataLevel,y=e.schema[r],u=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,P=!e.opts.allErrors,O,_="data"+(p||""),b="valid"+h;if(e.schema===!1){e.isTop?P=!0:t+=" var "+b+" = false; ";var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'boolean schema is false' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var w=t;t=v.pop(),!e.compositeRule&&P?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?t+=" return data; ":t+=" validate.errors = null; return true; ":t+=" var "+b+" = true; ";return e.isTop&&(t+=" }; return validate; "),t}if(e.isTop){var C=e.isTop,h=e.level=0,p=e.dataLevel=0,_="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var A="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(A);else throw new Error(A)}t+=" var vErrors = null; ",t+=" var errors = 0;     ",t+=" if (rootData === undefined) rootData = data; "}else{var h=e.level,p=e.dataLevel,_="data"+(p||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),n&&!e.async)throw new Error("async schema in sync schema");t+=" var errs_"+h+" = errors;"}var b="valid"+h,P=!e.opts.allErrors,I="",T="",O,$=e.schema.type,S=Array.isArray($);if($&&e.opts.nullable&&e.schema.nullable===!0&&(S?$.indexOf("null")==-1&&($=$.concat("null")):$!="null"&&($=[$,"null"],S=!0)),S&&$.length==1&&($=$[0],S=!1),e.schema.$ref&&i){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(i=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(t+=" "+e.RULES.all.$comment.code(e,"$comment")),$){if(e.opts.coerceTypes)var x=e.util.coerceToTypes(e.opts.coerceTypes,$);var N=e.RULES.types[$];if(x||S||N===!0||N&&!qe(N)){var u=e.schemaPath+".type",f=e.errSchemaPath+"/type",u=e.schemaPath+".type",f=e.errSchemaPath+"/type",q=S?"checkDataTypes":"checkDataType";if(t+=" if ("+e.util[q]($,_,e.opts.strictNumbers,!0)+") { ",x){var Z="dataType"+h,te="coerced"+h;t+=" var "+Z+" = typeof "+_+"; var "+te+" = undefined; ",e.opts.coerceTypes=="array"&&(t+=" if ("+Z+" == 'object' && Array.isArray("+_+") && "+_+".length == 1) { "+_+" = "+_+"[0]; "+Z+" = typeof "+_+"; if ("+e.util.checkDataType(e.schema.type,_,e.opts.strictNumbers)+") "+te+" = "+_+"; } "),t+=" if ("+te+" !== undefined) ; ";var pe=x;if(pe)for(var se,be=-1,ue=pe.length-1;be<ue;)se=pe[be+=1],se=="string"?t+=" else if ("+Z+" == 'number' || "+Z+" == 'boolean') "+te+" = '' + "+_+"; else if ("+_+" === null) "+te+" = ''; ":se=="number"||se=="integer"?(t+=" else if ("+Z+" == 'boolean' || "+_+" === null || ("+Z+" == 'string' && "+_+" && "+_+" == +"+_+" ",se=="integer"&&(t+=" && !("+_+" % 1)"),t+=")) "+te+" = +"+_+"; "):se=="boolean"?t+=" else if ("+_+" === 'false' || "+_+" === 0 || "+_+" === null) "+te+" = false; else if ("+_+" === 'true' || "+_+" === 1) "+te+" = true; ":se=="null"?t+=" else if ("+_+" === '' || "+_+" === 0 || "+_+" === false) "+te+" = null; ":e.opts.coerceTypes=="array"&&se=="array"&&(t+=" else if ("+Z+" == 'string' || "+Z+" == 'number' || "+Z+" == 'boolean' || "+_+" == null) "+te+" = ["+_+"]; ");t+=" else {   ";var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { type: '",S?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",S?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var w=t;t=v.pop(),!e.compositeRule&&P?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } if ("+te+" !== undefined) {  ";var de=p?"data"+(p-1||""):"parentData",tt=p?e.dataPathArr[p]:"parentDataProperty";t+=" "+_+" = "+te+"; ",p||(t+="if ("+de+" !== undefined)"),t+=" "+de+"["+tt+"] = "+te+"; } "}else{var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { type: '",S?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",S?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var w=t;t=v.pop(),!e.compositeRule&&P?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}t+=" } "}}if(e.schema.$ref&&!i)t+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",P&&(t+=" } if (errors === ",C?t+="0":t+="errs_"+h,t+=") { ",T+="}");else{var Xe=e.RULES;if(Xe){for(var N,Je=-1,ze=Xe.length-1;Je<ze;)if(N=Xe[Je+=1],qe(N)){if(N.type&&(t+=" if ("+e.util.checkDataType(N.type,_,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(N.type=="object"&&e.schema.properties){var y=e.schema.properties,vt=Object.keys(y),E=vt;if(E)for(var D,H=-1,ce=E.length-1;H<ce;){D=E[H+=1];var j=y[D];if(j.default!==void 0){var U=_+e.util.getProperty(D);if(e.compositeRule){if(e.opts.strictDefaults){var A="default is ignored for: "+U;if(e.opts.strictDefaults==="log")e.logger.warn(A);else throw new Error(A)}}else t+=" if ("+U+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+U+" === null || "+U+" === '' "),t+=" ) "+U+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(j.default)+" ":t+=" "+JSON.stringify(j.default)+" ",t+="; "}}}else if(N.type=="array"&&Array.isArray(e.schema.items)){var ge=e.schema.items;if(ge){for(var j,be=-1,Ee=ge.length-1;be<Ee;)if(j=ge[be+=1],j.default!==void 0){var U=_+"["+be+"]";if(e.compositeRule){if(e.opts.strictDefaults){var A="default is ignored for: "+U;if(e.opts.strictDefaults==="log")e.logger.warn(A);else throw new Error(A)}}else t+=" if ("+U+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+U+" === null || "+U+" === '' "),t+=" ) "+U+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(j.default)+" ":t+=" "+JSON.stringify(j.default)+" ",t+="; "}}}}var we=N.rules;if(we){for(var De,Ae=-1,Te=we.length-1;Ae<Te;)if(De=we[Ae+=1],Pt(De)){var et=De.code(e,De.keyword,N.type);et&&(t+=" "+et+" ",P&&(I+="}"))}}if(P&&(t+=" "+I+" ",I=""),N.type&&(t+=" } ",$&&$===N.type&&!x)){t+=" else { ";var u=e.schemaPath+".type",f=e.errSchemaPath+"/type",v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { type: '",S?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",S?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),t+=" } "):t+=" {} ";var w=t;t=v.pop(),!e.compositeRule&&P?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}P&&(t+=" if (errors === ",C?t+="0":t+="errs_"+h,t+=") { ",T+="}")}}}P&&(t+=" "+T+" "),C?(n?(t+=" if (errors === 0) return data;           ",t+=" else throw new ValidationError(vErrors); "):(t+=" validate.errors = vErrors; ",t+=" return errors === 0;       "),t+=" }; return validate;"):t+=" var "+b+" = errors === errs_"+h+";";function qe(Fe){for(var Ue=Fe.rules,ut=0;ut<Ue.length;ut++)if(Pt(Ue[ut]))return!0}function Pt(Fe){return e.schema[Fe.keyword]!==void 0||Fe.implements&&rt(Fe)}function rt(Fe){for(var Ue=Fe.implements,ut=0;ut<Ue.length;ut++)if(e.schema[Ue[ut]]!==void 0)return!0}return t}),za}var Ua,_i;function Id(){if(_i)return Ua;_i=1;var s=yn(),e=Er(),r=_n(),a=Xo(),t=el(),n=e.ucs2length,i=gn(),o=r.Validation;Ua=l;function l(w,C,A,b){var P=this,I=this._opts,T=[void 0],O={},$=[],S={},x=[],N={},q=[];C=C||{schema:w,refVal:T,refs:O};var Z=c.call(this,w,C,b),te=this._compilations[Z.index];if(Z.compiling)return te.callValidate=de;var pe=this._formats,se=this.RULES;try{var be=tt(w,C,A,b);te.validate=be;var ue=te.callValidate;return ue&&(ue.schema=be.schema,ue.errors=null,ue.refs=be.refs,ue.refVal=be.refVal,ue.root=be.root,ue.$async=be.$async,I.sourceCode&&(ue.source=be.source)),be}finally{h.call(this,w,C,b)}function de(){var j=te.validate,U=j.apply(this,arguments);return de.errors=j.errors,U}function tt(j,U,ge,Ee){var we=!U||U&&U.schema==j;if(U.schema!=C.schema)return l.call(P,j,U,ge,Ee);var De=j.$async===!0,Ae=t({isTop:!0,schema:j,isRoot:we,baseId:Ee,root:U,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:r.MissingRef,RULES:se,validate:t,util:e,resolve:s,resolveRef:Xe,usePattern:D,useDefault:H,useCustomRule:ce,opts:I,formats:pe,logger:P.logger,self:P});Ae=v(T,f)+v($,y)+v(x,u)+v(q,_)+Ae,I.processCode&&(Ae=I.processCode(Ae,j));var Te;try{var et=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",Ae);Te=et(P,se,pe,C,T,x,q,i,n,o),T[0]=Te}catch(qe){throw P.logger.error("Error compiling schema, function code:",Ae),qe}return Te.schema=j,Te.errors=null,Te.refs=O,Te.refVal=T,Te.root=we?Te:U,De&&(Te.$async=!0),I.sourceCode===!0&&(Te.source={code:Ae,patterns:$,defaults:x}),Te}function Xe(j,U,ge){U=s.url(j,U);var Ee=O[U],we,De;if(Ee!==void 0)return we=T[Ee],De="refVal["+Ee+"]",E(we,De);if(!ge&&C.refs){var Ae=C.refs[U];if(Ae!==void 0)return we=C.refVal[Ae],De=Je(U,we),E(we,De)}De=Je(U);var Te=s.call(P,tt,C,U);if(Te===void 0){var et=A&&A[U];et&&(Te=s.inlineRef(et,I.inlineRefs)?et:l.call(P,et,C,A,j))}if(Te===void 0)ze(U);else return vt(U,Te),E(Te,De)}function Je(j,U){var ge=T.length;return T[ge]=U,O[j]=ge,"refVal"+ge}function ze(j){delete O[j]}function vt(j,U){var ge=O[j];T[ge]=U}function E(j,U){return typeof j=="object"||typeof j=="boolean"?{code:U,schema:j,inline:!0}:{code:U,$async:j&&!!j.$async}}function D(j){var U=S[j];return U===void 0&&(U=S[j]=$.length,$[U]=j),"pattern"+U}function H(j){switch(typeof j){case"boolean":case"number":return""+j;case"string":return e.toQuotedString(j);case"object":if(j===null)return"null";var U=a(j),ge=N[U];return ge===void 0&&(ge=N[U]=x.length,x[ge]=j),"default"+ge}}function ce(j,U,ge,Ee){if(P._opts.validateSchema!==!1){var we=j.definition.dependencies;if(we&&!we.every(function(Ue){return Object.prototype.hasOwnProperty.call(ge,Ue)}))throw new Error("parent schema must have all required keywords: "+we.join(","));var De=j.definition.validateSchema;if(De){var Ae=De(U);if(!Ae){var Te="keyword schema is invalid: "+P.errorsText(De.errors);if(P._opts.validateSchema=="log")P.logger.error(Te);else throw new Error(Te)}}}var et=j.definition.compile,qe=j.definition.inline,Pt=j.definition.macro,rt;if(et)rt=et.call(P,U,ge,Ee);else if(Pt)rt=Pt.call(P,U,ge,Ee),I.validateSchema!==!1&&P.validateSchema(rt,!0);else if(qe)rt=qe.call(P,Ee,j.keyword,U,ge);else if(rt=j.definition.validate,!rt)return;if(rt===void 0)throw new Error('custom keyword "'+j.keyword+'"failed to compile');var Fe=q.length;return q[Fe]=rt,{code:"customRule"+Fe,validate:rt}}}function c(w,C,A){var b=p.call(this,w,C,A);return b>=0?{index:b,compiling:!0}:(b=this._compilations.length,this._compilations[b]={schema:w,root:C,baseId:A},{index:b,compiling:!1})}function h(w,C,A){var b=p.call(this,w,C,A);b>=0&&this._compilations.splice(b,1)}function p(w,C,A){for(var b=0;b<this._compilations.length;b++){var P=this._compilations[b];if(P.schema==w&&P.root==C&&P.baseId==A)return b}return-1}function y(w,C){return"var pattern"+w+" = new RegExp("+e.toQuotedString(C[w])+");"}function u(w){return"var default"+w+" = defaults["+w+"];"}function f(w,C){return C[w]===void 0?"":"var refVal"+w+" = refVal["+w+"];"}function _(w){return"var customRule"+w+" = customRules["+w+"];"}function v(w,C){if(!w.length)return"";for(var A="",b=0;b<w.length;b++)A+=C(b,w);return A}return Ua}var Va={exports:{}},bi;function Ad(){if(bi)return Va.exports;bi=1;var s=Va.exports=function(){this._cache={}};return s.prototype.put=function(r,a){this._cache[r]=a},s.prototype.get=function(r){return this._cache[r]},s.prototype.del=function(r){delete this._cache[r]},s.prototype.clear=function(){this._cache={}},Va.exports}var Ha,wi;function Td(){if(wi)return Ha;wi=1;var s=Er(),e=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,r=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,t=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,n=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,i=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,o=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,l=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,c=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,h=/^(?:\/(?:[^~/]|~0|~1)*)*$/,p=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,y=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;Ha=u;function u(T){return T=T=="full"?"full":"fast",s.copy(u[T])}u.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":o,url:l,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:t,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:I,uuid:c,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":y},u.full={date:_,time:v,"date-time":C,uri:b,"uri-reference":i,"uri-template":o,url:l,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:t,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:I,uuid:c,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":y};function f(T){return T%4===0&&(T%100!==0||T%400===0)}function _(T){var O=T.match(e);if(!O)return!1;var $=+O[1],S=+O[2],x=+O[3];return S>=1&&S<=12&&x>=1&&x<=(S==2&&f($)?29:r[S])}function v(T,O){var $=T.match(a);if(!$)return!1;var S=$[1],x=$[2],N=$[3],q=$[5];return(S<=23&&x<=59&&N<=59||S==23&&x==59&&N==60)&&(!O||q)}var w=/t|\s/i;function C(T){var O=T.split(w);return O.length==2&&_(O[0])&&v(O[1],!0)}var A=/\/|:/;function b(T){return A.test(T)&&n.test(T)}var P=/[^\\]\\Z/;function I(T){if(P.test(T))return!1;try{return new RegExp(T),!0}catch{return!1}}return Ha}var Ba,Si;function Od(){return Si||(Si=1,Ba=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.errSchemaPath+"/"+r,c=!e.opts.allErrors,h="data"+(i||""),p="valid"+n,y,u;if(o=="#"||o=="#/")e.isRoot?(y=e.async,u="validate"):(y=e.root.schema.$async===!0,u="root.refVal[0]");else{var f=e.resolveRef(e.baseId,o,e.isRoot);if(f===void 0){var _=e.MissingRefError.message(e.baseId,o);if(e.opts.missingRefs=="fail"){e.logger.error(_);var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(o)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(o)+"' "),e.opts.verbose&&(t+=" , schema: "+e.util.toQuotedString(o)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var w=t;t=v.pop(),!e.compositeRule&&c?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(t+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(_),c&&(t+=" if (true) { ");else throw new e.MissingRefError(e.baseId,o,_)}else if(f.inline){var C=e.util.copy(e);C.level++;var A="valid"+C.level;C.schema=f.schema,C.schemaPath="",C.errSchemaPath=o;var b=e.validate(C).replace(/validate\.schema/g,f.code);t+=" "+b+" ",c&&(t+=" if ("+A+") { ")}else y=f.$async===!0||e.async&&f.$async!==!1,u=f.code}if(u){var v=v||[];v.push(t),t="",e.opts.passContext?t+=" "+u+".call(this, ":t+=" "+u+"( ",t+=" "+h+", (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var P=i?"data"+(i-1||""):"parentData",I=i?e.dataPathArr[i]:"parentDataProperty";t+=" , "+P+" , "+I+", rootData)  ";var T=t;if(t=v.pop(),y){if(!e.async)throw new Error("async schema referenced by sync schema");c&&(t+=" var "+p+"; "),t+=" try { await "+T+"; ",c&&(t+=" "+p+" = true; "),t+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(t+=" "+p+" = false; "),t+=" } ",c&&(t+=" if ("+p+") { ")}else t+=" if (!"+T+") { if (vErrors === null) vErrors = "+u+".errors; else vErrors = vErrors.concat("+u+".errors); errors = vErrors.length; } ",c&&(t+=" else { ")}return t}),Ba}var Ga,Ei;function $d(){return Ei||(Ei=1,Ga=function(e,r,a){var t=" ",n=e.schema[r],i=e.schemaPath+e.util.getProperty(r),o=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,c=e.util.copy(e),h="";c.level++;var p="valid"+c.level,y=c.baseId,u=!0,f=n;if(f)for(var _,v=-1,w=f.length-1;v<w;)_=f[v+=1],(e.opts.strictKeywords?typeof _=="object"&&Object.keys(_).length>0||_===!1:e.util.schemaHasRules(_,e.RULES.all))&&(u=!1,c.schema=_,c.schemaPath=i+"["+v+"]",c.errSchemaPath=o+"/"+v,t+="  "+e.validate(c)+" ",c.baseId=y,l&&(t+=" if ("+p+") { ",h+="}"));return l&&(u?t+=" if (true) { ":t+=" "+h.slice(0,-1)+" "),t}),Ga}var Qa,Pi;function Cd(){return Pi||(Pi=1,Qa=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),_="";f.level++;var v="valid"+f.level,w=o.every(function(O){return e.opts.strictKeywords?typeof O=="object"&&Object.keys(O).length>0||O===!1:e.util.schemaHasRules(O,e.RULES.all)});if(w){var C=f.baseId;t+=" var "+u+" = errors; var "+y+" = false;  ";var A=e.compositeRule;e.compositeRule=f.compositeRule=!0;var b=o;if(b)for(var P,I=-1,T=b.length-1;I<T;)P=b[I+=1],f.schema=P,f.schemaPath=l+"["+I+"]",f.errSchemaPath=c+"/"+I,t+="  "+e.validate(f)+" ",f.baseId=C,t+=" "+y+" = "+y+" || "+v+"; if (!"+y+") { ",_+="}";e.compositeRule=f.compositeRule=A,t+=" "+_+" if (!"+y+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else h&&(t+=" if (true) { ");return t}),Qa}var Ka,xi;function Nd(){return xi||(xi=1,Ka=function(e,r,a){var t=" ",n=e.schema[r],i=e.errSchemaPath+"/"+r;e.opts.allErrors;var o=e.util.toQuotedString(n);return e.opts.$comment===!0?t+=" console.log("+o+");":typeof e.opts.$comment=="function"&&(t+=" self._opts.$comment("+o+", "+e.util.toQuotedString(i)+", validate.root.schema);"),t}),Ka}var Ja,Ri;function Dd(){return Ri||(Ri=1,Ja=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data;u&&(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; "),u||(t+=" var schema"+n+" = validate.schema"+l+";"),t+="var "+y+" = equal("+p+", schema"+n+"); if (!"+y+") {   ";var f=f||[];f.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to constant' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var _=t;return t=f.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+_+"]); ":t+=" validate.errors = ["+_+"]; return false; ":t+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",h&&(t+=" else { "),t}),Ja}var Wa,ki;function jd(){return ki||(ki=1,Wa=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),_="";f.level++;var v="valid"+f.level,w="i"+n,C=f.dataLevel=e.dataLevel+1,A="data"+C,b=e.baseId,P=e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all);if(t+="var "+u+" = errors;var "+y+";",P){var I=e.compositeRule;e.compositeRule=f.compositeRule=!0,f.schema=o,f.schemaPath=l,f.errSchemaPath=c,t+=" var "+v+" = false; for (var "+w+" = 0; "+w+" < "+p+".length; "+w+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var T=p+"["+w+"]";f.dataPathArr[C]=w;var O=e.validate(f);f.baseId=b,e.util.varOccurences(O,A)<2?t+=" "+e.util.varReplace(O,A,T)+" ":t+=" var "+A+" = "+T+"; "+O+" ",t+=" if ("+v+") break; }  ",e.compositeRule=f.compositeRule=I,t+=" "+_+" if (!"+v+") {"}else t+=" if ("+p+".length == 0) {";var $=$||[];$.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should contain a valid item' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var S=t;return t=$.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+S+"]); ":t+=" validate.errors = ["+S+"]; return false; ":t+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { ",P&&(t+="  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } "),e.opts.allErrors&&(t+=" } "),t}),Wa}var Ya,Ii;function Ld(){return Ii||(Ii=1,Ya=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e),f="";u.level++;var _="valid"+u.level,v={},w={},C=e.opts.ownProperties;for(I in o)if(I!="__proto__"){var A=o[I],b=Array.isArray(A)?w:v;b[I]=A}t+="var "+y+" = errors;";var P=e.errorPath;t+="var missing"+n+";";for(var I in w)if(b=w[I],b.length){if(t+=" if ( "+p+e.util.getProperty(I)+" !== undefined ",C&&(t+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(I)+"') "),h){t+=" && ( ";var T=b;if(T)for(var O,$=-1,S=T.length-1;$<S;){O=T[$+=1],$&&(t+=" || ");var x=e.util.getProperty(O),N=p+x;t+=" ( ( "+N+" === undefined ",C&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?O:x)+") ) "}t+=")) {  ";var q="missing"+n,Z="' + "+q+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(P,q,!0):P+" + "+q);var te=te||[];te.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(I)+"', missingProperty: '"+Z+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(b.length==1?b[0]:b.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",b.length==1?t+="property "+e.util.escapeQuotes(b[0]):t+="properties "+e.util.escapeQuotes(b.join(", ")),t+=" when property "+e.util.escapeQuotes(I)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var pe=t;t=te.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+pe+"]); ":t+=" validate.errors = ["+pe+"]; return false; ":t+=" var err = "+pe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{t+=" ) { ";var se=b;if(se)for(var O,be=-1,ue=se.length-1;be<ue;){O=se[be+=1];var x=e.util.getProperty(O),Z=e.util.escapeQuotes(O),N=p+x;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(P,O,e.opts.jsonPointers)),t+=" if ( "+N+" === undefined ",C&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(I)+"', missingProperty: '"+Z+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(b.length==1?b[0]:b.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",b.length==1?t+="property "+e.util.escapeQuotes(b[0]):t+="properties "+e.util.escapeQuotes(b.join(", ")),t+=" when property "+e.util.escapeQuotes(I)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t+=" }   ",h&&(f+="}",t+=" else { ")}e.errorPath=P;var de=u.baseId;for(var I in v){var A=v[I];(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))&&(t+=" "+_+" = true; if ( "+p+e.util.getProperty(I)+" !== undefined ",C&&(t+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(I)+"') "),t+=") { ",u.schema=A,u.schemaPath=l+e.util.getProperty(I),u.errSchemaPath=c+"/"+e.util.escapeFragment(I),t+="  "+e.validate(u)+" ",u.baseId=de,t+=" }  ",h&&(t+=" if ("+_+") { ",f+="}"))}return h&&(t+="   "+f+" if ("+y+" == errors) {"),t}),Ya}var Xa,Ai;function Md(){return Ai||(Ai=1,Xa=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data;u&&(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ");var f="i"+n,_="schema"+n;u||(t+=" var "+_+" = validate.schema"+l+";"),t+="var "+y+";",u&&(t+=" if (schema"+n+" === undefined) "+y+" = true; else if (!Array.isArray(schema"+n+")) "+y+" = false; else {"),t+=""+y+" = false;for (var "+f+"=0; "+f+"<"+_+".length; "+f+"++) if (equal("+p+", "+_+"["+f+"])) { "+y+" = true; break; }",u&&(t+="  }  "),t+=" if (!"+y+") {   ";var v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=v.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",h&&(t+=" else { "),t}),Xa}var es,Ti;function qd(){return Ti||(Ti=1,es=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||"");if(e.opts.format===!1)return h&&(t+=" if (true) { "),t;var y=e.opts.$data&&o&&o.$data,u;y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o;var f=e.opts.unknownFormats,_=Array.isArray(f);if(y){var v="format"+n,w="isObject"+n,C="formatType"+n;t+=" var "+v+" = formats["+u+"]; var "+w+" = typeof "+v+" == 'object' && !("+v+" instanceof RegExp) && "+v+".validate; var "+C+" = "+w+" && "+v+".type || 'string'; if ("+w+") { ",e.async&&(t+=" var async"+n+" = "+v+".async; "),t+=" "+v+" = "+v+".validate; } if (  ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),t+=" (",f!="ignore"&&(t+=" ("+u+" && !"+v+" ",_&&(t+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),t+=") || "),t+=" ("+v+" && "+C+" == '"+a+"' && !(typeof "+v+" == 'function' ? ",e.async?t+=" (async"+n+" ? await "+v+"("+p+") : "+v+"("+p+")) ":t+=" "+v+"("+p+") ",t+=" : "+v+".test("+p+"))))) {"}else{var v=e.formats[o];if(!v){if(f=="ignore")return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),h&&(t+=" if (true) { "),t;if(_&&f.indexOf(o)>=0)return h&&(t+=" if (true) { "),t;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var w=typeof v=="object"&&!(v instanceof RegExp)&&v.validate,C=w&&v.type||"string";if(w){var A=v.async===!0;v=v.validate}if(C!=a)return h&&(t+=" if (true) { "),t;if(A){if(!e.async)throw new Error("async format in sync schema");var b="formats"+e.util.getProperty(o)+".validate";t+=" if (!(await "+b+"("+p+"))) { "}else{t+=" if (! ";var b="formats"+e.util.getProperty(o);w&&(b+=".validate"),typeof v=="function"?t+=" "+b+"("+p+") ":t+=" "+b+".test("+p+") ",t+=") { "}}var P=P||[];P.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",y?t+=""+u:t+=""+e.util.toQuotedString(o),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match format "`,y?t+="' + "+u+" + '":t+=""+e.util.escapeQuotes(o),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var I=t;return t=P.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { "),t}),es}var ts,Oi;function Zd(){return Oi||(Oi=1,ts=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e);f.level++;var _="valid"+f.level,v=e.schema.then,w=e.schema.else,C=v!==void 0&&(e.opts.strictKeywords?typeof v=="object"&&Object.keys(v).length>0||v===!1:e.util.schemaHasRules(v,e.RULES.all)),A=w!==void 0&&(e.opts.strictKeywords?typeof w=="object"&&Object.keys(w).length>0||w===!1:e.util.schemaHasRules(w,e.RULES.all)),b=f.baseId;if(C||A){var P;f.createErrors=!1,f.schema=o,f.schemaPath=l,f.errSchemaPath=c,t+=" var "+u+" = errors; var "+y+" = true;  ";var I=e.compositeRule;e.compositeRule=f.compositeRule=!0,t+="  "+e.validate(f)+" ",f.baseId=b,f.createErrors=!0,t+="  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; }  ",e.compositeRule=f.compositeRule=I,C?(t+=" if ("+_+") {  ",f.schema=e.schema.then,f.schemaPath=e.schemaPath+".then",f.errSchemaPath=e.errSchemaPath+"/then",t+="  "+e.validate(f)+" ",f.baseId=b,t+=" "+y+" = "+_+"; ",C&&A?(P="ifClause"+n,t+=" var "+P+" = 'then'; "):P="'then'",t+=" } ",A&&(t+=" else { ")):t+=" if (!"+_+") { ",A&&(f.schema=e.schema.else,f.schemaPath=e.schemaPath+".else",f.errSchemaPath=e.errSchemaPath+"/else",t+="  "+e.validate(f)+" ",f.baseId=b,t+=" "+y+" = "+_+"; ",C&&A?(P="ifClause"+n,t+=" var "+P+" = 'else'; "):P="'else'",t+=" } "),t+=" if (!"+y+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+P+" } ",e.opts.messages!==!1&&(t+=` , message: 'should match "' + `+P+` + '" schema' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" }   ",h&&(t+=" else { ")}else h&&(t+=" if (true) { ");return t}),ts}var rs,$i;function Fd(){return $i||($i=1,rs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),_="";f.level++;var v="valid"+f.level,w="i"+n,C=f.dataLevel=e.dataLevel+1,A="data"+C,b=e.baseId;if(t+="var "+u+" = errors;var "+y+";",Array.isArray(o)){var P=e.schema.additionalItems;if(P===!1){t+=" "+y+" = "+p+".length <= "+o.length+"; ";var I=c;c=e.errSchemaPath+"/additionalItems",t+="  if (!"+y+") {   ";var T=T||[];T.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+o.length+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var O=t;t=T.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+O+"]); ":t+=" validate.errors = ["+O+"]; return false; ":t+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",c=I,h&&(_+="}",t+=" else { ")}var $=o;if($){for(var S,x=-1,N=$.length-1;x<N;)if(S=$[x+=1],e.opts.strictKeywords?typeof S=="object"&&Object.keys(S).length>0||S===!1:e.util.schemaHasRules(S,e.RULES.all)){t+=" "+v+" = true; if ("+p+".length > "+x+") { ";var q=p+"["+x+"]";f.schema=S,f.schemaPath=l+"["+x+"]",f.errSchemaPath=c+"/"+x,f.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0),f.dataPathArr[C]=x;var Z=e.validate(f);f.baseId=b,e.util.varOccurences(Z,A)<2?t+=" "+e.util.varReplace(Z,A,q)+" ":t+=" var "+A+" = "+q+"; "+Z+" ",t+=" }  ",h&&(t+=" if ("+v+") { ",_+="}")}}if(typeof P=="object"&&(e.opts.strictKeywords?typeof P=="object"&&Object.keys(P).length>0||P===!1:e.util.schemaHasRules(P,e.RULES.all))){f.schema=P,f.schemaPath=e.schemaPath+".additionalItems",f.errSchemaPath=e.errSchemaPath+"/additionalItems",t+=" "+v+" = true; if ("+p+".length > "+o.length+") {  for (var "+w+" = "+o.length+"; "+w+" < "+p+".length; "+w+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var q=p+"["+w+"]";f.dataPathArr[C]=w;var Z=e.validate(f);f.baseId=b,e.util.varOccurences(Z,A)<2?t+=" "+e.util.varReplace(Z,A,q)+" ":t+=" var "+A+" = "+q+"; "+Z+" ",h&&(t+=" if (!"+v+") break; "),t+=" } }  ",h&&(t+=" if ("+v+") { ",_+="}")}}else if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){f.schema=o,f.schemaPath=l,f.errSchemaPath=c,t+="  for (var "+w+" = 0; "+w+" < "+p+".length; "+w+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var q=p+"["+w+"]";f.dataPathArr[C]=w;var Z=e.validate(f);f.baseId=b,e.util.varOccurences(Z,A)<2?t+=" "+e.util.varReplace(Z,A,q)+" ":t+=" var "+A+" = "+q+"; "+Z+" ",h&&(t+=" if (!"+v+") break; "),t+=" }"}return h&&(t+=" "+_+" if ("+u+" == errors) {"),t}),rs}var as,Ci;function Ni(){return Ci||(Ci=1,as=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,b,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o;var f=r=="maximum",_=f?"exclusiveMaximum":"exclusiveMinimum",v=e.schema[_],w=e.opts.$data&&v&&v.$data,C=f?"<":">",A=f?">":"<",b=void 0;if(!(y||typeof o=="number"||o===void 0))throw new Error(r+" must be number");if(!(w||v===void 0||typeof v=="number"||typeof v=="boolean"))throw new Error(_+" must be number or boolean");if(w){var P=e.util.getData(v.$data,i,e.dataPathArr),I="exclusive"+n,T="exclType"+n,O="exclIsNumber"+n,$="op"+n,S="' + "+$+" + '";t+=" var schemaExcl"+n+" = "+P+"; ",P="schemaExcl"+n,t+=" var "+I+"; var "+T+" = typeof "+P+"; if ("+T+" != 'boolean' && "+T+" != 'undefined' && "+T+" != 'number') { ";var b=_,x=x||[];x.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: '"+_+" should be boolean' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var N=t;t=x.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+N+"]); ":t+=" validate.errors = ["+N+"]; return false; ":t+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" "+T+" == 'number' ? ( ("+I+" = "+u+" === undefined || "+P+" "+C+"= "+u+") ? "+p+" "+A+"= "+P+" : "+p+" "+A+" "+u+" ) : ( ("+I+" = "+P+" === true) ? "+p+" "+A+"= "+u+" : "+p+" "+A+" "+u+" ) || "+p+" !== "+p+") { var op"+n+" = "+I+" ? '"+C+"' : '"+C+"='; ",o===void 0&&(b=_,c=e.errSchemaPath+"/"+_,u=P,y=w)}else{var O=typeof v=="number",S=C;if(O&&y){var $="'"+S+"'";t+=" if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" ( "+u+" === undefined || "+v+" "+C+"= "+u+" ? "+p+" "+A+"= "+v+" : "+p+" "+A+" "+u+" ) || "+p+" !== "+p+") { "}else{O&&o===void 0?(I=!0,b=_,c=e.errSchemaPath+"/"+_,u=v,A+="="):(O&&(u=Math[f?"min":"max"](v,o)),v===(O?u:!0)?(I=!0,b=_,c=e.errSchemaPath+"/"+_,A+="="):(I=!1,S+="="));var $="'"+S+"'";t+=" if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" "+p+" "+A+" "+u+" || "+p+" !== "+p+") { "}}b=b||r;var x=x||[];x.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+$+", limit: "+u+", exclusive: "+I+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be "+S+" ",y?t+="' + "+u:t+=""+u+"'"),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var N=t;return t=x.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+N+"]); ":t+=" validate.errors = ["+N+"]; return false; ":t+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { "),t}),as}var ss,Di;function ji(){return Di||(Di=1,ss=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,_,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");var f=r=="maxItems"?">":"<";t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" "+p+".length "+f+" "+u+") { ";var _=r,v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(_||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxItems"?t+="more":t+="fewer",t+=" than ",y?t+="' + "+u+" + '":t+=""+o,t+=" items' "),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=v.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),ss}var ns,Li;function Mi(){return Li||(Li=1,ns=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,_,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");var f=r=="maxLength"?">":"<";t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),e.opts.unicode===!1?t+=" "+p+".length ":t+=" ucs2length("+p+") ",t+=" "+f+" "+u+") { ";var _=r,v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(_||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be ",r=="maxLength"?t+="longer":t+="shorter",t+=" than ",y?t+="' + "+u+" + '":t+=""+o,t+=" characters' "),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=v.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),ns}var is,qi;function Zi(){return qi||(qi=1,is=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,_,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");var f=r=="maxProperties"?">":"<";t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" Object.keys("+p+").length "+f+" "+u+") { ";var _=r,v=v||[];v.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(_||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxProperties"?t+="more":t+="fewer",t+=" than ",y?t+="' + "+u+" + '":t+=""+o,t+=" properties' "),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=v.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),is}var os,Fi;function zd(){return Fi||(Fi=1,os=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");t+="var division"+n+";if (",y&&(t+=" "+u+" !== undefined && ( typeof "+u+" != 'number' || "),t+=" (division"+n+" = "+p+" / "+u+", ",e.opts.multipleOfPrecision?t+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":t+=" division"+n+" !== parseInt(division"+n+") ",t+=" ) ",y&&(t+="  )  "),t+=" ) {   ";var f=f||[];f.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be multiple of ",y?t+="' + "+u:t+=""+u+"'"),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var _=t;return t=f.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+_+"]); ":t+=" validate.errors = ["+_+"]; return false; ":t+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),os}var ls,zi;function Ud(){return zi||(zi=1,ls=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e);u.level++;var f="valid"+u.level;if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){u.schema=o,u.schemaPath=l,u.errSchemaPath=c,t+=" var "+y+" = errors;  ";var _=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.createErrors=!1;var v;u.opts.allErrors&&(v=u.opts.allErrors,u.opts.allErrors=!1),t+=" "+e.validate(u)+" ",u.createErrors=!0,v&&(u.opts.allErrors=v),e.compositeRule=u.compositeRule=_,t+=" if ("+f+") {   ";var w=w||[];w.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var C=t;t=w.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+C+"]); ":t+=" validate.errors = ["+C+"]; return false; ":t+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  errors = "+y+"; if (vErrors !== null) { if ("+y+") vErrors.length = "+y+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else t+="  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h&&(t+=" if (false) { ");return t}),ls}var cs,Ui;function Vd(){return Ui||(Ui=1,cs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),_="";f.level++;var v="valid"+f.level,w=f.baseId,C="prevValid"+n,A="passingSchemas"+n;t+="var "+u+" = errors , "+C+" = false , "+y+" = false , "+A+" = null; ";var b=e.compositeRule;e.compositeRule=f.compositeRule=!0;var P=o;if(P)for(var I,T=-1,O=P.length-1;T<O;)I=P[T+=1],(e.opts.strictKeywords?typeof I=="object"&&Object.keys(I).length>0||I===!1:e.util.schemaHasRules(I,e.RULES.all))?(f.schema=I,f.schemaPath=l+"["+T+"]",f.errSchemaPath=c+"/"+T,t+="  "+e.validate(f)+" ",f.baseId=w):t+=" var "+v+" = true; ",T&&(t+=" if ("+v+" && "+C+") { "+y+" = false; "+A+" = ["+A+", "+T+"]; } else { ",_+="}"),t+=" if ("+v+") { "+y+" = "+C+" = true; "+A+" = "+T+"; }";return e.compositeRule=f.compositeRule=b,t+=""+_+"if (!"+y+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+A+" } ",e.opts.messages!==!1&&(t+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+="} else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; }",e.opts.allErrors&&(t+=" } "),t}),cs}var us,Vi;function Hd(){return Vi||(Vi=1,us=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o;var f=y?"(new RegExp("+u+"))":e.usePattern(o);t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),t+=" !"+f+".test("+p+") ) {   ";var _=_||[];_.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",y?t+=""+u:t+=""+e.util.toQuotedString(o),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match pattern "`,y?t+="' + "+u+" + '":t+=""+e.util.escapeQuotes(o),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var v=t;return t=_.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+v+"]); ":t+=" validate.errors = ["+v+"]; return false; ":t+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),us}var ds,Hi;function Bd(){return Hi||(Hi=1,ds=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e),f="";u.level++;var _="valid"+u.level,v="key"+n,w="idx"+n,C=u.dataLevel=e.dataLevel+1,A="data"+C,b="dataProperties"+n,P=Object.keys(o||{}).filter(be),I=e.schema.patternProperties||{},T=Object.keys(I).filter(be),O=e.schema.additionalProperties,$=P.length||T.length,S=O===!1,x=typeof O=="object"&&Object.keys(O).length,N=e.opts.removeAdditional,q=S||x||N,Z=e.opts.ownProperties,te=e.baseId,pe=e.schema.required;if(pe&&!(e.opts.$data&&pe.$data)&&pe.length<e.opts.loopRequired)var se=e.util.toHash(pe);function be(Ia){return Ia!=="__proto__"}if(t+="var "+y+" = errors;var "+_+" = true;",Z&&(t+=" var "+b+" = undefined;"),q){if(Z?t+=" "+b+" = "+b+" || Object.keys("+p+"); for (var "+w+"=0; "+w+"<"+b+".length; "+w+"++) { var "+v+" = "+b+"["+w+"]; ":t+=" for (var "+v+" in "+p+") { ",$){if(t+=" var isAdditional"+n+" = !(false ",P.length)if(P.length>8)t+=" || validate.schema"+l+".hasOwnProperty("+v+") ";else{var ue=P;if(ue)for(var de,tt=-1,Xe=ue.length-1;tt<Xe;)de=ue[tt+=1],t+=" || "+v+" == "+e.util.toQuotedString(de)+" "}if(T.length){var Je=T;if(Je)for(var ze,vt=-1,E=Je.length-1;vt<E;)ze=Je[vt+=1],t+=" || "+e.usePattern(ze)+".test("+v+") "}t+=" ); if (isAdditional"+n+") { "}if(N=="all")t+=" delete "+p+"["+v+"]; ";else{var D=e.errorPath,H="' + "+v+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers)),S)if(N)t+=" delete "+p+"["+v+"]; ";else{t+=" "+_+" = false; ";var ce=c;c=e.errSchemaPath+"/additionalProperties";var j=j||[];j.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+H+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is an invalid additional property":t+="should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var U=t;t=j.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+U+"]); ":t+=" validate.errors = ["+U+"]; return false; ":t+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=ce,h&&(t+=" break; ")}else if(x)if(N=="failing"){t+=" var "+y+" = errors;  ";var ge=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.schema=O,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Ee=p+"["+v+"]";u.dataPathArr[C]=v;var we=e.validate(u);u.baseId=te,e.util.varOccurences(we,A)<2?t+=" "+e.util.varReplace(we,A,Ee)+" ":t+=" var "+A+" = "+Ee+"; "+we+" ",t+=" if (!"+_+") { errors = "+y+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+v+"]; }  ",e.compositeRule=u.compositeRule=ge}else{u.schema=O,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Ee=p+"["+v+"]";u.dataPathArr[C]=v;var we=e.validate(u);u.baseId=te,e.util.varOccurences(we,A)<2?t+=" "+e.util.varReplace(we,A,Ee)+" ":t+=" var "+A+" = "+Ee+"; "+we+" ",h&&(t+=" if (!"+_+") break; ")}e.errorPath=D}$&&(t+=" } "),t+=" }  ",h&&(t+=" if ("+_+") { ",f+="}")}var De=e.opts.useDefaults&&!e.compositeRule;if(P.length){var Ae=P;if(Ae)for(var de,Te=-1,et=Ae.length-1;Te<et;){de=Ae[Te+=1];var qe=o[de];if(e.opts.strictKeywords?typeof qe=="object"&&Object.keys(qe).length>0||qe===!1:e.util.schemaHasRules(qe,e.RULES.all)){var Pt=e.util.getProperty(de),Ee=p+Pt,rt=De&&qe.default!==void 0;u.schema=qe,u.schemaPath=l+Pt,u.errSchemaPath=c+"/"+e.util.escapeFragment(de),u.errorPath=e.util.getPath(e.errorPath,de,e.opts.jsonPointers),u.dataPathArr[C]=e.util.toQuotedString(de);var we=e.validate(u);if(u.baseId=te,e.util.varOccurences(we,A)<2){we=e.util.varReplace(we,A,Ee);var Fe=Ee}else{var Fe=A;t+=" var "+A+" = "+Ee+"; "}if(rt)t+=" "+we+" ";else{if(se&&se[de]){t+=" if ( "+Fe+" === undefined ",Z&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(de)+"') "),t+=") { "+_+" = false; ";var D=e.errorPath,ce=c,Ue=e.util.escapeQuotes(de);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(D,de,e.opts.jsonPointers)),c=e.errSchemaPath+"/required";var j=j||[];j.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+Ue+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+Ue+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var U=t;t=j.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+U+"]); ":t+=" validate.errors = ["+U+"]; return false; ":t+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=ce,e.errorPath=D,t+=" } else { "}else h?(t+=" if ( "+Fe+" === undefined ",Z&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(de)+"') "),t+=") { "+_+" = true; } else { "):(t+=" if ("+Fe+" !== undefined ",Z&&(t+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(de)+"') "),t+=" ) { ");t+=" "+we+" } "}}h&&(t+=" if ("+_+") { ",f+="}")}}if(T.length){var ut=T;if(ut)for(var ze,Ur=-1,ka=ut.length-1;Ur<ka;){ze=ut[Ur+=1];var qe=I[ze];if(e.opts.strictKeywords?typeof qe=="object"&&Object.keys(qe).length>0||qe===!1:e.util.schemaHasRules(qe,e.RULES.all)){u.schema=qe,u.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ze),u.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ze),Z?t+=" "+b+" = "+b+" || Object.keys("+p+"); for (var "+w+"=0; "+w+"<"+b+".length; "+w+"++) { var "+v+" = "+b+"["+w+"]; ":t+=" for (var "+v+" in "+p+") { ",t+=" if ("+e.usePattern(ze)+".test("+v+")) { ",u.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Ee=p+"["+v+"]";u.dataPathArr[C]=v;var we=e.validate(u);u.baseId=te,e.util.varOccurences(we,A)<2?t+=" "+e.util.varReplace(we,A,Ee)+" ":t+=" var "+A+" = "+Ee+"; "+we+" ",h&&(t+=" if (!"+_+") break; "),t+=" } ",h&&(t+=" else "+_+" = true; "),t+=" }  ",h&&(t+=" if ("+_+") { ",f+="}")}}}return h&&(t+=" "+f+" if ("+y+" == errors) {"),t}),ds}var hs,Bi;function Gd(){return Bi||(Bi=1,hs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e),f="";u.level++;var _="valid"+u.level;if(t+="var "+y+" = errors;",e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){u.schema=o,u.schemaPath=l,u.errSchemaPath=c;var v="key"+n,w="idx"+n,C="i"+n,A="' + "+v+" + '",b=u.dataLevel=e.dataLevel+1,P="data"+b,I="dataProperties"+n,T=e.opts.ownProperties,O=e.baseId;T&&(t+=" var "+I+" = undefined; "),T?t+=" "+I+" = "+I+" || Object.keys("+p+"); for (var "+w+"=0; "+w+"<"+I+".length; "+w+"++) { var "+v+" = "+I+"["+w+"]; ":t+=" for (var "+v+" in "+p+") { ",t+=" var startErrs"+n+" = errors; ";var $=v,S=e.compositeRule;e.compositeRule=u.compositeRule=!0;var x=e.validate(u);u.baseId=O,e.util.varOccurences(x,P)<2?t+=" "+e.util.varReplace(x,P,$)+" ":t+=" var "+P+" = "+$+"; "+x+" ",e.compositeRule=u.compositeRule=S,t+=" if (!"+_+") { for (var "+C+"=startErrs"+n+"; "+C+"<errors; "+C+"++) { vErrors["+C+"].propertyName = "+v+"; }   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+A+"' } ",e.opts.messages!==!1&&(t+=" , message: 'property name \\'"+A+"\\' is invalid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),h&&(t+=" break; "),t+=" } }"}return h&&(t+=" "+f+" if ("+y+" == errors) {"),t}),hs}var fs,Gi;function Qd(){return Gi||(Gi=1,fs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data;u&&(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ");var f="schema"+n;if(!u)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var _=[],v=o;if(v)for(var w,C=-1,A=v.length-1;C<A;){w=v[C+=1];var b=e.schema.properties[w];b&&(e.opts.strictKeywords?typeof b=="object"&&Object.keys(b).length>0||b===!1:e.util.schemaHasRules(b,e.RULES.all))||(_[_.length]=w)}}else var _=o;if(u||_.length){var P=e.errorPath,I=u||_.length>=e.opts.loopRequired,T=e.opts.ownProperties;if(h)if(t+=" var missing"+n+"; ",I){u||(t+=" var "+f+" = validate.schema"+l+"; ");var O="i"+n,$="schema"+n+"["+O+"]",S="' + "+$+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(P,$,e.opts.jsonPointers)),t+=" var "+y+" = true; ",u&&(t+=" if (schema"+n+" === undefined) "+y+" = true; else if (!Array.isArray(schema"+n+")) "+y+" = false; else {"),t+=" for (var "+O+" = 0; "+O+" < "+f+".length; "+O+"++) { "+y+" = "+p+"["+f+"["+O+"]] !== undefined ",T&&(t+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+f+"["+O+"]) "),t+="; if (!"+y+") break; } ",u&&(t+="  }  "),t+="  if (!"+y+") {   ";var x=x||[];x.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var N=t;t=x.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+N+"]); ":t+=" validate.errors = ["+N+"]; return false; ":t+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else{t+=" if ( ";var q=_;if(q)for(var Z,O=-1,te=q.length-1;O<te;){Z=q[O+=1],O&&(t+=" || ");var pe=e.util.getProperty(Z),se=p+pe;t+=" ( ( "+se+" === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(Z)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?Z:pe)+") ) "}t+=") {  ";var $="missing"+n,S="' + "+$+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(P,$,!0):P+" + "+$);var x=x||[];x.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var N=t;t=x.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+N+"]); ":t+=" validate.errors = ["+N+"]; return false; ":t+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else if(I){u||(t+=" var "+f+" = validate.schema"+l+"; ");var O="i"+n,$="schema"+n+"["+O+"]",S="' + "+$+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(P,$,e.opts.jsonPointers)),u&&(t+=" if ("+f+" && !Array.isArray("+f+")) {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+f+" !== undefined) { "),t+=" for (var "+O+" = 0; "+O+" < "+f+".length; "+O+"++) { if ("+p+"["+f+"["+O+"]] === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+f+"["+O+"]) "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",u&&(t+="  }  ")}else{var be=_;if(be)for(var Z,ue=-1,de=be.length-1;ue<de;){Z=be[ue+=1];var pe=e.util.getProperty(Z),S=e.util.escapeQuotes(Z),se=p+pe;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(P,Z,e.opts.jsonPointers)),t+=" if ( "+se+" === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(Z)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=P}else h&&(t+=" if (true) {");return t}),fs}var ps,Qi;function Kd(){return Qi||(Qi=1,ps=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data,f;if(u?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",f="schema"+n):f=o,(o||u)&&e.opts.uniqueItems!==!1){u&&(t+=" var "+y+"; if ("+f+" === false || "+f+" === undefined) "+y+" = true; else if (typeof "+f+" != 'boolean') "+y+" = false; else { "),t+=" var i = "+p+".length , "+y+" = true , j; if (i > 1) { ";var _=e.schema.items&&e.schema.items.type,v=Array.isArray(_);if(!_||_=="object"||_=="array"||v&&(_.indexOf("object")>=0||_.indexOf("array")>=0))t+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+p+"[i], "+p+"[j])) { "+y+" = false; break outer; } } } ";else{t+=" var itemIndices = {}, item; for (;i--;) { var item = "+p+"[i]; ";var w="checkDataType"+(v?"s":"");t+=" if ("+e.util[w](_,"item",e.opts.strictNumbers,!0)+") continue; ",v&&(t+=` if (typeof item == 'string') item = '"' + item; `),t+=" if (typeof itemIndices[item] == 'number') { "+y+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}t+=" } ",u&&(t+="  }  "),t+=" if (!"+y+") {   ";var C=C||[];C.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(t+=" , schema:  ",u?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var A=t;t=C.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+A+"]); ":t+=" validate.errors = ["+A+"]; return false; ":t+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { ")}else h&&(t+=" if (true) { ");return t}),ps}var ms,Ki;function Jd(){return Ki||(Ki=1,ms={$ref:Od(),allOf:$d(),anyOf:Cd(),$comment:Nd(),const:Dd(),contains:jd(),dependencies:Ld(),enum:Md(),format:qd(),if:Zd(),items:Fd(),maximum:Ni(),minimum:Ni(),maxItems:ji(),minItems:ji(),maxLength:Mi(),minLength:Mi(),maxProperties:Zi(),minProperties:Zi(),multipleOf:zd(),not:Ud(),oneOf:Vd(),pattern:Hd(),properties:Bd(),propertyNames:Gd(),required:Qd(),uniqueItems:Kd(),validate:el()}),ms}var vs,Ji;function Wd(){if(Ji)return vs;Ji=1;var s=Jd(),e=Er().toHash;return vs=function(){var a=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"],n=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],i=["number","integer","string","array","object","boolean","null"];return a.all=e(t),a.types=e(i),a.forEach(function(o){o.rules=o.rules.map(function(l){var c;if(typeof l=="object"){var h=Object.keys(l)[0];c=l[h],l=h,c.forEach(function(y){t.push(y),a.all[y]=!0})}t.push(l);var p=a.all[l]={keyword:l,code:s[l],implements:c};return p}),a.all.$comment={keyword:"$comment",code:s.$comment},o.type&&(a.types[o.type]=o)}),a.keywords=e(t.concat(n)),a.custom={},a},vs}var gs,Wi;function Yd(){if(Wi)return gs;Wi=1;var s=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];return gs=function(e,r){for(var a=0;a<r.length;a++){e=JSON.parse(JSON.stringify(e));var t=r[a].split("/"),n=e,i;for(i=1;i<t.length;i++)n=n[t[i]];for(i=0;i<s.length;i++){var o=s[i],l=n[o];l&&(n[o]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e},gs}var ys,Yi;function Xd(){if(Yi)return ys;Yi=1;var s=_n().MissingRef;ys=e;function e(r,a,t){var n=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof a=="function"&&(t=a,a=void 0);var i=o(r).then(function(){var c=n._addSchema(r,void 0,a);return c.validate||l(c)});return t&&i.then(function(c){t(null,c)},t),i;function o(c){var h=c.$schema;return h&&!n.getSchema(h)?e.call(n,{$ref:h},!0):Promise.resolve()}function l(c){try{return n._compile(c)}catch(p){if(p instanceof s)return h(p);throw p}function h(p){var y=p.missingSchema;if(_(y))throw new Error("Schema "+y+" is loaded but "+p.missingRef+" cannot be resolved");var u=n._loadingSchemas[y];return u||(u=n._loadingSchemas[y]=n._opts.loadSchema(y),u.then(f,f)),u.then(function(v){if(!_(y))return o(v).then(function(){_(y)||n.addSchema(v,y,void 0,a)})}).then(function(){return l(c)});function f(){delete n._loadingSchemas[y]}function _(v){return n._refs[v]||n._schemas[v]}}}}return ys}var _s,Xi;function eh(){return Xi||(Xi=1,_s=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p,y="data"+(i||""),u="valid"+n,f="errs__"+n,_=e.opts.$data&&o&&o.$data,v;_?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",v="schema"+n):v=o;var w=this,C="definition"+n,A=w.definition,b="",P,I,T,O,$;if(_&&A.$data){$="keywordValidate"+n;var S=A.validateSchema;t+=" var "+C+" = RULES.custom['"+r+"'].definition; var "+$+" = "+C+".validate;"}else{if(O=e.useCustomRule(w,o,e.schema,e),!O)return;v="validate.schema"+l,$=O.code,P=A.compile,I=A.inline,T=A.macro}var x=$+".errors",N="i"+n,q="ruleErr"+n,Z=A.async;if(Z&&!e.async)throw new Error("async keyword in sync schema");if(I||T||(t+=""+x+" = null;"),t+="var "+f+" = errors;var "+u+";",_&&A.$data&&(b+="}",t+=" if ("+v+" === undefined) { "+u+" = true; } else { ",S&&(b+="}",t+=" "+u+" = "+C+".validateSchema("+v+"); if ("+u+") { ")),I)A.statements?t+=" "+O.validate+" ":t+=" "+u+" = "+O.validate+"; ";else if(T){var te=e.util.copy(e),b="";te.level++;var pe="valid"+te.level;te.schema=O.validate,te.schemaPath="";var se=e.compositeRule;e.compositeRule=te.compositeRule=!0;var be=e.validate(te).replace(/validate\.schema/g,$);e.compositeRule=te.compositeRule=se,t+=" "+be}else{var ue=ue||[];ue.push(t),t="",t+="  "+$+".call( ",e.opts.passContext?t+="this":t+="self",P||A.schema===!1?t+=" , "+y+" ":t+=" , "+v+" , "+y+" , validate.schema"+e.schemaPath+" ",t+=" , (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var de=i?"data"+(i-1||""):"parentData",tt=i?e.dataPathArr[i]:"parentDataProperty";t+=" , "+de+" , "+tt+" , rootData )  ";var Xe=t;t=ue.pop(),A.errors===!1?(t+=" "+u+" = ",Z&&(t+="await "),t+=""+Xe+"; "):Z?(x="customErrors"+n,t+=" var "+x+" = null; try { "+u+" = await "+Xe+"; } catch (e) { "+u+" = false; if (e instanceof ValidationError) "+x+" = e.errors; else throw e; } "):t+=" "+x+" = null; "+u+" = "+Xe+"; "}if(A.modifying&&(t+=" if ("+de+") "+y+" = "+de+"["+tt+"];"),t+=""+b,A.valid)h&&(t+=" if (true) { ");else{t+=" if ( ",A.valid===void 0?(t+=" !",T?t+=""+pe:t+=""+u):t+=" "+!A.valid+" ",t+=") { ",p=w.keyword;var ue=ue||[];ue.push(t),t="";var ue=ue||[];ue.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ";var Je=t;t=ue.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+Je+"]); ":t+=" validate.errors = ["+Je+"]; return false; ":t+=" var err = "+Je+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var ze=t;t=ue.pop(),I?A.errors?A.errors!="full"&&(t+="  for (var "+N+"="+f+"; "+N+"<errors; "+N+"++) { var "+q+" = vErrors["+N+"]; if ("+q+".dataPath === undefined) "+q+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+q+".schemaPath === undefined) { "+q+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+q+".schema = "+v+"; "+q+".data = "+y+"; "),t+=" } "):A.errors===!1?t+=" "+ze+" ":(t+=" if ("+f+" == errors) { "+ze+" } else {  for (var "+N+"="+f+"; "+N+"<errors; "+N+"++) { var "+q+" = vErrors["+N+"]; if ("+q+".dataPath === undefined) "+q+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+q+".schemaPath === undefined) { "+q+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+q+".schema = "+v+"; "+q+".data = "+y+"; "),t+=" } } "):T?(t+="   var err =   ",e.createErrors!==!1?(t+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; ")):A.errors===!1?t+=" "+ze+" ":(t+=" if (Array.isArray("+x+")) { if (vErrors === null) vErrors = "+x+"; else vErrors = vErrors.concat("+x+"); errors = vErrors.length;  for (var "+N+"="+f+"; "+N+"<errors; "+N+"++) { var "+q+" = vErrors["+N+"]; if ("+q+".dataPath === undefined) "+q+".dataPath = (dataPath || '') + "+e.errorPath+";  "+q+'.schemaPath = "'+c+'";  ',e.opts.verbose&&(t+=" "+q+".schema = "+v+"; "+q+".data = "+y+"; "),t+=" } } else { "+ze+" } "),t+=" } ",h&&(t+=" else { ")}return t}),_s}const th="http://json-schema.org/draft-07/schema#",rh="http://json-schema.org/draft-07/schema#",ah="Core schema meta-schema",sh={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},nh=["object","boolean"],ih={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},tl={$schema:th,$id:rh,title:ah,definitions:sh,type:nh,properties:ih,default:!0};var bs,eo;function oh(){if(eo)return bs;eo=1;var s=tl;return bs={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:s.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:s.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},bs}var ws,to;function lh(){if(to)return ws;to=1;var s=/^[a-z_$][a-z0-9_$-]*$/i,e=eh(),r=oh();ws={add:a,get:t,remove:n,validate:i};function a(o,l){var c=this.RULES;if(c.keywords[o])throw new Error("Keyword "+o+" is already defined");if(!s.test(o))throw new Error("Keyword "+o+" is not a valid identifier");if(l){this.validateKeyword(l,!0);var h=l.type;if(Array.isArray(h))for(var p=0;p<h.length;p++)u(o,h[p],l);else u(o,h,l);var y=l.metaSchema;y&&(l.$data&&this._opts.$data&&(y={anyOf:[y,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),l.validateSchema=this.compile(y,!0))}c.keywords[o]=c.all[o]=!0;function u(f,_,v){for(var w,C=0;C<c.length;C++){var A=c[C];if(A.type==_){w=A;break}}w||(w={type:_,rules:[]},c.push(w));var b={keyword:f,definition:v,custom:!0,code:e,implements:v.implements};w.rules.push(b),c.custom[f]=b}return this}function t(o){var l=this.RULES.custom[o];return l?l.definition:this.RULES.keywords[o]||!1}function n(o){var l=this.RULES;delete l.keywords[o],delete l.all[o],delete l.custom[o];for(var c=0;c<l.length;c++)for(var h=l[c].rules,p=0;p<h.length;p++)if(h[p].keyword==o){h.splice(p,1);break}return this}function i(o,l){i.errors=null;var c=this._validateKeyword=this._validateKeyword||this.compile(r,!0);if(c(o))return!0;if(i.errors=c.errors,l)throw new Error("custom keyword definition is invalid: "+this.errorsText(c.errors));return!1}return ws}const ch="http://json-schema.org/draft-07/schema#",uh="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",dh="Meta-schema for $data reference (JSON Schema extension proposal)",hh="object",fh=["$data"],ph={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},mh=!1,vh={$schema:ch,$id:uh,description:dh,type:hh,required:fh,properties:ph,additionalProperties:mh};var Ss,ro;function gh(){if(ro)return Ss;ro=1;var s=Id(),e=yn(),r=Ad(),a=Yo(),t=Xo(),n=Td(),i=Wd(),o=Yd(),l=Er();Ss=f,f.prototype.validate=_,f.prototype.compile=v,f.prototype.addSchema=w,f.prototype.addMetaSchema=C,f.prototype.validateSchema=A,f.prototype.getSchema=P,f.prototype.removeSchema=O,f.prototype.addFormat=se,f.prototype.errorsText=pe,f.prototype._addSchema=S,f.prototype._compile=x,f.prototype.compileAsync=Xd();var c=lh();f.prototype.addKeyword=c.add,f.prototype.getKeyword=c.get,f.prototype.removeKeyword=c.remove,f.prototype.validateKeyword=c.validate;var h=_n();f.ValidationError=h.Validation,f.MissingRefError=h.MissingRef,f.$dataMetaSchema=o;var p="http://json-schema.org/draft-07/schema",y=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],u=["/properties"];function f(E){if(!(this instanceof f))return new f(E);E=this._opts=l.copy(E)||{},ze(this),this._schemas={},this._refs={},this._fragments={},this._formats=n(E.format),this._cache=E.cache||new r,this._loadingSchemas={},this._compilations=[],this.RULES=i(),this._getId=N(E),E.loopRequired=E.loopRequired||1/0,E.errorDataPath=="property"&&(E._errorDataPathProperty=!0),E.serialize===void 0&&(E.serialize=t),this._metaOpts=Je(this),E.formats&&de(this),E.keywords&&tt(this),be(this),typeof E.meta=="object"&&this.addMetaSchema(E.meta),E.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),ue(this)}function _(E,D){var H;if(typeof E=="string"){if(H=this.getSchema(E),!H)throw new Error('no schema with key or ref "'+E+'"')}else{var ce=this._addSchema(E);H=ce.validate||this._compile(ce)}var j=H(D);return H.$async!==!0&&(this.errors=H.errors),j}function v(E,D){var H=this._addSchema(E,void 0,D);return H.validate||this._compile(H)}function w(E,D,H,ce){if(Array.isArray(E)){for(var j=0;j<E.length;j++)this.addSchema(E[j],void 0,H,ce);return this}var U=this._getId(E);if(U!==void 0&&typeof U!="string")throw new Error("schema id must be string");return D=e.normalizeId(D||U),Xe(this,D),this._schemas[D]=this._addSchema(E,H,ce,!0),this}function C(E,D,H){return this.addSchema(E,D,H,!0),this}function A(E,D){var H=E.$schema;if(H!==void 0&&typeof H!="string")throw new Error("$schema must be a string");if(H=H||this._opts.defaultMeta||b(this),!H)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var ce=this.validate(H,E);if(!ce&&D){var j="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(j);else throw new Error(j)}return ce}function b(E){var D=E._opts.meta;return E._opts.defaultMeta=typeof D=="object"?E._getId(D)||D:E.getSchema(p)?p:void 0,E._opts.defaultMeta}function P(E){var D=T(this,E);switch(typeof D){case"object":return D.validate||this._compile(D);case"string":return this.getSchema(D);case"undefined":return I(this,E)}}function I(E,D){var H=e.schema.call(E,{schema:{}},D);if(H){var ce=H.schema,j=H.root,U=H.baseId,ge=s.call(E,ce,j,void 0,U);return E._fragments[D]=new a({ref:D,fragment:!0,schema:ce,root:j,baseId:U,validate:ge}),ge}}function T(E,D){return D=e.normalizeId(D),E._schemas[D]||E._refs[D]||E._fragments[D]}function O(E){if(E instanceof RegExp)return $(this,this._schemas,E),$(this,this._refs,E),this;switch(typeof E){case"undefined":return $(this,this._schemas),$(this,this._refs),this._cache.clear(),this;case"string":var D=T(this,E);return D&&this._cache.del(D.cacheKey),delete this._schemas[E],delete this._refs[E],this;case"object":var H=this._opts.serialize,ce=H?H(E):E;this._cache.del(ce);var j=this._getId(E);j&&(j=e.normalizeId(j),delete this._schemas[j],delete this._refs[j])}return this}function $(E,D,H){for(var ce in D){var j=D[ce];!j.meta&&(!H||H.test(ce))&&(E._cache.del(j.cacheKey),delete D[ce])}}function S(E,D,H,ce){if(typeof E!="object"&&typeof E!="boolean")throw new Error("schema should be object or boolean");var j=this._opts.serialize,U=j?j(E):E,ge=this._cache.get(U);if(ge)return ge;ce=ce||this._opts.addUsedSchema!==!1;var Ee=e.normalizeId(this._getId(E));Ee&&ce&&Xe(this,Ee);var we=this._opts.validateSchema!==!1&&!D,De;we&&!(De=Ee&&Ee==e.normalizeId(E.$schema))&&this.validateSchema(E,!0);var Ae=e.ids.call(this,E),Te=new a({id:Ee,schema:E,localRefs:Ae,cacheKey:U,meta:H});return Ee[0]!="#"&&ce&&(this._refs[Ee]=Te),this._cache.put(U,Te),we&&De&&this.validateSchema(E,!0),Te}function x(E,D){if(E.compiling)return E.validate=j,j.schema=E.schema,j.errors=null,j.root=D||j,E.schema.$async===!0&&(j.$async=!0),j;E.compiling=!0;var H;E.meta&&(H=this._opts,this._opts=this._metaOpts);var ce;try{ce=s.call(this,E.schema,D,E.localRefs)}catch(U){throw delete E.validate,U}finally{E.compiling=!1,E.meta&&(this._opts=H)}return E.validate=ce,E.refs=ce.refs,E.refVal=ce.refVal,E.root=ce.root,ce;function j(){var U=E.validate,ge=U.apply(this,arguments);return j.errors=U.errors,ge}}function N(E){switch(E.schemaId){case"auto":return te;case"id":return q;default:return Z}}function q(E){return E.$id&&this.logger.warn("schema $id ignored",E.$id),E.id}function Z(E){return E.id&&this.logger.warn("schema id ignored",E.id),E.$id}function te(E){if(E.$id&&E.id&&E.$id!=E.id)throw new Error("schema $id is different from id");return E.$id||E.id}function pe(E,D){if(E=E||this.errors,!E)return"No errors";D=D||{};for(var H=D.separator===void 0?", ":D.separator,ce=D.dataVar===void 0?"data":D.dataVar,j="",U=0;U<E.length;U++){var ge=E[U];ge&&(j+=ce+ge.dataPath+" "+ge.message+H)}return j.slice(0,-H.length)}function se(E,D){return typeof D=="string"&&(D=new RegExp(D)),this._formats[E]=D,this}function be(E){var D;if(E._opts.$data&&(D=vh,E.addMetaSchema(D,D.$id,!0)),E._opts.meta!==!1){var H=tl;E._opts.$data&&(H=o(H,u)),E.addMetaSchema(H,p,!0),E._refs["http://json-schema.org/schema"]=p}}function ue(E){var D=E._opts.schemas;if(D)if(Array.isArray(D))E.addSchema(D);else for(var H in D)E.addSchema(D[H],H)}function de(E){for(var D in E._opts.formats){var H=E._opts.formats[D];E.addFormat(D,H)}}function tt(E){for(var D in E._opts.keywords){var H=E._opts.keywords[D];E.addKeyword(D,H)}}function Xe(E,D){if(E._schemas[D]||E._refs[D])throw new Error('schema with key or id "'+D+'" already exists')}function Je(E){for(var D=l.copy(E._opts),H=0;H<y.length;H++)delete D[y[H]];return D}function ze(E){var D=E._opts.logger;if(D===!1)E.logger={log:vt,warn:vt,error:vt};else{if(D===void 0&&(D=console),!(typeof D=="object"&&D.log&&D.warn&&D.error))throw new Error("logger must implement log, warn and error methods");E.logger=D}}function vt(){}return Ss}var yh=gh();const _h=wl(yh);class bh extends Sd{constructor(e,r){var a;super(r),this._serverInfo=e,this._capabilities=(a=r?.capabilities)!==null&&a!==void 0?a:{},this._instructions=r?.instructions,this.setRequestHandler(Zo,t=>this._oninitialize(t)),this.setNotificationHandler(Fo,()=>{var t;return(t=this.oninitialized)===null||t===void 0?void 0:t.call(this)})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ed(this._capabilities,e)}assertCapabilityForMethod(e){var r,a,t;switch(e){case"sampling/createMessage":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((a=this._clientCapabilities)===null||a===void 0)&&a.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break}}async _oninitialize(e){const r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Iu.includes(r)?r:$o,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},cn)}async createMessage(e,r){return this.request({method:"sampling/createMessage",params:e},Ko,r)}async elicitInput(e,r){const a=await this.request({method:"elicitation/create",params:e},Jo,r);if(a.action==="accept"&&a.content)try{const t=new _h,n=t.compile(e.requestedSchema);if(!n(a.content))throw new Be(Ze.InvalidParams,`Elicitation response content does not match requested schema: ${t.errorsText(n.errors)}`)}catch(t){throw t instanceof Be?t:new Be(Ze.InternalError,`Error validating elicitation response: ${t}`)}return a}async listRoots(e,r){return this.request({method:"roots/list",params:e},Wo,r)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}const wh=Symbol("Let zodToJsonSchema decide on which parser to use"),ao={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Sh=s=>typeof s=="string"?{...ao,name:s}:{...ao,...s},Eh=s=>{const e=Sh(s),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([a,t])=>[t._def,{def:t._def,path:[...e.basePath,e.definitionPath,a],jsonSchema:void 0}]))}};function rl(s,e,r,a){a?.errorMessages&&r&&(s.errorMessage={...s.errorMessage,[e]:r})}function $e(s,e,r,a,t){s[e]=r,rl(s,e,a,t)}const al=(s,e)=>{let r=0;for(;r<s.length&&r<e.length&&s[r]===e[r];r++);return[(s.length-r).toString(),...e.slice(r)].join("/")};var Dr;(function(s){s.assertEqual=t=>{};function e(t){}s.assertIs=e;function r(t){throw new Error}s.assertNever=r,s.arrayToEnum=t=>{const n={};for(const i of t)n[i]=i;return n},s.getValidEnumValues=t=>{const n=s.objectKeys(t).filter(o=>typeof t[t[o]]!="number"),i={};for(const o of n)i[o]=t[o];return s.objectValues(i)},s.objectValues=t=>s.objectKeys(t).map(function(n){return t[n]}),s.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{const n=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(i);return n},s.find=(t,n)=>{for(const i of t)if(n(i))return i},s.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&Number.isFinite(t)&&Math.floor(t)===t;function a(t,n=" | "){return t.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(Dr||(Dr={}));var so;(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(so||(so={}));Dr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);Dr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ga extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof ga))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Dr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r=Object.create(null),a=[];for(const t of this.issues)if(t.path.length>0){const n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}ga.create=s=>new ga(s);var no;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(no||(no={}));var fe;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(fe||(fe={}));function dt(s){if(s.target!=="openAi")return{};const e=[...s.basePath,s.definitionPath,s.openAiAnyTypeName];return s.flags.hasReferencedOpenAiAnyType=!0,{$ref:s.$refStrategy==="relative"?al(e,s.currentPath):e.join("/")}}function Ph(s,e){const r={type:"array"};return s.type?._def&&s.type?._def?.typeName!==fe.ZodAny&&(r.items=Oe(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&$e(r,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&$e(r,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&($e(r,"minItems",s.exactLength.value,s.exactLength.message,e),$e(r,"maxItems",s.exactLength.value,s.exactLength.message,e)),r}function xh(s,e){const r={type:"integer",format:"int64"};if(!s.checks)return r;for(const a of s.checks)switch(a.kind){case"min":e.target==="jsonSchema7"?a.inclusive?$e(r,"minimum",a.value,a.message,e):$e(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),$e(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?$e(r,"maximum",a.value,a.message,e):$e(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),$e(r,"maximum",a.value,a.message,e));break;case"multipleOf":$e(r,"multipleOf",a.value,a.message,e);break}return r}function Rh(){return{type:"boolean"}}function sl(s,e){return Oe(s.type._def,e)}const kh=(s,e)=>Oe(s.innerType._def,e);function nl(s,e,r){const a=r??e.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((t,n)=>nl(s,e,t))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Ih(s,e)}}const Ih=(s,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const a of s.checks)switch(a.kind){case"min":$e(r,"minimum",a.value,a.message,e);break;case"max":$e(r,"maximum",a.value,a.message,e);break}return r};function Ah(s,e){return{...Oe(s.innerType._def,e),default:s.defaultValue()}}function Th(s,e){return e.effectStrategy==="input"?Oe(s.schema._def,e):dt(e)}function Oh(s){return{type:"string",enum:Array.from(s.values)}}const $h=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function Ch(s,e){const r=[Oe(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Oe(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n);let a=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const t=[];return r.forEach(n=>{if($h(n))t.push(...n.allOf),n.unevaluatedProperties===void 0&&(a=void 0);else{let i=n;if("additionalProperties"in n&&n.additionalProperties===!1){const{additionalProperties:o,...l}=n;i=l}else a=void 0;t.push(i)}}),t.length?{allOf:t,...a}:void 0}function Nh(s,e){const r=typeof s.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[s.value]}:{type:r==="bigint"?"integer":r,const:s.value}}let Es;const xt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Es===void 0&&(Es=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Es),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function il(s,e){const r={type:"string"};if(s.checks)for(const a of s.checks)switch(a.kind){case"min":$e(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e);break;case"max":$e(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Rt(r,"email",a.message,e);break;case"format:idn-email":Rt(r,"idn-email",a.message,e);break;case"pattern:zod":at(r,xt.email,a.message,e);break}break;case"url":Rt(r,"uri",a.message,e);break;case"uuid":Rt(r,"uuid",a.message,e);break;case"regex":at(r,a.regex,a.message,e);break;case"cuid":at(r,xt.cuid,a.message,e);break;case"cuid2":at(r,xt.cuid2,a.message,e);break;case"startsWith":at(r,RegExp(`^${Ps(a.value,e)}`),a.message,e);break;case"endsWith":at(r,RegExp(`${Ps(a.value,e)}$`),a.message,e);break;case"datetime":Rt(r,"date-time",a.message,e);break;case"date":Rt(r,"date",a.message,e);break;case"time":Rt(r,"time",a.message,e);break;case"duration":Rt(r,"duration",a.message,e);break;case"length":$e(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e),$e(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"includes":{at(r,RegExp(Ps(a.value,e)),a.message,e);break}case"ip":{a.version!=="v6"&&Rt(r,"ipv4",a.message,e),a.version!=="v4"&&Rt(r,"ipv6",a.message,e);break}case"base64url":at(r,xt.base64url,a.message,e);break;case"jwt":at(r,xt.jwt,a.message,e);break;case"cidr":{a.version!=="v6"&&at(r,xt.ipv4Cidr,a.message,e),a.version!=="v4"&&at(r,xt.ipv6Cidr,a.message,e);break}case"emoji":at(r,xt.emoji(),a.message,e);break;case"ulid":{at(r,xt.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Rt(r,"binary",a.message,e);break}case"contentEncoding:base64":{$e(r,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{at(r,xt.base64,a.message,e);break}}break}case"nanoid":at(r,xt.nanoid,a.message,e)}return r}function Ps(s,e){return e.patternStrategy==="escape"?jh(s):s}const Dh=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function jh(s){let e="";for(let r=0;r<s.length;r++)Dh.has(s[r])||(e+="\\"),e+=s[r];return e}function Rt(s,e,r,a){s.format||s.anyOf?.some(t=>t.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&a.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...r&&a.errorMessages&&{errorMessage:{format:r}}})):$e(s,"format",e,r,a)}function at(s,e,r,a){s.pattern||s.allOf?.some(t=>t.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&a.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:io(e,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):$e(s,"pattern",io(e,a),r,a)}function io(s,e){if(!e.applyRegexFlags||!s.flags)return s.source;const r={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},a=r.i?s.source.toLowerCase():s.source;let t="",n=!1,i=!1,o=!1;for(let l=0;l<a.length;l++){if(n){t+=a[l],n=!1;continue}if(r.i){if(i){if(a[l].match(/[a-z]/)){o?(t+=a[l],t+=`${a[l-2]}-${a[l]}`.toUpperCase(),o=!1):a[l+1]==="-"&&a[l+2]?.match(/[a-z]/)?(t+=a[l],o=!0):t+=`${a[l]}${a[l].toUpperCase()}`;continue}}else if(a[l].match(/[a-z]/)){t+=`[${a[l]}${a[l].toUpperCase()}]`;continue}}if(r.m){if(a[l]==="^"){t+=`(^|(?<=[\r
]))`;continue}else if(a[l]==="$"){t+=`($|(?=[\r
]))`;continue}}if(r.s&&a[l]==="."){t+=i?`${a[l]}\r
`:`[${a[l]}\r
]`;continue}t+=a[l],a[l]==="\\"?n=!0:i&&a[l]==="]"?i=!1:!i&&a[l]==="["&&(i=!0)}try{new RegExp(t)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return t}function ol(s,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&s.keyType?._def.typeName===fe.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((a,t)=>({...a,[t]:Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",t]})??dt(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const r={type:"object",additionalProperties:Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(s.keyType?._def.typeName===fe.ZodString&&s.keyType._def.checks?.length){const{type:a,...t}=il(s.keyType._def,e);return{...r,propertyNames:t}}else{if(s.keyType?._def.typeName===fe.ZodEnum)return{...r,propertyNames:{enum:s.keyType._def.values}};if(s.keyType?._def.typeName===fe.ZodBranded&&s.keyType._def.type._def.typeName===fe.ZodString&&s.keyType._def.type._def.checks?.length){const{type:a,...t}=sl(s.keyType._def,e);return{...r,propertyNames:t}}}return r}function Lh(s,e){if(e.mapStrategy==="record")return ol(s,e);const r=Oe(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||dt(e),a=Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||dt(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,a],minItems:2,maxItems:2}}}function Mh(s){const e=s.values,a=Object.keys(s.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),t=Array.from(new Set(a.map(n=>typeof n)));return{type:t.length===1?t[0]==="string"?"string":"number":["string","number"],enum:a}}function qh(s){return s.target==="openAi"?void 0:{not:dt({...s,currentPath:[...s.currentPath,"not"]})}}function Zh(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ya={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Fh(s,e){if(e.target==="openApi3")return oo(s,e);const r=s.options instanceof Map?Array.from(s.options.values()):s.options;if(r.every(a=>a._def.typeName in ya&&(!a._def.checks||!a._def.checks.length))){const a=r.reduce((t,n)=>{const i=ya[n._def.typeName];return i&&!t.includes(i)?[...t,i]:t},[]);return{type:a.length>1?a:a[0]}}else if(r.every(a=>a._def.typeName==="ZodLiteral"&&!a.description)){const a=r.reduce((t,n)=>{const i=typeof n._def.value;switch(i){case"string":case"number":case"boolean":return[...t,i];case"bigint":return[...t,"integer"];case"object":if(n._def.value===null)return[...t,"null"];default:return t}},[]);if(a.length===r.length){const t=a.filter((n,i,o)=>o.indexOf(n)===i);return{type:t.length>1?t:t[0],enum:r.reduce((n,i)=>n.includes(i._def.value)?n:[...n,i._def.value],[])}}}else if(r.every(a=>a._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((a,t)=>[...a,...t._def.values.filter(n=>!a.includes(n))],[])};return oo(s,e)}const oo=(s,e)=>{const r=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((a,t)=>Oe(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${t}`]})).filter(a=>!!a&&(!e.strictUnions||typeof a=="object"&&Object.keys(a).length>0));return r.length?{anyOf:r}:void 0};function zh(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:ya[s.innerType._def.typeName],nullable:!0}:{type:[ya[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const a=Oe(s.innerType._def,{...e,currentPath:[...e.currentPath]});return a&&"$ref"in a?{allOf:[a],nullable:!0}:a&&{...a,nullable:!0}}const r=Oe(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Uh(s,e){const r={type:"number"};if(!s.checks)return r;for(const a of s.checks)switch(a.kind){case"int":r.type="integer",rl(r,"type",a.message,e);break;case"min":e.target==="jsonSchema7"?a.inclusive?$e(r,"minimum",a.value,a.message,e):$e(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),$e(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?$e(r,"maximum",a.value,a.message,e):$e(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),$e(r,"maximum",a.value,a.message,e));break;case"multipleOf":$e(r,"multipleOf",a.value,a.message,e);break}return r}function Vh(s,e){const r=e.target==="openAi",a={type:"object",properties:{}},t=[],n=s.shape();for(const o in n){let l=n[o];if(l===void 0||l._def===void 0)continue;let c=Bh(l);c&&r&&(l._def.typeName==="ZodOptional"&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const h=Oe(l._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});h!==void 0&&(a.properties[o]=h,c||t.push(o))}t.length&&(a.required=t);const i=Hh(s,e);return i!==void 0&&(a.additionalProperties=i),a}function Hh(s,e){if(s.catchall._def.typeName!=="ZodNever")return Oe(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Bh(s){try{return s.isOptional()}catch{return!0}}const Gh=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Oe(s.innerType._def,e);const r=Oe(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:dt(e)},r]}:dt(e)},Qh=(s,e)=>{if(e.pipeStrategy==="input")return Oe(s.in._def,e);if(e.pipeStrategy==="output")return Oe(s.out._def,e);const r=Oe(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),a=Oe(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(t=>t!==void 0)}};function Kh(s,e){return Oe(s.type._def,e)}function Jh(s,e){const a={type:"array",uniqueItems:!0,items:Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&$e(a,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&$e(a,"maxItems",s.maxSize.value,s.maxSize.message,e),a}function Wh(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((r,a)=>Oe(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[]),additionalItems:Oe(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((r,a)=>Oe(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[])}}function Yh(s){return{not:dt(s)}}function Xh(s){return dt(s)}const ef=(s,e)=>Oe(s.innerType._def,e),tf=(s,e,r)=>{switch(e){case fe.ZodString:return il(s,r);case fe.ZodNumber:return Uh(s,r);case fe.ZodObject:return Vh(s,r);case fe.ZodBigInt:return xh(s,r);case fe.ZodBoolean:return Rh();case fe.ZodDate:return nl(s,r);case fe.ZodUndefined:return Yh(r);case fe.ZodNull:return Zh(r);case fe.ZodArray:return Ph(s,r);case fe.ZodUnion:case fe.ZodDiscriminatedUnion:return Fh(s,r);case fe.ZodIntersection:return Ch(s,r);case fe.ZodTuple:return Wh(s,r);case fe.ZodRecord:return ol(s,r);case fe.ZodLiteral:return Nh(s,r);case fe.ZodEnum:return Oh(s);case fe.ZodNativeEnum:return Mh(s);case fe.ZodNullable:return zh(s,r);case fe.ZodOptional:return Gh(s,r);case fe.ZodMap:return Lh(s,r);case fe.ZodSet:return Jh(s,r);case fe.ZodLazy:return()=>s.getter()._def;case fe.ZodPromise:return Kh(s,r);case fe.ZodNaN:case fe.ZodNever:return qh(r);case fe.ZodEffects:return Th(s,r);case fe.ZodAny:return dt(r);case fe.ZodUnknown:return Xh(r);case fe.ZodDefault:return Ah(s,r);case fe.ZodBranded:return sl(s,r);case fe.ZodReadonly:return ef(s,r);case fe.ZodCatch:return kh(s,r);case fe.ZodPipeline:return Qh(s,r);case fe.ZodFunction:case fe.ZodVoid:case fe.ZodSymbol:return;default:return(a=>{})()}};function Oe(s,e,r=!1){const a=e.seen.get(s);if(e.override){const o=e.override?.(s,e,a,r);if(o!==wh)return o}if(a&&!r){const o=rf(a,e);if(o!==void 0)return o}const t={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,t);const n=tf(s,s.typeName,e),i=typeof n=="function"?Oe(n(),e):n;if(i&&af(s,e,i),e.postProcess){const o=e.postProcess(i,s,e);return t.jsonSchema=i,o}return t.jsonSchema=i,i}const rf=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:al(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((r,a)=>e.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),dt(e)):e.$refStrategy==="seen"?dt(e):void 0}},af=(s,e,r)=>(s.description&&(r.description=s.description,e.markdownDescription&&(r.markdownDescription=s.description)),r),lo=(s,e)=>{const r=Eh(e);let a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[c,h])=>({...l,[c]:Oe(h._def,{...r,currentPath:[...r.basePath,r.definitionPath,c]},!0)??dt(r)}),{}):void 0;const t=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=Oe(s._def,t===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,t]},!1)??dt(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(n.title=i),r.flags.hasReferencedOpenAiAnyType&&(a||(a={}),a[r.openAiAnyTypeName]||(a[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));const o=t===void 0?a?{...n,[r.definitionPath]:a}:n:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,t].join("/"),[r.definitionPath]:{...a,[t]:n}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Js;(function(s){s.Completable="McpCompletable"})(Js||(Js={}));class Ws extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}Ws.create=(s,e)=>new Ws({type:s,typeName:Js.Completable,complete:e.complete,...sf(e)});function sf(s){if(!s)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(i,o)=>{var l,c;const{message:h}=s;return i.code==="invalid_enum_value"?{message:h??o.defaultError}:typeof o.data>"u"?{message:(l=h??a)!==null&&l!==void 0?l:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(c=h??r)!==null&&c!==void 0?c:o.defaultError}},description:t}}class nf{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new bh(e,r)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Gs.shape.method.value),this.server.assertCanSetRequestHandler(Qs.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(Gs,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{const a={name:e,title:r.title,description:r.description,inputSchema:r.inputSchema?lo(r.inputSchema,{strictUnions:!0}):of,annotations:r.annotations};return r.outputSchema&&(a.outputSchema=lo(r.outputSchema,{strictUnions:!0})),a})})),this.server.setRequestHandler(Qs,async(e,r)=>{const a=this._registeredTools[e.params.name];if(!a)throw new Be(Ze.InvalidParams,`Tool ${e.params.name} not found`);if(!a.enabled)throw new Be(Ze.InvalidParams,`Tool ${e.params.name} disabled`);let t;if(a.inputSchema){const n=await a.inputSchema.safeParseAsync(e.params.arguments);if(!n.success)throw new Be(Ze.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${n.error.message}`);const i=n.data,o=a.callback;try{t=await Promise.resolve(o(i,r))}catch(l){t={content:[{type:"text",text:l instanceof Error?l.message:String(l)}],isError:!0}}}else{const n=a.callback;try{t=await Promise.resolve(n(r))}catch(i){t={content:[{type:"text",text:i instanceof Error?i.message:String(i)}],isError:!0}}}if(a.outputSchema&&!t.isError){if(!t.structuredContent)throw new Be(Ze.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);const n=await a.outputSchema.safeParseAsync(t.structuredContent);if(!n.success)throw new Be(Ze.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${n.error.message}`)}return t}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Ks.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(Ks,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new Be(Ze.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){const a=this._registeredPrompts[r.name];if(!a)throw new Be(Ze.InvalidParams,`Prompt ${r.name} not found`);if(!a.enabled)throw new Be(Ze.InvalidParams,`Prompt ${r.name} disabled`);if(!a.argsSchema)return Qr;const t=a.argsSchema.shape[e.params.argument.name];if(!(t instanceof Ws))return Qr;const i=await t._def.complete(e.params.argument.value,e.params.context);return uo(i)}async handleResourceCompletion(e,r){const a=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!a){if(this._registeredResources[r.uri])return Qr;throw new Be(Ze.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}const t=a.resourceTemplate.completeCallback(e.params.argument.name);if(!t)return Qr;const n=await t(e.params.argument.value,e.params.context);return uo(n)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(zs.shape.method.value),this.server.assertCanSetRequestHandler(Us.shape.method.value),this.server.assertCanSetRequestHandler(Vs.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(zs,async(e,r)=>{const a=Object.entries(this._registeredResources).filter(([n,i])=>i.enabled).map(([n,i])=>({uri:n,name:i.name,...i.metadata})),t=[];for(const n of Object.values(this._registeredResourceTemplates)){if(!n.resourceTemplate.listCallback)continue;const i=await n.resourceTemplate.listCallback(r);for(const o of i.resources)t.push({...n.metadata,...o})}return{resources:[...a,...t]}}),this.server.setRequestHandler(Us,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,a])=>({name:r,uriTemplate:a.resourceTemplate.uriTemplate.toString(),...a.metadata}))})),this.server.setRequestHandler(Vs,async(e,r)=>{const a=new URL(e.params.uri),t=this._registeredResources[a.toString()];if(t){if(!t.enabled)throw new Be(Ze.InvalidParams,`Resource ${a} disabled`);return t.readCallback(a,r)}for(const n of Object.values(this._registeredResourceTemplates)){const i=n.resourceTemplate.uriTemplate.match(a.toString());if(i)return n.readCallback(a,i,r)}throw new Be(Ze.InvalidParams,`Resource ${a} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Hs.shape.method.value),this.server.assertCanSetRequestHandler(Bs.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(Hs,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?cf(r.argsSchema):void 0}))})),this.server.setRequestHandler(Bs,async(e,r)=>{const a=this._registeredPrompts[e.params.name];if(!a)throw new Be(Ze.InvalidParams,`Prompt ${e.params.name} not found`);if(!a.enabled)throw new Be(Ze.InvalidParams,`Prompt ${e.params.name} disabled`);if(a.argsSchema){const t=await a.argsSchema.safeParseAsync(e.params.arguments);if(!t.success)throw new Be(Ze.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${t.error.message}`);const n=t.data,i=a.callback;return await Promise.resolve(i(n,r))}else{const t=a.callback;return await Promise.resolve(t(r))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,r,...a){let t;typeof a[0]=="object"&&(t=a.shift());const n=a[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);const i=this._createRegisteredResource(e,void 0,r,t,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const i=this._createRegisteredResourceTemplate(e,void 0,r,t,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,a,t){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);const n=this._createRegisteredResource(e,a.title,r,a,t);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const n=this._createRegisteredResourceTemplate(e,a.title,r,a,t);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}}_createRegisteredResource(e,r,a,t,n){const i={name:e,title:r,metadata:t,readCallback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:o=>{typeof o.uri<"u"&&o.uri!==a&&(delete this._registeredResources[a],o.uri&&(this._registeredResources[o.uri]=i)),typeof o.name<"u"&&(i.name=o.name),typeof o.title<"u"&&(i.title=o.title),typeof o.metadata<"u"&&(i.metadata=o.metadata),typeof o.callback<"u"&&(i.readCallback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResources[a]=i,i}_createRegisteredResourceTemplate(e,r,a,t,n){const i={resourceTemplate:a,title:r,metadata:t,readCallback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredResourceTemplates[e],o.name&&(this._registeredResourceTemplates[o.name]=i)),typeof o.title<"u"&&(i.title=o.title),typeof o.template<"u"&&(i.resourceTemplate=o.template),typeof o.metadata<"u"&&(i.metadata=o.metadata),typeof o.callback<"u"&&(i.readCallback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=i,i}_createRegisteredPrompt(e,r,a,t,n){const i={title:r,description:a,argsSchema:t===void 0?void 0:K(t),callback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredPrompts[e],o.name&&(this._registeredPrompts[o.name]=i)),typeof o.title<"u"&&(i.title=o.title),typeof o.description<"u"&&(i.description=o.description),typeof o.argsSchema<"u"&&(i.argsSchema=K(o.argsSchema)),typeof o.callback<"u"&&(i.callback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,i}_createRegisteredTool(e,r,a,t,n,i,o){const l={title:r,description:a,inputSchema:t===void 0?void 0:K(t),outputSchema:n===void 0?void 0:K(n),annotations:i,callback:o,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:c=>{typeof c.name<"u"&&c.name!==e&&(delete this._registeredTools[e],c.name&&(this._registeredTools[c.name]=l)),typeof c.title<"u"&&(l.title=c.title),typeof c.description<"u"&&(l.description=c.description),typeof c.paramsSchema<"u"&&(l.inputSchema=K(c.paramsSchema)),typeof c.callback<"u"&&(l.callback=c.callback),typeof c.annotations<"u"&&(l.annotations=c.annotations),typeof c.enabled<"u"&&(l.enabled=c.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let a,t,n,i;if(typeof r[0]=="string"&&(a=r.shift()),r.length>1){const l=r[0];co(l)?(t=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!co(r[0])&&(i=r.shift())):typeof l=="object"&&l!==null&&(i=r.shift())}const o=r[0];return this._createRegisteredTool(e,void 0,a,t,n,i,o)}registerTool(e,r,a){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);const{title:t,description:n,inputSchema:i,outputSchema:o,annotations:l}=r;return this._createRegisteredTool(e,t,n,i,o,l,a)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let a;typeof r[0]=="string"&&(a=r.shift());let t;r.length>1&&(t=r.shift());const n=r[0],i=this._createRegisteredPrompt(e,void 0,a,t,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,a){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);const{title:t,description:n,argsSchema:i}=r,o=this._createRegisteredPrompt(e,t,n,i,a);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}}const of={type:"object",properties:{}};function co(s){return typeof s!="object"||s===null?!1:Object.keys(s).length===0||Object.values(s).some(lf)}function lf(s){return s!==null&&typeof s=="object"&&"parse"in s&&typeof s.parse=="function"&&"safeParse"in s&&typeof s.safeParse=="function"}function cf(s){return Object.entries(s.shape).map(([e,r])=>({name:e,description:r.description,required:!r.isOptional()}))}function uo(s){return{completion:{values:s.slice(0,100),total:s.length,hasMore:s.length>100}}}const Qr={completion:{values:[],hasMore:!1}},ll=Sl.create({baseURL:window.wpAmeliaActionURL});ll.interceptors.request.use(s=>(s.params={...s.params,wpAmeliaNonce:window.wpAmeliaNonce},s),s=>Promise.reject(s));async function Kr(s,e={},r="GET",a){return(await ll.request({url:s,method:r,params:e,data:a})).data}function uf(){const s=new nf({name:"amelia-booking-service",version:"1.0.0"},{capabilities:{tools:{}}});return s.tool("list-services","Get all available booking services from Amelia. Use this when the user asks about services, available appointments, or what can be booked.",{},async()=>{const e=await Kr("/services"),r=e?.data?.data?.services||e?.data?.services||e?.services;if(r&&Array.isArray(r))return{content:[{type:"text",text:JSON.stringify(r,null,2)}]};throw new Error("No services found in response")}),s.tool("list-employees","Get all employees/providers who can deliver services. Use this to find provider IDs needed for creating appointments.",{},async()=>{const e=await Kr("/users/providers"),r=e?.data?.users||e?.users;if(r&&Array.isArray(r))return{content:[{type:"text",text:JSON.stringify(r,null,2)}]};throw new Error("No employees found in response")}),s.tool("list-customers","Get all customers in the Amelia system. Use this to find customer IDs needed for creating appointments.",{limit:Me().min(1).max(500).optional().describe("Number of customers to retrieve (default 100, max 500)"),search:V().optional().describe("Search customers by name or email"),page:Me().min(1).optional().describe("Page number for pagination (default 1)")},async({limit:e,search:r,page:a})=>{const t={page:a||1,limit:e||100};r&&(t.search=r);const n=await Kr("/users/customers",t),i=n?.data?.users||n?.users;if(i&&Array.isArray(i))return{content:[{type:"text",text:JSON.stringify(i,null,2)}]};throw new Error("No customers found in response")}),s.tool("create-appointment","Creates a new appointment booking in the Amelia system. Use this when user wants to book/create/schedule an appointment.",{serviceId:Me().describe("The ID of the service to book. Use list-services tool to get available service IDs."),providerId:Me().describe("The ID of the employee/provider who will deliver the service. Use list-employees to get provider IDs."),customerId:Me().describe("The ID of the customer making the booking. Use list-customers to get customer IDs."),bookingStart:V().regex(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/).describe('The appointment start date and time in format YYYY-MM-DD HH:mm (e.g., "2025-11-28 14:00")'),locationId:Me().optional().describe("Optional: The ID of the location where the service will be provided"),duration:Me().optional().describe("Optional: Duration in seconds. If not provided, uses the service default duration"),persons:Me().min(1).optional().describe("Optional: Number of persons for this booking. Default is 1"),status:jt(["approved","pending","rejected","canceled"]).optional().describe('Optional: Booking status. Default is "approved"'),notifyParticipants:Me().min(0).max(1).optional().describe("Optional: Whether to send notification emails. 1 = yes, 0 = no. Default is 1"),internalNotes:V().optional().describe("Optional: Internal notes for this appointment (not visible to customer)")},async({serviceId:e,providerId:r,customerId:a,bookingStart:t,locationId:n,duration:i,persons:o,status:l,notifyParticipants:c,internalNotes:h})=>{const[p,y]=t.split(" ");if(!p||!y)throw new Error("Invalid bookingStart format. Expected format: YYYY-MM-DD HH:mm");const f=await Kr("/appointments",{},"POST",{serviceId:e,providerId:r,locationId:n||null,bookingStart:t,date:p,time:y,notifyParticipants:c!==void 0?c:1,internalNotes:h||"",bookings:[{customerId:a,persons:o||1,status:l||"approved",duration:i||null,extras:[],customFields:[]}],recurring:[],payment:{gateway:"onSite",amount:0}});return{content:[{type:"text",text:JSON.stringify(f,null,2)}]}}),s}const ho=async()=>{try{const s=uf(),e=new tu;if(typeof e.waitForReady=="function")try{await e.waitForReady()}catch{}await e.registerServer({name:"Amelia Booking System",version:"1.0.0",description:"Amelia Booking System - Manage appointments, services, employees, and customers. Tools: list-services (get services), list-employees (get providers), list-customers (get customers), create-appointment (book/create/schedule appointments).",server:s})}catch(s){console.error(" [Amelia MCP] Registration failed:",s)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ho):ho();
